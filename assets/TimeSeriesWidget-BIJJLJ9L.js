import{r as o,j as g}from"./index-ChiMlKh7.js";import{i as S}from"./index-OzhOYD-U.js";function L({config:e,data:r}){const i=o.useRef(null),a=o.useRef(null);return o.useEffect(()=>{if(i.current&&r.length>0){a.current||(a.current=S(i.current));const{params:l}=e,p=l.x_axis,m=l.groupBy?.[0],n=l.metrics[0],u=typeof n=="string"?n:n.label,c=Array.from(new Set(r.map(s=>new Date(s[p]).toLocaleString()))).sort();let x=[],d=[];if(m){const s=Array.from(new Set(r.map(t=>t[m]).filter(t=>t)));d=s,x=s.map(t=>{const h=c.map(b=>{const f=r.find(y=>y[m]===t&&new Date(y[p]).toLocaleString()===b);debugger;return f?f[n.label]:0});return{name:t,type:"line",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:h,label:{show:e.params.show_value,position:"top",formatter:"{c}"}}})}else d=[u],x=[{name:u,type:"line",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:c.map(s=>{const t=r.find(h=>new Date(h[p]).toLocaleString()===s);return t?t[u]:0}),label:{show:e.params.show_value,position:"top",formatter:"{c}"}}];debugger;const w={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:e.params.show_legend,type:e.params.legendType,orient:e.params.legendOrientation==="top"?"horizontal":"vertical",top:e.params.legendOrientation==="top"?"top":"center",left:e.params.legendOrientation==="top"?"center":"left",data:d},xAxis:{type:"category",data:c,axisLabel:{rotate:e.params.x_axis_label_rotation||0}},yAxis:{type:"value",name:e.params.y_axis_title},series:x,grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};a.current.setOption(w)}},[r,e]),o.useEffect(()=>()=>{a.current&&(a.current.dispose(),a.current=null)},[]),r.length?g.jsx("div",{ref:i,style:{width:"100%",height:"400px"}}):g.jsx("div",{children:"Loading Time Series Chart..."})}export{L as TimeSeriesWidget};
