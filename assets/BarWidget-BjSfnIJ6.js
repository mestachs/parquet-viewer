import{r as m,a as v,j as w}from"./index-DDVzMRr9.js";import{i as _}from"./index-OzhOYD-U.js";function A({config:t,data:r}){const u=m.useRef(null),o=m.useRef(null),y=v();return m.useEffect(()=>{if(u.current&&r.length>0){o.current||(o.current=_(u.current));const{params:b}=t,x=b.x_axis.column,l=b.metrics[0].column.column_name,n=t.params.metrics?.[0];let a;typeof n=="string"?a=n:n&&typeof n=="object"&&"label"in n?a=n.label:a="value";const f=Array.from(new Set(r.map(s=>s[x]))).sort();let h=[],d=[];if(l){const s=Array.from(new Set(r.map(e=>e[l]).filter(e=>e))).sort();d=s;const i=new Map;s.forEach(e=>i.set(e,new Map)),r.forEach(e=>{const p=e[x],c=e[l];p&&c&&i.get(c).set(p,e[a])}),h=s.map(e=>{const p=y?.getColor(l,e);return{name:e,type:"bar",stack:t.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},itemStyle:{color:p},data:f.map(c=>i.get(e)?.get(c)||0),label:{show:t.params.show_value,position:"inside",formatter:"{c}"}}})}else d=[a],h=[{name:a,type:"bar",stack:t.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:f.map(s=>{const i=r.find(e=>e[x]===s);return i?i[a]:0}),label:{show:t.params.show_value,position:"inside",formatter:"{c}"}}];const g={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:t.params.show_legend,type:t.params.legendType,orient:t.params.legendOrientation==="top"?"horizontal":"vertical",top:t.params.legendOrientation==="top"?"top":"center",left:t.params.legendOrientation==="top"?"center":"left",data:d},xAxis:{type:"category",data:f,axisLabel:{rotate:t.params.x_axis.labelRotation||0}},yAxis:{type:"value",name:t.params.y_axis_title},series:h,grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};o.current.setOption(g)}},[r,t,y]),m.useEffect(()=>()=>{o.current&&(o.current.dispose(),o.current=null)},[]),r.length?w.jsx("div",{ref:u,style:{width:"100%",height:"400px"}}):w.jsx("div",{children:"Loading Bar Chartâ€¦"})}export{A as BarWidget};
