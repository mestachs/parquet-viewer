import{r as p,j as b}from"./index-kQLmHom5.js";import{i as w}from"./index-OzhOYD-U.js";function A({config:e,data:r}){const m=p.useRef(null),s=p.useRef(null);return p.useEffect(()=>{if(m.current&&r.length>0){s.current||(s.current=w(m.current));const{params:u}=e;console.log("BarWidget - params.groupby:",u.groupby);const i=u.x_axis.column;console.log("xAxisColumn:",i),console.log("config.params.groupby:",e.params.groupby);const l=u.metrics[0].column.column_name;console.log("seriesColumn:",l);const o=e.params.metrics?.[0];let a;typeof o=="string"?a=o:o&&typeof o=="object"&&"label"in o?a=o.label:a="value";const c=Array.from(new Set(r.map(n=>n[i])));let x=[],d=[];if(l){const n=Array.from(new Set(r.map(t=>t[l]).filter(t=>t)));d=n,x=n.map(t=>({name:t,type:"bar",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:c.map(f=>{const h=r.find(y=>y[i]===f&&y[l]===t);return h?h[a]:0}),label:{show:e.params.show_value,position:"inside",formatter:"{c}"}}))}else d=[a],x=[{name:a,type:"bar",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:c.map(n=>{const t=r.find(f=>f[i]===n);return t?t[a]:0}),label:{show:e.params.show_value,position:"inside",formatter:"{c}"}}];const g={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:e.params.show_legend,type:e.params.legendType,orient:e.params.legendOrientation==="top"?"horizontal":"vertical",top:e.params.legendOrientation==="top"?"top":"center",left:e.params.legendOrientation==="top"?"center":"left",data:d},xAxis:{type:"category",data:c,axisLabel:{rotate:e.params.x_axis.labelRotation||0}},yAxis:{type:"value",name:e.params.y_axis_title},series:x,grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};s.current.setOption(g)}},[r,e]),p.useEffect(()=>()=>{s.current&&(s.current.dispose(),s.current=null)},[]),r.length?b.jsx("div",{ref:m,style:{width:"100%",height:"400px"}}):b.jsx("div",{children:"Loading Bar Chartâ€¦"})}export{A as BarWidget};
