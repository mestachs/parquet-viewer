import{r as p,a as v,j as S}from"./index-M3yaa66H.js";import{i as _}from"./index-OzhOYD-U.js";function E({config:e,data:s}){const c=p.useRef(null),o=p.useRef(null),y=v();return p.useEffect(()=>{if(c.current&&s.length>0){o.current||(o.current=_(c.current));const{params:m}=e,u=m.x_axis,n=m.groupBy?.[0],x=m.metrics[0],i=typeof x=="string"?x:x.label,h=Array.from(new Set(s.map(a=>new Date(a[u]).toISOString()))).sort();let f=[],d=[];if(n){const a=Array.from(new Set(s.map(t=>t[n]).filter(t=>t))).sort();d=a;const r=new Map;a.forEach(t=>r.set(t,new Map)),s.forEach(t=>{const g=new Date(t[u]).toISOString(),l=t[n];l&&r.get(l).set(g,t[i])}),f=a.map(t=>{const g=h.map(b=>r.get(t)?.get(b)||0),l=y?.getColor(n,t);return{name:t,type:"line",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},itemStyle:{color:l},data:g,label:{show:e.params.show_value,position:"top",formatter:"{c}"}}})}else{d=[i];const a=new Map;s.forEach(r=>{const t=new Date(r[u]).toISOString();a.set(t,r[i])}),f=[{name:i,type:"line",stack:e.params.stack==="Stack"?"total":void 0,emphasis:{focus:"series"},data:h.map(r=>a.get(r)||0),label:{show:e.params.show_value,position:"top",formatter:"{c}"}}]}const w={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},toolbox:{feature:{dataZoom:{},restore:{},saveAsImage:{}}},legend:{show:e.params.show_legend,type:e.params.legendType,orient:e.params.legendOrientation==="top"?"horizontal":"vertical",top:e.params.legendOrientation==="top"?"top":"center",left:e.params.legendOrientation==="top"?"center":"left",data:d},xAxis:{type:"category",data:h,axisLabel:{rotate:e.params.x_axis_label_rotation||0}},yAxis:{type:"value",name:e.params.y_axis_title},series:f,grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};o.current.setOption(w)}},[s,e,y]),p.useEffect(()=>()=>{o.current&&(o.current.dispose(),o.current=null)},[]),s.length?S.jsx("div",{ref:c,style:{width:"100%",height:"400px"}}):S.jsx("div",{children:"Loading Time Series Chart..."})}export{E as TimeSeriesWidget};
