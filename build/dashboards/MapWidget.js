var Gb=Object.create;var{getPrototypeOf:Eb,defineProperty:B3,getOwnPropertyNames:GC,getOwnPropertyDescriptor:jb}=Object,EC=Object.prototype.hasOwnProperty;var A0=($,Q,J)=>{J=$!=null?Gb(Eb($)):{};let Z=Q||!$||!$.__esModule?B3(J,"default",{value:$,enumerable:!0}):J;for(let K of GC($))if(!EC.call(Z,K))B3(Z,K,{get:()=>$[K],enumerable:!0});return Z},IC=new WeakMap,J5=($)=>{var Q=IC.get($),J;if(Q)return Q;if(Q=B3({},"__esModule",{value:!0}),$&&typeof $==="object"||typeof $==="function")GC($).map((Z)=>!EC.call(Q,Z)&&B3(Q,Z,{get:()=>$[Z],enumerable:!(J=jb($,Z))||J.enumerable}));return IC.set($,Q),Q},g=($,Q)=>()=>(Q||$((Q={exports:{}}).exports,Q),Q.exports);var E7=($,Q)=>{for(var J in Q)B3($,J,{get:Q[J],enumerable:!0,configurable:!0,set:(Z)=>Q[J]=()=>Z})};var C=($,Q)=>()=>($&&(Q=$($=0)),Q);var Z5=g((hb,o$)=>{(function(){function $(A,h){Object.defineProperty(Z.prototype,A,{get:function(){console.warn("%s(...) is deprecated in plain JavaScript React classes. %s",h[0],h[1])}})}function Q(A){if(A===null||typeof A!=="object")return null;return A=y8&&A[y8]||A["@@iterator"],typeof A==="function"?A:null}function J(A,h){A=(A=A.constructor)&&(A.displayName||A.name)||"ReactClass";var u=A+"."+h;l$[u]||(console.error("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",h,A),l$[u]=!0)}function Z(A,h,u){this.props=A,this.context=h,this.refs=JY,this.updater=u||CC}function K(){}function X(A,h,u){this.props=A,this.context=h,this.refs=JY,this.updater=u||CC}function Y(A){return""+A}function W(A){try{Y(A);var h=!1}catch(t){h=!0}if(h){h=console;var u=h.error,o=typeof Symbol==="function"&&Symbol.toStringTag&&A[Symbol.toStringTag]||A.constructor.name||"Object";return u.call(h,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",o),Y(A)}}function q(A){if(A==null)return null;if(typeof A==="function")return A.$$typeof===Mb?null:A.displayName||A.name||null;if(typeof A==="string")return A;switch(A){case u6:return"Fragment";case B1:return"Profiler";case c:return"StrictMode";case n6:return"Suspense";case w4:return"SuspenseList";case S4:return"Activity"}if(typeof A==="object")switch(typeof A.tag==="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),A.$$typeof){case F6:return"Portal";case w0:return(A.displayName||"Context")+".Provider";case u1:return(A._context.displayName||"Context")+".Consumer";case i6:var h=A.render;return A=A.displayName,A||(A=h.displayName||h.name||"",A=A!==""?"ForwardRef("+A+")":"ForwardRef"),A;case G7:return h=A.displayName||null,h!==null?h:q(A.type)||"Memo";case q0:h=A._payload,A=A._init;try{return q(A(h))}catch(u){}}return null}function H(A){if(A===u6)return"<>";if(typeof A==="object"&&A!==null&&A.$$typeof===q0)return"<...>";try{var h=q(A);return h?"<"+h+">":"<...>"}catch(u){return"<...>"}}function F(){var A=S1.A;return A===null?null:A.getOwner()}function U(){return Error("react-stack-top-frame")}function V(A){if(u$.call(A,"key")){var h=Object.getOwnPropertyDescriptor(A,"key").get;if(h&&h.isReactWarning)return!1}return A.key!==void 0}function N(A,h){function u(){BC||(BC=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",h))}u.isReactWarning=!0,Object.defineProperty(A,"key",{get:u,configurable:!0})}function D(){var A=q(this.type);return OC[A]||(OC[A]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),A=this.props.ref,A!==void 0?A:null}function z(A,h,u,o,t,T1,R1,x1){return u=T1.ref,A={$$typeof:d5,type:A,key:h,props:T1,_owner:t},(u!==void 0?u:null)!==null?Object.defineProperty(A,"ref",{enumerable:!1,get:D}):Object.defineProperty(A,"ref",{enumerable:!1,value:null}),A._store={},Object.defineProperty(A._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(A,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(A,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:R1}),Object.defineProperty(A,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:x1}),Object.freeze&&(Object.freeze(A.props),Object.freeze(A)),A}function B(A,h){return h=z(A.type,h,void 0,void 0,A._owner,A.props,A._debugStack,A._debugTask),A._store&&(h._store.validated=A._store.validated),h}function M(A){return typeof A==="object"&&A!==null&&A.$$typeof===d5}function P(A){var h={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(u){return h[u]})}function O(A,h){return typeof A==="object"&&A!==null&&A.key!=null?(W(A.key),P(""+A.key)):h.toString(36)}function G(){}function L(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status==="string"?A.then(G,G):(A.status="pending",A.then(function(h){A.status==="pending"&&(A.status="fulfilled",A.value=h)},function(h){A.status==="pending"&&(A.status="rejected",A.reason=h)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function b(A,h,u,o,t){var T1=typeof A;if(T1==="undefined"||T1==="boolean")A=null;var R1=!1;if(A===null)R1=!0;else switch(T1){case"bigint":case"string":case"number":R1=!0;break;case"object":switch(A.$$typeof){case d5:case F6:R1=!0;break;case q0:return R1=A._init,b(R1(A._payload),h,u,o,t)}}if(R1){R1=A,t=t(R1);var x1=o===""?"."+O(R1,0):o;return zC(t)?(u="",x1!=null&&(u=x1.replace(MC,"$&/")+"/"),b(t,h,u,"",function(T4){return T4})):t!=null&&(M(t)&&(t.key!=null&&(R1&&R1.key===t.key||W(t.key)),u=B(t,u+(t.key==null||R1&&R1.key===t.key?"":(""+t.key).replace(MC,"$&/")+"/")+x1),o!==""&&R1!=null&&M(R1)&&R1.key==null&&R1._store&&!R1._store.validated&&(u._store.validated=2),t=u),h.push(t)),1}if(R1=0,x1=o===""?".":o+":",zC(A))for(var P1=0;P1<A.length;P1++)o=A[P1],T1=x1+O(o,P1),R1+=b(o,h,u,T1,t);else if(P1=Q(A),typeof P1==="function")for(P1===A.entries&&(PC||console.warn("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),PC=!0),A=P1.call(A),P1=0;!(o=A.next()).done;)o=o.value,T1=x1+O(o,P1++),R1+=b(o,h,u,T1,t);else if(T1==="object"){if(typeof A.then==="function")return b(L(A),h,u,o,t);throw h=String(A),Error("Objects are not valid as a React child (found: "+(h==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":h)+"). If you meant to render a collection of children, use an array instead.")}return R1}function d(A,h,u){if(A==null)return A;var o=[],t=0;return b(A,o,"","",function(T1){return h.call(u,T1,t++)}),o}function p(A){if(A._status===-1){var h=A._result;h=h(),h.then(function(u){if(A._status===0||A._status===-1)A._status=1,A._result=u},function(u){if(A._status===0||A._status===-1)A._status=2,A._result=u}),A._status===-1&&(A._status=0,A._result=h)}if(A._status===1)return h=A._result,h===void 0&&console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))

Did you accidentally put curly braces around the import?`,h),"default"in h||console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))`,h),h.default;throw A._result}function i(){var A=S1.H;return A===null&&console.error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`),A}function l(){}function N1(A){if(i$===null)try{var h=("require"+Math.random()).slice(0,7);i$=(o$&&o$[h]).call(o$,"timers").setImmediate}catch(u){i$=function(o){SC===!1&&(SC=!0,typeof MessageChannel>"u"&&console.error("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var t=new MessageChannel;t.port1.onmessage=o,t.port2.postMessage(void 0)}}return i$(A)}function Y1(A){return 1<A.length&&typeof AggregateError==="function"?AggregateError(A):A[0]}function a(A,h){h!==n$-1&&console.error("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),n$=h}function D1(A,h,u){var o=S1.actQueue;if(o!==null)if(o.length!==0)try{F0(o),N1(function(){return D1(A,h,u)});return}catch(t){S1.thrownErrors.push(t)}else S1.actQueue=null;0<S1.thrownErrors.length?(o=Y1(S1.thrownErrors),S1.thrownErrors.length=0,u(o)):h(A)}function F0(A){if(!ZY){ZY=!0;var h=0;try{for(;h<A.length;h++){var u=A[h];do{S1.didUsePromise=!1;var o=u(!1);if(o!==null){if(S1.didUsePromise){A[h]=u,A.splice(0,h);return}u=o}else break}while(1)}A.length=0}catch(t){A.splice(0,h+1),S1.thrownErrors.push(t)}finally{ZY=!1}}}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart==="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var d5=Symbol.for("react.transitional.element"),F6=Symbol.for("react.portal"),u6=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),B1=Symbol.for("react.profiler"),u1=Symbol.for("react.consumer"),w0=Symbol.for("react.context"),i6=Symbol.for("react.forward_ref"),n6=Symbol.for("react.suspense"),w4=Symbol.for("react.suspense_list"),G7=Symbol.for("react.memo"),q0=Symbol.for("react.lazy"),S4=Symbol.for("react.activity"),y8=Symbol.iterator,l$={},CC={isMounted:function(){return!1},enqueueForceUpdate:function(A){J(A,"forceUpdate")},enqueueReplaceState:function(A){J(A,"replaceState")},enqueueSetState:function(A){J(A,"setState")}},AC=Object.assign,JY={};Object.freeze(JY),Z.prototype.isReactComponent={},Z.prototype.setState=function(A,h){if(typeof A!=="object"&&typeof A!=="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,h,"setState")},Z.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};var A5={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},p$;for(p$ in A5)A5.hasOwnProperty(p$)&&$(p$,A5[p$]);K.prototype=Z.prototype,A5=X.prototype=new K,A5.constructor=X,AC(A5,Z.prototype),A5.isPureReactComponent=!0;var zC=Array.isArray,Mb=Symbol.for("react.client.reference"),S1={H:null,A:null,T:null,S:null,V:null,actQueue:null,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1,didUsePromise:!1,thrownErrors:[],getCurrentStack:null,recentlyCreatedOwnerStacks:0},u$=Object.prototype.hasOwnProperty,kC=console.createTask?console.createTask:function(){return null};A5={react_stack_bottom_frame:function(A){return A()}};var BC,RC,OC={},wb=A5.react_stack_bottom_frame.bind(A5,U)(),Sb=kC(H(U)),PC=!1,MC=/\/+/g,wC=typeof reportError==="function"?reportError:function(A){if(typeof window==="object"&&typeof window.ErrorEvent==="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A==="object"&&A!==null&&typeof A.message==="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(h))return}else if(typeof process==="object"&&typeof process.emit==="function"){process.emit("uncaughtException",A);return}console.error(A)},SC=!1,i$=null,n$=0,s$=!1,ZY=!1,TC=typeof queueMicrotask==="function"?function(A){queueMicrotask(function(){return queueMicrotask(A)})}:N1;A5=Object.freeze({__proto__:null,c:function(A){return i().useMemoCache(A)}}),hb.Children={map:d,forEach:function(A,h,u){d(A,function(){h.apply(this,arguments)},u)},count:function(A){var h=0;return d(A,function(){h++}),h},toArray:function(A){return d(A,function(h){return h})||[]},only:function(A){if(!M(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},hb.Component=Z,hb.Fragment=u6,hb.Profiler=B1,hb.PureComponent=X,hb.StrictMode=c,hb.Suspense=n6,hb.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S1,hb.__COMPILER_RUNTIME=A5,hb.act=function(A){var h=S1.actQueue,u=n$;n$++;var o=S1.actQueue=h!==null?h:[],t=!1;try{var T1=A()}catch(P1){S1.thrownErrors.push(P1)}if(0<S1.thrownErrors.length)throw a(h,u),A=Y1(S1.thrownErrors),S1.thrownErrors.length=0,A;if(T1!==null&&typeof T1==="object"&&typeof T1.then==="function"){var R1=T1;return TC(function(){t||s$||(s$=!0,console.error("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),{then:function(P1,T4){t=!0,R1.then(function(f8){if(a(h,u),u===0){try{F0(o),N1(function(){return D1(f8,P1,T4)})}catch(Ib){S1.thrownErrors.push(Ib)}if(0<S1.thrownErrors.length){var Tb=Y1(S1.thrownErrors);S1.thrownErrors.length=0,T4(Tb)}}else P1(f8)},function(f8){a(h,u),0<S1.thrownErrors.length?(f8=Y1(S1.thrownErrors),S1.thrownErrors.length=0,T4(f8)):T4(f8)})}}}var x1=T1;if(a(h,u),u===0&&(F0(o),o.length!==0&&TC(function(){t||s$||(s$=!0,console.error("A component suspended inside an `act` scope, but the `act` call was not awaited. When testing React components that depend on asynchronous data, you must await the result:\n\nawait act(() => ...)"))}),S1.actQueue=null),0<S1.thrownErrors.length)throw A=Y1(S1.thrownErrors),S1.thrownErrors.length=0,A;return{then:function(P1,T4){t=!0,u===0?(S1.actQueue=o,N1(function(){return D1(x1,P1,T4)})):P1(x1)}}},hb.cache=function(A){return function(){return A.apply(null,arguments)}},hb.captureOwnerStack=function(){var A=S1.getCurrentStack;return A===null?null:A()},hb.cloneElement=function(A,h,u){if(A===null||A===void 0)throw Error("The argument must be a React element, but you passed "+A+".");var o=AC({},A.props),t=A.key,T1=A._owner;if(h!=null){var R1;$:{if(u$.call(h,"ref")&&(R1=Object.getOwnPropertyDescriptor(h,"ref").get)&&R1.isReactWarning){R1=!1;break $}R1=h.ref!==void 0}R1&&(T1=F()),V(h)&&(W(h.key),t=""+h.key);for(x1 in h)!u$.call(h,x1)||x1==="key"||x1==="__self"||x1==="__source"||x1==="ref"&&h.ref===void 0||(o[x1]=h[x1])}var x1=arguments.length-2;if(x1===1)o.children=u;else if(1<x1){R1=Array(x1);for(var P1=0;P1<x1;P1++)R1[P1]=arguments[P1+2];o.children=R1}o=z(A.type,t,void 0,void 0,T1,o,A._debugStack,A._debugTask);for(t=2;t<arguments.length;t++)T1=arguments[t],M(T1)&&T1._store&&(T1._store.validated=1);return o},hb.createContext=function(A){return A={$$typeof:w0,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:u1,_context:A},A._currentRenderer=null,A._currentRenderer2=null,A},hb.createElement=function(A,h,u){for(var o=2;o<arguments.length;o++){var t=arguments[o];M(t)&&t._store&&(t._store.validated=1)}if(o={},t=null,h!=null)for(P1 in RC||!("__self"in h)||"key"in h||(RC=!0,console.warn("Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: https://react.dev/link/new-jsx-transform")),V(h)&&(W(h.key),t=""+h.key),h)u$.call(h,P1)&&P1!=="key"&&P1!=="__self"&&P1!=="__source"&&(o[P1]=h[P1]);var T1=arguments.length-2;if(T1===1)o.children=u;else if(1<T1){for(var R1=Array(T1),x1=0;x1<T1;x1++)R1[x1]=arguments[x1+2];Object.freeze&&Object.freeze(R1),o.children=R1}if(A&&A.defaultProps)for(P1 in T1=A.defaultProps,T1)o[P1]===void 0&&(o[P1]=T1[P1]);t&&N(o,typeof A==="function"?A.displayName||A.name||"Unknown":A);var P1=1e4>S1.recentlyCreatedOwnerStacks++;return z(A,t,void 0,void 0,F(),o,P1?Error("react-stack-top-frame"):wb,P1?kC(H(A)):Sb)},hb.createRef=function(){var A={current:null};return Object.seal(A),A},hb.forwardRef=function(A){A!=null&&A.$$typeof===G7?console.error("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):typeof A!=="function"?console.error("forwardRef requires a render function but was given %s.",A===null?"null":typeof A):A.length!==0&&A.length!==2&&console.error("forwardRef render functions accept exactly two parameters: props and ref. %s",A.length===1?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),A!=null&&A.defaultProps!=null&&console.error("forwardRef render functions do not support defaultProps. Did you accidentally pass a React component?");var h={$$typeof:i6,render:A},u;return Object.defineProperty(h,"displayName",{enumerable:!1,configurable:!0,get:function(){return u},set:function(o){u=o,A.name||A.displayName||(Object.defineProperty(A,"name",{value:o}),A.displayName=o)}}),h},hb.isValidElement=M,hb.lazy=function(A){return{$$typeof:q0,_payload:{_status:-1,_result:A},_init:p}},hb.memo=function(A,h){A==null&&console.error("memo: The first argument must be a component. Instead received: %s",A===null?"null":typeof A),h={$$typeof:G7,type:A,compare:h===void 0?null:h};var u;return Object.defineProperty(h,"displayName",{enumerable:!1,configurable:!0,get:function(){return u},set:function(o){u=o,A.name||A.displayName||(Object.defineProperty(A,"name",{value:o}),A.displayName=o)}}),h},hb.startTransition=function(A){var h=S1.T,u={};S1.T=u,u._updatedFibers=new Set;try{var o=A(),t=S1.S;t!==null&&t(u,o),typeof o==="object"&&o!==null&&typeof o.then==="function"&&o.then(l,wC)}catch(T1){wC(T1)}finally{h===null&&u._updatedFibers&&(A=u._updatedFibers.size,u._updatedFibers.clear(),10<A&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table.")),S1.T=h}},hb.unstable_useCacheRefresh=function(){return i().useCacheRefresh()},hb.use=function(A){return i().use(A)},hb.useActionState=function(A,h,u){return i().useActionState(A,h,u)},hb.useCallback=function(A,h){return i().useCallback(A,h)},hb.useContext=function(A){var h=i();return A.$$typeof===u1&&console.error("Calling useContext(Context.Consumer) is not supported and will cause bugs. Did you mean to call useContext(Context) instead?"),h.useContext(A)},hb.useDebugValue=function(A,h){return i().useDebugValue(A,h)},hb.useDeferredValue=function(A,h){return i().useDeferredValue(A,h)},hb.useEffect=function(A,h,u){A==null&&console.warn("React Hook useEffect requires an effect callback. Did you forget to pass a callback to the hook?");var o=i();if(typeof u==="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return o.useEffect(A,h)},hb.useId=function(){return i().useId()},hb.useImperativeHandle=function(A,h,u){return i().useImperativeHandle(A,h,u)},hb.useInsertionEffect=function(A,h){return A==null&&console.warn("React Hook useInsertionEffect requires an effect callback. Did you forget to pass a callback to the hook?"),i().useInsertionEffect(A,h)},hb.useLayoutEffect=function(A,h){return A==null&&console.warn("React Hook useLayoutEffect requires an effect callback. Did you forget to pass a callback to the hook?"),i().useLayoutEffect(A,h)},hb.useMemo=function(A,h){return i().useMemo(A,h)},hb.useOptimistic=function(A,h){return i().useOptimistic(A,h)},hb.useReducer=function(A,h,u){return i().useReducer(A,h,u)},hb.useRef=function(A){return i().useRef(A)},hb.useState=function(A){return i().useState(A)},hb.useSyncExternalStore=function(A,h,u){return i().useSyncExternalStore(A,h,u)},hb.useTransition=function(){return i().useTransition()},hb.version="19.1.1",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop==="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())})()});class KY{config;filters;db;constructor($,Q,J){this.db=$,this.config=Q,console.log("QueryModel constructor - incoming filters:",J),this.filters=Array.isArray(J)?J:[],console.log("QueryModel constructor - this.filters after assignment:",this.filters)}buildSQL(){let $=this.config.params,Q=$.dataSource.split("__")[0],J=$.queryMode==="aggregate",Z=[];if(J){if($.groupBy?.length)Z.push(...$.groupBy);for(let F of $.metrics??[])if(typeof F==="string")Z.push(F);else if(F.sqlExpression&&F.label)Z.push(`${F.sqlExpression} AS "${F.label}"`);else if(F.aggregate&&typeof F.column!=="string"&&F.column?.column_name&&F.label)Z.push(`${F.aggregate}(${F.column.column_name}) AS "${F.label}"`)}else if($.columns&&$.columns.length>0){let F=$.columns.map((U)=>{return U.label?`${U.column} AS "${U.label}"`:U.column});Z.push(F.join(", "))}else Z.push("*");if(Z.length===0&&$.groupBy?.length)Z.push(...$.groupBy);else if(Z.length===0)Z.push("*");let K=`SELECT ${Z.join(", ")} FROM ${Q}`,X=[],Y=$.adhocFilters??[],W=[],q=[...Y,...W],H=[];for(let F of q){let U=this.filterToSQL(F);if(U)H.push(U.sql),X=X.concat(U.params)}if(H.length)K+=` WHERE ${H.join(" AND ")}`;if(J&&$.groupBy?.length)K+=` GROUP BY ${$.groupBy.join(", ")}`;if($.rowLimit)K+=` LIMIT ${$.rowLimit}`;return{sql:K,params:X}}filterToSQL($){if($.operator==="IN"&&Array.isArray($.comparator)){let Q=$.comparator.map(()=>"?").join(", ");return{sql:`${$.subject} IN (${Q})`,params:$.comparator}}if($.operator==="=")return{sql:`${$.subject} = ?`,params:[$.comparator]};return null}async execute(){let $=await this.db.connect(),Q=this.config.params.dataSource.split("__")[0];try{if((await $.query(`SELECT 1 FROM information_schema.tables WHERE table_name = '${Q}'`)).numRows===0)return console.warn(`Table '${Q}' does not exist.`),[];let{sql:Z,params:K}=this.buildSQL();return console.log(this.config.label,"executing query "+Z,K),(await(await $.prepare(Z)).query(...K)).toArray()}catch(J){return console.error("Error executing query:",J),[]}finally{await $.close()}}}var n0={};E7(n0,{default:()=>_b,__values:()=>a$,__spreadArrays:()=>lC,__spreadArray:()=>pC,__spread:()=>dC,__setFunctionName:()=>yC,__runInitializers:()=>xC,__rewriteRelativeImportExtension:()=>JA,__rest:()=>hC,__read:()=>WY,__propKey:()=>gC,__param:()=>vC,__metadata:()=>fC,__makeTemplateObject:()=>sC,__importStar:()=>oC,__importDefault:()=>rC,__generator:()=>mC,__extends:()=>jC,__exportStar:()=>cC,__esDecorate:()=>_C,__disposeResources:()=>QA,__decorate:()=>LC,__createBinding:()=>t$,__classPrivateFieldSet:()=>tC,__classPrivateFieldIn:()=>eC,__classPrivateFieldGet:()=>aC,__awaiter:()=>bC,__await:()=>b8,__asyncValues:()=>nC,__asyncGenerator:()=>uC,__asyncDelegator:()=>iC,__assign:()=>r$,__addDisposableResource:()=>$A});function jC($,Q){if(typeof Q!=="function"&&Q!==null)throw TypeError("Class extends value "+String(Q)+" is not a constructor or null");XY($,Q);function J(){this.constructor=$}$.prototype=Q===null?Object.create(Q):(J.prototype=Q.prototype,new J)}function hC($,Q){var J={};for(var Z in $)if(Object.prototype.hasOwnProperty.call($,Z)&&Q.indexOf(Z)<0)J[Z]=$[Z];if($!=null&&typeof Object.getOwnPropertySymbols==="function"){for(var K=0,Z=Object.getOwnPropertySymbols($);K<Z.length;K++)if(Q.indexOf(Z[K])<0&&Object.prototype.propertyIsEnumerable.call($,Z[K]))J[Z[K]]=$[Z[K]]}return J}function LC($,Q,J,Z){var K=arguments.length,X=K<3?Q:Z===null?Z=Object.getOwnPropertyDescriptor(Q,J):Z,Y;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")X=Reflect.decorate($,Q,J,Z);else for(var W=$.length-1;W>=0;W--)if(Y=$[W])X=(K<3?Y(X):K>3?Y(Q,J,X):Y(Q,J))||X;return K>3&&X&&Object.defineProperty(Q,J,X),X}function vC($,Q){return function(J,Z){Q(J,Z,$)}}function _C($,Q,J,Z,K,X){function Y(M){if(M!==void 0&&typeof M!=="function")throw TypeError("Function expected");return M}var W=Z.kind,q=W==="getter"?"get":W==="setter"?"set":"value",H=!Q&&$?Z.static?$:$.prototype:null,F=Q||(H?Object.getOwnPropertyDescriptor(H,Z.name):{}),U,V=!1;for(var N=J.length-1;N>=0;N--){var D={};for(var z in Z)D[z]=z==="access"?{}:Z[z];for(var z in Z.access)D.access[z]=Z.access[z];D.addInitializer=function(M){if(V)throw TypeError("Cannot add initializers after decoration has completed");X.push(Y(M||null))};var B=(0,J[N])(W==="accessor"?{get:F.get,set:F.set}:F[q],D);if(W==="accessor"){if(B===void 0)continue;if(B===null||typeof B!=="object")throw TypeError("Object expected");if(U=Y(B.get))F.get=U;if(U=Y(B.set))F.set=U;if(U=Y(B.init))K.unshift(U)}else if(U=Y(B))if(W==="field")K.unshift(U);else F[q]=U}if(H)Object.defineProperty(H,Z.name,F);V=!0}function xC($,Q,J){var Z=arguments.length>2;for(var K=0;K<Q.length;K++)J=Z?Q[K].call($,J):Q[K].call($);return Z?J:void 0}function gC($){return typeof $==="symbol"?$:"".concat($)}function yC($,Q,J){if(typeof Q==="symbol")Q=Q.description?"[".concat(Q.description,"]"):"";return Object.defineProperty($,"name",{configurable:!0,value:J?"".concat(J," ",Q):Q})}function fC($,Q){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata($,Q)}function bC($,Q,J,Z){function K(X){return X instanceof J?X:new J(function(Y){Y(X)})}return new(J||(J=Promise))(function(X,Y){function W(F){try{H(Z.next(F))}catch(U){Y(U)}}function q(F){try{H(Z.throw(F))}catch(U){Y(U)}}function H(F){F.done?X(F.value):K(F.value).then(W,q)}H((Z=Z.apply($,Q||[])).next())})}function mC($,Q){var J={label:0,sent:function(){if(X[0]&1)throw X[1];return X[1]},trys:[],ops:[]},Z,K,X,Y=Object.create((typeof Iterator==="function"?Iterator:Object).prototype);return Y.next=W(0),Y.throw=W(1),Y.return=W(2),typeof Symbol==="function"&&(Y[Symbol.iterator]=function(){return this}),Y;function W(H){return function(F){return q([H,F])}}function q(H){if(Z)throw TypeError("Generator is already executing.");while(Y&&(Y=0,H[0]&&(J=0)),J)try{if(Z=1,K&&(X=H[0]&2?K.return:H[0]?K.throw||((X=K.return)&&X.call(K),0):K.next)&&!(X=X.call(K,H[1])).done)return X;if(K=0,X)H=[H[0]&2,X.value];switch(H[0]){case 0:case 1:X=H;break;case 4:return J.label++,{value:H[1],done:!1};case 5:J.label++,K=H[1],H=[0];continue;case 7:H=J.ops.pop(),J.trys.pop();continue;default:if((X=J.trys,!(X=X.length>0&&X[X.length-1]))&&(H[0]===6||H[0]===2)){J=0;continue}if(H[0]===3&&(!X||H[1]>X[0]&&H[1]<X[3])){J.label=H[1];break}if(H[0]===6&&J.label<X[1]){J.label=X[1],X=H;break}if(X&&J.label<X[2]){J.label=X[2],J.ops.push(H);break}if(X[2])J.ops.pop();J.trys.pop();continue}H=Q.call($,J)}catch(F){H=[6,F],K=0}finally{Z=X=0}if(H[0]&5)throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}}function cC($,Q){for(var J in $)if(J!=="default"&&!Object.prototype.hasOwnProperty.call(Q,J))t$(Q,$,J)}function a$($){var Q=typeof Symbol==="function"&&Symbol.iterator,J=Q&&$[Q],Z=0;if(J)return J.call($);if($&&typeof $.length==="number")return{next:function(){if($&&Z>=$.length)$=void 0;return{value:$&&$[Z++],done:!$}}};throw TypeError(Q?"Object is not iterable.":"Symbol.iterator is not defined.")}function WY($,Q){var J=typeof Symbol==="function"&&$[Symbol.iterator];if(!J)return $;var Z=J.call($),K,X=[],Y;try{while((Q===void 0||Q-- >0)&&!(K=Z.next()).done)X.push(K.value)}catch(W){Y={error:W}}finally{try{if(K&&!K.done&&(J=Z.return))J.call(Z)}finally{if(Y)throw Y.error}}return X}function dC(){for(var $=[],Q=0;Q<arguments.length;Q++)$=$.concat(WY(arguments[Q]));return $}function lC(){for(var $=0,Q=0,J=arguments.length;Q<J;Q++)$+=arguments[Q].length;for(var Z=Array($),K=0,Q=0;Q<J;Q++)for(var X=arguments[Q],Y=0,W=X.length;Y<W;Y++,K++)Z[K]=X[Y];return Z}function pC($,Q,J){if(J||arguments.length===2){for(var Z=0,K=Q.length,X;Z<K;Z++)if(X||!(Z in Q)){if(!X)X=Array.prototype.slice.call(Q,0,Z);X[Z]=Q[Z]}}return $.concat(X||Array.prototype.slice.call(Q))}function b8($){return this instanceof b8?(this.v=$,this):new b8($)}function uC($,Q,J){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var Z=J.apply($,Q||[]),K,X=[];return K=Object.create((typeof AsyncIterator==="function"?AsyncIterator:Object).prototype),W("next"),W("throw"),W("return",Y),K[Symbol.asyncIterator]=function(){return this},K;function Y(N){return function(D){return Promise.resolve(D).then(N,U)}}function W(N,D){if(Z[N]){if(K[N]=function(z){return new Promise(function(B,M){X.push([N,z,B,M])>1||q(N,z)})},D)K[N]=D(K[N])}}function q(N,D){try{H(Z[N](D))}catch(z){V(X[0][3],z)}}function H(N){N.value instanceof b8?Promise.resolve(N.value.v).then(F,U):V(X[0][2],N)}function F(N){q("next",N)}function U(N){q("throw",N)}function V(N,D){if(N(D),X.shift(),X.length)q(X[0][0],X[0][1])}}function iC($){var Q,J;return Q={},Z("next"),Z("throw",function(K){throw K}),Z("return"),Q[Symbol.iterator]=function(){return this},Q;function Z(K,X){Q[K]=$[K]?function(Y){return(J=!J)?{value:b8($[K](Y)),done:!1}:X?X(Y):Y}:X}}function nC($){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var Q=$[Symbol.asyncIterator],J;return Q?Q.call($):($=typeof a$==="function"?a$($):$[Symbol.iterator](),J={},Z("next"),Z("throw"),Z("return"),J[Symbol.asyncIterator]=function(){return this},J);function Z(X){J[X]=$[X]&&function(Y){return new Promise(function(W,q){Y=$[X](Y),K(W,q,Y.done,Y.value)})}}function K(X,Y,W,q){Promise.resolve(q).then(function(H){X({value:H,done:W})},Y)}}function sC($,Q){if(Object.defineProperty)Object.defineProperty($,"raw",{value:Q});else $.raw=Q;return $}function oC($){if($&&$.__esModule)return $;var Q={};if($!=null){for(var J=YY($),Z=0;Z<J.length;Z++)if(J[Z]!=="default")t$(Q,$,J[Z])}return Lb(Q,$),Q}function rC($){return $&&$.__esModule?$:{default:$}}function aC($,Q,J,Z){if(J==="a"&&!Z)throw TypeError("Private accessor was defined without a getter");if(typeof Q==="function"?$!==Q||!Z:!Q.has($))throw TypeError("Cannot read private member from an object whose class did not declare it");return J==="m"?Z:J==="a"?Z.call($):Z?Z.value:Q.get($)}function tC($,Q,J,Z,K){if(Z==="m")throw TypeError("Private method is not writable");if(Z==="a"&&!K)throw TypeError("Private accessor was defined without a setter");if(typeof Q==="function"?$!==Q||!K:!Q.has($))throw TypeError("Cannot write private member to an object whose class did not declare it");return Z==="a"?K.call($,J):K?K.value=J:Q.set($,J),J}function eC($,Q){if(Q===null||typeof Q!=="object"&&typeof Q!=="function")throw TypeError("Cannot use 'in' operator on non-object");return typeof $==="function"?Q===$:$.has(Q)}function $A($,Q,J){if(Q!==null&&Q!==void 0){if(typeof Q!=="object"&&typeof Q!=="function")throw TypeError("Object expected.");var Z,K;if(J){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");Z=Q[Symbol.asyncDispose]}if(Z===void 0){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");if(Z=Q[Symbol.dispose],J)K=Z}if(typeof Z!=="function")throw TypeError("Object not disposable.");if(K)Z=function(){try{K.call(this)}catch(X){return Promise.reject(X)}};$.stack.push({value:Q,dispose:Z,async:J})}else if(J)$.stack.push({async:!0});return Q}function QA($){function Q(X){$.error=$.hasError?new vb(X,$.error,"An error was suppressed during disposal."):X,$.hasError=!0}var J,Z=0;function K(){while(J=$.stack.pop())try{if(!J.async&&Z===1)return Z=0,$.stack.push(J),Promise.resolve().then(K);if(J.dispose){var X=J.dispose.call(J.value);if(J.async)return Z|=2,Promise.resolve(X).then(K,function(Y){return Q(Y),K()})}else Z|=1}catch(Y){Q(Y)}if(Z===1)return $.hasError?Promise.reject($.error):Promise.resolve();if($.hasError)throw $.error}return K()}function JA($,Q){if(typeof $==="string"&&/^\.\.?\//.test($))return $.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(J,Z,K,X,Y){return Z?Q?".jsx":".js":K&&(!X||!Y)?J:K+X+"."+Y.toLowerCase()+"js"});return $}var XY=function($,Q){return XY=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,Z){J.__proto__=Z}||function(J,Z){for(var K in Z)if(Object.prototype.hasOwnProperty.call(Z,K))J[K]=Z[K]},XY($,Q)},r$=function(){return r$=Object.assign||function(Q){for(var J,Z=1,K=arguments.length;Z<K;Z++){J=arguments[Z];for(var X in J)if(Object.prototype.hasOwnProperty.call(J,X))Q[X]=J[X]}return Q},r$.apply(this,arguments)},t$,Lb,YY=function($){return YY=Object.getOwnPropertyNames||function(Q){var J=[];for(var Z in Q)if(Object.prototype.hasOwnProperty.call(Q,Z))J[J.length]=Z;return J},YY($)},vb,_b;var s0=C(()=>{t$=Object.create?function($,Q,J,Z){if(Z===void 0)Z=J;var K=Object.getOwnPropertyDescriptor(Q,J);if(!K||("get"in K?!Q.__esModule:K.writable||K.configurable))K={enumerable:!0,get:function(){return Q[J]}};Object.defineProperty($,Z,K)}:function($,Q,J,Z){if(Z===void 0)Z=J;$[Z]=Q[J]};Lb=Object.create?function($,Q){Object.defineProperty($,"default",{enumerable:!0,value:Q})}:function($,Q){$.default=Q};vb=typeof SuppressedError==="function"?SuppressedError:function($,Q,J){var Z=Error(J);return Z.name="SuppressedError",Z.error=$,Z.suppressed=Q,Z};_b={__extends:jC,__assign:r$,__rest:hC,__decorate:LC,__param:vC,__esDecorate:_C,__runInitializers:xC,__propKey:gC,__setFunctionName:yC,__metadata:fC,__awaiter:bC,__generator:mC,__createBinding:t$,__exportStar:cC,__values:a$,__read:WY,__spread:dC,__spreadArrays:lC,__spreadArray:pC,__await:b8,__asyncGenerator:uC,__asyncDelegator:iC,__asyncValues:nC,__makeTemplateObject:sC,__importStar:oC,__importDefault:rC,__classPrivateFieldGet:aC,__classPrivateFieldSet:tC,__classPrivateFieldIn:eC,__addDisposableResource:$A,__disposeResources:QA,__rewriteRelativeImportExtension:JA}});var I4=g((ZA)=>{Object.defineProperty(ZA,"__esModule",{value:!0});ZA.encodeUtf8=ZA.decodeUtf8=void 0;var xb=new TextDecoder("utf-8"),gb=($)=>xb.decode($);ZA.decodeUtf8=gb;var yb=new TextEncoder,fb=($)=>yb.encode($);ZA.encodeUtf8=fb});var G4=g((YA)=>{Object.defineProperty(YA,"__esModule",{value:!0});YA.isFlatbuffersByteBuffer=YA.isReadableNodeStream=YA.isWritableNodeStream=YA.isReadableDOMStream=YA.isWritableDOMStream=YA.isFetchResponse=YA.isFSReadStream=YA.isFileHandle=YA.isUnderlyingSink=YA.isIteratorResult=YA.isArrayLike=YA.isArrowJSON=YA.isAsyncIterable=YA.isIterable=YA.isObservable=YA.isPromise=YA.isObject=void 0;var qY=($)=>typeof $==="number",XA=($)=>typeof $==="boolean",s1=($)=>typeof $==="function",mb=($)=>$!=null&&Object($)===$;YA.isObject=mb;var cb=($)=>{return YA.isObject($)&&s1($.then)};YA.isPromise=cb;var db=($)=>{return YA.isObject($)&&s1($.subscribe)};YA.isObservable=db;var lb=($)=>{return YA.isObject($)&&s1($[Symbol.iterator])};YA.isIterable=lb;var pb=($)=>{return YA.isObject($)&&s1($[Symbol.asyncIterator])};YA.isAsyncIterable=pb;var ub=($)=>{return YA.isObject($)&&YA.isObject($.schema)};YA.isArrowJSON=ub;var ib=($)=>{return YA.isObject($)&&qY($.length)};YA.isArrayLike=ib;var nb=($)=>{return YA.isObject($)&&"done"in $&&"value"in $};YA.isIteratorResult=nb;var sb=($)=>{return YA.isObject($)&&s1($.abort)&&s1($.close)&&s1($.start)&&s1($.write)};YA.isUnderlyingSink=sb;var ob=($)=>{return YA.isObject($)&&s1($.stat)&&qY($.fd)};YA.isFileHandle=ob;var rb=($)=>{return YA.isReadableNodeStream($)&&qY($.bytesRead)};YA.isFSReadStream=rb;var ab=($)=>{return YA.isObject($)&&YA.isReadableDOMStream($.body)};YA.isFetchResponse=ab;var e$=($)=>("_getDOMStream"in $)&&("_getNodeStream"in $),tb=($)=>{return YA.isObject($)&&s1($.abort)&&s1($.getWriter)&&!e$($)};YA.isWritableDOMStream=tb;var eb=($)=>{return YA.isObject($)&&s1($.cancel)&&s1($.getReader)&&!e$($)};YA.isReadableDOMStream=eb;var $m=($)=>{return YA.isObject($)&&s1($.end)&&s1($.write)&&XA($.writable)&&!e$($)};YA.isWritableNodeStream=$m;var Qm=($)=>{return YA.isObject($)&&s1($.read)&&s1($.pipe)&&XA($.readable)&&!e$($)};YA.isReadableNodeStream=Qm;var Jm=($)=>{return YA.isObject($)&&s1($.clear)&&s1($.bytes)&&s1($.position)&&s1($.setPosition)&&s1($.capacity)&&s1($.getBufferIdentifier)&&s1($.createLong)};YA.isFlatbuffersByteBuffer=Jm});var z0=g((FA)=>{Object.defineProperty(FA,"__esModule",{value:!0});FA.compareArrayLike=FA.rebaseValueOffsets=FA.toUint8ClampedArrayAsyncIterator=FA.toFloat64ArrayAsyncIterator=FA.toFloat32ArrayAsyncIterator=FA.toUint32ArrayAsyncIterator=FA.toUint16ArrayAsyncIterator=FA.toUint8ArrayAsyncIterator=FA.toInt32ArrayAsyncIterator=FA.toInt16ArrayAsyncIterator=FA.toInt8ArrayAsyncIterator=FA.toArrayBufferViewAsyncIterator=FA.toUint8ClampedArrayIterator=FA.toFloat64ArrayIterator=FA.toFloat32ArrayIterator=FA.toUint32ArrayIterator=FA.toUint16ArrayIterator=FA.toUint8ArrayIterator=FA.toInt32ArrayIterator=FA.toInt16ArrayIterator=FA.toInt8ArrayIterator=FA.toArrayBufferViewIterator=FA.toUint8ClampedArray=FA.toFloat64Array=FA.toFloat32Array=FA.toBigUint64Array=FA.toUint32Array=FA.toUint16Array=FA.toUint8Array=FA.toBigInt64Array=FA.toInt32Array=FA.toInt16Array=FA.toInt8Array=FA.toArrayBufferView=FA.joinUint8Arrays=FA.memcpy=void 0;var U0=(s0(),J5(n0)),Am=I4(),m8=G4(),UY=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function zm($){let Q=$[0]?[$[0]]:[],J,Z,K,X;for(let Y,W,q=0,H=0,F=$.length;++q<F;){if(Y=Q[H],W=$[q],!Y||!W||Y.buffer!==W.buffer||W.byteOffset<Y.byteOffset){W&&(Q[++H]=W);continue}if({byteOffset:J,byteLength:K}=Y,{byteOffset:Z,byteLength:X}=W,J+K<Z||Z+X<J){W&&(Q[++H]=W);continue}Q[H]=new Uint8Array(Y.buffer,J,Z-J+X)}return Q}function HY($,Q,J=0,Z=Q.byteLength){let K=$.byteLength,X=new Uint8Array($.buffer,$.byteOffset,K),Y=new Uint8Array(Q.buffer,Q.byteOffset,Math.min(Z,K));return X.set(Y,J),$}FA.memcpy=HY;function km($,Q){let J=zm($),Z=J.reduce((F,U)=>F+U.byteLength,0),K,X,Y,W=0,q=-1,H=Math.min(Q||Number.POSITIVE_INFINITY,Z);for(let F=J.length;++q<F;){if(K=J[q],X=K.subarray(0,Math.min(K.length,H-W)),H<=W+X.length){if(X.length<K.length)J[q]=K.subarray(X.length);else if(X.length===K.length)q++;Y?HY(Y,X,W):Y=X;break}HY(Y||(Y=new Uint8Array(H)),X,W),W+=X.length}return[Y||new Uint8Array(0),J.slice(q),Z-(Y?Y.byteLength:0)]}FA.joinUint8Arrays=km;function f0($,Q){let J=(0,m8.isIteratorResult)(Q)?Q.value:Q;if(J instanceof $){if($===Uint8Array)return new $(J.buffer,J.byteOffset,J.byteLength);return J}if(!J)return new $(0);if(typeof J==="string")J=(0,Am.encodeUtf8)(J);if(J instanceof ArrayBuffer)return new $(J);if(J instanceof UY)return new $(J);if((0,m8.isFlatbuffersByteBuffer)(J))return f0($,J.bytes());return!ArrayBuffer.isView(J)?$.from(J):J.byteLength<=0?new $(0):new $(J.buffer,J.byteOffset,J.byteLength/$.BYTES_PER_ELEMENT)}FA.toArrayBufferView=f0;var Bm=($)=>f0(Int8Array,$);FA.toInt8Array=Bm;var Rm=($)=>f0(Int16Array,$);FA.toInt16Array=Rm;var Om=($)=>f0(Int32Array,$);FA.toInt32Array=Om;var Pm=($)=>f0(BigInt64Array,$);FA.toBigInt64Array=Pm;var Mm=($)=>f0(Uint8Array,$);FA.toUint8Array=Mm;var wm=($)=>f0(Uint16Array,$);FA.toUint16Array=wm;var Sm=($)=>f0(Uint32Array,$);FA.toUint32Array=Sm;var Tm=($)=>f0(BigUint64Array,$);FA.toBigUint64Array=Tm;var Im=($)=>f0(Float32Array,$);FA.toFloat32Array=Im;var Gm=($)=>f0(Float64Array,$);FA.toFloat64Array=Gm;var Em=($)=>f0(Uint8ClampedArray,$);FA.toUint8ClampedArray=Em;var FY=($)=>{return $.next(),$};function*U6($,Q){let J=function*(K){yield K},Z=typeof Q==="string"?J(Q):ArrayBuffer.isView(Q)?J(Q):Q instanceof ArrayBuffer?J(Q):Q instanceof UY?J(Q):!(0,m8.isIterable)(Q)?J(Q):Q;return yield*FY(function*(K){let X=null;do X=K.next(yield f0($,X));while(!X.done)}(Z[Symbol.iterator]())),new $}FA.toArrayBufferViewIterator=U6;var jm=($)=>U6(Int8Array,$);FA.toInt8ArrayIterator=jm;var hm=($)=>U6(Int16Array,$);FA.toInt16ArrayIterator=hm;var Lm=($)=>U6(Int32Array,$);FA.toInt32ArrayIterator=Lm;var vm=($)=>U6(Uint8Array,$);FA.toUint8ArrayIterator=vm;var _m=($)=>U6(Uint16Array,$);FA.toUint16ArrayIterator=_m;var xm=($)=>U6(Uint32Array,$);FA.toUint32ArrayIterator=xm;var gm=($)=>U6(Float32Array,$);FA.toFloat32ArrayIterator=gm;var ym=($)=>U6(Float64Array,$);FA.toFloat64ArrayIterator=ym;var fm=($)=>U6(Uint8ClampedArray,$);FA.toUint8ClampedArrayIterator=fm;function l5($,Q){return U0.__asyncGenerator(this,arguments,function*(){if((0,m8.isPromise)(Q))return yield U0.__await(yield U0.__await(yield*U0.__asyncDelegator(U0.__asyncValues(l5($,yield U0.__await(Q))))));let Z=function(Y){return U0.__asyncGenerator(this,arguments,function*(){yield yield U0.__await(yield U0.__await(Y))})},K=function(Y){return U0.__asyncGenerator(this,arguments,function*(){yield U0.__await(yield*U0.__asyncDelegator(U0.__asyncValues(FY(function*(W){let q=null;do q=W.next(yield q===null||q===void 0?void 0:q.value);while(!q.done)}(Y[Symbol.iterator]())))))})},X=typeof Q==="string"?Z(Q):ArrayBuffer.isView(Q)?Z(Q):Q instanceof ArrayBuffer?Z(Q):Q instanceof UY?Z(Q):(0,m8.isIterable)(Q)?K(Q):!(0,m8.isAsyncIterable)(Q)?Z(Q):Q;return yield U0.__await(yield*U0.__asyncDelegator(U0.__asyncValues(FY(function(Y){return U0.__asyncGenerator(this,arguments,function*(){let W=null;do W=yield U0.__await(Y.next(yield yield U0.__await(f0($,W))));while(!W.done)})}(X[Symbol.asyncIterator]()))))),yield U0.__await(new $)})}FA.toArrayBufferViewAsyncIterator=l5;var bm=($)=>l5(Int8Array,$);FA.toInt8ArrayAsyncIterator=bm;var mm=($)=>l5(Int16Array,$);FA.toInt16ArrayAsyncIterator=mm;var cm=($)=>l5(Int32Array,$);FA.toInt32ArrayAsyncIterator=cm;var dm=($)=>l5(Uint8Array,$);FA.toUint8ArrayAsyncIterator=dm;var lm=($)=>l5(Uint16Array,$);FA.toUint16ArrayAsyncIterator=lm;var pm=($)=>l5(Uint32Array,$);FA.toUint32ArrayAsyncIterator=pm;var um=($)=>l5(Float32Array,$);FA.toFloat32ArrayAsyncIterator=um;var im=($)=>l5(Float64Array,$);FA.toFloat64ArrayAsyncIterator=im;var nm=($)=>l5(Uint8ClampedArray,$);FA.toUint8ClampedArrayAsyncIterator=nm;function sm($,Q,J){if($!==0){J=J.slice(0,Q);for(let Z=-1,K=J.length;++Z<K;)J[Z]+=$}return J.subarray(0,Q)}FA.rebaseValueOffsets=sm;function om($,Q){let J=0,Z=$.length;if(Z!==Q.length)return!1;if(Z>0)do if($[J]!==Q[J])return!1;while(++J<Z);return!0}FA.compareArrayLike=om});var R3=g((NA)=>{Object.defineProperty(NA,"__esModule",{value:!0});var l1=(s0(),J5(n0)),b0=z0();NA.default={fromIterable($){return $Q(hc($))},fromAsyncIterable($){return $Q(Lc($))},fromDOMStream($){return $Q(vc($))},fromNodeStream($){return $Q(_c($))},toDOMStream($,Q){throw Error('"toDOMStream" not available in this environment')},toNodeStream($,Q){throw Error('"toNodeStream" not available in this environment')}};var $Q=($)=>{return $.next(),$};function*hc($){let Q,J=!1,Z=[],K,X,Y,W=0;function q(){if(X==="peek")return(0,b0.joinUint8Arrays)(Z,Y)[0];return[K,Z,W]=(0,b0.joinUint8Arrays)(Z,Y),K}({cmd:X,size:Y}=(yield(()=>null)())||{cmd:"read",size:0});let H=(0,b0.toUint8ArrayIterator)($)[Symbol.iterator]();try{do{if({done:Q,value:K}=Number.isNaN(Y-W)?H.next():H.next(Y-W),!Q&&K.byteLength>0)Z.push(K),W+=K.byteLength;if(Q||Y<=W)do({cmd:X,size:Y}=yield q());while(Y<W)}while(!Q)}catch(F){(J=!0)&&typeof H.throw==="function"&&H.throw(F)}finally{J===!1&&typeof H.return==="function"&&H.return(null)}return null}function Lc($){return l1.__asyncGenerator(this,arguments,function*(){let J,Z=!1,K=[],X,Y,W,q=0;function H(){if(Y==="peek")return(0,b0.joinUint8Arrays)(K,W)[0];return[X,K,q]=(0,b0.joinUint8Arrays)(K,W),X}({cmd:Y,size:W}=(yield yield l1.__await((()=>null)()))||{cmd:"read",size:0});let F=(0,b0.toUint8ArrayAsyncIterator)($)[Symbol.asyncIterator]();try{do{if({done:J,value:X}=Number.isNaN(W-q)?yield l1.__await(F.next()):yield l1.__await(F.next(W-q)),!J&&X.byteLength>0)K.push(X),q+=X.byteLength;if(J||W<=q)do({cmd:Y,size:W}=yield yield l1.__await(H()));while(W<q)}while(!J)}catch(U){(Z=!0)&&typeof F.throw==="function"&&(yield l1.__await(F.throw(U)))}finally{Z===!1&&typeof F.return==="function"&&(yield l1.__await(F.return(new Uint8Array(0))))}return yield l1.__await(null)})}function vc($){return l1.__asyncGenerator(this,arguments,function*(){let J=!1,Z=!1,K=[],X,Y,W,q=0;function H(){if(Y==="peek")return(0,b0.joinUint8Arrays)(K,W)[0];return[X,K,q]=(0,b0.joinUint8Arrays)(K,W),X}({cmd:Y,size:W}=(yield yield l1.__await((()=>null)()))||{cmd:"read",size:0});let F=new VA($);try{do{if({done:J,value:X}=Number.isNaN(W-q)?yield l1.__await(F.read()):yield l1.__await(F.read(W-q)),!J&&X.byteLength>0)K.push((0,b0.toUint8Array)(X)),q+=X.byteLength;if(J||W<=q)do({cmd:Y,size:W}=yield yield l1.__await(H()));while(W<q)}while(!J)}catch(U){(Z=!0)&&(yield l1.__await(F.cancel(U)))}finally{Z===!1?yield l1.__await(F.cancel()):$.locked&&F.releaseLock()}return yield l1.__await(null)})}class VA{constructor($){this.source=$,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){if(this.reader)this.reader.releaseLock();this.reader=null}cancel($){return l1.__awaiter(this,void 0,void 0,function*(){let{reader:Q,source:J}=this;Q&&(yield Q.cancel($).catch(()=>{})),J&&(J.locked&&this.releaseLock())})}read($){return l1.__awaiter(this,void 0,void 0,function*(){if($===0)return{done:this.reader==null,value:new Uint8Array(0)};let Q=yield this.reader.read();return!Q.done&&(Q.value=(0,b0.toUint8Array)(Q)),Q})}}var VY=($,Q)=>{let J=(K)=>Z([Q,K]),Z;return[Q,J,new Promise((K)=>(Z=K)&&$.once(Q,J))]};function _c($){return l1.__asyncGenerator(this,arguments,function*(){let J=[],Z="error",K=!1,X=null,Y,W,q=0,H=[],F;function U(){if(Y==="peek")return(0,b0.joinUint8Arrays)(H,W)[0];return[F,H,q]=(0,b0.joinUint8Arrays)(H,W),F}if({cmd:Y,size:W}=(yield yield l1.__await((()=>null)()))||{cmd:"read",size:0},$.isTTY)return yield yield l1.__await(new Uint8Array(0)),yield l1.__await(null);try{J[0]=VY($,"end"),J[1]=VY($,"error");do{if(J[2]=VY($,"readable"),[Z,X]=yield l1.__await(Promise.race(J.map((N)=>N[2]))),Z==="error")break;if(!(K=Z==="end")){if(!Number.isFinite(W-q))F=(0,b0.toUint8Array)($.read());else if(F=(0,b0.toUint8Array)($.read(W-q)),F.byteLength<W-q)F=(0,b0.toUint8Array)($.read());if(F.byteLength>0)H.push(F),q+=F.byteLength}if(K||W<=q)do({cmd:Y,size:W}=yield yield l1.__await(U()));while(W<q)}while(!K)}finally{yield l1.__await(V(J,Z==="error"?X:null))}return yield l1.__await(null);function V(N,D){return F=H=null,new Promise((z,B)=>{for(let[M,P]of N)$.off(M,P);try{let M=$.destroy;M&&M.call($,D),D=void 0}catch(M){D=M||D}finally{D!=null?B(D):z()}})}})}});var QQ=g((CA)=>{Object.defineProperty(CA,"__esModule",{value:!0});CA.MetadataVersion=void 0;var DA;(function($){$[$.V1=0]="V1",$[$.V2=1]="V2",$[$.V3=2]="V3",$[$.V4=3]="V4",$[$.V5=4]="V5"})(DA||(CA.MetadataVersion=DA={}))});var NY=g((kA)=>{Object.defineProperty(kA,"__esModule",{value:!0});kA.UnionMode=void 0;var zA;(function($){$[$.Sparse=0]="Sparse",$[$.Dense=1]="Dense"})(zA||(kA.UnionMode=zA={}))});var DY=g((OA)=>{Object.defineProperty(OA,"__esModule",{value:!0});OA.Precision=void 0;var RA;(function($){$[$.HALF=0]="HALF",$[$.SINGLE=1]="SINGLE",$[$.DOUBLE=2]="DOUBLE"})(RA||(OA.Precision=RA={}))});var CY=g((wA)=>{Object.defineProperty(wA,"__esModule",{value:!0});wA.DateUnit=void 0;var MA;(function($){$[$.DAY=0]="DAY",$[$.MILLISECOND=1]="MILLISECOND"})(MA||(wA.DateUnit=MA={}))});var O3=g((IA)=>{Object.defineProperty(IA,"__esModule",{value:!0});IA.TimeUnit=void 0;var TA;(function($){$[$.SECOND=0]="SECOND",$[$.MILLISECOND=1]="MILLISECOND",$[$.MICROSECOND=2]="MICROSECOND",$[$.NANOSECOND=3]="NANOSECOND"})(TA||(IA.TimeUnit=TA={}))});var AY=g((jA)=>{Object.defineProperty(jA,"__esModule",{value:!0});jA.IntervalUnit=void 0;var EA;(function($){$[$.YEAR_MONTH=0]="YEAR_MONTH",$[$.DAY_TIME=1]="DAY_TIME",$[$.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(EA||(jA.IntervalUnit=EA={}))});var j7=g((LA)=>{Object.defineProperty(LA,"__esModule",{value:!0});LA.SIZE_PREFIX_LENGTH=LA.FILE_IDENTIFIER_LENGTH=LA.SIZEOF_INT=LA.SIZEOF_SHORT=void 0;LA.SIZEOF_SHORT=2;LA.SIZEOF_INT=4;LA.FILE_IDENTIFIER_LENGTH=4;LA.SIZE_PREFIX_LENGTH=4});var kY=g((_A)=>{Object.defineProperty(_A,"__esModule",{value:!0});_A.isLittleEndian=_A.float64=_A.float32=_A.int32=void 0;_A.int32=new Int32Array(2);_A.float32=new Float32Array(_A.int32.buffer);_A.float64=new Float64Array(_A.int32.buffer);_A.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1});var BY=g((yA)=>{Object.defineProperty(yA,"__esModule",{value:!0});yA.Encoding=void 0;var gA;(function($){$[$.UTF8_BYTES=1]="UTF8_BYTES",$[$.UTF16_STRING=2]="UTF16_STRING"})(gA||(yA.Encoding=gA={}))});var OY=g((bA)=>{Object.defineProperty(bA,"__esModule",{value:!0});bA.ByteBuffer=void 0;var V6=j7(),o0=kY(),cc=BY();class RY{constructor($){this.bytes_=$,this.position_=0,this.text_decoder_=new TextDecoder}static allocate($){return new RY(new Uint8Array($))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition($){this.position_=$}capacity(){return this.bytes_.length}readInt8($){return this.readUint8($)<<24>>24}readUint8($){return this.bytes_[$]}readInt16($){return this.readUint16($)<<16>>16}readUint16($){return this.bytes_[$]|this.bytes_[$+1]<<8}readInt32($){return this.bytes_[$]|this.bytes_[$+1]<<8|this.bytes_[$+2]<<16|this.bytes_[$+3]<<24}readUint32($){return this.readInt32($)>>>0}readInt64($){return BigInt.asIntN(64,BigInt(this.readUint32($))+(BigInt(this.readUint32($+4))<<BigInt(32)))}readUint64($){return BigInt.asUintN(64,BigInt(this.readUint32($))+(BigInt(this.readUint32($+4))<<BigInt(32)))}readFloat32($){return o0.int32[0]=this.readInt32($),o0.float32[0]}readFloat64($){return o0.int32[o0.isLittleEndian?0:1]=this.readInt32($),o0.int32[o0.isLittleEndian?1:0]=this.readInt32($+4),o0.float64[0]}writeInt8($,Q){this.bytes_[$]=Q}writeUint8($,Q){this.bytes_[$]=Q}writeInt16($,Q){this.bytes_[$]=Q,this.bytes_[$+1]=Q>>8}writeUint16($,Q){this.bytes_[$]=Q,this.bytes_[$+1]=Q>>8}writeInt32($,Q){this.bytes_[$]=Q,this.bytes_[$+1]=Q>>8,this.bytes_[$+2]=Q>>16,this.bytes_[$+3]=Q>>24}writeUint32($,Q){this.bytes_[$]=Q,this.bytes_[$+1]=Q>>8,this.bytes_[$+2]=Q>>16,this.bytes_[$+3]=Q>>24}writeInt64($,Q){this.writeInt32($,Number(BigInt.asIntN(32,Q))),this.writeInt32($+4,Number(BigInt.asIntN(32,Q>>BigInt(32))))}writeUint64($,Q){this.writeUint32($,Number(BigInt.asUintN(32,Q))),this.writeUint32($+4,Number(BigInt.asUintN(32,Q>>BigInt(32))))}writeFloat32($,Q){o0.float32[0]=Q,this.writeInt32($,o0.int32[0])}writeFloat64($,Q){o0.float64[0]=Q,this.writeInt32($,o0.int32[o0.isLittleEndian?0:1]),this.writeInt32($+4,o0.int32[o0.isLittleEndian?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+V6.SIZEOF_INT+V6.FILE_IDENTIFIER_LENGTH)throw Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let $="";for(let Q=0;Q<V6.FILE_IDENTIFIER_LENGTH;Q++)$+=String.fromCharCode(this.readInt8(this.position_+V6.SIZEOF_INT+Q));return $}__offset($,Q){let J=$-this.readInt32($);return Q<this.readInt16(J)?this.readInt16(J+Q):0}__union($,Q){return $.bb_pos=Q+this.readInt32(Q),$.bb=this,$}__string($,Q){$+=this.readInt32($);let J=this.readInt32($);$+=V6.SIZEOF_INT;let Z=this.bytes_.subarray($,$+J);if(Q===cc.Encoding.UTF8_BYTES)return Z;else return this.text_decoder_.decode(Z)}__union_with_string($,Q){if(typeof $==="string")return this.__string(Q);return this.__union($,Q)}__indirect($){return $+this.readInt32($)}__vector($){return $+this.readInt32($)+V6.SIZEOF_INT}__vector_len($){return this.readInt32($+this.readInt32($))}__has_identifier($){if($.length!=V6.FILE_IDENTIFIER_LENGTH)throw Error("FlatBuffers: file identifier must be length "+V6.FILE_IDENTIFIER_LENGTH);for(let Q=0;Q<V6.FILE_IDENTIFIER_LENGTH;Q++)if($.charCodeAt(Q)!=this.readInt8(this.position()+V6.SIZEOF_INT+Q))return!1;return!0}createScalarList($,Q){let J=[];for(let Z=0;Z<Q;++Z){let K=$(Z);if(K!==null)J.push(K)}return J}createObjList($,Q){let J=[];for(let Z=0;Z<Q;++Z){let K=$(Z);if(K!==null)J.push(K.unpack())}return J}}bA.ByteBuffer=RY});var pA=g((dA)=>{Object.defineProperty(dA,"__esModule",{value:!0});dA.Builder=void 0;var cA=OY(),K5=j7();class PY{constructor($){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let Q;if(!$)Q=1024;else Q=$;this.bb=cA.ByteBuffer.allocate(Q),this.space=Q}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults($){this.force_defaults=$}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep($,Q){if($>this.minalign)this.minalign=$;let J=~(this.bb.capacity()-this.space+Q)+1&$-1;while(this.space<J+$+Q){let Z=this.bb.capacity();this.bb=PY.growByteBuffer(this.bb),this.space+=this.bb.capacity()-Z}this.pad(J)}pad($){for(let Q=0;Q<$;Q++)this.bb.writeInt8(--this.space,0)}writeInt8($){this.bb.writeInt8(this.space-=1,$)}writeInt16($){this.bb.writeInt16(this.space-=2,$)}writeInt32($){this.bb.writeInt32(this.space-=4,$)}writeInt64($){this.bb.writeInt64(this.space-=8,$)}writeFloat32($){this.bb.writeFloat32(this.space-=4,$)}writeFloat64($){this.bb.writeFloat64(this.space-=8,$)}addInt8($){this.prep(1,0),this.writeInt8($)}addInt16($){this.prep(2,0),this.writeInt16($)}addInt32($){this.prep(4,0),this.writeInt32($)}addInt64($){this.prep(8,0),this.writeInt64($)}addFloat32($){this.prep(4,0),this.writeFloat32($)}addFloat64($){this.prep(8,0),this.writeFloat64($)}addFieldInt8($,Q,J){if(this.force_defaults||Q!=J)this.addInt8(Q),this.slot($)}addFieldInt16($,Q,J){if(this.force_defaults||Q!=J)this.addInt16(Q),this.slot($)}addFieldInt32($,Q,J){if(this.force_defaults||Q!=J)this.addInt32(Q),this.slot($)}addFieldInt64($,Q,J){if(this.force_defaults||Q!==J)this.addInt64(Q),this.slot($)}addFieldFloat32($,Q,J){if(this.force_defaults||Q!=J)this.addFloat32(Q),this.slot($)}addFieldFloat64($,Q,J){if(this.force_defaults||Q!=J)this.addFloat64(Q),this.slot($)}addFieldOffset($,Q,J){if(this.force_defaults||Q!=J)this.addOffset(Q),this.slot($)}addFieldStruct($,Q,J){if(Q!=J)this.nested(Q),this.slot($)}nested($){if($!=this.offset())throw TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw TypeError("FlatBuffers: object serialization must not be nested.")}slot($){if(this.vtable!==null)this.vtable[$]=this.offset()}offset(){return this.bb.capacity()-this.space}static growByteBuffer($){let Q=$.capacity();if(Q&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let J=Q<<1,Z=cA.ByteBuffer.allocate(J);return Z.setPosition(J-Q),Z.bytes().set($.bytes(),J-Q),Z}addOffset($){this.prep(K5.SIZEOF_INT,0),this.writeInt32(this.offset()-$+K5.SIZEOF_INT)}startObject($){if(this.notNested(),this.vtable==null)this.vtable=[];this.vtable_in_use=$;for(let Q=0;Q<$;Q++)this.vtable[Q]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let $=this.offset(),Q=this.vtable_in_use-1;for(;Q>=0&&this.vtable[Q]==0;Q--);let J=Q+1;for(;Q>=0;Q--)this.addInt16(this.vtable[Q]!=0?$-this.vtable[Q]:0);let Z=2;this.addInt16($-this.object_start);let K=(J+Z)*K5.SIZEOF_SHORT;this.addInt16(K);let X=0,Y=this.space;$:for(Q=0;Q<this.vtables.length;Q++){let W=this.bb.capacity()-this.vtables[Q];if(K==this.bb.readInt16(W)){for(let q=K5.SIZEOF_SHORT;q<K;q+=K5.SIZEOF_SHORT)if(this.bb.readInt16(Y+q)!=this.bb.readInt16(W+q))continue $;X=this.vtables[Q];break}}if(X)this.space=this.bb.capacity()-$,this.bb.writeInt32(this.space,X-$);else this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-$,this.offset()-$);return this.isNested=!1,$}finish($,Q,J){let Z=J?K5.SIZE_PREFIX_LENGTH:0;if(Q){let K=Q;if(this.prep(this.minalign,K5.SIZEOF_INT+K5.FILE_IDENTIFIER_LENGTH+Z),K.length!=K5.FILE_IDENTIFIER_LENGTH)throw TypeError("FlatBuffers: file identifier must be length "+K5.FILE_IDENTIFIER_LENGTH);for(let X=K5.FILE_IDENTIFIER_LENGTH-1;X>=0;X--)this.writeInt8(K.charCodeAt(X))}if(this.prep(this.minalign,K5.SIZEOF_INT+Z),this.addOffset($),Z)this.addInt32(this.bb.capacity()-this.space);this.bb.setPosition(this.space)}finishSizePrefixed($,Q){this.finish($,Q,!0)}requiredField($,Q){let J=this.bb.capacity()-$,Z=J-this.bb.readInt32(J);if(!(Q<this.bb.readInt16(Z)&&this.bb.readInt16(Z+Q)!=0))throw TypeError("FlatBuffers: field "+Q+" must be set")}startVector($,Q,J){this.notNested(),this.vector_num_elems=Q,this.prep(K5.SIZEOF_INT,$*Q),this.prep(J,$*Q)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString($){if(!$)return 0;if(!this.string_maps)this.string_maps=new Map;if(this.string_maps.has($))return this.string_maps.get($);let Q=this.createString($);return this.string_maps.set($,Q),Q}createString($){if($===null||$===void 0)return 0;let Q;if($ instanceof Uint8Array)Q=$;else Q=this.text_encoder.encode($);return this.addInt8(0),this.startVector(1,Q.length,1),this.bb.setPosition(this.space-=Q.length),this.bb.bytes().set(Q,this.space),this.endVector()}createByteVector($){if($===null||$===void 0)return 0;return this.startVector(1,$.length,1),this.bb.setPosition(this.space-=$.length),this.bb.bytes().set($,this.space),this.endVector()}createObjectOffset($){if($===null)return 0;if(typeof $==="string")return this.createString($);else return $.pack(this)}createObjectOffsetList($){let Q=[];for(let J=0;J<$.length;++J){let Z=$[J];if(Z!==null)Q.push(this.createObjectOffset(Z));else throw TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return Q}createStructOffsetList($,Q){return Q(this,$.length),this.createObjectOffsetList($.slice().reverse()),this.endVector()}}dA.Builder=PY});var k1=g((X5)=>{Object.defineProperty(X5,"__esModule",{value:!0});X5.ByteBuffer=X5.Builder=X5.Encoding=X5.isLittleEndian=X5.float64=X5.float32=X5.int32=X5.SIZE_PREFIX_LENGTH=X5.FILE_IDENTIFIER_LENGTH=X5.SIZEOF_INT=X5.SIZEOF_SHORT=void 0;var dc=j7();Object.defineProperty(X5,"SIZEOF_SHORT",{enumerable:!0,get:function(){return dc.SIZEOF_SHORT}});var lc=j7();Object.defineProperty(X5,"SIZEOF_INT",{enumerable:!0,get:function(){return lc.SIZEOF_INT}});var pc=j7();Object.defineProperty(X5,"FILE_IDENTIFIER_LENGTH",{enumerable:!0,get:function(){return pc.FILE_IDENTIFIER_LENGTH}});var uc=j7();Object.defineProperty(X5,"SIZE_PREFIX_LENGTH",{enumerable:!0,get:function(){return uc.SIZE_PREFIX_LENGTH}});var JQ=kY();Object.defineProperty(X5,"int32",{enumerable:!0,get:function(){return JQ.int32}});Object.defineProperty(X5,"float32",{enumerable:!0,get:function(){return JQ.float32}});Object.defineProperty(X5,"float64",{enumerable:!0,get:function(){return JQ.float64}});Object.defineProperty(X5,"isLittleEndian",{enumerable:!0,get:function(){return JQ.isLittleEndian}});var ic=BY();Object.defineProperty(X5,"Encoding",{enumerable:!0,get:function(){return ic.Encoding}});var nc=pA();Object.defineProperty(X5,"Builder",{enumerable:!0,get:function(){return nc.Builder}});var sc=OY();Object.defineProperty(X5,"ByteBuffer",{enumerable:!0,get:function(){return sc.ByteBuffer}})});var sA=g((iA)=>{Object.defineProperty(iA,"__esModule",{value:!0});iA.BodyCompressionMethod=void 0;var uA;(function($){$[$.BUFFER=0]="BUFFER"})(uA||(iA.BodyCompressionMethod=uA={}))});var tA=g((rA)=>{Object.defineProperty(rA,"__esModule",{value:!0});rA.CompressionType=void 0;var oA;(function($){$[$.LZ4_FRAME=0]="LZ4_FRAME",$[$.ZSTD=1]="ZSTD"})(oA||(rA.CompressionType=oA={}))});var Zz=g((Qz)=>{Object.defineProperty(Qz,"__esModule",{value:!0});Qz.BodyCompression=void 0;var rc=k1(),eA=sA(),$z=tA();class E4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsBodyCompression($,Q){return(Q||new E4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsBodyCompression($,Q){return $.setPosition($.position()+rc.SIZE_PREFIX_LENGTH),(Q||new E4).__init($.readInt32($.position())+$.position(),$)}codec(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt8(this.bb_pos+$):$z.CompressionType.LZ4_FRAME}method(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.readInt8(this.bb_pos+$):eA.BodyCompressionMethod.BUFFER}static startBodyCompression($){$.startObject(2)}static addCodec($,Q){$.addFieldInt8(0,Q,$z.CompressionType.LZ4_FRAME)}static addMethod($,Q){$.addFieldInt8(1,Q,eA.BodyCompressionMethod.BUFFER)}static endBodyCompression($){return $.endObject()}static createBodyCompression($,Q,J){return E4.startBodyCompression($),E4.addCodec($,Q),E4.addMethod($,J),E4.endBodyCompression($)}}Qz.BodyCompression=E4});var j4=g((Xz)=>{Object.defineProperty(Xz,"__esModule",{value:!0});Xz.Buffer=void 0;class Kz{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer($,Q,J){return $.prep(8,16),$.writeInt64(BigInt(J!==null&&J!==void 0?J:0)),$.writeInt64(BigInt(Q!==null&&Q!==void 0?Q:0)),$.offset()}}Xz.Buffer=Kz});var MY=g((qz)=>{Object.defineProperty(qz,"__esModule",{value:!0});qz.FieldNode=void 0;class Wz{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode($,Q,J){return $.prep(8,16),$.writeInt64(BigInt(J!==null&&J!==void 0?J:0)),$.writeInt64(BigInt(Q!==null&&Q!==void 0?Q:0)),$.offset()}}qz.FieldNode=Wz});var KQ=g((Fz)=>{Object.defineProperty(Fz,"__esModule",{value:!0});Fz.RecordBatch=void 0;var ac=k1(),tc=Zz(),ec=j4(),$d=MY();class ZQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsRecordBatch($,Q){return(Q||new ZQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsRecordBatch($,Q){return $.setPosition($.position()+ac.SIZE_PREFIX_LENGTH),(Q||new ZQ).__init($.readInt32($.position())+$.position(),$)}length(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}nodes($,Q){let J=this.bb.__offset(this.bb_pos,6);return J?(Q||new $d.FieldNode).__init(this.bb.__vector(this.bb_pos+J)+$*16,this.bb):null}nodesLength(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.__vector_len(this.bb_pos+$):0}buffers($,Q){let J=this.bb.__offset(this.bb_pos,8);return J?(Q||new ec.Buffer).__init(this.bb.__vector(this.bb_pos+J)+$*16,this.bb):null}buffersLength(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.__vector_len(this.bb_pos+$):0}compression($){let Q=this.bb.__offset(this.bb_pos,10);return Q?($||new tc.BodyCompression).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}static startRecordBatch($){$.startObject(4)}static addLength($,Q){$.addFieldInt64(0,Q,BigInt("0"))}static addNodes($,Q){$.addFieldOffset(1,Q,0)}static startNodesVector($,Q){$.startVector(16,Q,8)}static addBuffers($,Q){$.addFieldOffset(2,Q,0)}static startBuffersVector($,Q){$.startVector(16,Q,8)}static addCompression($,Q){$.addFieldOffset(3,Q,0)}static endRecordBatch($){return $.endObject()}}Fz.RecordBatch=ZQ});var wY=g((Vz)=>{Object.defineProperty(Vz,"__esModule",{value:!0});Vz.DictionaryBatch=void 0;var Qd=k1(),Jd=KQ();class XQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsDictionaryBatch($,Q){return(Q||new XQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsDictionaryBatch($,Q){return $.setPosition($.position()+Qd.SIZE_PREFIX_LENGTH),(Q||new XQ).__init($.readInt32($.position())+$.position(),$)}id(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}data($){let Q=this.bb.__offset(this.bb_pos,6);return Q?($||new Jd.RecordBatch).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}isDelta(){let $=this.bb.__offset(this.bb_pos,8);return $?!!this.bb.readInt8(this.bb_pos+$):!1}static startDictionaryBatch($){$.startObject(3)}static addId($,Q){$.addFieldInt64(0,Q,BigInt("0"))}static addData($,Q){$.addFieldOffset(1,Q,0)}static addIsDelta($,Q){$.addFieldInt8(2,+Q,0)}static endDictionaryBatch($){return $.endObject()}}Vz.DictionaryBatch=XQ});var SY=g((Cz)=>{Object.defineProperty(Cz,"__esModule",{value:!0});Cz.Endianness=void 0;var Dz;(function($){$[$.Little=0]="Little",$[$.Big=1]="Big"})(Dz||(Cz.Endianness=Dz={}))});var Rz=g((kz)=>{Object.defineProperty(kz,"__esModule",{value:!0});kz.DictionaryKind=void 0;var zz;(function($){$[$.DenseArray=0]="DenseArray"})(zz||(kz.DictionaryKind=zz={}))});var L4=g((Oz)=>{Object.defineProperty(Oz,"__esModule",{value:!0});Oz.Int=void 0;var Zd=k1();class h4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsInt($,Q){return(Q||new h4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsInt($,Q){return $.setPosition($.position()+Zd.SIZE_PREFIX_LENGTH),(Q||new h4).__init($.readInt32($.position())+$.position(),$)}bitWidth(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt32(this.bb_pos+$):0}isSigned(){let $=this.bb.__offset(this.bb_pos,6);return $?!!this.bb.readInt8(this.bb_pos+$):!1}static startInt($){$.startObject(2)}static addBitWidth($,Q){$.addFieldInt32(0,Q,0)}static addIsSigned($,Q){$.addFieldInt8(1,+Q,0)}static endInt($){return $.endObject()}static createInt($,Q,J){return h4.startInt($),h4.addBitWidth($,Q),h4.addIsSigned($,J),h4.endInt($)}}Oz.Int=h4});var TY=g((wz)=>{Object.defineProperty(wz,"__esModule",{value:!0});wz.DictionaryEncoding=void 0;var Kd=k1(),Mz=Rz(),Xd=L4();class YQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsDictionaryEncoding($,Q){return(Q||new YQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsDictionaryEncoding($,Q){return $.setPosition($.position()+Kd.SIZE_PREFIX_LENGTH),(Q||new YQ).__init($.readInt32($.position())+$.position(),$)}id(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}indexType($){let Q=this.bb.__offset(this.bb_pos,6);return Q?($||new Xd.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}isOrdered(){let $=this.bb.__offset(this.bb_pos,8);return $?!!this.bb.readInt8(this.bb_pos+$):!1}dictionaryKind(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.readInt16(this.bb_pos+$):Mz.DictionaryKind.DenseArray}static startDictionaryEncoding($){$.startObject(4)}static addId($,Q){$.addFieldInt64(0,Q,BigInt("0"))}static addIndexType($,Q){$.addFieldOffset(1,Q,0)}static addIsOrdered($,Q){$.addFieldInt8(2,+Q,0)}static addDictionaryKind($,Q){$.addFieldInt16(3,Q,Mz.DictionaryKind.DenseArray)}static endDictionaryEncoding($){return $.endObject()}}wz.DictionaryEncoding=YQ});var c8=g((Tz)=>{Object.defineProperty(Tz,"__esModule",{value:!0});Tz.KeyValue=void 0;var Yd=k1();class v4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsKeyValue($,Q){return(Q||new v4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsKeyValue($,Q){return $.setPosition($.position()+Yd.SIZE_PREFIX_LENGTH),(Q||new v4).__init($.readInt32($.position())+$.position(),$)}key($){let Q=this.bb.__offset(this.bb_pos,4);return Q?this.bb.__string(this.bb_pos+Q,$):null}value($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.__string(this.bb_pos+Q,$):null}static startKeyValue($){$.startObject(2)}static addKey($,Q){$.addFieldOffset(0,Q,0)}static addValue($,Q){$.addFieldOffset(1,Q,0)}static endKeyValue($){return $.endObject()}static createKeyValue($,Q,J){return v4.startKeyValue($),v4.addKey($,Q),v4.addValue($,J),v4.endKeyValue($)}}Tz.KeyValue=v4});var IY=g((Gz)=>{Object.defineProperty(Gz,"__esModule",{value:!0});Gz.Binary=void 0;var Wd=k1();class d8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsBinary($,Q){return(Q||new d8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsBinary($,Q){return $.setPosition($.position()+Wd.SIZE_PREFIX_LENGTH),(Q||new d8).__init($.readInt32($.position())+$.position(),$)}static startBinary($){$.startObject(0)}static endBinary($){return $.endObject()}static createBinary($){return d8.startBinary($),d8.endBinary($)}}Gz.Binary=d8});var GY=g((jz)=>{Object.defineProperty(jz,"__esModule",{value:!0});jz.Bool=void 0;var qd=k1();class l8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsBool($,Q){return(Q||new l8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsBool($,Q){return $.setPosition($.position()+qd.SIZE_PREFIX_LENGTH),(Q||new l8).__init($.readInt32($.position())+$.position(),$)}static startBool($){$.startObject(0)}static endBool($){return $.endObject()}static createBool($){return l8.startBool($),l8.endBool($)}}jz.Bool=l8});var WQ=g((vz)=>{Object.defineProperty(vz,"__esModule",{value:!0});vz.Date=void 0;var Hd=k1(),Lz=CY();class h7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsDate($,Q){return(Q||new h7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsDate($,Q){return $.setPosition($.position()+Hd.SIZE_PREFIX_LENGTH),(Q||new h7).__init($.readInt32($.position())+$.position(),$)}unit(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):Lz.DateUnit.MILLISECOND}static startDate($){$.startObject(1)}static addUnit($,Q){$.addFieldInt16(0,Q,Lz.DateUnit.MILLISECOND)}static endDate($){return $.endObject()}static createDate($,Q){return h7.startDate($),h7.addUnit($,Q),h7.endDate($)}}vz.Date=h7});var qQ=g((xz)=>{Object.defineProperty(xz,"__esModule",{value:!0});xz.Decimal=void 0;var Fd=k1();class s6{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsDecimal($,Q){return(Q||new s6).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsDecimal($,Q){return $.setPosition($.position()+Fd.SIZE_PREFIX_LENGTH),(Q||new s6).__init($.readInt32($.position())+$.position(),$)}precision(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt32(this.bb_pos+$):0}scale(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.readInt32(this.bb_pos+$):0}bitWidth(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.readInt32(this.bb_pos+$):128}static startDecimal($){$.startObject(3)}static addPrecision($,Q){$.addFieldInt32(0,Q,0)}static addScale($,Q){$.addFieldInt32(1,Q,0)}static addBitWidth($,Q){$.addFieldInt32(2,Q,128)}static endDecimal($){return $.endObject()}static createDecimal($,Q,J,Z){return s6.startDecimal($),s6.addPrecision($,Q),s6.addScale($,J),s6.addBitWidth($,Z),s6.endDecimal($)}}xz.Decimal=s6});var HQ=g((fz)=>{Object.defineProperty(fz,"__esModule",{value:!0});fz.Duration=void 0;var Ud=k1(),yz=O3();class L7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsDuration($,Q){return(Q||new L7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsDuration($,Q){return $.setPosition($.position()+Ud.SIZE_PREFIX_LENGTH),(Q||new L7).__init($.readInt32($.position())+$.position(),$)}unit(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):yz.TimeUnit.MILLISECOND}static startDuration($){$.startObject(1)}static addUnit($,Q){$.addFieldInt16(0,Q,yz.TimeUnit.MILLISECOND)}static endDuration($){return $.endObject()}static createDuration($,Q){return L7.startDuration($),L7.addUnit($,Q),L7.endDuration($)}}fz.Duration=L7});var FQ=g((mz)=>{Object.defineProperty(mz,"__esModule",{value:!0});mz.FixedSizeBinary=void 0;var Vd=k1();class v7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsFixedSizeBinary($,Q){return(Q||new v7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsFixedSizeBinary($,Q){return $.setPosition($.position()+Vd.SIZE_PREFIX_LENGTH),(Q||new v7).__init($.readInt32($.position())+$.position(),$)}byteWidth(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt32(this.bb_pos+$):0}static startFixedSizeBinary($){$.startObject(1)}static addByteWidth($,Q){$.addFieldInt32(0,Q,0)}static endFixedSizeBinary($){return $.endObject()}static createFixedSizeBinary($,Q){return v7.startFixedSizeBinary($),v7.addByteWidth($,Q),v7.endFixedSizeBinary($)}}mz.FixedSizeBinary=v7});var UQ=g((dz)=>{Object.defineProperty(dz,"__esModule",{value:!0});dz.FixedSizeList=void 0;var Nd=k1();class _7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsFixedSizeList($,Q){return(Q||new _7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsFixedSizeList($,Q){return $.setPosition($.position()+Nd.SIZE_PREFIX_LENGTH),(Q||new _7).__init($.readInt32($.position())+$.position(),$)}listSize(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt32(this.bb_pos+$):0}static startFixedSizeList($){$.startObject(1)}static addListSize($,Q){$.addFieldInt32(0,Q,0)}static endFixedSizeList($){return $.endObject()}static createFixedSizeList($,Q){return _7.startFixedSizeList($),_7.addListSize($,Q),_7.endFixedSizeList($)}}dz.FixedSizeList=_7});var VQ=g((uz)=>{Object.defineProperty(uz,"__esModule",{value:!0});uz.FloatingPoint=void 0;var Dd=k1(),pz=DY();class x7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsFloatingPoint($,Q){return(Q||new x7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsFloatingPoint($,Q){return $.setPosition($.position()+Dd.SIZE_PREFIX_LENGTH),(Q||new x7).__init($.readInt32($.position())+$.position(),$)}precision(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):pz.Precision.HALF}static startFloatingPoint($){$.startObject(1)}static addPrecision($,Q){$.addFieldInt16(0,Q,pz.Precision.HALF)}static endFloatingPoint($){return $.endObject()}static createFloatingPoint($,Q){return x7.startFloatingPoint($),x7.addPrecision($,Q),x7.endFloatingPoint($)}}uz.FloatingPoint=x7});var NQ=g((sz)=>{Object.defineProperty(sz,"__esModule",{value:!0});sz.Interval=void 0;var Cd=k1(),nz=AY();class g7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsInterval($,Q){return(Q||new g7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsInterval($,Q){return $.setPosition($.position()+Cd.SIZE_PREFIX_LENGTH),(Q||new g7).__init($.readInt32($.position())+$.position(),$)}unit(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):nz.IntervalUnit.YEAR_MONTH}static startInterval($){$.startObject(1)}static addUnit($,Q){$.addFieldInt16(0,Q,nz.IntervalUnit.YEAR_MONTH)}static endInterval($){return $.endObject()}static createInterval($,Q){return g7.startInterval($),g7.addUnit($,Q),g7.endInterval($)}}sz.Interval=g7});var EY=g((rz)=>{Object.defineProperty(rz,"__esModule",{value:!0});rz.LargeBinary=void 0;var Ad=k1();class p8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsLargeBinary($,Q){return(Q||new p8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsLargeBinary($,Q){return $.setPosition($.position()+Ad.SIZE_PREFIX_LENGTH),(Q||new p8).__init($.readInt32($.position())+$.position(),$)}static startLargeBinary($){$.startObject(0)}static endLargeBinary($){return $.endObject()}static createLargeBinary($){return p8.startLargeBinary($),p8.endLargeBinary($)}}rz.LargeBinary=p8});var $k=g((tz)=>{Object.defineProperty(tz,"__esModule",{value:!0});tz.LargeList=void 0;var zd=k1();class u8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsLargeList($,Q){return(Q||new u8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsLargeList($,Q){return $.setPosition($.position()+zd.SIZE_PREFIX_LENGTH),(Q||new u8).__init($.readInt32($.position())+$.position(),$)}static startLargeList($){$.startObject(0)}static endLargeList($){return $.endObject()}static createLargeList($){return u8.startLargeList($),u8.endLargeList($)}}tz.LargeList=u8});var jY=g((Qk)=>{Object.defineProperty(Qk,"__esModule",{value:!0});Qk.LargeUtf8=void 0;var kd=k1();class i8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsLargeUtf8($,Q){return(Q||new i8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsLargeUtf8($,Q){return $.setPosition($.position()+kd.SIZE_PREFIX_LENGTH),(Q||new i8).__init($.readInt32($.position())+$.position(),$)}static startLargeUtf8($){$.startObject(0)}static endLargeUtf8($){return $.endObject()}static createLargeUtf8($){return i8.startLargeUtf8($),i8.endLargeUtf8($)}}Qk.LargeUtf8=i8});var hY=g((Zk)=>{Object.defineProperty(Zk,"__esModule",{value:!0});Zk.List=void 0;var Bd=k1();class n8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsList($,Q){return(Q||new n8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsList($,Q){return $.setPosition($.position()+Bd.SIZE_PREFIX_LENGTH),(Q||new n8).__init($.readInt32($.position())+$.position(),$)}static startList($){$.startObject(0)}static endList($){return $.endObject()}static createList($){return n8.startList($),n8.endList($)}}Zk.List=n8});var DQ=g((Xk)=>{Object.defineProperty(Xk,"__esModule",{value:!0});Xk.Map=void 0;var Rd=k1();class y7{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsMap($,Q){return(Q||new y7).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsMap($,Q){return $.setPosition($.position()+Rd.SIZE_PREFIX_LENGTH),(Q||new y7).__init($.readInt32($.position())+$.position(),$)}keysSorted(){let $=this.bb.__offset(this.bb_pos,4);return $?!!this.bb.readInt8(this.bb_pos+$):!1}static startMap($){$.startObject(1)}static addKeysSorted($,Q){$.addFieldInt8(0,+Q,0)}static endMap($){return $.endObject()}static createMap($,Q){return y7.startMap($),y7.addKeysSorted($,Q),y7.endMap($)}}Xk.Map=y7});var LY=g((Wk)=>{Object.defineProperty(Wk,"__esModule",{value:!0});Wk.Null=void 0;var Od=k1();class s8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsNull($,Q){return(Q||new s8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsNull($,Q){return $.setPosition($.position()+Od.SIZE_PREFIX_LENGTH),(Q||new s8).__init($.readInt32($.position())+$.position(),$)}static startNull($){$.startObject(0)}static endNull($){return $.endObject()}static createNull($){return s8.startNull($),s8.endNull($)}}Wk.Null=s8});var Uk=g((Hk)=>{Object.defineProperty(Hk,"__esModule",{value:!0});Hk.RunEndEncoded=void 0;var Pd=k1();class o8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsRunEndEncoded($,Q){return(Q||new o8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsRunEndEncoded($,Q){return $.setPosition($.position()+Pd.SIZE_PREFIX_LENGTH),(Q||new o8).__init($.readInt32($.position())+$.position(),$)}static startRunEndEncoded($){$.startObject(0)}static endRunEndEncoded($){return $.endObject()}static createRunEndEncoded($){return o8.startRunEndEncoded($),o8.endRunEndEncoded($)}}Hk.RunEndEncoded=o8});var vY=g((Vk)=>{Object.defineProperty(Vk,"__esModule",{value:!0});Vk.Struct_=void 0;var Md=k1();class r8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsStruct_($,Q){return(Q||new r8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsStruct_($,Q){return $.setPosition($.position()+Md.SIZE_PREFIX_LENGTH),(Q||new r8).__init($.readInt32($.position())+$.position(),$)}static startStruct_($){$.startObject(0)}static endStruct_($){return $.endObject()}static createStruct_($){return r8.startStruct_($),r8.endStruct_($)}}Vk.Struct_=r8});var CQ=g((Ck)=>{Object.defineProperty(Ck,"__esModule",{value:!0});Ck.Time=void 0;var wd=k1(),Dk=O3();class _4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsTime($,Q){return(Q||new _4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsTime($,Q){return $.setPosition($.position()+wd.SIZE_PREFIX_LENGTH),(Q||new _4).__init($.readInt32($.position())+$.position(),$)}unit(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):Dk.TimeUnit.MILLISECOND}bitWidth(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.readInt32(this.bb_pos+$):32}static startTime($){$.startObject(2)}static addUnit($,Q){$.addFieldInt16(0,Q,Dk.TimeUnit.MILLISECOND)}static addBitWidth($,Q){$.addFieldInt32(1,Q,32)}static endTime($){return $.endObject()}static createTime($,Q,J){return _4.startTime($),_4.addUnit($,Q),_4.addBitWidth($,J),_4.endTime($)}}Ck.Time=_4});var AQ=g((kk)=>{Object.defineProperty(kk,"__esModule",{value:!0});kk.Timestamp=void 0;var Sd=k1(),zk=O3();class x4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsTimestamp($,Q){return(Q||new x4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsTimestamp($,Q){return $.setPosition($.position()+Sd.SIZE_PREFIX_LENGTH),(Q||new x4).__init($.readInt32($.position())+$.position(),$)}unit(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):zk.TimeUnit.SECOND}timezone($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.__string(this.bb_pos+Q,$):null}static startTimestamp($){$.startObject(2)}static addUnit($,Q){$.addFieldInt16(0,Q,zk.TimeUnit.SECOND)}static addTimezone($,Q){$.addFieldOffset(1,Q,0)}static endTimestamp($){return $.endObject()}static createTimestamp($,Q,J){return x4.startTimestamp($),x4.addUnit($,Q),x4.addTimezone($,J),x4.endTimestamp($)}}kk.Timestamp=x4});var zQ=g((Ok)=>{Object.defineProperty(Ok,"__esModule",{value:!0});Ok.Union=void 0;var Td=k1(),Rk=NY();class g4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsUnion($,Q){return(Q||new g4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsUnion($,Q){return $.setPosition($.position()+Td.SIZE_PREFIX_LENGTH),(Q||new g4).__init($.readInt32($.position())+$.position(),$)}mode(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):Rk.UnionMode.Sparse}typeIds($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.readInt32(this.bb.__vector(this.bb_pos+Q)+$*4):0}typeIdsLength(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.__vector_len(this.bb_pos+$):0}typeIdsArray(){let $=this.bb.__offset(this.bb_pos,6);return $?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+$),this.bb.__vector_len(this.bb_pos+$)):null}static startUnion($){$.startObject(2)}static addMode($,Q){$.addFieldInt16(0,Q,Rk.UnionMode.Sparse)}static addTypeIds($,Q){$.addFieldOffset(1,Q,0)}static createTypeIdsVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addInt32(Q[J]);return $.endVector()}static startTypeIdsVector($,Q){$.startVector(4,Q,4)}static endUnion($){return $.endObject()}static createUnion($,Q,J){return g4.startUnion($),g4.addMode($,Q),g4.addTypeIds($,J),g4.endUnion($)}}Ok.Union=g4});var _Y=g((Mk)=>{Object.defineProperty(Mk,"__esModule",{value:!0});Mk.Utf8=void 0;var Id=k1();class a8{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsUtf8($,Q){return(Q||new a8).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsUtf8($,Q){return $.setPosition($.position()+Id.SIZE_PREFIX_LENGTH),(Q||new a8).__init($.readInt32($.position())+$.position(),$)}static startUtf8($){$.startObject(0)}static endUtf8($){return $.endObject()}static createUtf8($){return a8.startUtf8($),a8.endUtf8($)}}Mk.Utf8=a8});var t8=g((nk)=>{Object.defineProperty(nk,"__esModule",{value:!0});nk.unionListToType=nk.unionToType=nk.Type=void 0;var Sk=IY(),Tk=GY(),Ik=WQ(),Gk=qQ(),Ek=HQ(),jk=FQ(),hk=UQ(),Lk=VQ(),vk=L4(),_k=NQ(),xk=EY(),gk=$k(),yk=jY(),fk=hY(),bk=DQ(),mk=LY(),ck=Uk(),dk=vY(),lk=CQ(),pk=AQ(),uk=zQ(),ik=_Y(),kQ;(function($){$[$.NONE=0]="NONE",$[$.Null=1]="Null",$[$.Int=2]="Int",$[$.FloatingPoint=3]="FloatingPoint",$[$.Binary=4]="Binary",$[$.Utf8=5]="Utf8",$[$.Bool=6]="Bool",$[$.Decimal=7]="Decimal",$[$.Date=8]="Date",$[$.Time=9]="Time",$[$.Timestamp=10]="Timestamp",$[$.Interval=11]="Interval",$[$.List=12]="List",$[$.Struct_=13]="Struct_",$[$.Union=14]="Union",$[$.FixedSizeBinary=15]="FixedSizeBinary",$[$.FixedSizeList=16]="FixedSizeList",$[$.Map=17]="Map",$[$.Duration=18]="Duration",$[$.LargeBinary=19]="LargeBinary",$[$.LargeUtf8=20]="LargeUtf8",$[$.LargeList=21]="LargeList",$[$.RunEndEncoded=22]="RunEndEncoded"})(kQ||(nk.Type=kQ={}));function Gd($,Q){switch(kQ[$]){case"NONE":return null;case"Null":return Q(new mk.Null);case"Int":return Q(new vk.Int);case"FloatingPoint":return Q(new Lk.FloatingPoint);case"Binary":return Q(new Sk.Binary);case"Utf8":return Q(new ik.Utf8);case"Bool":return Q(new Tk.Bool);case"Decimal":return Q(new Gk.Decimal);case"Date":return Q(new Ik.Date);case"Time":return Q(new lk.Time);case"Timestamp":return Q(new pk.Timestamp);case"Interval":return Q(new _k.Interval);case"List":return Q(new fk.List);case"Struct_":return Q(new dk.Struct_);case"Union":return Q(new uk.Union);case"FixedSizeBinary":return Q(new jk.FixedSizeBinary);case"FixedSizeList":return Q(new hk.FixedSizeList);case"Map":return Q(new bk.Map);case"Duration":return Q(new Ek.Duration);case"LargeBinary":return Q(new xk.LargeBinary);case"LargeUtf8":return Q(new yk.LargeUtf8);case"LargeList":return Q(new gk.LargeList);case"RunEndEncoded":return Q(new ck.RunEndEncoded);default:return null}}nk.unionToType=Gd;function Ed($,Q,J){switch(kQ[$]){case"NONE":return null;case"Null":return Q(J,new mk.Null);case"Int":return Q(J,new vk.Int);case"FloatingPoint":return Q(J,new Lk.FloatingPoint);case"Binary":return Q(J,new Sk.Binary);case"Utf8":return Q(J,new ik.Utf8);case"Bool":return Q(J,new Tk.Bool);case"Decimal":return Q(J,new Gk.Decimal);case"Date":return Q(J,new Ik.Date);case"Time":return Q(J,new lk.Time);case"Timestamp":return Q(J,new pk.Timestamp);case"Interval":return Q(J,new _k.Interval);case"List":return Q(J,new fk.List);case"Struct_":return Q(J,new dk.Struct_);case"Union":return Q(J,new uk.Union);case"FixedSizeBinary":return Q(J,new jk.FixedSizeBinary);case"FixedSizeList":return Q(J,new hk.FixedSizeList);case"Map":return Q(J,new bk.Map);case"Duration":return Q(J,new Ek.Duration);case"LargeBinary":return Q(J,new xk.LargeBinary);case"LargeUtf8":return Q(J,new yk.LargeUtf8);case"LargeList":return Q(J,new gk.LargeList);case"RunEndEncoded":return Q(J,new ck.RunEndEncoded);default:return null}}nk.unionListToType=Ed});var xY=g((rk)=>{Object.defineProperty(rk,"__esModule",{value:!0});rk.Field=void 0;var Ld=k1(),vd=TY(),_d=c8(),ok=t8();class P3{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsField($,Q){return(Q||new P3).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsField($,Q){return $.setPosition($.position()+Ld.SIZE_PREFIX_LENGTH),(Q||new P3).__init($.readInt32($.position())+$.position(),$)}name($){let Q=this.bb.__offset(this.bb_pos,4);return Q?this.bb.__string(this.bb_pos+Q,$):null}nullable(){let $=this.bb.__offset(this.bb_pos,6);return $?!!this.bb.readInt8(this.bb_pos+$):!1}typeType(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.readUint8(this.bb_pos+$):ok.Type.NONE}type($){let Q=this.bb.__offset(this.bb_pos,10);return Q?this.bb.__union($,this.bb_pos+Q):null}dictionary($){let Q=this.bb.__offset(this.bb_pos,12);return Q?($||new vd.DictionaryEncoding).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}children($,Q){let J=this.bb.__offset(this.bb_pos,14);return J?(Q||new P3).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}childrenLength(){let $=this.bb.__offset(this.bb_pos,14);return $?this.bb.__vector_len(this.bb_pos+$):0}customMetadata($,Q){let J=this.bb.__offset(this.bb_pos,16);return J?(Q||new _d.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}customMetadataLength(){let $=this.bb.__offset(this.bb_pos,16);return $?this.bb.__vector_len(this.bb_pos+$):0}static startField($){$.startObject(7)}static addName($,Q){$.addFieldOffset(0,Q,0)}static addNullable($,Q){$.addFieldInt8(1,+Q,0)}static addTypeType($,Q){$.addFieldInt8(2,Q,ok.Type.NONE)}static addType($,Q){$.addFieldOffset(3,Q,0)}static addDictionary($,Q){$.addFieldOffset(4,Q,0)}static addChildren($,Q){$.addFieldOffset(5,Q,0)}static createChildrenVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startChildrenVector($,Q){$.startVector(4,Q,4)}static addCustomMetadata($,Q){$.addFieldOffset(6,Q,0)}static createCustomMetadataVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startCustomMetadataVector($,Q){$.startVector(4,Q,4)}static endField($){return $.endObject()}}rk.Field=P3});var BQ=g((ek)=>{Object.defineProperty(ek,"__esModule",{value:!0});ek.Schema=void 0;var xd=k1(),tk=SY(),gd=xY(),yd=c8();class N6{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsSchema($,Q){return(Q||new N6).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsSchema($,Q){return $.setPosition($.position()+xd.SIZE_PREFIX_LENGTH),(Q||new N6).__init($.readInt32($.position())+$.position(),$)}endianness(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):tk.Endianness.Little}fields($,Q){let J=this.bb.__offset(this.bb_pos,6);return J?(Q||new gd.Field).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}fieldsLength(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.__vector_len(this.bb_pos+$):0}customMetadata($,Q){let J=this.bb.__offset(this.bb_pos,8);return J?(Q||new yd.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}customMetadataLength(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.__vector_len(this.bb_pos+$):0}features($){let Q=this.bb.__offset(this.bb_pos,10);return Q?this.bb.readInt64(this.bb.__vector(this.bb_pos+Q)+$*8):BigInt(0)}featuresLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.__vector_len(this.bb_pos+$):0}static startSchema($){$.startObject(4)}static addEndianness($,Q){$.addFieldInt16(0,Q,tk.Endianness.Little)}static addFields($,Q){$.addFieldOffset(1,Q,0)}static createFieldsVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startFieldsVector($,Q){$.startVector(4,Q,4)}static addCustomMetadata($,Q){$.addFieldOffset(2,Q,0)}static createCustomMetadataVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startCustomMetadataVector($,Q){$.startVector(4,Q,4)}static addFeatures($,Q){$.addFieldOffset(3,Q,0)}static createFeaturesVector($,Q){$.startVector(8,Q.length,8);for(let J=Q.length-1;J>=0;J--)$.addInt64(Q[J]);return $.endVector()}static startFeaturesVector($,Q){$.startVector(8,Q,8)}static endSchema($){return $.endObject()}static finishSchemaBuffer($,Q){$.finish(Q)}static finishSizePrefixedSchemaBuffer($,Q){$.finish(Q,void 0,!0)}static createSchema($,Q,J,Z,K){return N6.startSchema($),N6.addEndianness($,Q),N6.addFields($,J),N6.addCustomMetadata($,Z),N6.addFeatures($,K),N6.endSchema($)}}ek.Schema=N6});var KB=g((JB)=>{Object.defineProperty(JB,"__esModule",{value:!0});JB.SparseMatrixCompressedAxis=void 0;var QB;(function($){$[$.Row=0]="Row",$[$.Column=1]="Column"})(QB||(JB.SparseMatrixCompressedAxis=QB={}))});var FB=g((qB)=>{Object.defineProperty(qB,"__esModule",{value:!0});qB.SparseMatrixIndexCSX=void 0;var fd=k1(),XB=j4(),YB=L4(),WB=KB();class RQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsSparseMatrixIndexCSX($,Q){return(Q||new RQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsSparseMatrixIndexCSX($,Q){return $.setPosition($.position()+fd.SIZE_PREFIX_LENGTH),(Q||new RQ).__init($.readInt32($.position())+$.position(),$)}compressedAxis(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):WB.SparseMatrixCompressedAxis.Row}indptrType($){let Q=this.bb.__offset(this.bb_pos,6);return Q?($||new YB.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}indptrBuffer($){let Q=this.bb.__offset(this.bb_pos,8);return Q?($||new XB.Buffer).__init(this.bb_pos+Q,this.bb):null}indicesType($){let Q=this.bb.__offset(this.bb_pos,10);return Q?($||new YB.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}indicesBuffer($){let Q=this.bb.__offset(this.bb_pos,12);return Q?($||new XB.Buffer).__init(this.bb_pos+Q,this.bb):null}static startSparseMatrixIndexCSX($){$.startObject(5)}static addCompressedAxis($,Q){$.addFieldInt16(0,Q,WB.SparseMatrixCompressedAxis.Row)}static addIndptrType($,Q){$.addFieldOffset(1,Q,0)}static addIndptrBuffer($,Q){$.addFieldStruct(2,Q,0)}static addIndicesType($,Q){$.addFieldOffset(3,Q,0)}static addIndicesBuffer($,Q){$.addFieldStruct(4,Q,0)}static endSparseMatrixIndexCSX($){let Q=$.endObject();return $.requiredField(Q,6),$.requiredField(Q,8),$.requiredField(Q,10),$.requiredField(Q,12),Q}}qB.SparseMatrixIndexCSX=RQ});var NB=g((UB)=>{Object.defineProperty(UB,"__esModule",{value:!0});UB.SparseTensorIndexCOO=void 0;var bd=k1(),md=j4(),cd=L4();class OQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsSparseTensorIndexCOO($,Q){return(Q||new OQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsSparseTensorIndexCOO($,Q){return $.setPosition($.position()+bd.SIZE_PREFIX_LENGTH),(Q||new OQ).__init($.readInt32($.position())+$.position(),$)}indicesType($){let Q=this.bb.__offset(this.bb_pos,4);return Q?($||new cd.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}indicesStrides($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.readInt64(this.bb.__vector(this.bb_pos+Q)+$*8):BigInt(0)}indicesStridesLength(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.__vector_len(this.bb_pos+$):0}indicesBuffer($){let Q=this.bb.__offset(this.bb_pos,8);return Q?($||new md.Buffer).__init(this.bb_pos+Q,this.bb):null}isCanonical(){let $=this.bb.__offset(this.bb_pos,10);return $?!!this.bb.readInt8(this.bb_pos+$):!1}static startSparseTensorIndexCOO($){$.startObject(4)}static addIndicesType($,Q){$.addFieldOffset(0,Q,0)}static addIndicesStrides($,Q){$.addFieldOffset(1,Q,0)}static createIndicesStridesVector($,Q){$.startVector(8,Q.length,8);for(let J=Q.length-1;J>=0;J--)$.addInt64(Q[J]);return $.endVector()}static startIndicesStridesVector($,Q){$.startVector(8,Q,8)}static addIndicesBuffer($,Q){$.addFieldStruct(2,Q,0)}static addIsCanonical($,Q){$.addFieldInt8(3,+Q,0)}static endSparseTensorIndexCOO($){let Q=$.endObject();return $.requiredField(Q,4),$.requiredField(Q,8),Q}}UB.SparseTensorIndexCOO=OQ});var kB=g((AB)=>{Object.defineProperty(AB,"__esModule",{value:!0});AB.SparseTensorIndexCSF=void 0;var dd=k1(),DB=j4(),CB=L4();class PQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsSparseTensorIndexCSF($,Q){return(Q||new PQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsSparseTensorIndexCSF($,Q){return $.setPosition($.position()+dd.SIZE_PREFIX_LENGTH),(Q||new PQ).__init($.readInt32($.position())+$.position(),$)}indptrType($){let Q=this.bb.__offset(this.bb_pos,4);return Q?($||new CB.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}indptrBuffers($,Q){let J=this.bb.__offset(this.bb_pos,6);return J?(Q||new DB.Buffer).__init(this.bb.__vector(this.bb_pos+J)+$*16,this.bb):null}indptrBuffersLength(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.__vector_len(this.bb_pos+$):0}indicesType($){let Q=this.bb.__offset(this.bb_pos,8);return Q?($||new CB.Int).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}indicesBuffers($,Q){let J=this.bb.__offset(this.bb_pos,10);return J?(Q||new DB.Buffer).__init(this.bb.__vector(this.bb_pos+J)+$*16,this.bb):null}indicesBuffersLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.__vector_len(this.bb_pos+$):0}axisOrder($){let Q=this.bb.__offset(this.bb_pos,12);return Q?this.bb.readInt32(this.bb.__vector(this.bb_pos+Q)+$*4):0}axisOrderLength(){let $=this.bb.__offset(this.bb_pos,12);return $?this.bb.__vector_len(this.bb_pos+$):0}axisOrderArray(){let $=this.bb.__offset(this.bb_pos,12);return $?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+$),this.bb.__vector_len(this.bb_pos+$)):null}static startSparseTensorIndexCSF($){$.startObject(5)}static addIndptrType($,Q){$.addFieldOffset(0,Q,0)}static addIndptrBuffers($,Q){$.addFieldOffset(1,Q,0)}static startIndptrBuffersVector($,Q){$.startVector(16,Q,8)}static addIndicesType($,Q){$.addFieldOffset(2,Q,0)}static addIndicesBuffers($,Q){$.addFieldOffset(3,Q,0)}static startIndicesBuffersVector($,Q){$.startVector(16,Q,8)}static addAxisOrder($,Q){$.addFieldOffset(4,Q,0)}static createAxisOrderVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addInt32(Q[J]);return $.endVector()}static startAxisOrderVector($,Q){$.startVector(4,Q,4)}static endSparseTensorIndexCSF($){let Q=$.endObject();return $.requiredField(Q,4),$.requiredField(Q,6),$.requiredField(Q,8),$.requiredField(Q,10),$.requiredField(Q,12),Q}}AB.SparseTensorIndexCSF=PQ});var wB=g((PB)=>{Object.defineProperty(PB,"__esModule",{value:!0});PB.unionListToSparseTensorIndex=PB.unionToSparseTensorIndex=PB.SparseTensorIndex=void 0;var BB=FB(),RB=NB(),OB=kB(),MQ;(function($){$[$.NONE=0]="NONE",$[$.SparseTensorIndexCOO=1]="SparseTensorIndexCOO",$[$.SparseMatrixIndexCSX=2]="SparseMatrixIndexCSX",$[$.SparseTensorIndexCSF=3]="SparseTensorIndexCSF"})(MQ||(PB.SparseTensorIndex=MQ={}));function ld($,Q){switch(MQ[$]){case"NONE":return null;case"SparseTensorIndexCOO":return Q(new RB.SparseTensorIndexCOO);case"SparseMatrixIndexCSX":return Q(new BB.SparseMatrixIndexCSX);case"SparseTensorIndexCSF":return Q(new OB.SparseTensorIndexCSF);default:return null}}PB.unionToSparseTensorIndex=ld;function pd($,Q,J){switch(MQ[$]){case"NONE":return null;case"SparseTensorIndexCOO":return Q(J,new RB.SparseTensorIndexCOO);case"SparseMatrixIndexCSX":return Q(J,new BB.SparseMatrixIndexCSX);case"SparseTensorIndexCSF":return Q(J,new OB.SparseTensorIndexCSF);default:return null}}PB.unionListToSparseTensorIndex=pd});var gY=g((SB)=>{Object.defineProperty(SB,"__esModule",{value:!0});SB.TensorDim=void 0;var nd=k1();class y4{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsTensorDim($,Q){return(Q||new y4).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsTensorDim($,Q){return $.setPosition($.position()+nd.SIZE_PREFIX_LENGTH),(Q||new y4).__init($.readInt32($.position())+$.position(),$)}size(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}name($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.__string(this.bb_pos+Q,$):null}static startTensorDim($){$.startObject(2)}static addSize($,Q){$.addFieldInt64(0,Q,BigInt("0"))}static addName($,Q){$.addFieldOffset(1,Q,0)}static endTensorDim($){return $.endObject()}static createTensorDim($,Q,J){return y4.startTensorDim($),y4.addSize($,Q),y4.addName($,J),y4.endTensorDim($)}}SB.TensorDim=y4});var hB=g((EB)=>{Object.defineProperty(EB,"__esModule",{value:!0});EB.SparseTensor=void 0;var sd=k1(),od=j4(),IB=wB(),rd=gY(),GB=t8();class wQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsSparseTensor($,Q){return(Q||new wQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsSparseTensor($,Q){return $.setPosition($.position()+sd.SIZE_PREFIX_LENGTH),(Q||new wQ).__init($.readInt32($.position())+$.position(),$)}typeType(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readUint8(this.bb_pos+$):GB.Type.NONE}type($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.__union($,this.bb_pos+Q):null}shape($,Q){let J=this.bb.__offset(this.bb_pos,8);return J?(Q||new rd.TensorDim).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}shapeLength(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.__vector_len(this.bb_pos+$):0}nonZeroLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}sparseIndexType(){let $=this.bb.__offset(this.bb_pos,12);return $?this.bb.readUint8(this.bb_pos+$):IB.SparseTensorIndex.NONE}sparseIndex($){let Q=this.bb.__offset(this.bb_pos,14);return Q?this.bb.__union($,this.bb_pos+Q):null}data($){let Q=this.bb.__offset(this.bb_pos,16);return Q?($||new od.Buffer).__init(this.bb_pos+Q,this.bb):null}static startSparseTensor($){$.startObject(7)}static addTypeType($,Q){$.addFieldInt8(0,Q,GB.Type.NONE)}static addType($,Q){$.addFieldOffset(1,Q,0)}static addShape($,Q){$.addFieldOffset(2,Q,0)}static createShapeVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startShapeVector($,Q){$.startVector(4,Q,4)}static addNonZeroLength($,Q){$.addFieldInt64(3,Q,BigInt("0"))}static addSparseIndexType($,Q){$.addFieldInt8(4,Q,IB.SparseTensorIndex.NONE)}static addSparseIndex($,Q){$.addFieldOffset(5,Q,0)}static addData($,Q){$.addFieldStruct(6,Q,0)}static endSparseTensor($){let Q=$.endObject();return $.requiredField(Q,6),$.requiredField(Q,8),$.requiredField(Q,14),$.requiredField(Q,16),Q}static finishSparseTensorBuffer($,Q){$.finish(Q)}static finishSizePrefixedSparseTensorBuffer($,Q){$.finish(Q,void 0,!0)}}EB.SparseTensor=wQ});var xB=g((vB)=>{Object.defineProperty(vB,"__esModule",{value:!0});vB.Tensor=void 0;var ad=k1(),td=j4(),ed=gY(),LB=t8();class SQ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsTensor($,Q){return(Q||new SQ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsTensor($,Q){return $.setPosition($.position()+ad.SIZE_PREFIX_LENGTH),(Q||new SQ).__init($.readInt32($.position())+$.position(),$)}typeType(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readUint8(this.bb_pos+$):LB.Type.NONE}type($){let Q=this.bb.__offset(this.bb_pos,6);return Q?this.bb.__union($,this.bb_pos+Q):null}shape($,Q){let J=this.bb.__offset(this.bb_pos,8);return J?(Q||new ed.TensorDim).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}shapeLength(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.__vector_len(this.bb_pos+$):0}strides($){let Q=this.bb.__offset(this.bb_pos,10);return Q?this.bb.readInt64(this.bb.__vector(this.bb_pos+Q)+$*8):BigInt(0)}stridesLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.__vector_len(this.bb_pos+$):0}data($){let Q=this.bb.__offset(this.bb_pos,12);return Q?($||new td.Buffer).__init(this.bb_pos+Q,this.bb):null}static startTensor($){$.startObject(5)}static addTypeType($,Q){$.addFieldInt8(0,Q,LB.Type.NONE)}static addType($,Q){$.addFieldOffset(1,Q,0)}static addShape($,Q){$.addFieldOffset(2,Q,0)}static createShapeVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startShapeVector($,Q){$.startVector(4,Q,4)}static addStrides($,Q){$.addFieldOffset(3,Q,0)}static createStridesVector($,Q){$.startVector(8,Q.length,8);for(let J=Q.length-1;J>=0;J--)$.addInt64(Q[J]);return $.endVector()}static startStridesVector($,Q){$.startVector(8,Q,8)}static addData($,Q){$.addFieldStruct(4,Q,0)}static endTensor($){let Q=$.endObject();return $.requiredField(Q,6),$.requiredField(Q,8),$.requiredField(Q,12),Q}static finishTensorBuffer($,Q){$.finish(Q)}static finishSizePrefixedTensorBuffer($,Q){$.finish(Q,void 0,!0)}}vB.Tensor=SQ});var IQ=g((cB)=>{Object.defineProperty(cB,"__esModule",{value:!0});cB.unionListToMessageHeader=cB.unionToMessageHeader=cB.MessageHeader=void 0;var gB=wY(),yB=KQ(),fB=BQ(),bB=hB(),mB=xB(),TQ;(function($){$[$.NONE=0]="NONE",$[$.Schema=1]="Schema",$[$.DictionaryBatch=2]="DictionaryBatch",$[$.RecordBatch=3]="RecordBatch",$[$.Tensor=4]="Tensor",$[$.SparseTensor=5]="SparseTensor"})(TQ||(cB.MessageHeader=TQ={}));function $l($,Q){switch(TQ[$]){case"NONE":return null;case"Schema":return Q(new fB.Schema);case"DictionaryBatch":return Q(new gB.DictionaryBatch);case"RecordBatch":return Q(new yB.RecordBatch);case"Tensor":return Q(new mB.Tensor);case"SparseTensor":return Q(new bB.SparseTensor);default:return null}}cB.unionToMessageHeader=$l;function Ql($,Q,J){switch(TQ[$]){case"NONE":return null;case"Schema":return Q(J,new fB.Schema);case"DictionaryBatch":return Q(J,new gB.DictionaryBatch);case"RecordBatch":return Q(J,new yB.RecordBatch);case"Tensor":return Q(J,new mB.Tensor);case"SparseTensor":return Q(J,new bB.SparseTensor);default:return null}}cB.unionListToMessageHeader=Ql});var a1=g((o6)=>{Object.defineProperty(o6,"__esModule",{value:!0});o6.BufferType=o6.Type=o6.MessageHeader=o6.IntervalUnit=o6.TimeUnit=o6.DateUnit=o6.Precision=o6.UnionMode=o6.MetadataVersion=void 0;var Kl=QQ();Object.defineProperty(o6,"MetadataVersion",{enumerable:!0,get:function(){return Kl.MetadataVersion}});var Xl=NY();Object.defineProperty(o6,"UnionMode",{enumerable:!0,get:function(){return Xl.UnionMode}});var Yl=DY();Object.defineProperty(o6,"Precision",{enumerable:!0,get:function(){return Yl.Precision}});var Wl=CY();Object.defineProperty(o6,"DateUnit",{enumerable:!0,get:function(){return Wl.DateUnit}});var ql=O3();Object.defineProperty(o6,"TimeUnit",{enumerable:!0,get:function(){return ql.TimeUnit}});var Hl=AY();Object.defineProperty(o6,"IntervalUnit",{enumerable:!0,get:function(){return Hl.IntervalUnit}});var Fl=IQ();Object.defineProperty(o6,"MessageHeader",{enumerable:!0,get:function(){return Fl.MessageHeader}});var lB;(function($){$[$.NONE=0]="NONE",$[$.Null=1]="Null",$[$.Int=2]="Int",$[$.Float=3]="Float",$[$.Binary=4]="Binary",$[$.Utf8=5]="Utf8",$[$.Bool=6]="Bool",$[$.Decimal=7]="Decimal",$[$.Date=8]="Date",$[$.Time=9]="Time",$[$.Timestamp=10]="Timestamp",$[$.Interval=11]="Interval",$[$.List=12]="List",$[$.Struct=13]="Struct",$[$.Union=14]="Union",$[$.FixedSizeBinary=15]="FixedSizeBinary",$[$.FixedSizeList=16]="FixedSizeList",$[$.Map=17]="Map",$[$.Duration=18]="Duration",$[$.LargeBinary=19]="LargeBinary",$[$.LargeUtf8=20]="LargeUtf8",$[$.Dictionary=-1]="Dictionary",$[$.Int8=-2]="Int8",$[$.Int16=-3]="Int16",$[$.Int32=-4]="Int32",$[$.Int64=-5]="Int64",$[$.Uint8=-6]="Uint8",$[$.Uint16=-7]="Uint16",$[$.Uint32=-8]="Uint32",$[$.Uint64=-9]="Uint64",$[$.Float16=-10]="Float16",$[$.Float32=-11]="Float32",$[$.Float64=-12]="Float64",$[$.DateDay=-13]="DateDay",$[$.DateMillisecond=-14]="DateMillisecond",$[$.TimestampSecond=-15]="TimestampSecond",$[$.TimestampMillisecond=-16]="TimestampMillisecond",$[$.TimestampMicrosecond=-17]="TimestampMicrosecond",$[$.TimestampNanosecond=-18]="TimestampNanosecond",$[$.TimeSecond=-19]="TimeSecond",$[$.TimeMillisecond=-20]="TimeMillisecond",$[$.TimeMicrosecond=-21]="TimeMicrosecond",$[$.TimeNanosecond=-22]="TimeNanosecond",$[$.DenseUnion=-23]="DenseUnion",$[$.SparseUnion=-24]="SparseUnion",$[$.IntervalDayTime=-25]="IntervalDayTime",$[$.IntervalYearMonth=-26]="IntervalYearMonth",$[$.DurationSecond=-27]="DurationSecond",$[$.DurationMillisecond=-28]="DurationMillisecond",$[$.DurationMicrosecond=-29]="DurationMicrosecond",$[$.DurationNanosecond=-30]="DurationNanosecond"})(lB||(o6.Type=lB={}));var pB;(function($){$[$.OFFSET=0]="OFFSET",$[$.DATA=1]="DATA",$[$.VALIDITY=2]="VALIDITY",$[$.TYPE=3]="TYPE"})(pB||(o6.BufferType=pB={}))});var M3=g((nB)=>{Object.defineProperty(nB,"__esModule",{value:!0});nB.valueToString=void 0;var Vl=void 0;function iB($){if($===null)return"null";if($===Vl)return"undefined";switch(typeof $){case"number":return`${$}`;case"bigint":return`${$}`;case"string":return`"${$}"`}if(typeof $[Symbol.toPrimitive]==="function")return $[Symbol.toPrimitive]("string");if(ArrayBuffer.isView($)){if($ instanceof BigInt64Array||$ instanceof BigUint64Array)return`[${[...$].map((Q)=>iB(Q))}]`;return`[${$}]`}return ArrayBuffer.isView($)?`[${$}]`:JSON.stringify($,(Q,J)=>typeof J==="bigint"?`${J}`:J)}nB.valueToString=iB});var f4=g((oB)=>{Object.defineProperty(oB,"__esModule",{value:!0});oB.divideBigInts=oB.bigIntToNumber=void 0;function GQ($){if(typeof $==="bigint"&&($<Number.MIN_SAFE_INTEGER||$>Number.MAX_SAFE_INTEGER))throw TypeError(`${$} is not safe to convert to a number.`);return Number($)}oB.bigIntToNumber=GQ;function Nl($,Q){return GQ($/Q)+GQ($%Q)/GQ(Q)}oB.divideBigInts=Nl});var jQ=g((tB)=>{Object.defineProperty(tB,"__esModule",{value:!0});tB.BN=tB.bigNumToBigInt=tB.bigNumToString=tB.bigNumToNumber=tB.isArrowBigNumSymbol=void 0;var Cl=z0(),EQ=f4();tB.isArrowBigNumSymbol=Symbol.for("isArrowBigNum");function p5($,...Q){if(Q.length===0)return Object.setPrototypeOf((0,Cl.toArrayBufferView)(this.TypedArray,$),this.constructor.prototype);return Object.setPrototypeOf(new this.TypedArray($,...Q),this.constructor.prototype)}p5.prototype[tB.isArrowBigNumSymbol]=!0;p5.prototype.toJSON=function(){return`"${Q9(this)}"`};p5.prototype.valueOf=function($){return fY(this,$)};p5.prototype.toString=function(){return Q9(this)};p5.prototype[Symbol.toPrimitive]=function($="default"){switch($){case"number":return fY(this);case"string":return Q9(this);case"default":return aB(this)}return Q9(this)};function e8(...$){return p5.apply(this,$)}function $9(...$){return p5.apply(this,$)}function w3(...$){return p5.apply(this,$)}Object.setPrototypeOf(e8.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf($9.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(w3.prototype,Object.create(Uint32Array.prototype));Object.assign(e8.prototype,p5.prototype,{constructor:e8,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign($9.prototype,p5.prototype,{constructor:$9,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(w3.prototype,p5.prototype,{constructor:w3,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});var Al=BigInt(4294967296)*BigInt(4294967296),zl=Al-BigInt(1);function fY($,Q){let{buffer:J,byteOffset:Z,byteLength:K,signed:X}=$,Y=new BigUint64Array(J,Z,K/8),W=X&&Y.at(-1)&BigInt(1)<<BigInt(63),q=BigInt(0),H=0;if(W){for(let F of Y)q|=(F^zl)*(BigInt(1)<<BigInt(64*H++));q*=BigInt(-1),q-=BigInt(1)}else for(let F of Y)q|=F*(BigInt(1)<<BigInt(64*H++));if(typeof Q==="number"){let F=BigInt(Math.pow(10,Q)),U=q/F,V=q%F;return(0,EQ.bigIntToNumber)(U)+(0,EQ.bigIntToNumber)(V)/(0,EQ.bigIntToNumber)(F)}return(0,EQ.bigIntToNumber)(q)}tB.bigNumToNumber=fY;function Q9($){if($.byteLength===8)return`${new $.BigIntArray($.buffer,$.byteOffset,1)[0]}`;if(!$.signed)return yY($);let Q=new Uint16Array($.buffer,$.byteOffset,$.byteLength/2);if(new Int16Array([Q.at(-1)])[0]>=0)return yY($);Q=Q.slice();let Z=1;for(let X=0;X<Q.length;X++){let Y=Q[X],W=~Y+Z;Q[X]=W,Z&=Y===0?1:0}return`-${yY(Q)}`}tB.bigNumToString=Q9;function aB($){if($.byteLength===8)return new $.BigIntArray($.buffer,$.byteOffset,1)[0];else return Q9($)}tB.bigNumToBigInt=aB;function yY($){let Q="",J=new Uint32Array(2),Z=new Uint16Array($.buffer,$.byteOffset,$.byteLength/2),K=new Uint32Array((Z=new Uint16Array(Z).reverse()).buffer),X=-1,Y=Z.length-1;do{for(J[0]=Z[X=0];X<Y;)Z[X++]=J[1]=J[0]/10,J[0]=(J[0]-J[1]*10<<16)+Z[X];Z[X]=J[1]=J[0]/10,J[0]=J[0]-J[1]*10,Q=`${J[0]}${Q}`}while(K[0]||K[1]||K[2]||K[3]);return Q!==null&&Q!==void 0?Q:"0"}class bY{static new($,Q){switch(Q){case!0:return new e8($);case!1:return new $9($)}switch($.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new e8($)}if($.byteLength===16)return new w3($);return new $9($)}static signed($){return new e8($)}static unsigned($){return new $9($)}static decimal($){return new w3($)}constructor($,Q){return bY.new($,Q)}}tB.BN=bY});var p1=g((cR)=>{var QR,JR,ZR,KR,XR,YR,WR,qR,HR,FR,UR,VR,NR,DR,CR,AR,zR,kR,BR,RR,OR,PR;Object.defineProperty(cR,"__esModule",{value:!0});cR.Map_=cR.FixedSizeList=cR.FixedSizeBinary=cR.SparseUnion=cR.DenseUnion=cR.Union=cR.Struct=cR.List=cR.DurationNanosecond=cR.DurationMicrosecond=cR.DurationMillisecond=cR.DurationSecond=cR.Duration=cR.IntervalYearMonth=cR.IntervalDayTime=cR.Interval=cR.TimestampNanosecond=cR.TimestampMicrosecond=cR.TimestampMillisecond=cR.TimestampSecond=cR.Timestamp=cR.TimeNanosecond=cR.TimeMicrosecond=cR.TimeMillisecond=cR.TimeSecond=cR.Time=cR.DateMillisecond=cR.DateDay=cR.Date_=cR.Decimal=cR.Bool=cR.LargeUtf8=cR.Utf8=cR.LargeBinary=cR.Binary=cR.Float64=cR.Float32=cR.Float16=cR.Float=cR.Uint64=cR.Uint32=cR.Uint16=cR.Uint8=cR.Int64=cR.Int32=cR.Int16=cR.Int8=cR.Int=cR.Null=cR.DataType=void 0;cR.strideForType=cR.Dictionary=void 0;var Ol=f4(),n=a1();class f1{static isNull($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Null}static isInt($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Int}static isFloat($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Float}static isBinary($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Binary}static isLargeBinary($){return($===null||$===void 0?void 0:$.typeId)===n.Type.LargeBinary}static isUtf8($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Utf8}static isLargeUtf8($){return($===null||$===void 0?void 0:$.typeId)===n.Type.LargeUtf8}static isBool($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Bool}static isDecimal($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Decimal}static isDate($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Date}static isTime($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Time}static isTimestamp($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Timestamp}static isInterval($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Interval}static isDuration($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Duration}static isList($){return($===null||$===void 0?void 0:$.typeId)===n.Type.List}static isStruct($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Struct}static isUnion($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Union}static isFixedSizeBinary($){return($===null||$===void 0?void 0:$.typeId)===n.Type.FixedSizeBinary}static isFixedSizeList($){return($===null||$===void 0?void 0:$.typeId)===n.Type.FixedSizeList}static isMap($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Map}static isDictionary($){return($===null||$===void 0?void 0:$.typeId)===n.Type.Dictionary}static isDenseUnion($){return f1.isUnion($)&&$.mode===n.UnionMode.Dense}static isSparseUnion($){return f1.isUnion($)&&$.mode===n.UnionMode.Sparse}constructor($){this.typeId=$}}cR.DataType=f1;QR=Symbol.toStringTag;f1[QR]=(($)=>{return $.children=null,$.ArrayType=Array,$.OffsetArrayType=Int32Array,$[Symbol.toStringTag]="DataType"})(f1.prototype);class hQ extends f1{constructor(){super(n.Type.Null)}toString(){return"Null"}}cR.Null=hQ;JR=Symbol.toStringTag;hQ[JR]=(($)=>$[Symbol.toStringTag]="Null")(hQ.prototype);class z5 extends f1{constructor($,Q){super(n.Type.Int);this.isSigned=$,this.bitWidth=Q}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}cR.Int=z5;ZR=Symbol.toStringTag;z5[ZR]=(($)=>{return $.isSigned=null,$.bitWidth=null,$[Symbol.toStringTag]="Int"})(z5.prototype);class mY extends z5{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}cR.Int8=mY;class cY extends z5{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}cR.Int16=cY;class dY extends z5{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}cR.Int32=dY;class lY extends z5{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}cR.Int64=lY;class pY extends z5{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}cR.Uint8=pY;class uY extends z5{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}cR.Uint16=uY;class iY extends z5{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}cR.Uint32=iY;class nY extends z5{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}cR.Uint64=nY;Object.defineProperty(mY.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(cY.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(dY.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(lY.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(pY.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(uY.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(iY.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(nY.prototype,"ArrayType",{value:BigUint64Array});class f7 extends f1{constructor($){super(n.Type.Float);this.precision=$}get ArrayType(){switch(this.precision){case n.Precision.HALF:return Uint16Array;case n.Precision.SINGLE:return Float32Array;case n.Precision.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}cR.Float=f7;KR=Symbol.toStringTag;f7[KR]=(($)=>{return $.precision=null,$[Symbol.toStringTag]="Float"})(f7.prototype);class sY extends f7{constructor(){super(n.Precision.HALF)}}cR.Float16=sY;class oY extends f7{constructor(){super(n.Precision.SINGLE)}}cR.Float32=oY;class rY extends f7{constructor(){super(n.Precision.DOUBLE)}}cR.Float64=rY;Object.defineProperty(sY.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(oY.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(rY.prototype,"ArrayType",{value:Float64Array});class LQ extends f1{constructor(){super(n.Type.Binary)}toString(){return"Binary"}}cR.Binary=LQ;XR=Symbol.toStringTag;LQ[XR]=(($)=>{return $.ArrayType=Uint8Array,$[Symbol.toStringTag]="Binary"})(LQ.prototype);class vQ extends f1{constructor(){super(n.Type.LargeBinary)}toString(){return"LargeBinary"}}cR.LargeBinary=vQ;YR=Symbol.toStringTag;vQ[YR]=(($)=>{return $.ArrayType=Uint8Array,$.OffsetArrayType=BigInt64Array,$[Symbol.toStringTag]="LargeBinary"})(vQ.prototype);class _Q extends f1{constructor(){super(n.Type.Utf8)}toString(){return"Utf8"}}cR.Utf8=_Q;WR=Symbol.toStringTag;_Q[WR]=(($)=>{return $.ArrayType=Uint8Array,$[Symbol.toStringTag]="Utf8"})(_Q.prototype);class xQ extends f1{constructor(){super(n.Type.LargeUtf8)}toString(){return"LargeUtf8"}}cR.LargeUtf8=xQ;qR=Symbol.toStringTag;xQ[qR]=(($)=>{return $.ArrayType=Uint8Array,$.OffsetArrayType=BigInt64Array,$[Symbol.toStringTag]="LargeUtf8"})(xQ.prototype);class gQ extends f1{constructor(){super(n.Type.Bool)}toString(){return"Bool"}}cR.Bool=gQ;HR=Symbol.toStringTag;gQ[HR]=(($)=>{return $.ArrayType=Uint8Array,$[Symbol.toStringTag]="Bool"})(gQ.prototype);class yQ extends f1{constructor($,Q,J=128){super(n.Type.Decimal);this.scale=$,this.precision=Q,this.bitWidth=J}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}cR.Decimal=yQ;FR=Symbol.toStringTag;yQ[FR]=(($)=>{return $.scale=null,$.precision=null,$.ArrayType=Uint32Array,$[Symbol.toStringTag]="Decimal"})(yQ.prototype);class J9 extends f1{constructor($){super(n.Type.Date);this.unit=$}toString(){return`Date${(this.unit+1)*32}<${n.DateUnit[this.unit]}>`}get ArrayType(){return this.unit===n.DateUnit.DAY?Int32Array:BigInt64Array}}cR.Date_=J9;UR=Symbol.toStringTag;J9[UR]=(($)=>{return $.unit=null,$[Symbol.toStringTag]="Date"})(J9.prototype);class MR extends J9{constructor(){super(n.DateUnit.DAY)}}cR.DateDay=MR;class wR extends J9{constructor(){super(n.DateUnit.MILLISECOND)}}cR.DateMillisecond=wR;class b4 extends f1{constructor($,Q){super(n.Type.Time);this.unit=$,this.bitWidth=Q}toString(){return`Time${this.bitWidth}<${n.TimeUnit[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}cR.Time=b4;VR=Symbol.toStringTag;b4[VR]=(($)=>{return $.unit=null,$.bitWidth=null,$[Symbol.toStringTag]="Time"})(b4.prototype);class SR extends b4{constructor(){super(n.TimeUnit.SECOND,32)}}cR.TimeSecond=SR;class TR extends b4{constructor(){super(n.TimeUnit.MILLISECOND,32)}}cR.TimeMillisecond=TR;class IR extends b4{constructor(){super(n.TimeUnit.MICROSECOND,64)}}cR.TimeMicrosecond=IR;class GR extends b4{constructor(){super(n.TimeUnit.NANOSECOND,64)}}cR.TimeNanosecond=GR;class m4 extends f1{constructor($,Q){super(n.Type.Timestamp);this.unit=$,this.timezone=Q}toString(){return`Timestamp<${n.TimeUnit[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}cR.Timestamp=m4;NR=Symbol.toStringTag;m4[NR]=(($)=>{return $.unit=null,$.timezone=null,$.ArrayType=BigInt64Array,$[Symbol.toStringTag]="Timestamp"})(m4.prototype);class ER extends m4{constructor($){super(n.TimeUnit.SECOND,$)}}cR.TimestampSecond=ER;class jR extends m4{constructor($){super(n.TimeUnit.MILLISECOND,$)}}cR.TimestampMillisecond=jR;class hR extends m4{constructor($){super(n.TimeUnit.MICROSECOND,$)}}cR.TimestampMicrosecond=hR;class LR extends m4{constructor($){super(n.TimeUnit.NANOSECOND,$)}}cR.TimestampNanosecond=LR;class Z9 extends f1{constructor($){super(n.Type.Interval);this.unit=$}toString(){return`Interval<${n.IntervalUnit[this.unit]}>`}}cR.Interval=Z9;DR=Symbol.toStringTag;Z9[DR]=(($)=>{return $.unit=null,$.ArrayType=Int32Array,$[Symbol.toStringTag]="Interval"})(Z9.prototype);class vR extends Z9{constructor(){super(n.IntervalUnit.DAY_TIME)}}cR.IntervalDayTime=vR;class _R extends Z9{constructor(){super(n.IntervalUnit.YEAR_MONTH)}}cR.IntervalYearMonth=_R;class c4 extends f1{constructor($){super(n.Type.Duration);this.unit=$}toString(){return`Duration<${n.TimeUnit[this.unit]}>`}}cR.Duration=c4;CR=Symbol.toStringTag;c4[CR]=(($)=>{return $.unit=null,$.ArrayType=BigInt64Array,$[Symbol.toStringTag]="Duration"})(c4.prototype);class xR extends c4{constructor(){super(n.TimeUnit.SECOND)}}cR.DurationSecond=xR;class gR extends c4{constructor(){super(n.TimeUnit.MILLISECOND)}}cR.DurationMillisecond=gR;class yR extends c4{constructor(){super(n.TimeUnit.MICROSECOND)}}cR.DurationMicrosecond=yR;class fR extends c4{constructor(){super(n.TimeUnit.NANOSECOND)}}cR.DurationNanosecond=fR;class fQ extends f1{constructor($){super(n.Type.List);this.children=[$]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}cR.List=fQ;AR=Symbol.toStringTag;fQ[AR]=(($)=>{return $.children=null,$[Symbol.toStringTag]="List"})(fQ.prototype);class bQ extends f1{constructor($){super(n.Type.Struct);this.children=$}toString(){return`Struct<{${this.children.map(($)=>`${$.name}:${$.type}`).join(", ")}}>`}}cR.Struct=bQ;zR=Symbol.toStringTag;bQ[zR]=(($)=>{return $.children=null,$[Symbol.toStringTag]="Struct"})(bQ.prototype);class K9 extends f1{constructor($,Q,J){super(n.Type.Union);this.mode=$,this.children=J,this.typeIds=Q=Int32Array.from(Q),this.typeIdToChildIndex=Q.reduce((Z,K,X)=>(Z[K]=X)&&Z||Z,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(($)=>`${$.type}`).join(" | ")}>`}}cR.Union=K9;kR=Symbol.toStringTag;K9[kR]=(($)=>{return $.mode=null,$.typeIds=null,$.children=null,$.typeIdToChildIndex=null,$.ArrayType=Int8Array,$[Symbol.toStringTag]="Union"})(K9.prototype);class bR extends K9{constructor($,Q){super(n.UnionMode.Dense,$,Q)}}cR.DenseUnion=bR;class mR extends K9{constructor($,Q){super(n.UnionMode.Sparse,$,Q)}}cR.SparseUnion=mR;class mQ extends f1{constructor($){super(n.Type.FixedSizeBinary);this.byteWidth=$}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}cR.FixedSizeBinary=mQ;BR=Symbol.toStringTag;mQ[BR]=(($)=>{return $.byteWidth=null,$.ArrayType=Uint8Array,$[Symbol.toStringTag]="FixedSizeBinary"})(mQ.prototype);class cQ extends f1{constructor($,Q){super(n.Type.FixedSizeList);this.listSize=$,this.children=[Q]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}cR.FixedSizeList=cQ;RR=Symbol.toStringTag;cQ[RR]=(($)=>{return $.children=null,$.listSize=null,$[Symbol.toStringTag]="FixedSizeList"})(cQ.prototype);class dQ extends f1{constructor($,Q=!1){var J,Z,K;super(n.Type.Map);if(this.children=[$],this.keysSorted=Q,$){if($.name="entries",(J=$===null||$===void 0?void 0:$.type)===null||J===void 0?void 0:J.children){let X=(Z=$===null||$===void 0?void 0:$.type)===null||Z===void 0?void 0:Z.children[0];if(X)X.name="key";let Y=(K=$===null||$===void 0?void 0:$.type)===null||K===void 0?void 0:K.children[1];if(Y)Y.name="value"}}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(($)=>`${$.name}:${$.type}`).join(", ")}}>`}}cR.Map_=dQ;OR=Symbol.toStringTag;dQ[OR]=(($)=>{return $.children=null,$.keysSorted=null,$[Symbol.toStringTag]="Map_"})(dQ.prototype);var Pl=(($)=>()=>++$)(-1);class lQ extends f1{constructor($,Q,J,Z){super(n.Type.Dictionary);this.indices=Q,this.dictionary=$,this.isOrdered=Z||!1,this.id=J==null?Pl():(0,Ol.bigIntToNumber)(J)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}cR.Dictionary=lQ;PR=Symbol.toStringTag;lQ[PR]=(($)=>{return $.id=null,$.indices=null,$.isOrdered=null,$.dictionary=null,$[Symbol.toStringTag]="Dictionary"})(lQ.prototype);function Ml($){let Q=$;switch($.typeId){case n.Type.Decimal:return $.bitWidth/32;case n.Type.Interval:return 1+Q.unit;case n.Type.FixedSizeList:return Q.listSize;case n.Type.FixedSizeBinary:return Q.byteWidth;default:return 1}}cR.strideForType=Ml});var r0=g((iR)=>{Object.defineProperty(iR,"__esModule",{value:!0});iR.Visitor=void 0;var x=a1(),pR=p1();class j1{visitMany($,...Q){return $.map((J,Z)=>this.visit(J,...Q.map((K)=>K[Z])))}visit(...$){return this.getVisitFn($[0],!1).apply(this,$)}getVisitFn($,Q=!0){return Rp(this,$,Q)}getVisitFnByTypeId($,Q=!0){return X9(this,$,Q)}visitNull($,...Q){return null}visitBool($,...Q){return null}visitInt($,...Q){return null}visitFloat($,...Q){return null}visitUtf8($,...Q){return null}visitLargeUtf8($,...Q){return null}visitBinary($,...Q){return null}visitLargeBinary($,...Q){return null}visitFixedSizeBinary($,...Q){return null}visitDate($,...Q){return null}visitTimestamp($,...Q){return null}visitTime($,...Q){return null}visitDecimal($,...Q){return null}visitList($,...Q){return null}visitStruct($,...Q){return null}visitUnion($,...Q){return null}visitDictionary($,...Q){return null}visitInterval($,...Q){return null}visitDuration($,...Q){return null}visitFixedSizeList($,...Q){return null}visitMap($,...Q){return null}}iR.Visitor=j1;function Rp($,Q,J=!0){if(typeof Q==="number")return X9($,Q,J);if(typeof Q==="string"&&Q in x.Type)return X9($,x.Type[Q],J);if(Q&&Q instanceof pR.DataType)return X9($,uR(Q),J);if((Q===null||Q===void 0?void 0:Q.type)&&Q.type instanceof pR.DataType)return X9($,uR(Q.type),J);return X9($,x.Type.NONE,J)}function X9($,Q,J=!0){let Z=null;switch(Q){case x.Type.Null:Z=$.visitNull;break;case x.Type.Bool:Z=$.visitBool;break;case x.Type.Int:Z=$.visitInt;break;case x.Type.Int8:Z=$.visitInt8||$.visitInt;break;case x.Type.Int16:Z=$.visitInt16||$.visitInt;break;case x.Type.Int32:Z=$.visitInt32||$.visitInt;break;case x.Type.Int64:Z=$.visitInt64||$.visitInt;break;case x.Type.Uint8:Z=$.visitUint8||$.visitInt;break;case x.Type.Uint16:Z=$.visitUint16||$.visitInt;break;case x.Type.Uint32:Z=$.visitUint32||$.visitInt;break;case x.Type.Uint64:Z=$.visitUint64||$.visitInt;break;case x.Type.Float:Z=$.visitFloat;break;case x.Type.Float16:Z=$.visitFloat16||$.visitFloat;break;case x.Type.Float32:Z=$.visitFloat32||$.visitFloat;break;case x.Type.Float64:Z=$.visitFloat64||$.visitFloat;break;case x.Type.Utf8:Z=$.visitUtf8;break;case x.Type.LargeUtf8:Z=$.visitLargeUtf8;break;case x.Type.Binary:Z=$.visitBinary;break;case x.Type.LargeBinary:Z=$.visitLargeBinary;break;case x.Type.FixedSizeBinary:Z=$.visitFixedSizeBinary;break;case x.Type.Date:Z=$.visitDate;break;case x.Type.DateDay:Z=$.visitDateDay||$.visitDate;break;case x.Type.DateMillisecond:Z=$.visitDateMillisecond||$.visitDate;break;case x.Type.Timestamp:Z=$.visitTimestamp;break;case x.Type.TimestampSecond:Z=$.visitTimestampSecond||$.visitTimestamp;break;case x.Type.TimestampMillisecond:Z=$.visitTimestampMillisecond||$.visitTimestamp;break;case x.Type.TimestampMicrosecond:Z=$.visitTimestampMicrosecond||$.visitTimestamp;break;case x.Type.TimestampNanosecond:Z=$.visitTimestampNanosecond||$.visitTimestamp;break;case x.Type.Time:Z=$.visitTime;break;case x.Type.TimeSecond:Z=$.visitTimeSecond||$.visitTime;break;case x.Type.TimeMillisecond:Z=$.visitTimeMillisecond||$.visitTime;break;case x.Type.TimeMicrosecond:Z=$.visitTimeMicrosecond||$.visitTime;break;case x.Type.TimeNanosecond:Z=$.visitTimeNanosecond||$.visitTime;break;case x.Type.Decimal:Z=$.visitDecimal;break;case x.Type.List:Z=$.visitList;break;case x.Type.Struct:Z=$.visitStruct;break;case x.Type.Union:Z=$.visitUnion;break;case x.Type.DenseUnion:Z=$.visitDenseUnion||$.visitUnion;break;case x.Type.SparseUnion:Z=$.visitSparseUnion||$.visitUnion;break;case x.Type.Dictionary:Z=$.visitDictionary;break;case x.Type.Interval:Z=$.visitInterval;break;case x.Type.IntervalDayTime:Z=$.visitIntervalDayTime||$.visitInterval;break;case x.Type.IntervalYearMonth:Z=$.visitIntervalYearMonth||$.visitInterval;break;case x.Type.Duration:Z=$.visitDuration;break;case x.Type.DurationSecond:Z=$.visitDurationSecond||$.visitDuration;break;case x.Type.DurationMillisecond:Z=$.visitDurationMillisecond||$.visitDuration;break;case x.Type.DurationMicrosecond:Z=$.visitDurationMicrosecond||$.visitDuration;break;case x.Type.DurationNanosecond:Z=$.visitDurationNanosecond||$.visitDuration;break;case x.Type.FixedSizeList:Z=$.visitFixedSizeList;break;case x.Type.Map:Z=$.visitMap;break}if(typeof Z==="function")return Z;if(!J)return()=>null;throw Error(`Unrecognized type '${x.Type[Q]}'`)}function uR($){switch($.typeId){case x.Type.Null:return x.Type.Null;case x.Type.Int:{let{bitWidth:Q,isSigned:J}=$;switch(Q){case 8:return J?x.Type.Int8:x.Type.Uint8;case 16:return J?x.Type.Int16:x.Type.Uint16;case 32:return J?x.Type.Int32:x.Type.Uint32;case 64:return J?x.Type.Int64:x.Type.Uint64}return x.Type.Int}case x.Type.Float:switch($.precision){case x.Precision.HALF:return x.Type.Float16;case x.Precision.SINGLE:return x.Type.Float32;case x.Precision.DOUBLE:return x.Type.Float64}return x.Type.Float;case x.Type.Binary:return x.Type.Binary;case x.Type.LargeBinary:return x.Type.LargeBinary;case x.Type.Utf8:return x.Type.Utf8;case x.Type.LargeUtf8:return x.Type.LargeUtf8;case x.Type.Bool:return x.Type.Bool;case x.Type.Decimal:return x.Type.Decimal;case x.Type.Time:switch($.unit){case x.TimeUnit.SECOND:return x.Type.TimeSecond;case x.TimeUnit.MILLISECOND:return x.Type.TimeMillisecond;case x.TimeUnit.MICROSECOND:return x.Type.TimeMicrosecond;case x.TimeUnit.NANOSECOND:return x.Type.TimeNanosecond}return x.Type.Time;case x.Type.Timestamp:switch($.unit){case x.TimeUnit.SECOND:return x.Type.TimestampSecond;case x.TimeUnit.MILLISECOND:return x.Type.TimestampMillisecond;case x.TimeUnit.MICROSECOND:return x.Type.TimestampMicrosecond;case x.TimeUnit.NANOSECOND:return x.Type.TimestampNanosecond}return x.Type.Timestamp;case x.Type.Date:switch($.unit){case x.DateUnit.DAY:return x.Type.DateDay;case x.DateUnit.MILLISECOND:return x.Type.DateMillisecond}return x.Type.Date;case x.Type.Interval:switch($.unit){case x.IntervalUnit.DAY_TIME:return x.Type.IntervalDayTime;case x.IntervalUnit.YEAR_MONTH:return x.Type.IntervalYearMonth}return x.Type.Interval;case x.Type.Duration:switch($.unit){case x.TimeUnit.SECOND:return x.Type.DurationSecond;case x.TimeUnit.MILLISECOND:return x.Type.DurationMillisecond;case x.TimeUnit.MICROSECOND:return x.Type.DurationMicrosecond;case x.TimeUnit.NANOSECOND:return x.Type.DurationNanosecond}return x.Type.Duration;case x.Type.Map:return x.Type.Map;case x.Type.List:return x.Type.List;case x.Type.Struct:return x.Type.Struct;case x.Type.Union:switch($.mode){case x.UnionMode.Dense:return x.Type.DenseUnion;case x.UnionMode.Sparse:return x.Type.SparseUnion}return x.Type.Union;case x.Type.FixedSizeBinary:return x.Type.FixedSizeBinary;case x.Type.FixedSizeList:return x.Type.FixedSizeList;case x.Type.Dictionary:return x.Type.Dictionary}throw Error(`Unrecognized type '${x.Type[$.typeId]}'`)}j1.prototype.visitInt8=null;j1.prototype.visitInt16=null;j1.prototype.visitInt32=null;j1.prototype.visitInt64=null;j1.prototype.visitUint8=null;j1.prototype.visitUint16=null;j1.prototype.visitUint32=null;j1.prototype.visitUint64=null;j1.prototype.visitFloat16=null;j1.prototype.visitFloat32=null;j1.prototype.visitFloat64=null;j1.prototype.visitDateDay=null;j1.prototype.visitDateMillisecond=null;j1.prototype.visitTimestampSecond=null;j1.prototype.visitTimestampMillisecond=null;j1.prototype.visitTimestampMicrosecond=null;j1.prototype.visitTimestampNanosecond=null;j1.prototype.visitTimeSecond=null;j1.prototype.visitTimeMillisecond=null;j1.prototype.visitTimeMicrosecond=null;j1.prototype.visitTimeNanosecond=null;j1.prototype.visitDenseUnion=null;j1.prototype.visitSparseUnion=null;j1.prototype.visitIntervalDayTime=null;j1.prototype.visitIntervalYearMonth=null;j1.prototype.visitDuration=null;j1.prototype.visitDurationSecond=null;j1.prototype.visitDurationMillisecond=null;j1.prototype.visitDurationMicrosecond=null;j1.prototype.visitDurationNanosecond=null});var S3=g((oR)=>{Object.defineProperty(oR,"__esModule",{value:!0});oR.float64ToUint16=oR.uint16ToFloat64=void 0;var sR=new Float64Array(1),Y9=new Uint32Array(sR.buffer);function Op($){let Q=($&31744)>>10,J=($&1023)/1024,Z=Math.pow(-1,($&32768)>>15);switch(Q){case 31:return Z*(J?Number.NaN:1/0);case 0:return Z*(J?0.00006103515625*J:0)}return Z*Math.pow(2,Q-15)*(1+J)}oR.uint16ToFloat64=Op;function Pp($){if($!==$)return 32256;sR[0]=$;let Q=(Y9[1]&2147483648)>>16&65535,J=Y9[1]&2146435072,Z=0;if(J>=1089470464)if(Y9[0]>0)J=31744;else J=(J&2080374784)>>16,Z=(Y9[1]&1048575)>>10;else if(J<=1056964608)Z=1048576+(Y9[1]&1048575),Z=1048576+(Z<<(J>>20)-998)>>21,J=0;else J=J-1056964608>>10,Z=(Y9[1]&1048575)+512>>10;return Q|J|Z&65535}oR.float64ToUint16=Pp});var Y5=g((JO)=>{Object.defineProperty(JO,"__esModule",{value:!0});JO.instance=JO.setDuration=JO.setDurationNanosecond=JO.setDurationMicrosecond=JO.setDurationMillisecond=JO.setDurationSecond=JO.setIntervalYearMonth=JO.setIntervalDayTime=JO.setIntervalValue=JO.setDecimal=JO.setTime=JO.setTimeNanosecond=JO.setTimeMicrosecond=JO.setTimeMillisecond=JO.setTimeSecond=JO.setTimestamp=JO.setTimestampNanosecond=JO.setTimestampMicrosecond=JO.setTimestampMillisecond=JO.setTimestampSecond=JO.setDate=JO.setFixedSizeBinary=JO.setDateMillisecond=JO.setDateDay=JO.setAnyFloat=JO.setFloat16=JO.setFloat=JO.setInt=JO.setVariableWidthBytes=JO.setEpochMsToDays=JO.SetVisitor=void 0;var wp=m0(),Sp=r0(),aR=f4(),Tp=I4(),Ip=S3(),k0=a1();class K1 extends Sp.Visitor{}JO.SetVisitor=K1;function U1($){return(Q,J,Z)=>{if(Q.setValid(J,Z!=null))return $(Q,J,Z)}}var Gp=($,Q,J)=>{$[Q]=Math.floor(J/86400000)};JO.setEpochMsToDays=Gp;var Ep=($,Q,J,Z)=>{if(J+1<Q.length){let K=(0,aR.bigIntToNumber)(Q[J]),X=(0,aR.bigIntToNumber)(Q[J+1]);$.set(Z.subarray(0,X-K),K)}};JO.setVariableWidthBytes=Ep;var jp=({offset:$,values:Q},J,Z)=>{let K=$+J;Z?Q[K>>3]|=1<<K%8:Q[K>>3]&=~(1<<K%8)},hp=({values:$},Q,J)=>{$[Q]=J};JO.setInt=hp;var Lp=({values:$},Q,J)=>{$[Q]=J};JO.setFloat=Lp;var vp=({values:$},Q,J)=>{$[Q]=(0,Ip.float64ToUint16)(J)};JO.setFloat16=vp;var _p=($,Q,J)=>{switch($.type.precision){case k0.Precision.HALF:return JO.setFloat16($,Q,J);case k0.Precision.SINGLE:case k0.Precision.DOUBLE:return JO.setFloat($,Q,J)}};JO.setAnyFloat=_p;var xp=({values:$},Q,J)=>{JO.setEpochMsToDays($,Q,J.valueOf())};JO.setDateDay=xp;var gp=({values:$},Q,J)=>{$[Q]=BigInt(J)};JO.setDateMillisecond=gp;var yp=({stride:$,values:Q},J,Z)=>{Q.set(Z.subarray(0,$),$*J)};JO.setFixedSizeBinary=yp;var tR=({values:$,valueOffsets:Q},J,Z)=>JO.setVariableWidthBytes($,Q,J,Z),eR=({values:$,valueOffsets:Q},J,Z)=>JO.setVariableWidthBytes($,Q,J,(0,Tp.encodeUtf8)(Z)),fp=($,Q,J)=>{$.type.unit===k0.DateUnit.DAY?JO.setDateDay($,Q,J):JO.setDateMillisecond($,Q,J)};JO.setDate=fp;var bp=({values:$},Q,J)=>{$[Q]=BigInt(J/1000)};JO.setTimestampSecond=bp;var mp=({values:$},Q,J)=>{$[Q]=BigInt(J)};JO.setTimestampMillisecond=mp;var cp=({values:$},Q,J)=>{$[Q]=BigInt(J*1000)};JO.setTimestampMicrosecond=cp;var dp=({values:$},Q,J)=>{$[Q]=BigInt(J*1e6)};JO.setTimestampNanosecond=dp;var lp=($,Q,J)=>{switch($.type.unit){case k0.TimeUnit.SECOND:return JO.setTimestampSecond($,Q,J);case k0.TimeUnit.MILLISECOND:return JO.setTimestampMillisecond($,Q,J);case k0.TimeUnit.MICROSECOND:return JO.setTimestampMicrosecond($,Q,J);case k0.TimeUnit.NANOSECOND:return JO.setTimestampNanosecond($,Q,J)}};JO.setTimestamp=lp;var pp=({values:$},Q,J)=>{$[Q]=J};JO.setTimeSecond=pp;var up=({values:$},Q,J)=>{$[Q]=J};JO.setTimeMillisecond=up;var ip=({values:$},Q,J)=>{$[Q]=J};JO.setTimeMicrosecond=ip;var np=({values:$},Q,J)=>{$[Q]=J};JO.setTimeNanosecond=np;var sp=($,Q,J)=>{switch($.type.unit){case k0.TimeUnit.SECOND:return JO.setTimeSecond($,Q,J);case k0.TimeUnit.MILLISECOND:return JO.setTimeMillisecond($,Q,J);case k0.TimeUnit.MICROSECOND:return JO.setTimeMicrosecond($,Q,J);case k0.TimeUnit.NANOSECOND:return JO.setTimeNanosecond($,Q,J)}};JO.setTime=sp;var op=({values:$,stride:Q},J,Z)=>{$.set(Z.subarray(0,Q),Q*J)};JO.setDecimal=op;var rp=($,Q,J)=>{let Z=$.children[0],K=$.valueOffsets,X=JO.instance.getVisitFn(Z);if(Array.isArray(J))for(let Y=-1,W=K[Q],q=K[Q+1];W<q;)X(Z,W++,J[++Y]);else for(let Y=-1,W=K[Q],q=K[Q+1];W<q;)X(Z,W++,J.get(++Y))},ap=($,Q,J)=>{let Z=$.children[0],{valueOffsets:K}=$,X=JO.instance.getVisitFn(Z),{[Q]:Y,[Q+1]:W}=K,q=J instanceof Map?J.entries():Object.entries(J);for(let H of q)if(X(Z,Y,H),++Y>=W)break},tp=($,Q)=>(J,Z,K,X)=>Z&&J(Z,$,Q[X]),ep=($,Q)=>(J,Z,K,X)=>Z&&J(Z,$,Q.get(X)),$u=($,Q)=>(J,Z,K,X)=>Z&&J(Z,$,Q.get(K.name)),Qu=($,Q)=>(J,Z,K,X)=>Z&&J(Z,$,Q[K.name]),Ju=($,Q,J)=>{let Z=$.type.children.map((X)=>JO.instance.getVisitFn(X.type)),K=J instanceof Map?$u(Q,J):J instanceof wp.Vector?ep(Q,J):Array.isArray(J)?tp(Q,J):Qu(Q,J);$.type.children.forEach((X,Y)=>K(Z[Y],$.children[Y],X,Y))},Zu=($,Q,J)=>{$.type.mode===k0.UnionMode.Dense?$O($,Q,J):QO($,Q,J)},$O=($,Q,J)=>{let Z=$.type.typeIdToChildIndex[$.typeIds[Q]],K=$.children[Z];JO.instance.visit(K,$.valueOffsets[Q],J)},QO=($,Q,J)=>{let Z=$.type.typeIdToChildIndex[$.typeIds[Q]],K=$.children[Z];JO.instance.visit(K,Q,J)},Ku=($,Q,J)=>{var Z;(Z=$.dictionary)===null||Z===void 0||Z.set($.values[Q],J)},Xu=($,Q,J)=>{$.type.unit===k0.IntervalUnit.DAY_TIME?JO.setIntervalDayTime($,Q,J):JO.setIntervalYearMonth($,Q,J)};JO.setIntervalValue=Xu;var Yu=({values:$},Q,J)=>{$.set(J.subarray(0,2),2*Q)};JO.setIntervalDayTime=Yu;var Wu=({values:$},Q,J)=>{$[Q]=J[0]*12+J[1]%12};JO.setIntervalYearMonth=Wu;var qu=({values:$},Q,J)=>{$[Q]=J};JO.setDurationSecond=qu;var Hu=({values:$},Q,J)=>{$[Q]=J};JO.setDurationMillisecond=Hu;var Fu=({values:$},Q,J)=>{$[Q]=J};JO.setDurationMicrosecond=Fu;var Uu=({values:$},Q,J)=>{$[Q]=J};JO.setDurationNanosecond=Uu;var Vu=($,Q,J)=>{switch($.type.unit){case k0.TimeUnit.SECOND:return JO.setDurationSecond($,Q,J);case k0.TimeUnit.MILLISECOND:return JO.setDurationMillisecond($,Q,J);case k0.TimeUnit.MICROSECOND:return JO.setDurationMicrosecond($,Q,J);case k0.TimeUnit.NANOSECOND:return JO.setDurationNanosecond($,Q,J)}};JO.setDuration=Vu;var Nu=($,Q,J)=>{let{stride:Z}=$,K=$.children[0],X=JO.instance.getVisitFn(K);if(Array.isArray(J))for(let Y=-1,W=Q*Z;++Y<Z;)X(K,W+Y,J[Y]);else for(let Y=-1,W=Q*Z;++Y<Z;)X(K,W+Y,J.get(Y))};K1.prototype.visitBool=U1(jp);K1.prototype.visitInt=U1(JO.setInt);K1.prototype.visitInt8=U1(JO.setInt);K1.prototype.visitInt16=U1(JO.setInt);K1.prototype.visitInt32=U1(JO.setInt);K1.prototype.visitInt64=U1(JO.setInt);K1.prototype.visitUint8=U1(JO.setInt);K1.prototype.visitUint16=U1(JO.setInt);K1.prototype.visitUint32=U1(JO.setInt);K1.prototype.visitUint64=U1(JO.setInt);K1.prototype.visitFloat=U1(JO.setAnyFloat);K1.prototype.visitFloat16=U1(JO.setFloat16);K1.prototype.visitFloat32=U1(JO.setFloat);K1.prototype.visitFloat64=U1(JO.setFloat);K1.prototype.visitUtf8=U1(eR);K1.prototype.visitLargeUtf8=U1(eR);K1.prototype.visitBinary=U1(tR);K1.prototype.visitLargeBinary=U1(tR);K1.prototype.visitFixedSizeBinary=U1(JO.setFixedSizeBinary);K1.prototype.visitDate=U1(JO.setDate);K1.prototype.visitDateDay=U1(JO.setDateDay);K1.prototype.visitDateMillisecond=U1(JO.setDateMillisecond);K1.prototype.visitTimestamp=U1(JO.setTimestamp);K1.prototype.visitTimestampSecond=U1(JO.setTimestampSecond);K1.prototype.visitTimestampMillisecond=U1(JO.setTimestampMillisecond);K1.prototype.visitTimestampMicrosecond=U1(JO.setTimestampMicrosecond);K1.prototype.visitTimestampNanosecond=U1(JO.setTimestampNanosecond);K1.prototype.visitTime=U1(JO.setTime);K1.prototype.visitTimeSecond=U1(JO.setTimeSecond);K1.prototype.visitTimeMillisecond=U1(JO.setTimeMillisecond);K1.prototype.visitTimeMicrosecond=U1(JO.setTimeMicrosecond);K1.prototype.visitTimeNanosecond=U1(JO.setTimeNanosecond);K1.prototype.visitDecimal=U1(JO.setDecimal);K1.prototype.visitList=U1(rp);K1.prototype.visitStruct=U1(Ju);K1.prototype.visitUnion=U1(Zu);K1.prototype.visitDenseUnion=U1($O);K1.prototype.visitSparseUnion=U1(QO);K1.prototype.visitDictionary=U1(Ku);K1.prototype.visitInterval=U1(JO.setIntervalValue);K1.prototype.visitIntervalDayTime=U1(JO.setIntervalDayTime);K1.prototype.visitIntervalYearMonth=U1(JO.setIntervalYearMonth);K1.prototype.visitDuration=U1(JO.setDuration);K1.prototype.visitDurationSecond=U1(JO.setDurationSecond);K1.prototype.visitDurationMillisecond=U1(JO.setDurationMillisecond);K1.prototype.visitDurationMicrosecond=U1(JO.setDurationMicrosecond);K1.prototype.visitDurationNanosecond=U1(JO.setDurationNanosecond);K1.prototype.visitFixedSizeList=U1(Nu);K1.prototype.visitMap=U1(ap);JO.instance=new K1});var uQ=g((CO)=>{Object.defineProperty(CO,"__esModule",{value:!0});CO.StructRow=void 0;var VO=M3(),CW=b7(),Cu=Y5(),u5=Symbol.for("parent"),W9=Symbol.for("rowIndex");class AW{constructor($,Q){return this[u5]=$,this[W9]=Q,new Proxy(this,new DO)}toArray(){return Object.values(this.toJSON())}toJSON(){let $=this[W9],Q=this[u5],J=Q.type.children,Z={};for(let K=-1,X=J.length;++K<X;)Z[J[K].name]=CW.instance.visit(Q.children[K],$);return Z}toString(){return`{${[...this].map(([$,Q])=>`${(0,VO.valueToString)($)}: ${(0,VO.valueToString)(Q)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new NO(this[u5],this[W9])}}CO.StructRow=AW;class NO{constructor($,Q){this.childIndex=0,this.children=$.children,this.rowIndex=Q,this.childFields=$.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let $=this.childIndex;if($<this.numChildren)return this.childIndex=$+1,{done:!1,value:[this.childFields[$].name,CW.instance.visit(this.children[$],this.rowIndex)]};return{done:!0,value:null}}}Object.defineProperties(AW.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[u5]:{writable:!0,enumerable:!1,configurable:!1,value:null},[W9]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class DO{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys($){return $[u5].type.children.map((Q)=>Q.name)}has($,Q){return $[u5].type.children.findIndex((J)=>J.name===Q)!==-1}getOwnPropertyDescriptor($,Q){if($[u5].type.children.findIndex((J)=>J.name===Q)!==-1)return{writable:!0,enumerable:!0,configurable:!0};return}get($,Q){if(Reflect.has($,Q))return $[Q];let J=$[u5].type.children.findIndex((Z)=>Z.name===Q);if(J!==-1){let Z=CW.instance.visit($[u5].children[J],$[W9]);return Reflect.set($,Q,Z),Z}}set($,Q,J){let Z=$[u5].type.children.findIndex((K)=>K.name===Q);if(Z!==-1)return Cu.instance.visit($[u5].children[Z],$[W9],J),Reflect.set($,Q,J);else if(Reflect.has($,Q)||typeof Q==="symbol")return Reflect.set($,Q,J);return!1}}});var b7=g((cO)=>{Object.defineProperty(cO,"__esModule",{value:!0});cO.instance=cO.GetVisitor=void 0;var Au=jQ(),zO=m0(),zu=r0(),ku=T3(),Bu=uQ(),m7=f4(),Ru=I4(),kO=S3(),j0=a1();class e extends zu.Visitor{}cO.GetVisitor=e;function W1($){return(Q,J)=>Q.getValid(J)?$(Q,J):null}var Ou=($,Q)=>86400000*$[Q],Pu=($,Q)=>null,BO=($,Q,J)=>{if(J+1>=Q.length)return null;let Z=(0,m7.bigIntToNumber)(Q[J]),K=(0,m7.bigIntToNumber)(Q[J+1]);return $.subarray(Z,K)},Mu=({offset:$,values:Q},J)=>{let Z=$+J;return(Q[Z>>3]&1<<Z%8)!==0},RO=({values:$},Q)=>Ou($,Q),OO=({values:$},Q)=>(0,m7.bigIntToNumber)($[Q]),l4=({stride:$,values:Q},J)=>Q[$*J],wu=({stride:$,values:Q},J)=>(0,kO.uint16ToFloat64)(Q[$*J]),PO=({values:$},Q)=>$[Q],Su=({stride:$,values:Q},J)=>Q.subarray($*J,$*(J+1)),MO=({values:$,valueOffsets:Q},J)=>BO($,Q,J),wO=({values:$,valueOffsets:Q},J)=>{let Z=BO($,Q,J);return Z!==null?(0,Ru.decodeUtf8)(Z):null},Tu=({values:$},Q)=>$[Q],Iu=({type:$,values:Q},J)=>$.precision!==j0.Precision.HALF?Q[J]:(0,kO.uint16ToFloat64)(Q[J]),Gu=($,Q)=>$.type.unit===j0.DateUnit.DAY?RO($,Q):OO($,Q),SO=({values:$},Q)=>1000*(0,m7.bigIntToNumber)($[Q]),TO=({values:$},Q)=>(0,m7.bigIntToNumber)($[Q]),IO=({values:$},Q)=>(0,m7.divideBigInts)($[Q],BigInt(1000)),GO=({values:$},Q)=>(0,m7.divideBigInts)($[Q],BigInt(1e6)),Eu=($,Q)=>{switch($.type.unit){case j0.TimeUnit.SECOND:return SO($,Q);case j0.TimeUnit.MILLISECOND:return TO($,Q);case j0.TimeUnit.MICROSECOND:return IO($,Q);case j0.TimeUnit.NANOSECOND:return GO($,Q)}},EO=({values:$},Q)=>$[Q],jO=({values:$},Q)=>$[Q],hO=({values:$},Q)=>$[Q],LO=({values:$},Q)=>$[Q],ju=($,Q)=>{switch($.type.unit){case j0.TimeUnit.SECOND:return EO($,Q);case j0.TimeUnit.MILLISECOND:return jO($,Q);case j0.TimeUnit.MICROSECOND:return hO($,Q);case j0.TimeUnit.NANOSECOND:return LO($,Q)}},hu=({values:$,stride:Q},J)=>Au.BN.decimal($.subarray(Q*J,Q*(J+1))),Lu=($,Q)=>{let{valueOffsets:J,stride:Z,children:K}=$,{[Q*Z]:X,[Q*Z+1]:Y}=J,q=K[0].slice(X,Y-X);return new zO.Vector([q])},vu=($,Q)=>{let{valueOffsets:J,children:Z}=$,{[Q]:K,[Q+1]:X}=J,Y=Z[0];return new ku.MapRow(Y.slice(K,X-K))},_u=($,Q)=>{return new Bu.StructRow($,Q)},xu=($,Q)=>{return $.type.mode===j0.UnionMode.Dense?vO($,Q):_O($,Q)},vO=($,Q)=>{let J=$.type.typeIdToChildIndex[$.typeIds[Q]],Z=$.children[J];return cO.instance.visit(Z,$.valueOffsets[Q])},_O=($,Q)=>{let J=$.type.typeIdToChildIndex[$.typeIds[Q]],Z=$.children[J];return cO.instance.visit(Z,Q)},gu=($,Q)=>{var J;return(J=$.dictionary)===null||J===void 0?void 0:J.get($.values[Q])},yu=($,Q)=>$.type.unit===j0.IntervalUnit.DAY_TIME?xO($,Q):gO($,Q),xO=({values:$},Q)=>$.subarray(2*Q,2*(Q+1)),gO=({values:$},Q)=>{let J=$[Q],Z=new Int32Array(2);return Z[0]=Math.trunc(J/12),Z[1]=Math.trunc(J%12),Z},yO=({values:$},Q)=>$[Q],fO=({values:$},Q)=>$[Q],bO=({values:$},Q)=>$[Q],mO=({values:$},Q)=>$[Q],fu=($,Q)=>{switch($.type.unit){case j0.TimeUnit.SECOND:return yO($,Q);case j0.TimeUnit.MILLISECOND:return fO($,Q);case j0.TimeUnit.MICROSECOND:return bO($,Q);case j0.TimeUnit.NANOSECOND:return mO($,Q)}},bu=($,Q)=>{let{stride:J,children:Z}=$,X=Z[0].slice(Q*J,J);return new zO.Vector([X])};e.prototype.visitNull=W1(Pu);e.prototype.visitBool=W1(Mu);e.prototype.visitInt=W1(Tu);e.prototype.visitInt8=W1(l4);e.prototype.visitInt16=W1(l4);e.prototype.visitInt32=W1(l4);e.prototype.visitInt64=W1(PO);e.prototype.visitUint8=W1(l4);e.prototype.visitUint16=W1(l4);e.prototype.visitUint32=W1(l4);e.prototype.visitUint64=W1(PO);e.prototype.visitFloat=W1(Iu);e.prototype.visitFloat16=W1(wu);e.prototype.visitFloat32=W1(l4);e.prototype.visitFloat64=W1(l4);e.prototype.visitUtf8=W1(wO);e.prototype.visitLargeUtf8=W1(wO);e.prototype.visitBinary=W1(MO);e.prototype.visitLargeBinary=W1(MO);e.prototype.visitFixedSizeBinary=W1(Su);e.prototype.visitDate=W1(Gu);e.prototype.visitDateDay=W1(RO);e.prototype.visitDateMillisecond=W1(OO);e.prototype.visitTimestamp=W1(Eu);e.prototype.visitTimestampSecond=W1(SO);e.prototype.visitTimestampMillisecond=W1(TO);e.prototype.visitTimestampMicrosecond=W1(IO);e.prototype.visitTimestampNanosecond=W1(GO);e.prototype.visitTime=W1(ju);e.prototype.visitTimeSecond=W1(EO);e.prototype.visitTimeMillisecond=W1(jO);e.prototype.visitTimeMicrosecond=W1(hO);e.prototype.visitTimeNanosecond=W1(LO);e.prototype.visitDecimal=W1(hu);e.prototype.visitList=W1(Lu);e.prototype.visitStruct=W1(_u);e.prototype.visitUnion=W1(xu);e.prototype.visitDenseUnion=W1(vO);e.prototype.visitSparseUnion=W1(_O);e.prototype.visitDictionary=W1(gu);e.prototype.visitInterval=W1(yu);e.prototype.visitIntervalDayTime=W1(xO);e.prototype.visitIntervalYearMonth=W1(gO);e.prototype.visitDuration=W1(fu);e.prototype.visitDurationSecond=W1(yO);e.prototype.visitDurationMillisecond=W1(fO);e.prototype.visitDurationMicrosecond=W1(bO);e.prototype.visitDurationNanosecond=W1(mO);e.prototype.visitFixedSizeList=W1(bu);e.prototype.visitMap=W1(vu);cO.instance=new e});var T3=g((uO)=>{Object.defineProperty(uO,"__esModule",{value:!0});uO.MapRow=uO._kKeysAsStrings=uO.kKeysAsStrings=uO.kVals=uO.kKeys=void 0;var cu=m0(),dO=M3(),zW=b7(),du=Y5();uO.kKeys=Symbol.for("keys");uO.kVals=Symbol.for("vals");uO.kKeysAsStrings=Symbol.for("kKeysAsStrings");uO._kKeysAsStrings=Symbol.for("_kKeysAsStrings");class kW{constructor($){return this[uO.kKeys]=new cu.Vector([$.children[0]]).memoize(),this[uO.kVals]=$.children[1],new Proxy(this,new pO)}get[uO.kKeysAsStrings](){return this[uO._kKeysAsStrings]||(this[uO._kKeysAsStrings]=Array.from(this[uO.kKeys].toArray(),String))}[Symbol.iterator](){return new lO(this[uO.kKeys],this[uO.kVals])}get size(){return this[uO.kKeys].length}toArray(){return Object.values(this.toJSON())}toJSON(){let $=this[uO.kKeys],Q=this[uO.kVals],J={};for(let Z=-1,K=$.length;++Z<K;)J[$.get(Z)]=zW.instance.visit(Q,Z);return J}toString(){return`{${[...this].map(([$,Q])=>`${(0,dO.valueToString)($)}: ${(0,dO.valueToString)(Q)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}uO.MapRow=kW;class lO{constructor($,Q){this.keys=$,this.vals=Q,this.keyIndex=0,this.numKeys=$.length}[Symbol.iterator](){return this}next(){let $=this.keyIndex;if($===this.numKeys)return{done:!0,value:null};return this.keyIndex++,{done:!1,value:[this.keys.get($),zW.instance.visit(this.vals,$)]}}}class pO{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys($){return $[uO.kKeysAsStrings]}has($,Q){return $[uO.kKeysAsStrings].includes(Q)}getOwnPropertyDescriptor($,Q){if($[uO.kKeysAsStrings].indexOf(Q)!==-1)return{writable:!0,enumerable:!0,configurable:!0};return}get($,Q){if(Reflect.has($,Q))return $[Q];let J=$[uO.kKeysAsStrings].indexOf(Q);if(J!==-1){let Z=zW.instance.visit(Reflect.get($,uO.kVals),J);return Reflect.set($,Q,Z),Z}}set($,Q,J){let Z=$[uO.kKeysAsStrings].indexOf(Q);if(Z!==-1)return du.instance.visit(Reflect.get($,uO.kVals),Z,J),Reflect.set($,Q,J);else if(Reflect.has($,Q))return Reflect.set($,Q,J);return!1}}Object.defineProperties(kW.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[uO.kKeys]:{writable:!0,enumerable:!1,configurable:!1,value:null},[uO.kVals]:{writable:!0,enumerable:!1,configurable:!1,value:null},[uO._kKeysAsStrings]:{writable:!0,enumerable:!1,configurable:!1,value:null}})});var q9=g((aO)=>{Object.defineProperty(aO,"__esModule",{value:!0});aO.createElementComparator=aO.wrapIndex=aO.clampRange=void 0;var rO=m0(),lu=T3(),pu=uQ(),uu=z0(),nO;function iu($,Q,J,Z){let{length:K=0}=$,X=typeof Q!=="number"?0:Q,Y=typeof J!=="number"?K:J;return X<0&&(X=(X%K+K)%K),Y<0&&(Y=(Y%K+K)%K),Y<X&&(nO=X,X=Y,Y=nO),Y>K&&(Y=K),Z?Z($,X,Y):[X,Y]}aO.clampRange=iu;var nu=($,Q)=>$<0?Q+$:$;aO.wrapIndex=nu;var sO=($)=>$!==$;function I3($){if(typeof $!=="object"||$===null){if(sO($))return sO;return(J)=>J===$}if($ instanceof Date){let J=$.valueOf();return(Z)=>Z instanceof Date?Z.valueOf()===J:!1}if(ArrayBuffer.isView($))return(J)=>J?(0,uu.compareArrayLike)($,J):!1;if($ instanceof Map)return ou($);if(Array.isArray($))return su($);if($ instanceof rO.Vector)return ru($);return au($,!0)}aO.createElementComparator=I3;function su($){let Q=[];for(let J=-1,Z=$.length;++J<Z;)Q[J]=I3($[J]);return sQ(Q)}function ou($){let Q=-1,J=[];for(let Z of $.values())J[++Q]=I3(Z);return sQ(J)}function ru($){let Q=[];for(let J=-1,Z=$.length;++J<Z;)Q[J]=I3($.get(J));return sQ(Q)}function au($,Q=!1){let J=Object.keys($);if(!Q&&J.length===0)return()=>!1;let Z=[];for(let K=-1,X=J.length;++K<X;)Z[K]=I3($[J[K]]);return sQ(Z,J)}function sQ($,Q){return(J)=>{if(!J||typeof J!=="object")return!1;switch(J.constructor){case Array:return tu($,J);case Map:return oO($,J,J.keys());case lu.MapRow:case pu.StructRow:case Object:case void 0:return oO($,J,Q||Object.keys(J))}return J instanceof rO.Vector?eu($,J):!1}}function tu($,Q){let J=$.length;if(Q.length!==J)return!1;for(let Z=-1;++Z<J;)if(!$[Z](Q[Z]))return!1;return!0}function eu($,Q){let J=$.length;if(Q.length!==J)return!1;for(let Z=-1;++Z<J;)if(!$[Z](Q.get(Z)))return!1;return!0}function oO($,Q,J){let Z=J[Symbol.iterator](),K=Q instanceof Map?Q.keys():Object.keys(Q)[Symbol.iterator](),X=Q instanceof Map?Q.values():Object.values(Q)[Symbol.iterator](),Y=0,W=$.length,q=X.next(),H=Z.next(),F=K.next();for(;Y<W&&!H.done&&!F.done&&!q.done;++Y,H=Z.next(),F=K.next(),q=X.next())if(H.value!==F.value||!$[Y](q.value))break;if(Y===W&&H.done&&F.done&&q.done)return!0;return Z.return&&Z.return(),K.return&&K.return(),X.return&&X.return(),!1}});var p7=g((ZP)=>{Object.defineProperty(ZP,"__esModule",{value:!0});ZP.popcnt_uint32=ZP.popcnt_array=ZP.popcnt_bit_range=ZP.BitIterator=ZP.packBools=ZP.truncateBitmap=ZP.setBool=ZP.getBit=ZP.getBool=void 0;function eO($,Q,J,Z){return(J&1<<Z)!==0}ZP.getBool=eO;function $P($,Q,J,Z){return(J&1<<Z)>>Z}ZP.getBit=$P;function Ji($,Q,J){return J?!!($[Q>>3]|=1<<Q%8)||!0:!($[Q>>3]&=~(1<<Q%8))&&!1}ZP.setBool=Ji;function Zi($,Q,J){let Z=J.byteLength+7&-8;if($>0||J.byteLength<Z){let K=new Uint8Array(Z);return K.set($%8===0?J.subarray($>>3):QP(new rQ(J,$,Q,null,eO)).subarray(0,Z)),K}return J}ZP.truncateBitmap=Zi;function QP($){let Q=[],J=0,Z=0,K=0;for(let Y of $)if(Y&&(K|=1<<Z),++Z===8)Q[J++]=K,K=Z=0;if(J===0||Z>0)Q[J++]=K;let X=new Uint8Array(Q.length+7&-8);return X.set(Q),X}ZP.packBools=QP;class rQ{constructor($,Q,J,Z,K){this.bytes=$,this.length=J,this.context=Z,this.get=K,this.bit=Q%8,this.byteIndex=Q>>3,this.byte=$[this.byteIndex++],this.index=0}next(){if(this.index<this.length){if(this.bit===8)this.bit=0,this.byte=this.bytes[this.byteIndex++];return{value:this.get(this.context,this.index++,this.byte,this.bit++)}}return{done:!0,value:null}}[Symbol.iterator](){return this}}ZP.BitIterator=rQ;function BW($,Q,J){if(J-Q<=0)return 0;if(J-Q<8){let X=0;for(let Y of new rQ($,Q,J-Q,$,$P))X+=Y;return X}let Z=J>>3<<3,K=Q+(Q%8===0?0:8-Q%8);return BW($,Q,K)+BW($,Z,J)+JP($,K>>3,Z-K>>3)}ZP.popcnt_bit_range=BW;function JP($,Q,J){let Z=0,K=Math.trunc(Q),X=new DataView($.buffer,$.byteOffset,$.byteLength),Y=J===void 0?$.byteLength:K+J;while(Y-K>=4)Z+=oQ(X.getUint32(K)),K+=4;while(Y-K>=2)Z+=oQ(X.getUint16(K)),K+=2;while(Y-K>=1)Z+=oQ(X.getUint8(K)),K+=1;return Z}ZP.popcnt_array=JP;function oQ($){let Q=Math.trunc($);return Q=Q-(Q>>>1&1431655765),Q=(Q&858993459)+(Q>>>2&858993459),(Q+(Q>>>4)&252645135)*16843009>>>24}ZP.popcnt_uint32=oQ});var A6=g((XP)=>{Object.defineProperty(XP,"__esModule",{value:!0});XP.makeData=XP.Data=XP.kUnknownNullCount=void 0;var Vi=m0(),C6=a1(),a0=p1(),RW=p7();XP.kUnknownNullCount=-1;class b1{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){let{type:$}=this;if(a0.DataType.isSparseUnion($))return this.children.some((Q)=>Q.nullable);else if(a0.DataType.isDenseUnion($))return this.children.some((Q)=>Q.nullable);return this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let $=0,{valueOffsets:Q,values:J,nullBitmap:Z,typeIds:K}=this;return Q&&($+=Q.byteLength),J&&($+=J.byteLength),Z&&($+=Z.byteLength),K&&($+=K.byteLength),this.children.reduce((X,Y)=>X+Y.byteLength,$)}get nullCount(){if(a0.DataType.isUnion(this.type))return this.children.reduce((J,Z)=>J+Z.nullCount,0);let $=this._nullCount,Q;if($<=XP.kUnknownNullCount&&(Q=this.nullBitmap))this._nullCount=$=Q.length===0?0:this.length-(0,RW.popcnt_bit_range)(Q,this.offset,this.offset+this.length);return $}constructor($,Q,J,Z,K,X=[],Y){this.type=$,this.children=X,this.dictionary=Y,this.offset=Math.floor(Math.max(Q||0,0)),this.length=Math.floor(Math.max(J||0,0)),this._nullCount=Math.floor(Math.max(Z||0,-1));let W;if(K instanceof b1)this.stride=K.stride,this.values=K.values,this.typeIds=K.typeIds,this.nullBitmap=K.nullBitmap,this.valueOffsets=K.valueOffsets;else if(this.stride=(0,a0.strideForType)($),K)(W=K[0])&&(this.valueOffsets=W),(W=K[1])&&(this.values=W),(W=K[2])&&(this.nullBitmap=W),(W=K[3])&&(this.typeIds=W)}getValid($){let{type:Q}=this;if(a0.DataType.isUnion(Q)){let J=Q,Z=this.children[J.typeIdToChildIndex[this.typeIds[$]]],K=J.mode===C6.UnionMode.Dense?this.valueOffsets[$]:$;return Z.getValid(K)}if(this.nullable&&this.nullCount>0){let J=this.offset+$;return(this.nullBitmap[J>>3]&1<<J%8)!==0}return!0}setValid($,Q){let J,{type:Z}=this;if(a0.DataType.isUnion(Z)){let K=Z,X=this.children[K.typeIdToChildIndex[this.typeIds[$]]],Y=K.mode===C6.UnionMode.Dense?this.valueOffsets[$]:$;J=X.getValid(Y),X.setValid(Y,Q)}else{let{nullBitmap:K}=this,{offset:X,length:Y}=this,W=X+$,q=1<<W%8,H=W>>3;if(!K||K.byteLength<=H)if(K=new Uint8Array((X+Y+63&-64)>>3).fill(255),this.nullCount>0)K.set((0,RW.truncateBitmap)(X,Y,this.nullBitmap),0),Object.assign(this,{nullBitmap:K});else Object.assign(this,{nullBitmap:K,_nullCount:0});let F=K[H];J=(F&q)!==0,K[H]=Q?F|q:F&~q}if(J!==!!Q)this._nullCount=this.nullCount+(Q?-1:1);return Q}clone($=this.type,Q=this.offset,J=this.length,Z=this._nullCount,K=this,X=this.children){return new b1($,Q,J,Z,K,X,this.dictionary)}slice($,Q){let{stride:J,typeId:Z,children:K}=this,X=+(this._nullCount===0)-1,Y=Z===16?J:1,W=this._sliceBuffers($,Q,J,Z);return this.clone(this.type,this.offset+$,Q,X,W,K.length===0||this.valueOffsets?K:this._sliceChildren(K,Y*$,Y*Q))}_changeLengthAndBackfillNullBitmap($){if(this.typeId===C6.Type.Null)return this.clone(this.type,0,$,0);let{length:Q,nullCount:J}=this,Z=new Uint8Array(($+63&-64)>>3).fill(255,0,Q>>3);if(Z[Q>>3]=(1<<Q-(Q&-8))-1,J>0)Z.set((0,RW.truncateBitmap)(this.offset,Q,this.nullBitmap),0);let K=this.buffers;return K[C6.BufferType.VALIDITY]=Z,this.clone(this.type,0,$,J+($-Q),K)}_sliceBuffers($,Q,J,Z){let K,{buffers:X}=this;return(K=X[C6.BufferType.TYPE])&&(X[C6.BufferType.TYPE]=K.subarray($,$+Q)),(K=X[C6.BufferType.OFFSET])&&(X[C6.BufferType.OFFSET]=K.subarray($,$+Q+1))||(K=X[C6.BufferType.DATA])&&(X[C6.BufferType.DATA]=Z===6?K:K.subarray(J*$,J*($+Q))),X}_sliceChildren($,Q,J){return $.map((Z)=>Z.slice(Q,J))}}XP.Data=b1;b1.prototype.children=Object.freeze([]);var Ni=r0(),A1=z0();class G3 extends Ni.Visitor{visit($){return this.getVisitFn($.type).call(this,$)}visitNull($){let{["type"]:Q,["offset"]:J=0,["length"]:Z=0}=$;return new b1(Q,J,Z,Z)}visitBool($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length>>3,["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitInt($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length,["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitFloat($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length,["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitUtf8($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.data),K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toInt32Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,Z,K])}visitLargeUtf8($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.data),K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toBigInt64Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,Z,K])}visitBinary($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.data),K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toInt32Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,Z,K])}visitLargeBinary($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.data),K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toBigInt64Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,Z,K])}visitFixedSizeBinary($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitDate($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitTimestamp($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitTime($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitDecimal($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitList($){let{["type"]:Q,["offset"]:J=0,["child"]:Z}=$,K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toInt32Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,void 0,K],[Z])}visitStruct($){let{["type"]:Q,["offset"]:J=0,["children"]:Z=[]}=$,K=(0,A1.toUint8Array)($.nullBitmap),{length:X=Z.reduce((W,{length:q})=>Math.max(W,q),0),nullCount:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,void 0,K],Z)}visitUnion($){let{["type"]:Q,["offset"]:J=0,["children"]:Z=[]}=$,K=(0,A1.toArrayBufferView)(Q.ArrayType,$.typeIds),{["length"]:X=K.length,["nullCount"]:Y=-1}=$;if(a0.DataType.isSparseUnion(Q))return new b1(Q,J,X,Y,[void 0,void 0,void 0,K],Z);let W=(0,A1.toInt32Array)($.valueOffsets);return new b1(Q,J,X,Y,[W,void 0,void 0,K],Z)}visitDictionary($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.indices.ArrayType,$.data),{["dictionary"]:X=new Vi.Vector([new G3().visit({type:Q.dictionary})])}=$,{["length"]:Y=K.length,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[void 0,K,Z],[],X)}visitInterval($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitDuration($){let{["type"]:Q,["offset"]:J=0}=$,Z=(0,A1.toUint8Array)($.nullBitmap),K=(0,A1.toArrayBufferView)(Q.ArrayType,$.data),{["length"]:X=K.length,["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,K,Z])}visitFixedSizeList($){let{["type"]:Q,["offset"]:J=0,["child"]:Z=new G3().visit({type:Q.valueType})}=$,K=(0,A1.toUint8Array)($.nullBitmap),{["length"]:X=Z.length/(0,a0.strideForType)(Q),["nullCount"]:Y=$.nullBitmap?-1:0}=$;return new b1(Q,J,X,Y,[void 0,void 0,K],[Z])}visitMap($){let{["type"]:Q,["offset"]:J=0,["child"]:Z=new G3().visit({type:Q.childType})}=$,K=(0,A1.toUint8Array)($.nullBitmap),X=(0,A1.toInt32Array)($.valueOffsets),{["length"]:Y=X.length-1,["nullCount"]:W=$.nullBitmap?-1:0}=$;return new b1(Q,J,Y,W,[X,void 0,K],[Z])}}var Di=new G3;function Ci($){return Di.visit($)}XP.makeData=Ci});var tQ=g((HP)=>{Object.defineProperty(HP,"__esModule",{value:!0});HP.wrapChunkedIndexOf=HP.wrapChunkedCall2=HP.wrapChunkedCall1=HP.isChunkedValid=HP.binarySearch=HP.sliceChunks=HP.computeChunkOffsets=HP.computeChunkNullCounts=HP.computeChunkNullable=HP.ChunkedIterator=void 0;class qP{constructor($=0,Q){this.numChunks=$,this.getChunkIterator=Q,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){while(this.chunkIndex<this.numChunks){let $=this.chunkIterator.next();if(!$.done)return $;if(++this.chunkIndex<this.numChunks)this.chunkIterator=this.getChunkIterator(this.chunkIndex)}return{done:!0,value:null}}[Symbol.iterator](){return this}}HP.ChunkedIterator=qP;function zi($){return $.some((Q)=>Q.nullable)}HP.computeChunkNullable=zi;function ki($){return $.reduce((Q,J)=>Q+J.nullCount,0)}HP.computeChunkNullCounts=ki;function Bi($){return $.reduce((Q,J,Z)=>{return Q[Z+1]=Q[Z]+J.length,Q},new Uint32Array($.length+1))}HP.computeChunkOffsets=Bi;function Ri($,Q,J,Z){let K=[];for(let X=-1,Y=$.length;++X<Y;){let W=$[X],q=Q[X],{length:H}=W;if(q>=Z)break;if(J>=q+H)continue;if(q>=J&&q+H<=Z){K.push(W);continue}let F=Math.max(0,J-q),U=Math.min(Z-q,H);K.push(W.slice(F,U-F))}if(K.length===0)K.push($[0].slice(0,0));return K}HP.sliceChunks=Ri;function aQ($,Q,J,Z){let K=0,X=0,Y=Q.length-1;do{if(K>=Y-1)return J<Q[Y]?Z($,K,J-Q[K]):null;X=K+Math.trunc((Y-K)*0.5),J<Q[X]?Y=X:K=X}while(K<Y)}HP.binarySearch=aQ;function Oi($,Q){return $.getValid(Q)}HP.isChunkedValid=Oi;function Pi($){function Q(J,Z,K){return $(J[Z],K)}return function(J){let Z=this.data;return aQ(Z,this._offsets,J,Q)}}HP.wrapChunkedCall1=Pi;function Mi($){let Q;function J(Z,K,X){return $(Z[K],X,Q)}return function(Z,K){let X=this.data;Q=K;let Y=aQ(X,this._offsets,Z,J);return Q=void 0,Y}}HP.wrapChunkedCall2=Mi;function wi($){let Q;function J(Z,K,X){let Y=X,W=0,q=0;for(let H=K-1,F=Z.length;++H<F;){let U=Z[H];if(~(W=$(U,Q,Y)))return q+W;Y=0,q+=U.length}return-1}return function(Z,K){Q=Z;let X=this.data,Y=typeof K!=="number"?J(X,0,0):aQ(X,this._offsets,K,J);return Q=void 0,Y}}HP.wrapChunkedIndexOf=wi});var eQ=g((AP)=>{Object.defineProperty(AP,"__esModule",{value:!0});AP.instance=AP.IndexOfVisitor=void 0;var UP=a1(),_i=r0(),NP=b7(),VP=p7(),DP=q9();class $1 extends _i.Visitor{}AP.IndexOfVisitor=$1;function xi($,Q){return Q===null&&$.length>0?0:-1}function gi($,Q){let{nullBitmap:J}=$;if(!J||$.nullCount<=0)return-1;let Z=0;for(let K of new VP.BitIterator(J,$.offset+(Q||0),$.length,J,VP.getBool)){if(!K)return Z;++Z}return-1}function V1($,Q,J){if(Q===void 0)return-1;if(Q===null)switch($.typeId){case UP.Type.Union:break;case UP.Type.Dictionary:break;default:return gi($,J)}let Z=NP.instance.getVisitFn($),K=(0,DP.createElementComparator)(Q);for(let X=(J||0)-1,Y=$.length;++X<Y;)if(K(Z($,X)))return X;return-1}function CP($,Q,J){let Z=NP.instance.getVisitFn($),K=(0,DP.createElementComparator)(Q);for(let X=(J||0)-1,Y=$.length;++X<Y;)if(K(Z($,X)))return X;return-1}$1.prototype.visitNull=xi;$1.prototype.visitBool=V1;$1.prototype.visitInt=V1;$1.prototype.visitInt8=V1;$1.prototype.visitInt16=V1;$1.prototype.visitInt32=V1;$1.prototype.visitInt64=V1;$1.prototype.visitUint8=V1;$1.prototype.visitUint16=V1;$1.prototype.visitUint32=V1;$1.prototype.visitUint64=V1;$1.prototype.visitFloat=V1;$1.prototype.visitFloat16=V1;$1.prototype.visitFloat32=V1;$1.prototype.visitFloat64=V1;$1.prototype.visitUtf8=V1;$1.prototype.visitLargeUtf8=V1;$1.prototype.visitBinary=V1;$1.prototype.visitLargeBinary=V1;$1.prototype.visitFixedSizeBinary=V1;$1.prototype.visitDate=V1;$1.prototype.visitDateDay=V1;$1.prototype.visitDateMillisecond=V1;$1.prototype.visitTimestamp=V1;$1.prototype.visitTimestampSecond=V1;$1.prototype.visitTimestampMillisecond=V1;$1.prototype.visitTimestampMicrosecond=V1;$1.prototype.visitTimestampNanosecond=V1;$1.prototype.visitTime=V1;$1.prototype.visitTimeSecond=V1;$1.prototype.visitTimeMillisecond=V1;$1.prototype.visitTimeMicrosecond=V1;$1.prototype.visitTimeNanosecond=V1;$1.prototype.visitDecimal=V1;$1.prototype.visitList=V1;$1.prototype.visitStruct=V1;$1.prototype.visitUnion=V1;$1.prototype.visitDenseUnion=CP;$1.prototype.visitSparseUnion=CP;$1.prototype.visitDictionary=V1;$1.prototype.visitInterval=V1;$1.prototype.visitIntervalDayTime=V1;$1.prototype.visitIntervalYearMonth=V1;$1.prototype.visitDuration=V1;$1.prototype.visitDurationSecond=V1;$1.prototype.visitDurationMillisecond=V1;$1.prototype.visitDurationMicrosecond=V1;$1.prototype.visitDurationNanosecond=V1;$1.prototype.visitFixedSizeList=V1;$1.prototype.visitMap=V1;AP.instance=new $1});var $J=g((RP)=>{Object.defineProperty(RP,"__esModule",{value:!0});RP.instance=RP.IteratorVisitor=void 0;var fi=r0(),bi=a1(),OW=p1(),kP=tQ();class Q1 extends fi.Visitor{}RP.IteratorVisitor=Q1;function q1($){let{type:Q}=$;if($.nullCount===0&&$.stride===1&&(OW.DataType.isInt(Q)&&Q.bitWidth!==64||OW.DataType.isTime(Q)&&Q.bitWidth!==64||OW.DataType.isFloat(Q)&&Q.precision!==bi.Precision.HALF))return new kP.ChunkedIterator($.data.length,(Z)=>{let K=$.data[Z];return K.values.subarray(0,K.length)[Symbol.iterator]()});let J=0;return new kP.ChunkedIterator($.data.length,(Z)=>{let X=$.data[Z].length,Y=$.slice(J,J+X);return J+=X,new BP(Y)})}class BP{constructor($){this.vector=$,this.index=0}next(){if(this.index<this.vector.length)return{value:this.vector.get(this.index++)};return{done:!0,value:null}}[Symbol.iterator](){return this}}Q1.prototype.visitNull=q1;Q1.prototype.visitBool=q1;Q1.prototype.visitInt=q1;Q1.prototype.visitInt8=q1;Q1.prototype.visitInt16=q1;Q1.prototype.visitInt32=q1;Q1.prototype.visitInt64=q1;Q1.prototype.visitUint8=q1;Q1.prototype.visitUint16=q1;Q1.prototype.visitUint32=q1;Q1.prototype.visitUint64=q1;Q1.prototype.visitFloat=q1;Q1.prototype.visitFloat16=q1;Q1.prototype.visitFloat32=q1;Q1.prototype.visitFloat64=q1;Q1.prototype.visitUtf8=q1;Q1.prototype.visitLargeUtf8=q1;Q1.prototype.visitBinary=q1;Q1.prototype.visitLargeBinary=q1;Q1.prototype.visitFixedSizeBinary=q1;Q1.prototype.visitDate=q1;Q1.prototype.visitDateDay=q1;Q1.prototype.visitDateMillisecond=q1;Q1.prototype.visitTimestamp=q1;Q1.prototype.visitTimestampSecond=q1;Q1.prototype.visitTimestampMillisecond=q1;Q1.prototype.visitTimestampMicrosecond=q1;Q1.prototype.visitTimestampNanosecond=q1;Q1.prototype.visitTime=q1;Q1.prototype.visitTimeSecond=q1;Q1.prototype.visitTimeMillisecond=q1;Q1.prototype.visitTimeMicrosecond=q1;Q1.prototype.visitTimeNanosecond=q1;Q1.prototype.visitDecimal=q1;Q1.prototype.visitList=q1;Q1.prototype.visitStruct=q1;Q1.prototype.visitUnion=q1;Q1.prototype.visitDenseUnion=q1;Q1.prototype.visitSparseUnion=q1;Q1.prototype.visitDictionary=q1;Q1.prototype.visitInterval=q1;Q1.prototype.visitIntervalDayTime=q1;Q1.prototype.visitIntervalYearMonth=q1;Q1.prototype.visitDuration=q1;Q1.prototype.visitDurationSecond=q1;Q1.prototype.visitDurationMillisecond=q1;Q1.prototype.visitDurationMicrosecond=q1;Q1.prototype.visitDurationNanosecond=q1;Q1.prototype.visitFixedSizeList=q1;Q1.prototype.visitMap=q1;RP.instance=new Q1});var m0=g((jP)=>{var TP;Object.defineProperty(jP,"__esModule",{value:!0});jP.makeVector=jP.Vector=void 0;var r6=a1(),PP=q9(),H9=p1(),t0=A6(),k6=tQ(),MP=b7(),wP=Y5(),SP=eQ(),ci=$J(),IP={},GP={};class g1{constructor($){var Q,J,Z;let K=$[0]instanceof g1?$.flatMap((Y)=>Y.data):$;if(K.length===0||K.some((Y)=>!(Y instanceof t0.Data)))throw TypeError("Vector constructor expects an Array of Data instances.");let X=(Q=K[0])===null||Q===void 0?void 0:Q.type;switch(K.length){case 0:this._offsets=[0];break;case 1:{let{get:Y,set:W,indexOf:q}=IP[X.typeId],H=K[0];this.isValid=(F)=>(0,k6.isChunkedValid)(H,F),this.get=(F)=>Y(H,F),this.set=(F,U)=>W(H,F,U),this.indexOf=(F)=>q(H,F),this._offsets=[0,H.length];break}default:Object.setPrototypeOf(this,GP[X.typeId]),this._offsets=(0,k6.computeChunkOffsets)(K);break}this.data=K,this.type=X,this.stride=(0,H9.strideForType)(X),this.numChildren=(Z=(J=X.children)===null||J===void 0?void 0:J.length)!==null&&Z!==void 0?Z:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce(($,Q)=>$+Q.byteLength,0)}get nullable(){return(0,k6.computeChunkNullable)(this.data)}get nullCount(){return(0,k6.computeChunkNullCounts)(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${r6.Type[this.type.typeId]}Vector`}isValid($){return!1}get($){return null}at($){return this.get((0,PP.wrapIndex)($,this.length))}set($,Q){return}indexOf($,Q){return-1}includes($,Q){return this.indexOf($,Q)>-1}[Symbol.iterator](){return ci.instance.visit(this)}concat(...$){return new g1(this.data.concat($.flatMap((Q)=>Q.data).flat(Number.POSITIVE_INFINITY)))}slice($,Q){return new g1((0,PP.clampRange)(this,$,Q,({data:J,_offsets:Z},K,X)=>(0,k6.sliceChunks)(J,Z,K,X)))}toJSON(){return[...this]}toArray(){let{type:$,data:Q,length:J,stride:Z,ArrayType:K}=this;switch($.typeId){case r6.Type.Int:case r6.Type.Float:case r6.Type.Decimal:case r6.Type.Time:case r6.Type.Timestamp:switch(Q.length){case 0:return new K;case 1:return Q[0].values.subarray(0,J*Z);default:return Q.reduce((X,{values:Y,length:W})=>{return X.array.set(Y.subarray(0,W*Z),X.offset),X.offset+=W*Z,X},{array:new K(J*Z),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild($){var Q;return this.getChildAt((Q=this.type.children)===null||Q===void 0?void 0:Q.findIndex((J)=>J.name===$))}getChildAt($){if($>-1&&$<this.numChildren)return new g1(this.data.map(({children:Q})=>Q[$]));return null}get isMemoized(){if(H9.DataType.isDictionary(this.type))return this.data[0].dictionary.isMemoized;return!1}memoize(){if(H9.DataType.isDictionary(this.type)){let $=new QJ(this.data[0].dictionary),Q=this.data.map((J)=>{let Z=J.clone();return Z.dictionary=$,Z});return new g1(Q)}return new QJ(this)}unmemoize(){if(H9.DataType.isDictionary(this.type)&&this.isMemoized){let $=this.data[0].dictionary.unmemoize(),Q=this.data.map((J)=>{let Z=J.clone();return Z.dictionary=$,Z});return new g1(Q)}return this}}jP.Vector=g1;TP=Symbol.toStringTag;g1[TP]=(($)=>{$.type=H9.DataType.prototype,$.data=[],$.length=0,$.stride=1,$.numChildren=0,$._offsets=new Uint32Array([0]),$[Symbol.isConcatSpreadable]=!0;let Q=Object.keys(r6.Type).map((J)=>r6.Type[J]).filter((J)=>typeof J==="number"&&J!==r6.Type.NONE);for(let J of Q){let Z=MP.instance.getVisitFnByTypeId(J),K=wP.instance.getVisitFnByTypeId(J),X=SP.instance.getVisitFnByTypeId(J);IP[J]={get:Z,set:K,indexOf:X},GP[J]=Object.create($,{["isValid"]:{value:(0,k6.wrapChunkedCall1)(k6.isChunkedValid)},["get"]:{value:(0,k6.wrapChunkedCall1)(MP.instance.getVisitFnByTypeId(J))},["set"]:{value:(0,k6.wrapChunkedCall2)(wP.instance.getVisitFnByTypeId(J))},["indexOf"]:{value:(0,k6.wrapChunkedIndexOf)(SP.instance.getVisitFnByTypeId(J))}})}return"Vector"})(g1.prototype);class QJ extends g1{constructor($){super($.data);let Q=this.get,J=this.set,Z=this.slice,K=Array(this.length);Object.defineProperty(this,"get",{value(X){let Y=K[X];if(Y!==void 0)return Y;let W=Q.call(this,X);return K[X]=W,W}}),Object.defineProperty(this,"set",{value(X,Y){J.call(this,X,Y),K[X]=Y}}),Object.defineProperty(this,"slice",{value:(X,Y)=>new QJ(Z.call(this,X,Y))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new g1(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}var z6=p1();function EP($){if($){if($ instanceof t0.Data)return new g1([$]);if($ instanceof g1)return new g1($.data);if($.type instanceof H9.DataType)return new g1([(0,t0.makeData)($)]);if(Array.isArray($))return new g1($.flatMap((Q)=>di(Q)));if(ArrayBuffer.isView($)){if($ instanceof DataView)$=new Uint8Array($.buffer);let Q={offset:0,length:$.length,nullCount:-1,data:$};if($ instanceof Int8Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Int8}))]);if($ instanceof Int16Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Int16}))]);if($ instanceof Int32Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Int32}))]);if($ instanceof BigInt64Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Int64}))]);if($ instanceof Uint8Array||$ instanceof Uint8ClampedArray)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Uint8}))]);if($ instanceof Uint16Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Uint16}))]);if($ instanceof Uint32Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Uint32}))]);if($ instanceof BigUint64Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Uint64}))]);if($ instanceof Float32Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Float32}))]);if($ instanceof Float64Array)return new g1([(0,t0.makeData)(Object.assign(Object.assign({},Q),{type:new z6.Float64}))]);throw Error("Unrecognized input")}}throw Error("Unrecognized input")}jP.makeVector=EP;function di($){return $ instanceof t0.Data?[$]:$ instanceof g1?$.data:EP($).data}});var xP=g((vP)=>{Object.defineProperty(vP,"__esModule",{value:!0});vP.createIsValidFunction=void 0;var LP=M3();function pi($){if(!$||$.length<=0)return function(K){return!0};let Q="",J=$.filter((Z)=>Z===Z);if(J.length>0)Q=`
    switch (x) {${J.map((Z)=>`
        case ${ui(Z)}:`).join("")}
            return false;
    }`;if($.length!==J.length)Q=`if (x !== x) return false;
${Q}`;return Function("x",`${Q}
return true;`)}vP.createIsValidFunction=pi;function ui($){if(typeof $!=="bigint")return(0,LP.valueToString)($);return`${(0,LP.valueToString)($)}n`}});var a6=g((bP)=>{Object.defineProperty(bP,"__esModule",{value:!0});bP.OffsetsBufferBuilder=bP.BitmapBufferBuilder=bP.DataBufferBuilder=bP.BufferBuilder=void 0;var ii=z0();function PW($,Q){let J=Math.ceil($)*Q-1;return(J-J%64+64||64)/Q}function gP($,Q=0){return $.length>=Q?$.subarray(0,Q):(0,ii.memcpy)(new $.constructor(Q),$,0)}class MW{constructor($,Q=0,J=1){this.length=Math.ceil(Q/J),this.buffer=new $(this.length),this.stride=J,this.BYTES_PER_ELEMENT=$.BYTES_PER_ELEMENT,this.ArrayType=$}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set($,Q){return this}append($){return this.set(this.length,$)}reserve($){if($>0){this.length+=$;let Q=this.stride,J=this.length*Q,Z=this.buffer.length;if(J>=Z)this._resize(Z===0?PW(J*1,this.BYTES_PER_ELEMENT):PW(J*2,this.BYTES_PER_ELEMENT))}return this}flush($=this.length){$=PW($*this.stride,this.BYTES_PER_ELEMENT);let Q=gP(this.buffer,$);return this.clear(),Q}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize($){return this.buffer=gP(this.buffer,$)}}bP.BufferBuilder=MW;class JJ extends MW{last(){return this.get(this.length-1)}get($){return this.buffer[$]}set($,Q){return this.reserve($-this.length+1),this.buffer[$*this.stride]=Q,this}}bP.DataBufferBuilder=JJ;class yP extends JJ{constructor(){super(Uint8Array,0,0.125);this.numValid=0}get numInvalid(){return this.length-this.numValid}get($){return this.buffer[$>>3]>>$%8&1}set($,Q){let{buffer:J}=this.reserve($-this.length+1),Z=$>>3,K=$%8,X=J[Z]>>K&1;return Q?X===0&&(J[Z]|=1<<K,++this.numValid):X===1&&(J[Z]&=~(1<<K),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}bP.BitmapBufferBuilder=yP;class fP extends JJ{constructor($){super($.OffsetArrayType,1,1)}append($){return this.set(this.length-1,$)}set($,Q){let J=this.length-1,Z=this.reserve($-J+1).buffer;if(J<$++&&J>=0)Z.fill(Z[J],J,$);return Z[$]=Z[$-1]+Q,this}flush($=this.length-1){if($>this.length)this.set($-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0);return super.flush($+1)}}bP.OffsetsBufferBuilder=fP});var o1=g((pP)=>{Object.defineProperty(pP,"__esModule",{value:!0});pP.VariableWidthBuilder=pP.FixedWidthBuilder=pP.Builder=void 0;var ri=m0(),ai=A6(),cP=T3(),ti=p1(),ei=xP(),wW=a6();class B6{static throughNode($){throw Error('"throughNode" not available in this environment')}static throughDOM($){throw Error('"throughDOM" not available in this environment')}constructor({type:$,nullValues:Q}){if(this.length=0,this.finished=!1,this.type=$,this.children=[],this.nullValues=Q,this.stride=(0,ti.strideForType)($),this._nulls=new wW.BitmapBufferBuilder,Q&&Q.length>0)this._isValid=(0,ei.createIsValidFunction)(Q)}toVector(){return new ri.Vector([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let $=0,{_offsets:Q,_values:J,_nulls:Z,_typeIds:K,children:X}=this;return Q&&($+=Q.byteLength),J&&($+=J.byteLength),Z&&($+=Z.byteLength),K&&($+=K.byteLength),X.reduce((Y,W)=>Y+W.byteLength,$)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let $=0;return this._offsets&&($+=this._offsets.reservedByteLength),this._values&&($+=this._values.reservedByteLength),this._nulls&&($+=this._nulls.reservedByteLength),this._typeIds&&($+=this._typeIds.reservedByteLength),this.children.reduce((Q,J)=>Q+J.reservedByteLength,$)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append($){return this.set(this.length,$)}isValid($){return this._isValid($)}set($,Q){if(this.setValid($,this.isValid(Q)))this.setValue($,Q);return this}setValue($,Q){this._setValue(this,$,Q)}setValid($,Q){return this.length=this._nulls.set($,+Q).length,Q}addChild($,Q=`${this.numChildren}`){throw Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt($){return this.children[$]||null}flush(){let $,Q,J,Z,{type:K,length:X,nullCount:Y,_typeIds:W,_offsets:q,_values:H,_nulls:F}=this;if(Q=W===null||W===void 0?void 0:W.flush(X))Z=q===null||q===void 0?void 0:q.flush(X);else if(Z=q===null||q===void 0?void 0:q.flush(X))$=H===null||H===void 0?void 0:H.flush(q.last());else $=H===null||H===void 0?void 0:H.flush(X);if(Y>0)J=F===null||F===void 0?void 0:F.flush(X);let U=this.children.map((V)=>V.flush());return this.clear(),(0,ai.makeData)({type:K,length:X,nullCount:Y,children:U,child:U[0],data:$,typeIds:Q,nullBitmap:J,valueOffsets:Z})}finish(){this.finished=!0;for(let $ of this.children)$.finish();return this}clear(){var $,Q,J,Z;this.length=0,($=this._nulls)===null||$===void 0||$.clear(),(Q=this._values)===null||Q===void 0||Q.clear(),(J=this._offsets)===null||J===void 0||J.clear(),(Z=this._typeIds)===null||Z===void 0||Z.clear();for(let K of this.children)K.clear();return this}}pP.Builder=B6;B6.prototype.length=1;B6.prototype.stride=1;B6.prototype.children=null;B6.prototype.finished=!1;B6.prototype.nullValues=null;B6.prototype._isValid=()=>!0;class dP extends B6{constructor($){super($);this._values=new wW.DataBufferBuilder(this.ArrayType,0,this.stride)}setValue($,Q){let J=this._values;return J.reserve($-J.length+1),super.setValue($,Q)}}pP.FixedWidthBuilder=dP;class lP extends B6{constructor($){super($);this._pendingLength=0,this._offsets=new wW.OffsetsBufferBuilder($.type)}setValue($,Q){let J=this._pending||(this._pending=new Map),Z=J.get($);Z&&(this._pendingLength-=Z.length),this._pendingLength+=Q instanceof cP.MapRow?Q[cP.kKeys].length:Q.length,J.set($,Q)}setValid($,Q){if(!super.setValid($,Q))return(this._pending||(this._pending=new Map)).set($,void 0),!1;return!0}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let $=this._pending,Q=this._pendingLength;if(this._pendingLength=0,this._pending=void 0,$&&$.size>0)this._flushPending($,Q);return this}}pP.VariableWidthBuilder=lP});var SW=g((nP)=>{Object.defineProperty(nP,"__esModule",{value:!0});nP.Block=void 0;class iP{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock($,Q,J,Z){return $.prep(8,24),$.writeInt64(BigInt(Z!==null&&Z!==void 0?Z:0)),$.pad(4),$.writeInt32(J),$.writeInt64(BigInt(Q!==null&&Q!==void 0?Q:0)),$.offset()}}nP.Block=iP});var eP=g((aP)=>{Object.defineProperty(aP,"__esModule",{value:!0});aP.Footer=void 0;var Jn=k1(),oP=SW(),Zn=c8(),rP=QQ(),Kn=BQ();class ZJ{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsFooter($,Q){return(Q||new ZJ).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsFooter($,Q){return $.setPosition($.position()+Jn.SIZE_PREFIX_LENGTH),(Q||new ZJ).__init($.readInt32($.position())+$.position(),$)}version(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):rP.MetadataVersion.V1}schema($){let Q=this.bb.__offset(this.bb_pos,6);return Q?($||new Kn.Schema).__init(this.bb.__indirect(this.bb_pos+Q),this.bb):null}dictionaries($,Q){let J=this.bb.__offset(this.bb_pos,8);return J?(Q||new oP.Block).__init(this.bb.__vector(this.bb_pos+J)+$*24,this.bb):null}dictionariesLength(){let $=this.bb.__offset(this.bb_pos,8);return $?this.bb.__vector_len(this.bb_pos+$):0}recordBatches($,Q){let J=this.bb.__offset(this.bb_pos,10);return J?(Q||new oP.Block).__init(this.bb.__vector(this.bb_pos+J)+$*24,this.bb):null}recordBatchesLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.__vector_len(this.bb_pos+$):0}customMetadata($,Q){let J=this.bb.__offset(this.bb_pos,12);return J?(Q||new Zn.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}customMetadataLength(){let $=this.bb.__offset(this.bb_pos,12);return $?this.bb.__vector_len(this.bb_pos+$):0}static startFooter($){$.startObject(5)}static addVersion($,Q){$.addFieldInt16(0,Q,rP.MetadataVersion.V1)}static addSchema($,Q){$.addFieldOffset(1,Q,0)}static addDictionaries($,Q){$.addFieldOffset(2,Q,0)}static startDictionariesVector($,Q){$.startVector(24,Q,8)}static addRecordBatches($,Q){$.addFieldOffset(3,Q,0)}static startRecordBatchesVector($,Q){$.startVector(24,Q,8)}static addCustomMetadata($,Q){$.addFieldOffset(4,Q,0)}static createCustomMetadataVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startCustomMetadataVector($,Q){$.startVector(4,Q,4)}static endFooter($){return $.endObject()}static finishFooterBuffer($,Q){$.finish(Q)}static finishSizePrefixedFooterBuffer($,Q){$.finish(Q,void 0,!0)}}aP.Footer=ZJ});var e0=g(($M)=>{Object.defineProperty($M,"__esModule",{value:!0});$M.Field=$M.Schema=void 0;var Xn=a1(),Yn=p1();class i5{constructor($=[],Q,J,Z=Xn.MetadataVersion.V5){if(this.fields=$||[],this.metadata=Q||new Map,!J)J=TW(this.fields);this.dictionaries=J,this.metadataVersion=Z}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(($)=>$.name)}toString(){return`Schema<{ ${this.fields.map(($,Q)=>`${Q}: ${$}`).join(", ")} }>`}select($){let Q=new Set($),J=this.fields.filter((Z)=>Q.has(Z.name));return new i5(J,this.metadata)}selectAt($){let Q=$.map((J)=>this.fields[J]).filter(Boolean);return new i5(Q,this.metadata)}assign(...$){let Q=$[0]instanceof i5?$[0]:Array.isArray($[0])?new i5($[0]):new i5($),J=[...this.fields],Z=KJ(KJ(new Map,this.metadata),Q.metadata),K=Q.fields.filter((Y)=>{let W=J.findIndex((q)=>q.name===Y.name);return~W?(J[W]=Y.clone({metadata:KJ(KJ(new Map,J[W].metadata),Y.metadata)}))&&!1:!0}),X=TW(K,new Map);return new i5([...J,...K],Z,new Map([...this.dictionaries,...X]))}}$M.Schema=i5;i5.prototype.fields=null;i5.prototype.metadata=null;i5.prototype.dictionaries=null;class p4{static new(...$){let[Q,J,Z,K]=$;if($[0]&&typeof $[0]==="object")({name:Q}=$[0]),J===void 0&&(J=$[0].type),Z===void 0&&(Z=$[0].nullable),K===void 0&&(K=$[0].metadata);return new p4(`${Q}`,J,Z,K)}constructor($,Q,J=!1,Z){this.name=$,this.type=Q,this.nullable=J,this.metadata=Z||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...$){let[Q,J,Z,K]=$;return!$[0]||typeof $[0]!=="object"?[Q=this.name,J=this.type,Z=this.nullable,K=this.metadata]=$:{name:Q=this.name,type:J=this.type,nullable:Z=this.nullable,metadata:K=this.metadata}=$[0],p4.new(Q,J,Z,K)}}$M.Field=p4;p4.prototype.type=null;p4.prototype.name=null;p4.prototype.nullable=null;p4.prototype.metadata=null;function KJ($,Q){return new Map([...$||new Map,...Q||new Map])}function TW($,Q=new Map){for(let J=-1,Z=$.length;++J<Z;){let X=$[J].type;if(Yn.DataType.isDictionary(X)){if(!Q.has(X.id))Q.set(X.id,X.dictionary);else if(Q.get(X.id)!==X.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id")}if(X.children&&X.children.length>0)TW(X.children,Q)}return Q}});var GW=g((WM)=>{Object.defineProperty(WM,"__esModule",{value:!0});WM.FileBlock=WM.Footer=void 0;var qn=SW(),R6=eP(),XM=k1(),Hn=XM.Builder,Fn=XM.ByteBuffer,JM=e0(),ZM=a1(),Un=z0(),KM=f4();class IW{static decode($){$=new Fn((0,Un.toUint8Array)($));let Q=R6.Footer.getRootAsFooter($),J=JM.Schema.decode(Q.schema(),new Map,Q.version());return new YM(J,Q)}static encode($){let Q=new Hn,J=JM.Schema.encode(Q,$.schema);R6.Footer.startRecordBatchesVector(Q,$.numRecordBatches);for(let X of[...$.recordBatches()].slice().reverse())u7.encode(Q,X);let Z=Q.endVector();R6.Footer.startDictionariesVector(Q,$.numDictionaries);for(let X of[...$.dictionaryBatches()].slice().reverse())u7.encode(Q,X);let K=Q.endVector();return R6.Footer.startFooter(Q),R6.Footer.addSchema(Q,J),R6.Footer.addVersion(Q,ZM.MetadataVersion.V5),R6.Footer.addRecordBatches(Q,Z),R6.Footer.addDictionaries(Q,K),R6.Footer.finishFooterBuffer(Q,R6.Footer.endFooter(Q)),Q.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor($,Q=ZM.MetadataVersion.V5,J,Z){this.schema=$,this.version=Q,J&&(this._recordBatches=J),Z&&(this._dictionaryBatches=Z)}*recordBatches(){for(let $,Q=-1,J=this.numRecordBatches;++Q<J;)if($=this.getRecordBatch(Q))yield $}*dictionaryBatches(){for(let $,Q=-1,J=this.numDictionaries;++Q<J;)if($=this.getDictionaryBatch(Q))yield $}getRecordBatch($){return $>=0&&$<this.numRecordBatches&&this._recordBatches[$]||null}getDictionaryBatch($){return $>=0&&$<this.numDictionaries&&this._dictionaryBatches[$]||null}}WM.Footer=IW;class YM extends IW{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor($,Q){super($,Q.version());this._footer=Q}getRecordBatch($){if($>=0&&$<this.numRecordBatches){let Q=this._footer.recordBatches($);if(Q)return u7.decode(Q)}return null}getDictionaryBatch($){if($>=0&&$<this.numDictionaries){let Q=this._footer.dictionaries($);if(Q)return u7.decode(Q)}return null}}class u7{static decode($){return new u7($.metaDataLength(),$.bodyLength(),$.offset())}static encode($,Q){let{metaDataLength:J}=Q,Z=BigInt(Q.offset),K=BigInt(Q.bodyLength);return qn.Block.createBlock($,Z,J,K)}constructor($,Q,J){this.metaDataLength=$,this.offset=(0,KM.bigIntToNumber)(J),this.bodyLength=(0,KM.bigIntToNumber)(Q)}}WM.FileBlock=u7});var h3=g((VM)=>{Object.defineProperty(VM,"__esModule",{value:!0});VM.AsyncQueue=VM.ReadableInterop=VM.ArrowJSON=VM.ITERATOR_DONE=void 0;var E3=(s0(),J5(n0)),HM=R3();VM.ITERATOR_DONE=Object.freeze({done:!0,value:void 0});class FM{constructor($){this._json=$}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}VM.ArrowJSON=FM;class EW{tee(){return this._getDOMStream().tee()}pipe($,Q){return this._getNodeStream().pipe($,Q)}pipeTo($,Q){return this._getDOMStream().pipeTo($,Q)}pipeThrough($,Q){return this._getDOMStream().pipeThrough($,Q)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}VM.ReadableInterop=EW;class UM extends EW{constructor(){super();this._values=[],this.resolvers=[],this._closedPromise=new Promise(($)=>this._closedPromiseResolve=$)}get closed(){return this._closedPromise}cancel($){return E3.__awaiter(this,void 0,void 0,function*(){yield this.return($)})}write($){if(this._ensureOpen())this.resolvers.length<=0?this._values.push($):this.resolvers.shift().resolve({done:!1,value:$})}abort($){if(this._closedPromiseResolve)this.resolvers.length<=0?this._error={error:$}:this.resolvers.shift().reject({done:!0,value:$})}close(){if(this._closedPromiseResolve){let{resolvers:$}=this;while($.length>0)$.shift().resolve(VM.ITERATOR_DONE);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream($){return HM.default.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,$)}toNodeStream($){return HM.default.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,$)}throw($){return E3.__awaiter(this,void 0,void 0,function*(){return yield this.abort($),VM.ITERATOR_DONE})}return($){return E3.__awaiter(this,void 0,void 0,function*(){return yield this.close(),VM.ITERATOR_DONE})}read($){return E3.__awaiter(this,void 0,void 0,function*(){return(yield this.next($,"read")).value})}peek($){return E3.__awaiter(this,void 0,void 0,function*(){return(yield this.next($,"peek")).value})}next(...$){if(this._values.length>0)return Promise.resolve({done:!1,value:this._values.shift()});else if(this._error)return Promise.reject({done:!0,value:this._error.error});else if(!this._closedPromiseResolve)return Promise.resolve(VM.ITERATOR_DONE);else return new Promise((Q,J)=>{this.resolvers.push({resolve:Q,reject:J})})}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw Error("AsyncQueue is closed")}}VM.AsyncQueue=UM});var s4=g((zM)=>{Object.defineProperty(zM,"__esModule",{value:!0});zM.AsyncByteStream=zM.ByteStream=zM.AsyncByteQueue=void 0;var n4=(s0(),J5(n0)),u4=R3(),DM=I4(),L3=h3(),jW=z0(),F9=G4();class hW extends L3.AsyncQueue{write($){if(($=(0,jW.toUint8Array)($)).byteLength>0)return super.write($)}toString($=!1){return $?(0,DM.decodeUtf8)(this.toUint8Array(!0)):this.toUint8Array(!1).then(DM.decodeUtf8)}toUint8Array($=!1){return $?(0,jW.joinUint8Arrays)(this._values)[0]:(()=>n4.__awaiter(this,void 0,void 0,function*(){var Q,J,Z,K;let X=[],Y=0;try{for(var W=!0,q=n4.__asyncValues(this),H;H=yield q.next(),Q=H.done,!Q;W=!0){K=H.value,W=!1;let F=K;X.push(F),Y+=F.byteLength}}catch(F){J={error:F}}finally{try{if(!W&&!Q&&(Z=q.return))yield Z.call(q)}finally{if(J)throw J.error}}return(0,jW.joinUint8Arrays)(X,Y)[0]}))()}}zM.AsyncByteQueue=hW;class CM{constructor($){if($)this.source=new AM(u4.default.fromIterable($))}[Symbol.iterator](){return this}next($){return this.source.next($)}throw($){return this.source.throw($)}return($){return this.source.return($)}peek($){return this.source.peek($)}read($){return this.source.read($)}}zM.ByteStream=CM;class LW{constructor($){if($ instanceof LW)this.source=$.source;else if($ instanceof hW)this.source=new i4(u4.default.fromAsyncIterable($));else if((0,F9.isReadableNodeStream)($))this.source=new i4(u4.default.fromNodeStream($));else if((0,F9.isReadableDOMStream)($))this.source=new i4(u4.default.fromDOMStream($));else if((0,F9.isFetchResponse)($))this.source=new i4(u4.default.fromDOMStream($.body));else if((0,F9.isIterable)($))this.source=new i4(u4.default.fromIterable($));else if((0,F9.isPromise)($))this.source=new i4(u4.default.fromAsyncIterable($));else if((0,F9.isAsyncIterable)($))this.source=new i4(u4.default.fromAsyncIterable($))}[Symbol.asyncIterator](){return this}next($){return this.source.next($)}throw($){return this.source.throw($)}return($){return this.source.return($)}get closed(){return this.source.closed}cancel($){return this.source.cancel($)}peek($){return this.source.peek($)}read($){return this.source.read($)}}zM.AsyncByteStream=LW;class AM{constructor($){this.source=$}cancel($){this.return($)}peek($){return this.next($,"peek").value}read($){return this.next($,"read").value}next($,Q="read"){return this.source.next({cmd:Q,size:$})}throw($){return Object.create(this.source.throw&&this.source.throw($)||L3.ITERATOR_DONE)}return($){return Object.create(this.source.return&&this.source.return($)||L3.ITERATOR_DONE)}}class i4{constructor($){this.source=$,this._closedPromise=new Promise((Q)=>this._closedPromiseResolve=Q)}cancel($){return n4.__awaiter(this,void 0,void 0,function*(){yield this.return($)})}get closed(){return this._closedPromise}read($){return n4.__awaiter(this,void 0,void 0,function*(){return(yield this.next($,"read")).value})}peek($){return n4.__awaiter(this,void 0,void 0,function*(){return(yield this.next($,"peek")).value})}next($){return n4.__awaiter(this,arguments,void 0,function*(Q,J="read"){return yield this.source.next({cmd:J,size:Q})})}throw($){return n4.__awaiter(this,void 0,void 0,function*(){let Q=this.source.throw&&(yield this.source.throw($))||L3.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(Q)})}return($){return n4.__awaiter(this,void 0,void 0,function*(){let Q=this.source.return&&(yield this.source.return($))||L3.ITERATOR_DONE;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(Q)})}}});var vW=g((PM)=>{Object.defineProperty(PM,"__esModule",{value:!0});PM.AsyncRandomAccessFile=PM.RandomAccessFile=void 0;var o4=(s0(),J5(n0)),BM=s4(),zn=z0();class RM extends BM.ByteStream{constructor($,Q){super();this.position=0,this.buffer=(0,zn.toUint8Array)($),this.size=Q===void 0?this.buffer.byteLength:Q}readInt32($){let{buffer:Q,byteOffset:J}=this.readAt($,4);return new DataView(Q,J).getInt32(0,!0)}seek($){return this.position=Math.min($,this.size),$<this.size}read($){let{buffer:Q,size:J,position:Z}=this;if(Q&&Z<J){if(typeof $!=="number")$=Number.POSITIVE_INFINITY;return this.position=Math.min(J,Z+Math.min(J-Z,$)),Q.subarray(Z,this.position)}return null}readAt($,Q){let J=this.buffer,Z=Math.min(this.size,$+Q);return J?J.subarray($,Z):new Uint8Array(Q)}close(){this.buffer&&(this.buffer=null)}throw($){return this.close(),{done:!0,value:$}}return($){return this.close(),{done:!0,value:$}}}PM.RandomAccessFile=RM;class OM extends BM.AsyncByteStream{constructor($,Q){super();if(this.position=0,this._handle=$,typeof Q==="number")this.size=Q;else this._pending=(()=>o4.__awaiter(this,void 0,void 0,function*(){this.size=(yield $.stat()).size,delete this._pending}))()}readInt32($){return o4.__awaiter(this,void 0,void 0,function*(){let{buffer:Q,byteOffset:J}=yield this.readAt($,4);return new DataView(Q,J).getInt32(0,!0)})}seek($){return o4.__awaiter(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min($,this.size),$<this.size})}read($){return o4.__awaiter(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:Q,size:J,position:Z}=this;if(Q&&Z<J){if(typeof $!=="number")$=Number.POSITIVE_INFINITY;let K=Z,X=0,Y=0,W=Math.min(J,K+Math.min(J-K,$)),q=new Uint8Array(Math.max(0,(this.position=W)-K));while((K+=Y)<W&&(X+=Y)<q.byteLength)({bytesRead:Y}=yield Q.read(q,X,q.byteLength-X,K));return q}return null})}readAt($,Q){return o4.__awaiter(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:J,size:Z}=this;if(J&&$+Q<Z){let K=Math.min(Z,$+Q),X=new Uint8Array(K-$);return(yield J.read(X,0,Q,$)).buffer}return new Uint8Array(Q)})}close(){return o4.__awaiter(this,void 0,void 0,function*(){let $=this._handle;this._handle=null,$&&(yield $.close())})}throw($){return o4.__awaiter(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:$}})}return($){return o4.__awaiter(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:$}})}}PM.AsyncRandomAccessFile=OM});var xW=g((wM)=>{Object.defineProperty(wM,"__esModule",{value:!0});wM.Int128=wM.Int64=wM.Uint64=wM.BaseInt64=void 0;var Bn=65536;function U9($){if($<0)$=4294967295+$+1;return`0x${$.toString(16)}`}var V9=8,_W=[1,10,100,1000,1e4,1e5,1e6,1e7,1e8];class XJ{constructor($){this.buffer=$}high(){return this.buffer[1]}low(){return this.buffer[0]}_times($){let Q=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),J=new Uint32Array([$.buffer[1]>>>16,$.buffer[1]&65535,$.buffer[0]>>>16,$.buffer[0]&65535]),Z=Q[3]*J[3];this.buffer[0]=Z&65535;let K=Z>>>16;return Z=Q[2]*J[3],K+=Z,Z=Q[3]*J[2]>>>0,K+=Z,this.buffer[0]+=K<<16,this.buffer[1]=K>>>0<Z?Bn:0,this.buffer[1]+=K>>>16,this.buffer[1]+=Q[1]*J[3]+Q[2]*J[2]+Q[3]*J[1],this.buffer[1]+=Q[0]*J[3]+Q[1]*J[2]+Q[2]*J[1]+Q[3]*J[0]<<16,this}_plus($){let Q=this.buffer[0]+$.buffer[0]>>>0;if(this.buffer[1]+=$.buffer[1],Q<this.buffer[0]>>>0)++this.buffer[1];this.buffer[0]=Q}lessThan($){return this.buffer[1]<$.buffer[1]||this.buffer[1]===$.buffer[1]&&this.buffer[0]<$.buffer[0]}equals($){return this.buffer[1]===$.buffer[1]&&this.buffer[0]==$.buffer[0]}greaterThan($){return $.lessThan(this)}hex(){return`${U9(this.buffer[1])} ${U9(this.buffer[0])}`}}wM.BaseInt64=XJ;class L1 extends XJ{times($){return this._times($),this}plus($){return this._plus($),this}static from($,Q=new Uint32Array(2)){return L1.fromString(typeof $==="string"?$:$.toString(),Q)}static fromNumber($,Q=new Uint32Array(2)){return L1.fromString($.toString(),Q)}static fromString($,Q=new Uint32Array(2)){let J=$.length,Z=new L1(Q);for(let K=0;K<J;){let X=V9<J-K?V9:J-K,Y=new L1(new Uint32Array([Number.parseInt($.slice(K,K+X),10),0])),W=new L1(new Uint32Array([_W[X],0]));Z.times(W),Z.plus(Y),K+=X}return Z}static convertArray($){let Q=new Uint32Array($.length*2);for(let J=-1,Z=$.length;++J<Z;)L1.from($[J],new Uint32Array(Q.buffer,Q.byteOffset+2*J*4,2));return Q}static multiply($,Q){return new L1(new Uint32Array($.buffer)).times(Q)}static add($,Q){return new L1(new Uint32Array($.buffer)).plus(Q)}}wM.Uint64=L1;class k5 extends XJ{negate(){if(this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0)++this.buffer[1];return this}times($){return this._times($),this}plus($){return this._plus($),this}lessThan($){let Q=this.buffer[1]<<0,J=$.buffer[1]<<0;return Q<J||Q===J&&this.buffer[0]<$.buffer[0]}static from($,Q=new Uint32Array(2)){return k5.fromString(typeof $==="string"?$:$.toString(),Q)}static fromNumber($,Q=new Uint32Array(2)){return k5.fromString($.toString(),Q)}static fromString($,Q=new Uint32Array(2)){let J=$.startsWith("-"),Z=$.length,K=new k5(Q);for(let X=J?1:0;X<Z;){let Y=V9<Z-X?V9:Z-X,W=new k5(new Uint32Array([Number.parseInt($.slice(X,X+Y),10),0])),q=new k5(new Uint32Array([_W[Y],0]));K.times(q),K.plus(W),X+=Y}return J?K.negate():K}static convertArray($){let Q=new Uint32Array($.length*2);for(let J=-1,Z=$.length;++J<Z;)k5.from($[J],new Uint32Array(Q.buffer,Q.byteOffset+2*J*4,2));return Q}static multiply($,Q){return new k5(new Uint32Array($.buffer)).times(Q)}static add($,Q){return new k5(new Uint32Array($.buffer)).plus(Q)}}wM.Int64=k5;class O6{constructor($){this.buffer=$}high(){return new k5(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new k5(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){if(this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0)++this.buffer[1];if(this.buffer[1]==0)++this.buffer[2];if(this.buffer[2]==0)++this.buffer[3];return this}times($){let Q=new L1(new Uint32Array([this.buffer[3],0])),J=new L1(new Uint32Array([this.buffer[2],0])),Z=new L1(new Uint32Array([this.buffer[1],0])),K=new L1(new Uint32Array([this.buffer[0],0])),X=new L1(new Uint32Array([$.buffer[3],0])),Y=new L1(new Uint32Array([$.buffer[2],0])),W=new L1(new Uint32Array([$.buffer[1],0])),q=new L1(new Uint32Array([$.buffer[0],0])),H=L1.multiply(K,q);this.buffer[0]=H.low();let F=new L1(new Uint32Array([H.high(),0]));return H=L1.multiply(Z,q),F.plus(H),H=L1.multiply(K,W),F.plus(H),this.buffer[1]=F.low(),this.buffer[3]=F.lessThan(H)?1:0,this.buffer[2]=F.high(),new L1(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(L1.multiply(J,q)).plus(L1.multiply(Z,W)).plus(L1.multiply(K,Y)),this.buffer[3]+=L1.multiply(Q,q).plus(L1.multiply(J,W)).plus(L1.multiply(Z,Y)).plus(L1.multiply(K,X)).low(),this}plus($){let Q=new Uint32Array(4);if(Q[3]=this.buffer[3]+$.buffer[3]>>>0,Q[2]=this.buffer[2]+$.buffer[2]>>>0,Q[1]=this.buffer[1]+$.buffer[1]>>>0,Q[0]=this.buffer[0]+$.buffer[0]>>>0,Q[0]<this.buffer[0]>>>0)++Q[1];if(Q[1]<this.buffer[1]>>>0)++Q[2];if(Q[2]<this.buffer[2]>>>0)++Q[3];return this.buffer[3]=Q[3],this.buffer[2]=Q[2],this.buffer[1]=Q[1],this.buffer[0]=Q[0],this}hex(){return`${U9(this.buffer[3])} ${U9(this.buffer[2])} ${U9(this.buffer[1])} ${U9(this.buffer[0])}`}static multiply($,Q){return new O6(new Uint32Array($.buffer)).times(Q)}static add($,Q){return new O6(new Uint32Array($.buffer)).plus(Q)}static from($,Q=new Uint32Array(4)){return O6.fromString(typeof $==="string"?$:$.toString(),Q)}static fromNumber($,Q=new Uint32Array(4)){return O6.fromString($.toString(),Q)}static fromString($,Q=new Uint32Array(4)){let J=$.startsWith("-"),Z=$.length,K=new O6(Q);for(let X=J?1:0;X<Z;){let Y=V9<Z-X?V9:Z-X,W=new O6(new Uint32Array([Number.parseInt($.slice(X,X+Y),10),0,0,0])),q=new O6(new Uint32Array([_W[Y],0,0,0]));K.times(q),K.plus(W),X+=Y}return J?K.negate():K}static convertArray($){let Q=new Uint32Array($.length*4);for(let J=-1,Z=$.length;++J<Z;)O6.from($[J],new Uint32Array(Q.buffer,Q.byteOffset+16*J,4));return Q}}wM.Int128=O6});var jM=g((GM)=>{Object.defineProperty(GM,"__esModule",{value:!0});GM.JSONVectorLoader=GM.VectorLoader=void 0;var $0=A6(),Mn=e0(),B5=p1(),wn=r0(),TM=p7(),Sn=I4(),YJ=xW(),WJ=a1(),P6=z0();class gW extends wn.Visitor{constructor($,Q,J,Z,K=WJ.MetadataVersion.V5){super();this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=$,this.nodes=Q,this.buffers=J,this.dictionaries=Z,this.metadataVersion=K}visit($){return super.visit($ instanceof Mn.Field?$.type:$)}visitNull($,{length:Q}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q})}visitBool($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitInt($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitFloat($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitUtf8($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),data:this.readData($)})}visitLargeUtf8($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),data:this.readData($)})}visitBinary($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),data:this.readData($)})}visitLargeBinary($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),data:this.readData($)})}visitFixedSizeBinary($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitDate($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitTimestamp($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitTime($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitDecimal($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitList($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),child:this.visit($.children[0])})}visitStruct($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),children:this.visitMany($.children)})}visitUnion($,{length:Q,nullCount:J}=this.nextFieldNode()){if(this.metadataVersion<WJ.MetadataVersion.V5)this.readNullBitmap($,J);return $.mode===WJ.UnionMode.Sparse?this.visitSparseUnion($,{length:Q,nullCount:J}):this.visitDenseUnion($,{length:Q,nullCount:J})}visitDenseUnion($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,typeIds:this.readTypeIds($),valueOffsets:this.readOffsets($),children:this.visitMany($.children)})}visitSparseUnion($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,typeIds:this.readTypeIds($),children:this.visitMany($.children)})}visitDictionary($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($.indices),dictionary:this.readDictionary($)})}visitInterval($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitDuration($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),data:this.readData($)})}visitFixedSizeList($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),child:this.visit($.children[0])})}visitMap($,{length:Q,nullCount:J}=this.nextFieldNode()){return(0,$0.makeData)({type:$,length:Q,nullCount:J,nullBitmap:this.readNullBitmap($,J),valueOffsets:this.readOffsets($),child:this.visit($.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap($,Q,J=this.nextBufferRange()){return Q>0&&this.readData($,J)||new Uint8Array(0)}readOffsets($,Q){return this.readData($,Q)}readTypeIds($,Q){return this.readData($,Q)}readData($,{length:Q,offset:J}=this.nextBufferRange()){return this.bytes.subarray(J,J+Q)}readDictionary($){return this.dictionaries.get($.id)}}GM.VectorLoader=gW;class IM extends gW{constructor($,Q,J,Z,K){super(new Uint8Array(0),Q,J,Z,K);this.sources=$}readNullBitmap($,Q,{offset:J}=this.nextBufferRange()){return Q<=0?new Uint8Array(0):(0,TM.packBools)(this.sources[J])}readOffsets($,{offset:Q}=this.nextBufferRange()){return(0,P6.toArrayBufferView)(Uint8Array,(0,P6.toArrayBufferView)($.OffsetArrayType,this.sources[Q]))}readTypeIds($,{offset:Q}=this.nextBufferRange()){return(0,P6.toArrayBufferView)(Uint8Array,(0,P6.toArrayBufferView)($.ArrayType,this.sources[Q]))}readData($,{offset:Q}=this.nextBufferRange()){let{sources:J}=this;if(B5.DataType.isTimestamp($))return(0,P6.toArrayBufferView)(Uint8Array,YJ.Int64.convertArray(J[Q]));else if((B5.DataType.isInt($)||B5.DataType.isTime($))&&$.bitWidth===64||B5.DataType.isDuration($))return(0,P6.toArrayBufferView)(Uint8Array,YJ.Int64.convertArray(J[Q]));else if(B5.DataType.isDate($)&&$.unit===WJ.DateUnit.MILLISECOND)return(0,P6.toArrayBufferView)(Uint8Array,YJ.Int64.convertArray(J[Q]));else if(B5.DataType.isDecimal($))return(0,P6.toArrayBufferView)(Uint8Array,YJ.Int128.convertArray(J[Q]));else if(B5.DataType.isBinary($)||B5.DataType.isLargeBinary($)||B5.DataType.isFixedSizeBinary($))return Tn(J[Q]);else if(B5.DataType.isBool($))return(0,TM.packBools)(J[Q]);else if(B5.DataType.isUtf8($)||B5.DataType.isLargeUtf8($))return(0,Sn.encodeUtf8)(J[Q].join(""));return(0,P6.toArrayBufferView)(Uint8Array,(0,P6.toArrayBufferView)($.ArrayType,J[Q].map((Z)=>+Z)))}}GM.JSONVectorLoader=IM;function Tn($){let Q=$.join(""),J=new Uint8Array(Q.length/2);for(let Z=0;Z<Q.length;Z+=2)J[Z>>1]=Number.parseInt(Q.slice(Z,Z+2),16);return J}});var qJ=g((LM)=>{Object.defineProperty(LM,"__esModule",{value:!0});LM.BinaryBuilder=void 0;var Gn=a6(),En=o1(),jn=z0();class hM extends En.VariableWidthBuilder{constructor($){super($);this._values=new Gn.BufferBuilder(Uint8Array)}get byteLength(){let $=this._pendingLength+this.length*4;return this._offsets&&($+=this._offsets.byteLength),this._values&&($+=this._values.byteLength),this._nulls&&($+=this._nulls.byteLength),$}setValue($,Q){return super.setValue($,(0,jn.toUint8Array)(Q))}_flushPending($,Q){let J=this._offsets,Z=this._values.reserve(Q).buffer,K=0;for(let[X,Y]of $)if(Y===void 0)J.set(X,0);else{let W=Y.length;Z.set(Y,K),J.set(X,W),K+=W}}}LM.BinaryBuilder=hM});var HJ=g((xM)=>{Object.defineProperty(xM,"__esModule",{value:!0});xM.LargeBinaryBuilder=void 0;var hn=z0(),Ln=a6(),vn=o1();class _M extends vn.VariableWidthBuilder{constructor($){super($);this._values=new Ln.BufferBuilder(Uint8Array)}get byteLength(){let $=this._pendingLength+this.length*4;return this._offsets&&($+=this._offsets.byteLength),this._values&&($+=this._values.byteLength),this._nulls&&($+=this._nulls.byteLength),$}setValue($,Q){return super.setValue($,(0,hn.toUint8Array)(Q))}_flushPending($,Q){let J=this._offsets,Z=this._values.reserve(Q).buffer,K=0;for(let[X,Y]of $)if(Y===void 0)J.set(X,BigInt(0));else{let W=Y.length;Z.set(Y,K),J.set(X,BigInt(W)),K+=W}}}xM.LargeBinaryBuilder=_M});var yW=g((fM)=>{Object.defineProperty(fM,"__esModule",{value:!0});fM.BoolBuilder=void 0;var _n=a6(),xn=o1();class yM extends xn.Builder{constructor($){super($);this._values=new _n.BitmapBufferBuilder}setValue($,Q){this._values.set($,+Q)}}fM.BoolBuilder=yM});var cW=g((mM)=>{Object.defineProperty(mM,"__esModule",{value:!0});mM.DateMillisecondBuilder=mM.DateDayBuilder=mM.DateBuilder=void 0;var gn=o1(),fW=Y5();class v3 extends gn.FixedWidthBuilder{}mM.DateBuilder=v3;v3.prototype._setValue=fW.setDate;class bW extends v3{}mM.DateDayBuilder=bW;bW.prototype._setValue=fW.setDateDay;class mW extends v3{}mM.DateMillisecondBuilder=mW;mW.prototype._setValue=fW.setDateMillisecond});var lW=g((dM)=>{Object.defineProperty(dM,"__esModule",{value:!0});dM.DecimalBuilder=void 0;var bn=o1(),mn=Y5();class dW extends bn.FixedWidthBuilder{}dM.DecimalBuilder=dW;dW.prototype._setValue=mn.setDecimal});var pW=g((iM)=>{Object.defineProperty(iM,"__esModule",{value:!0});iM.DictionaryBuilder=void 0;var cn=p1(),dn=o1(),pM=_3();class uM extends dn.Builder{constructor({type:$,nullValues:Q,dictionaryHashFunction:J}){super({type:new cn.Dictionary($.dictionary,$.indices,$.id,$.isOrdered)});if(this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=(0,pM.makeBuilder)({type:this.type.indices,nullValues:Q}),this.dictionary=(0,pM.makeBuilder)({type:this.type.dictionary,nullValues:null}),typeof J==="function")this.valueToKey=J}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid($){return this.indices.isValid($)}setValid($,Q){let J=this.indices;return Q=J.setValid($,Q),this.length=J.length,Q}setValue($,Q){let J=this._keysToIndices,Z=this.valueToKey(Q),K=J[Z];if(K===void 0)J[Z]=K=this._dictionaryOffset+this.dictionary.append(Q).length-1;return this.indices.setValue($,K)}flush(){let $=this.type,Q=this._dictionary,J=this.dictionary.toVector(),Z=this.indices.flush().clone($);return Z.dictionary=Q?Q.concat(J):J,this.finished||(this._dictionaryOffset+=J.length),this._dictionary=Z.dictionary,this.clear(),Z}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey($){return typeof $==="string"?$:`${$}`}}iM.DictionaryBuilder=uM});var iW=g((sM)=>{Object.defineProperty(sM,"__esModule",{value:!0});sM.FixedSizeBinaryBuilder=void 0;var ln=o1(),pn=Y5();class uW extends ln.FixedWidthBuilder{}sM.FixedSizeBinaryBuilder=uW;uW.prototype._setValue=pn.setFixedSizeBinary});var nW=g((aM)=>{Object.defineProperty(aM,"__esModule",{value:!0});aM.FixedSizeListBuilder=void 0;var un=e0(),nn=o1(),sn=p1();class rM extends nn.Builder{setValue($,Q){let[J]=this.children,Z=$*this.stride;for(let K=-1,X=Q.length;++K<X;)J.set(Z+K,Q[K])}addChild($,Q="0"){if(this.numChildren>0)throw Error("FixedSizeListBuilder can only have one child.");let J=this.children.push($);return this.type=new sn.FixedSizeList(this.type.listSize,new un.Field(Q,$.type,!0)),J}}aM.FixedSizeListBuilder=rM});var sW=g((Jw)=>{Object.defineProperty(Jw,"__esModule",{value:!0});Jw.Float64Builder=Jw.Float32Builder=Jw.Float16Builder=Jw.FloatBuilder=void 0;var on=S3(),rn=o1();class x3 extends rn.FixedWidthBuilder{setValue($,Q){this._values.set($,Q)}}Jw.FloatBuilder=x3;class eM extends x3{setValue($,Q){super.setValue($,(0,on.float64ToUint16)(Q))}}Jw.Float16Builder=eM;class $w extends x3{}Jw.Float32Builder=$w;class Qw extends x3{}Jw.Float64Builder=Qw});var tW=g((Kw)=>{Object.defineProperty(Kw,"__esModule",{value:!0});Kw.IntervalYearMonthBuilder=Kw.IntervalDayTimeBuilder=Kw.IntervalBuilder=void 0;var $s=o1(),oW=Y5();class g3 extends $s.FixedWidthBuilder{}Kw.IntervalBuilder=g3;g3.prototype._setValue=oW.setIntervalValue;class rW extends g3{}Kw.IntervalDayTimeBuilder=rW;rW.prototype._setValue=oW.setIntervalDayTime;class aW extends g3{}Kw.IntervalYearMonthBuilder=aW;aW.prototype._setValue=oW.setIntervalYearMonth});var Zq=g((Yw)=>{Object.defineProperty(Yw,"__esModule",{value:!0});Yw.DurationNanosecondBuilder=Yw.DurationMicrosecondBuilder=Yw.DurationMillisecondBuilder=Yw.DurationSecondBuilder=Yw.DurationBuilder=void 0;var Zs=o1(),y3=Y5();class i7 extends Zs.FixedWidthBuilder{}Yw.DurationBuilder=i7;i7.prototype._setValue=y3.setDuration;class eW extends i7{}Yw.DurationSecondBuilder=eW;eW.prototype._setValue=y3.setDurationSecond;class $q extends i7{}Yw.DurationMillisecondBuilder=$q;$q.prototype._setValue=y3.setDurationMillisecond;class Qq extends i7{}Yw.DurationMicrosecondBuilder=Qq;Qq.prototype._setValue=y3.setDurationMicrosecond;class Jq extends i7{}Yw.DurationNanosecondBuilder=Jq;Jq.prototype._setValue=y3.setDurationNanosecond});var Kq=g((Aw)=>{Object.defineProperty(Aw,"__esModule",{value:!0});Aw.Uint64Builder=Aw.Uint32Builder=Aw.Uint16Builder=Aw.Uint8Builder=Aw.Int64Builder=Aw.Int32Builder=Aw.Int16Builder=Aw.Int8Builder=Aw.IntBuilder=void 0;var qs=o1();class M6 extends qs.FixedWidthBuilder{setValue($,Q){this._values.set($,Q)}}Aw.IntBuilder=M6;class qw extends M6{}Aw.Int8Builder=qw;class Hw extends M6{}Aw.Int16Builder=Hw;class Fw extends M6{}Aw.Int32Builder=Fw;class Uw extends M6{}Aw.Int64Builder=Uw;class Vw extends M6{}Aw.Uint8Builder=Vw;class Nw extends M6{}Aw.Uint16Builder=Nw;class Dw extends M6{}Aw.Uint32Builder=Dw;class Cw extends M6{}Aw.Uint64Builder=Cw});var Xq=g((Bw)=>{Object.defineProperty(Bw,"__esModule",{value:!0});Bw.ListBuilder=void 0;var zs=e0(),ks=p1(),Bs=a6(),Rs=o1();class kw extends Rs.VariableWidthBuilder{constructor($){super($);this._offsets=new Bs.OffsetsBufferBuilder($.type)}addChild($,Q="0"){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");return this.children[this.numChildren]=$,this.type=new ks.List(new zs.Field(Q,$.type,!0)),this.numChildren-1}_flushPending($){let Q=this._offsets,[J]=this.children;for(let[Z,K]of $)if(typeof K>"u")Q.set(Z,0);else{let X=K,Y=X.length,W=Q.set(Z,Y).buffer[Z];for(let q=-1;++q<Y;)J.set(W+q,X[q])}}}Bw.ListBuilder=kw});var Yq=g((Pw)=>{Object.defineProperty(Pw,"__esModule",{value:!0});Pw.MapBuilder=void 0;var Os=e0(),Ps=p1(),Ms=o1();class Ow extends Ms.VariableWidthBuilder{set($,Q){return super.set($,Q)}setValue($,Q){let J=Q instanceof Map?Q:new Map(Object.entries(Q)),Z=this._pending||(this._pending=new Map),K=Z.get($);K&&(this._pendingLength-=K.size),this._pendingLength+=J.size,Z.set($,J)}addChild($,Q=`${this.numChildren}`){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");return this.children[this.numChildren]=$,this.type=new Ps.Map_(new Os.Field(Q,$.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending($){let Q=this._offsets,[J]=this.children;for(let[Z,K]of $)if(K===void 0)Q.set(Z,0);else{let{[Z]:X,[Z+1]:Y}=Q.set(Z,K.size).buffer;for(let W of K.entries())if(J.set(X,W),++X>=Y)break}}}Pw.MapBuilder=Ow});var Wq=g((Sw)=>{Object.defineProperty(Sw,"__esModule",{value:!0});Sw.NullBuilder=void 0;var ws=o1();class ww extends ws.Builder{setValue($,Q){}setValid($,Q){return this.length=Math.max($+1,this.length),Q}}Sw.NullBuilder=ww});var qq=g((Gw)=>{Object.defineProperty(Gw,"__esModule",{value:!0});Gw.StructBuilder=void 0;var Ss=e0(),Ts=o1(),Is=p1();class Iw extends Ts.Builder{setValue($,Q){let{children:J,type:Z}=this;switch(Array.isArray(Q)||Q.constructor){case!0:return Z.children.forEach((K,X)=>J[X].set($,Q[X]));case Map:return Z.children.forEach((K,X)=>J[X].set($,Q.get(K.name)));default:return Z.children.forEach((K,X)=>J[X].set($,Q[K.name]))}}setValid($,Q){if(!super.setValid($,Q))this.children.forEach((J)=>J.setValid($,Q));return Q}addChild($,Q=`${this.numChildren}`){let J=this.children.push($);return this.type=new Is.Struct([...this.type.children,new Ss.Field(Q,$.type,!0)]),J}}Gw.StructBuilder=Iw});var Nq=g((jw)=>{Object.defineProperty(jw,"__esModule",{value:!0});jw.TimestampNanosecondBuilder=jw.TimestampMicrosecondBuilder=jw.TimestampMillisecondBuilder=jw.TimestampSecondBuilder=jw.TimestampBuilder=void 0;var Gs=o1(),f3=Y5();class n7 extends Gs.FixedWidthBuilder{}jw.TimestampBuilder=n7;n7.prototype._setValue=f3.setTimestamp;class Hq extends n7{}jw.TimestampSecondBuilder=Hq;Hq.prototype._setValue=f3.setTimestampSecond;class Fq extends n7{}jw.TimestampMillisecondBuilder=Fq;Fq.prototype._setValue=f3.setTimestampMillisecond;class Uq extends n7{}jw.TimestampMicrosecondBuilder=Uq;Uq.prototype._setValue=f3.setTimestampMicrosecond;class Vq extends n7{}jw.TimestampNanosecondBuilder=Vq;Vq.prototype._setValue=f3.setTimestampNanosecond});var kq=g((Lw)=>{Object.defineProperty(Lw,"__esModule",{value:!0});Lw.TimeNanosecondBuilder=Lw.TimeMicrosecondBuilder=Lw.TimeMillisecondBuilder=Lw.TimeSecondBuilder=Lw.TimeBuilder=void 0;var vs=o1(),b3=Y5();class s7 extends vs.FixedWidthBuilder{}Lw.TimeBuilder=s7;s7.prototype._setValue=b3.setTime;class Dq extends s7{}Lw.TimeSecondBuilder=Dq;Dq.prototype._setValue=b3.setTimeSecond;class Cq extends s7{}Lw.TimeMillisecondBuilder=Cq;Cq.prototype._setValue=b3.setTimeMillisecond;class Aq extends s7{}Lw.TimeMicrosecondBuilder=Aq;Aq.prototype._setValue=b3.setTimeMicrosecond;class zq extends s7{}Lw.TimeNanosecondBuilder=zq;zq.prototype._setValue=b3.setTimeNanosecond});var Bq=g((yw)=>{Object.defineProperty(yw,"__esModule",{value:!0});yw.DenseUnionBuilder=yw.SparseUnionBuilder=yw.UnionBuilder=void 0;var fs=e0(),_w=a6(),bs=o1(),ms=p1();class FJ extends bs.Builder{constructor($){super($);if(this._typeIds=new _w.DataBufferBuilder(Int8Array,0,1),typeof $.valueToChildTypeId==="function")this._valueToChildTypeId=$.valueToChildTypeId}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append($,Q){return this.set(this.length,$,Q)}set($,Q,J){if(J===void 0)J=this._valueToChildTypeId(this,Q,$);return this.setValue($,Q,J),this}setValue($,Q,J){this._typeIds.set($,J);let Z=this.type.typeIdToChildIndex[J],K=this.children[Z];K===null||K===void 0||K.set($,Q)}addChild($,Q=`${this.children.length}`){let J=this.children.push($),{type:{children:Z,mode:K,typeIds:X}}=this,Y=[...Z,new fs.Field(Q,$.type)];return this.type=new ms.Union(K,[...X,J],Y),J}_valueToChildTypeId($,Q,J){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}yw.UnionBuilder=FJ;class xw extends FJ{}yw.SparseUnionBuilder=xw;class gw extends FJ{constructor($){super($);this._offsets=new _w.DataBufferBuilder(Int32Array)}setValue($,Q,J){let Z=this._typeIds.set($,J).buffer[$],K=this.getChildAt(this.type.typeIdToChildIndex[Z]),X=this._offsets.set($,K.length).buffer[$];K===null||K===void 0||K.set(X,Q)}}yw.DenseUnionBuilder=gw});var Oq=g((bw)=>{Object.defineProperty(bw,"__esModule",{value:!0});bw.Utf8Builder=void 0;var ls=I4(),ps=qJ(),us=a6(),is=o1();class Rq extends is.VariableWidthBuilder{constructor($){super($);this._values=new us.BufferBuilder(Uint8Array)}get byteLength(){let $=this._pendingLength+this.length*4;return this._offsets&&($+=this._offsets.byteLength),this._values&&($+=this._values.byteLength),this._nulls&&($+=this._nulls.byteLength),$}setValue($,Q){return super.setValue($,(0,ls.encodeUtf8)(Q))}_flushPending($,Q){}}bw.Utf8Builder=Rq;Rq.prototype._flushPending=ps.BinaryBuilder.prototype._flushPending});var Mq=g((cw)=>{Object.defineProperty(cw,"__esModule",{value:!0});cw.LargeUtf8Builder=void 0;var ns=I4(),ss=a6(),os=o1(),rs=HJ();class Pq extends os.VariableWidthBuilder{constructor($){super($);this._values=new ss.BufferBuilder(Uint8Array)}get byteLength(){let $=this._pendingLength+this.length*4;return this._offsets&&($+=this._offsets.byteLength),this._values&&($+=this._values.byteLength),this._nulls&&($+=this._nulls.byteLength),$}setValue($,Q){return super.setValue($,(0,ns.encodeUtf8)(Q))}_flushPending($,Q){}}cw.LargeUtf8Builder=Pq;Pq.prototype._flushPending=rs.LargeBinaryBuilder.prototype._flushPending});var uw=g((lw)=>{Object.defineProperty(lw,"__esModule",{value:!0});lw.instance=lw.GetBuilderCtor=void 0;var as=r0(),ts=qJ(),es=HJ(),$o=yW(),wq=cW(),Qo=lW(),Jo=pW(),Zo=iW(),Ko=nW(),UJ=sW(),Sq=tW(),m3=Zq(),t6=Kq(),Xo=Xq(),Yo=Yq(),Wo=Wq(),qo=qq(),c3=Nq(),d3=kq(),Tq=Bq(),Ho=Oq(),Fo=Mq();class Iq extends as.Visitor{visitNull(){return Wo.NullBuilder}visitBool(){return $o.BoolBuilder}visitInt(){return t6.IntBuilder}visitInt8(){return t6.Int8Builder}visitInt16(){return t6.Int16Builder}visitInt32(){return t6.Int32Builder}visitInt64(){return t6.Int64Builder}visitUint8(){return t6.Uint8Builder}visitUint16(){return t6.Uint16Builder}visitUint32(){return t6.Uint32Builder}visitUint64(){return t6.Uint64Builder}visitFloat(){return UJ.FloatBuilder}visitFloat16(){return UJ.Float16Builder}visitFloat32(){return UJ.Float32Builder}visitFloat64(){return UJ.Float64Builder}visitUtf8(){return Ho.Utf8Builder}visitLargeUtf8(){return Fo.LargeUtf8Builder}visitBinary(){return ts.BinaryBuilder}visitLargeBinary(){return es.LargeBinaryBuilder}visitFixedSizeBinary(){return Zo.FixedSizeBinaryBuilder}visitDate(){return wq.DateBuilder}visitDateDay(){return wq.DateDayBuilder}visitDateMillisecond(){return wq.DateMillisecondBuilder}visitTimestamp(){return c3.TimestampBuilder}visitTimestampSecond(){return c3.TimestampSecondBuilder}visitTimestampMillisecond(){return c3.TimestampMillisecondBuilder}visitTimestampMicrosecond(){return c3.TimestampMicrosecondBuilder}visitTimestampNanosecond(){return c3.TimestampNanosecondBuilder}visitTime(){return d3.TimeBuilder}visitTimeSecond(){return d3.TimeSecondBuilder}visitTimeMillisecond(){return d3.TimeMillisecondBuilder}visitTimeMicrosecond(){return d3.TimeMicrosecondBuilder}visitTimeNanosecond(){return d3.TimeNanosecondBuilder}visitDecimal(){return Qo.DecimalBuilder}visitList(){return Xo.ListBuilder}visitStruct(){return qo.StructBuilder}visitUnion(){return Tq.UnionBuilder}visitDenseUnion(){return Tq.DenseUnionBuilder}visitSparseUnion(){return Tq.SparseUnionBuilder}visitDictionary(){return Jo.DictionaryBuilder}visitInterval(){return Sq.IntervalBuilder}visitIntervalDayTime(){return Sq.IntervalDayTimeBuilder}visitIntervalYearMonth(){return Sq.IntervalYearMonthBuilder}visitDuration(){return m3.DurationBuilder}visitDurationSecond(){return m3.DurationSecondBuilder}visitDurationMillisecond(){return m3.DurationMillisecondBuilder}visitDurationMicrosecond(){return m3.DurationMicrosecondBuilder}visitDurationNanosecond(){return m3.DurationNanosecondBuilder}visitFixedSizeList(){return Ko.FixedSizeListBuilder}visitMap(){return Yo.MapBuilder}}lw.GetBuilderCtor=Iq;lw.instance=new Iq});var i3=g((iw)=>{Object.defineProperty(iw,"__esModule",{value:!0});iw.compareTypes=iw.compareFields=iw.compareSchemas=iw.instance=iw.TypeComparator=void 0;var Vo=r0();class J1 extends Vo.Visitor{compareSchemas($,Q){return $===Q||Q instanceof $.constructor&&this.compareManyFields($.fields,Q.fields)}compareManyFields($,Q){return $===Q||Array.isArray($)&&Array.isArray(Q)&&$.length===Q.length&&$.every((J,Z)=>this.compareFields(J,Q[Z]))}compareFields($,Q){return $===Q||Q instanceof $.constructor&&$.name===Q.name&&$.nullable===Q.nullable&&this.visit($.type,Q.type)}}iw.TypeComparator=J1;function c0($,Q){return Q instanceof $.constructor}function o7($,Q){return $===Q||c0($,Q)}function e6($,Q){return $===Q||c0($,Q)&&$.bitWidth===Q.bitWidth&&$.isSigned===Q.isSigned}function VJ($,Q){return $===Q||c0($,Q)&&$.precision===Q.precision}function No($,Q){return $===Q||c0($,Q)&&$.byteWidth===Q.byteWidth}function Gq($,Q){return $===Q||c0($,Q)&&$.unit===Q.unit}function l3($,Q){return $===Q||c0($,Q)&&$.unit===Q.unit&&$.timezone===Q.timezone}function p3($,Q){return $===Q||c0($,Q)&&$.unit===Q.unit&&$.bitWidth===Q.bitWidth}function Do($,Q){return $===Q||c0($,Q)&&$.children.length===Q.children.length&&iw.instance.compareManyFields($.children,Q.children)}function Co($,Q){return $===Q||c0($,Q)&&$.children.length===Q.children.length&&iw.instance.compareManyFields($.children,Q.children)}function Eq($,Q){return $===Q||c0($,Q)&&$.mode===Q.mode&&$.typeIds.every((J,Z)=>J===Q.typeIds[Z])&&iw.instance.compareManyFields($.children,Q.children)}function Ao($,Q){return $===Q||c0($,Q)&&$.id===Q.id&&$.isOrdered===Q.isOrdered&&iw.instance.visit($.indices,Q.indices)&&iw.instance.visit($.dictionary,Q.dictionary)}function jq($,Q){return $===Q||c0($,Q)&&$.unit===Q.unit}function u3($,Q){return $===Q||c0($,Q)&&$.unit===Q.unit}function zo($,Q){return $===Q||c0($,Q)&&$.listSize===Q.listSize&&$.children.length===Q.children.length&&iw.instance.compareManyFields($.children,Q.children)}function ko($,Q){return $===Q||c0($,Q)&&$.keysSorted===Q.keysSorted&&$.children.length===Q.children.length&&iw.instance.compareManyFields($.children,Q.children)}J1.prototype.visitNull=o7;J1.prototype.visitBool=o7;J1.prototype.visitInt=e6;J1.prototype.visitInt8=e6;J1.prototype.visitInt16=e6;J1.prototype.visitInt32=e6;J1.prototype.visitInt64=e6;J1.prototype.visitUint8=e6;J1.prototype.visitUint16=e6;J1.prototype.visitUint32=e6;J1.prototype.visitUint64=e6;J1.prototype.visitFloat=VJ;J1.prototype.visitFloat16=VJ;J1.prototype.visitFloat32=VJ;J1.prototype.visitFloat64=VJ;J1.prototype.visitUtf8=o7;J1.prototype.visitLargeUtf8=o7;J1.prototype.visitBinary=o7;J1.prototype.visitLargeBinary=o7;J1.prototype.visitFixedSizeBinary=No;J1.prototype.visitDate=Gq;J1.prototype.visitDateDay=Gq;J1.prototype.visitDateMillisecond=Gq;J1.prototype.visitTimestamp=l3;J1.prototype.visitTimestampSecond=l3;J1.prototype.visitTimestampMillisecond=l3;J1.prototype.visitTimestampMicrosecond=l3;J1.prototype.visitTimestampNanosecond=l3;J1.prototype.visitTime=p3;J1.prototype.visitTimeSecond=p3;J1.prototype.visitTimeMillisecond=p3;J1.prototype.visitTimeMicrosecond=p3;J1.prototype.visitTimeNanosecond=p3;J1.prototype.visitDecimal=o7;J1.prototype.visitList=Do;J1.prototype.visitStruct=Co;J1.prototype.visitUnion=Eq;J1.prototype.visitDenseUnion=Eq;J1.prototype.visitSparseUnion=Eq;J1.prototype.visitDictionary=Ao;J1.prototype.visitInterval=jq;J1.prototype.visitIntervalDayTime=jq;J1.prototype.visitIntervalYearMonth=jq;J1.prototype.visitDuration=u3;J1.prototype.visitDurationSecond=u3;J1.prototype.visitDurationMillisecond=u3;J1.prototype.visitDurationMicrosecond=u3;J1.prototype.visitDurationNanosecond=u3;J1.prototype.visitFixedSizeList=zo;J1.prototype.visitMap=ko;iw.instance=new J1;function Bo($,Q){return iw.instance.compareSchemas($,Q)}iw.compareSchemas=Bo;function Ro($,Q){return iw.instance.compareFields($,Q)}iw.compareFields=Ro;function Oo($,Q){return iw.instance.visit($,Q)}iw.compareTypes=Oo});var _3=g((aw)=>{Object.defineProperty(aw,"__esModule",{value:!0});aw.builderThroughAsyncIterable=aw.builderThroughIterable=aw.tableFromJSON=aw.vectorFromArray=aw.makeBuilder=void 0;var N9=(s0(),J5(n0)),hq=e0(),R5=p1(),So=A6(),sw=m0(),To=uw(),Io=D9(),Go=r4(),Eo=i3();function DJ($){let Q=$.type,J=new(To.instance.getVisitFn(Q)())($);if(Q.children&&Q.children.length>0){let Z=$.children||[],K={nullValues:$.nullValues},X=Array.isArray(Z)?(Y,W)=>Z[W]||K:({name:Y})=>Z[Y]||K;for(let[Y,W]of Q.children.entries()){let{type:q}=W,H=X(W,Y);J.children.push(DJ(Object.assign(Object.assign({},H),{type:q})))}}return J}aw.makeBuilder=DJ;function ow($,Q){if($ instanceof So.Data||$ instanceof sw.Vector||$.type instanceof R5.DataType||ArrayBuffer.isView($))return(0,sw.makeVector)($);let J={type:Q!==null&&Q!==void 0?Q:NJ($),nullValues:[null]},Z=[...rw(J)($)],K=Z.length===1?Z[0]:Z.reduce((X,Y)=>X.concat(Y));if(R5.DataType.isDictionary(K.type))return K.memoize();return K}aw.vectorFromArray=ow;function jo($){let Q=ow($),J=new Go.RecordBatch(new hq.Schema(Q.type.children),Q.data[0]);return new Io.Table(J)}aw.tableFromJSON=jo;function NJ($){if($.length===0)return new R5.Null;let Q=0,J=0,Z=0,K=0,X=0,Y=0,W=0,q=0;for(let H of $){if(H==null){++Q;continue}switch(typeof H){case"bigint":++Y;continue;case"boolean":++W;continue;case"number":++K;continue;case"string":++X;continue;case"object":if(Array.isArray(H))++J;else if(Object.prototype.toString.call(H)==="[object Date]")++q;else++Z;continue}throw TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}if(K+Q===$.length)return new R5.Float64;else if(X+Q===$.length)return new R5.Dictionary(new R5.Utf8,new R5.Int32);else if(Y+Q===$.length)return new R5.Int64;else if(W+Q===$.length)return new R5.Bool;else if(q+Q===$.length)return new R5.TimestampMillisecond;else if(J+Q===$.length){let H=$,F=NJ(H[H.findIndex((U)=>U!=null)]);if(H.every((U)=>U==null||(0,Eo.compareTypes)(F,NJ(U))))return new R5.List(new hq.Field("",F,!0))}else if(Z+Q===$.length){let H=new Map;for(let F of $)for(let U of Object.keys(F))if(!H.has(U)&&F[U]!=null)H.set(U,new hq.Field(U,NJ([F[U]]),!0));return new R5.Struct([...H.values()])}throw TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}function rw($){let{["queueingStrategy"]:Q="count"}=$,{["highWaterMark"]:J=Q!=="bytes"?Number.POSITIVE_INFINITY:Math.pow(2,14)}=$,Z=Q!=="bytes"?"length":"byteLength";return function*(K){let X=0,Y=DJ($);for(let W of K)if(Y.append(W)[Z]>=J)++X&&(yield Y.toVector());if(Y.finish().length>0||X===0)yield Y.toVector()}}aw.builderThroughIterable=rw;function ho($){let{["queueingStrategy"]:Q="count"}=$,{["highWaterMark"]:J=Q!=="bytes"?Number.POSITIVE_INFINITY:Math.pow(2,14)}=$,Z=Q!=="bytes"?"length":"byteLength";return function(K){return N9.__asyncGenerator(this,arguments,function*(){var X,Y,W,q;let H=0,F=DJ($);try{for(var U=!0,V=N9.__asyncValues(K),N;N=yield N9.__await(V.next()),X=N.done,!X;U=!0){q=N.value,U=!1;let D=q;if(F.append(D)[Z]>=J)++H&&(yield yield N9.__await(F.toVector()))}}catch(D){Y={error:D}}finally{try{if(!U&&!X&&(W=V.return))yield N9.__await(W.call(V))}finally{if(Y)throw Y.error}}if(F.finish().length>0||H===0)yield yield N9.__await(F.toVector())})}}aw.builderThroughAsyncIterable=ho});var JS=g(($S)=>{Object.defineProperty($S,"__esModule",{value:!0});$S.distributeVectorsIntoRecordBatches=void 0;var ew=A6(),go=p1(),yo=r4();function fo($,Q){return bo($,Q.map((J)=>J.data.concat()))}$S.distributeVectorsIntoRecordBatches=fo;function bo($,Q){let J=[...$.fields],Z=[],K={numBatches:Q.reduce((U,V)=>Math.max(U,V.length),0)},X=0,Y=0,W=-1,q=Q.length,H,F=[];while(K.numBatches-- >0){for(Y=Number.POSITIVE_INFINITY,W=-1;++W<q;)F[W]=H=Q[W].shift(),Y=Math.min(Y,H?H.length:Y);if(Number.isFinite(Y)){if(F=mo(J,Y,F,Q,K),Y>0)Z[X++]=(0,ew.makeData)({type:new go.Struct(J),length:Y,nullCount:0,children:F.slice()})}}return[$=$.assign(J),Z.map((U)=>new yo.RecordBatch($,U))]}function mo($,Q,J,Z,K){var X;let Y=(Q+63&-64)>>3;for(let W=-1,q=Z.length;++W<q;){let H=J[W],F=H===null||H===void 0?void 0:H.length;if(F>=Q)if(F===Q)J[W]=H;else J[W]=H.slice(0,Q),K.numBatches=Math.max(K.numBatches,Z[W].unshift(H.slice(Q,F-Q)));else{let U=$[W];$[W]=U.clone({nullable:!0}),J[W]=(X=H===null||H===void 0?void 0:H._changeLengthAndBackfillNullBitmap(Q))!==null&&X!==void 0?X:(0,ew.makeData)({type:U.type,length:Q,nullCount:Q,nullBitmap:new Uint8Array(Y)})}}return J}});var D9=g((YS)=>{var XS;Object.defineProperty(YS,"__esModule",{value:!0});YS.tableFromArrays=YS.makeTable=YS.Table=void 0;var Lq=a1(),vq=A6(),co=_3(),n3=m0(),r7=e0(),ZS=p1(),lo=i3(),_q=JS(),a4=tQ(),po=b7(),uo=Y5(),io=eQ(),no=$J(),KS=q9(),C9=r4();class O5{constructor(...$){var Q,J;if($.length===0)return this.batches=[],this.schema=new r7.Schema([]),this._offsets=[0],this;let Z,K;if($[0]instanceof r7.Schema)Z=$.shift();if($.at(-1)instanceof Uint32Array)K=$.pop();let X=(W)=>{if(W){if(W instanceof C9.RecordBatch)return[W];else if(W instanceof O5)return W.batches;else if(W instanceof vq.Data){if(W.type instanceof ZS.Struct)return[new C9.RecordBatch(new r7.Schema(W.type.children),W)]}else if(Array.isArray(W))return W.flatMap((q)=>X(q));else if(typeof W[Symbol.iterator]==="function")return[...W].flatMap((q)=>X(q));else if(typeof W==="object"){let q=Object.keys(W),H=q.map((V)=>new n3.Vector([W[V]])),F=Z!==null&&Z!==void 0?Z:new r7.Schema(q.map((V,N)=>new r7.Field(String(V),H[N].type,H[N].nullable))),[,U]=(0,_q.distributeVectorsIntoRecordBatches)(F,H);return U.length===0?[new C9.RecordBatch(W)]:U}}return[]},Y=$.flatMap((W)=>X(W));if(Z=(J=Z!==null&&Z!==void 0?Z:(Q=Y[0])===null||Q===void 0?void 0:Q.schema)!==null&&J!==void 0?J:new r7.Schema([]),!(Z instanceof r7.Schema))throw TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let W of Y){if(!(W instanceof C9.RecordBatch))throw TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!(0,lo.compareSchemas)(Z,W.schema))throw TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=Z,this.batches=Y,this._offsets=K!==null&&K!==void 0?K:(0,a4.computeChunkOffsets)(this.data)}get data(){return this.batches.map(({data:$})=>$)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(($,Q)=>$+Q.length,0)}get nullCount(){if(this._nullCount===-1)this._nullCount=(0,a4.computeChunkNullCounts)(this.data);return this._nullCount}isValid($){return!1}get($){return null}at($){return this.get((0,KS.wrapIndex)($,this.numRows))}set($,Q){return}indexOf($,Q){return-1}[Symbol.iterator](){if(this.batches.length>0)return no.instance.visit(new n3.Vector(this.data));return[][Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...$){let Q=this.schema,J=this.data.concat($.flatMap(({data:Z})=>Z));return new O5(Q,J.map((Z)=>new C9.RecordBatch(Q,Z)))}slice($,Q){let J=this.schema;[$,Q]=(0,KS.clampRange)({length:this.numRows},$,Q);let Z=(0,a4.sliceChunks)(this.data,this._offsets,$,Q);return new O5(J,Z.map((K)=>new C9.RecordBatch(J,K)))}getChild($){return this.getChildAt(this.schema.fields.findIndex((Q)=>Q.name===$))}getChildAt($){if($>-1&&$<this.schema.fields.length){let Q=this.data.map((J)=>J.children[$]);if(Q.length===0){let{type:J}=this.schema.fields[$],Z=(0,vq.makeData)({type:J,length:0,nullCount:0});Q.push(Z._changeLengthAndBackfillNullBitmap(this.numRows))}return new n3.Vector(Q)}return null}setChild($,Q){var J;return this.setChildAt((J=this.schema.fields)===null||J===void 0?void 0:J.findIndex((Z)=>Z.name===$),Q)}setChildAt($,Q){let J=this.schema,Z=[...this.batches];if($>-1&&$<this.numCols){if(!Q)Q=new n3.Vector([(0,vq.makeData)({type:new ZS.Null,length:this.numRows})]);let K=J.fields.slice(),X=K[$].clone({type:Q.type}),Y=this.schema.fields.map((W,q)=>this.getChildAt(q));[K[$],Y[$]]=[X,Q],[J,Z]=(0,_q.distributeVectorsIntoRecordBatches)(J,Y)}return new O5(J,Z)}select($){let Q=this.schema.fields.reduce((J,Z,K)=>J.set(Z.name,K),new Map);return this.selectAt($.map((J)=>Q.get(J)).filter((J)=>J>-1))}selectAt($){let Q=this.schema.selectAt($),J=this.batches.map((Z)=>Z.selectAt($));return new O5(Q,J)}assign($){let Q=this.schema.fields,[J,Z]=$.schema.fields.reduce((Y,W,q)=>{let[H,F]=Y,U=Q.findIndex((V)=>V.name===W.name);return~U?F[U]=q:H.push(q),Y},[[],[]]),K=this.schema.assign($.schema),X=[...Q.map((Y,W)=>[W,Z[W]]).map(([Y,W])=>W===void 0?this.getChildAt(Y):$.getChildAt(W)),...J.map((Y)=>$.getChildAt(Y))].filter(Boolean);return new O5(...(0,_q.distributeVectorsIntoRecordBatches)(K,X))}}YS.Table=O5;XS=Symbol.toStringTag;O5[XS]=(($)=>{return $.schema=null,$.batches=[],$._offsets=new Uint32Array([0]),$._nullCount=-1,$[Symbol.isConcatSpreadable]=!0,$.isValid=(0,a4.wrapChunkedCall1)(a4.isChunkedValid),$.get=(0,a4.wrapChunkedCall1)(po.instance.getVisitFn(Lq.Type.Struct)),$.set=(0,a4.wrapChunkedCall2)(uo.instance.getVisitFn(Lq.Type.Struct)),$.indexOf=(0,a4.wrapChunkedIndexOf)(io.instance.getVisitFn(Lq.Type.Struct)),"Table"})(O5.prototype);function so($){let Q={},J=Object.entries($);for(let[Z,K]of J)Q[Z]=(0,n3.makeVector)(K);return new O5(Q)}YS.makeTable=so;function oo($){let Q={},J=Object.entries($);for(let[Z,K]of J)Q[Z]=(0,co.vectorFromArray)(K);return new O5(Q)}YS.tableFromArrays=oo});var r4=g((VS)=>{var HS;Object.defineProperty(VS,"__esModule",{value:!0});VS._InternalEmptyPlaceholderRecordBatch=VS.RecordBatch=void 0;var P5=A6(),to=D9(),CJ=m0(),AJ=e0(),$4=p1(),eo=q9(),$r=b7(),Qr=Y5(),Jr=eQ(),Zr=$J();class Q4{constructor(...$){switch($.length){case 2:{if([this.schema]=$,!(this.schema instanceof AJ.Schema))throw TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=(0,P5.makeData)({nullCount:0,type:new $4.Struct(this.schema.fields),children:this.schema.fields.map((Q)=>(0,P5.makeData)({type:Q.type,nullCount:0}))})]=$,!(this.data instanceof P5.Data))throw TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=qS(this.schema,this.data.children);break}case 1:{let[Q]=$,{fields:J,children:Z,length:K}=Object.keys(Q).reduce((W,q,H)=>{return W.children[H]=Q[q],W.length=Math.max(W.length,Q[q].length),W.fields[H]=AJ.Field.new({name:q,type:Q[q].type,nullable:!0}),W},{length:0,fields:[],children:[]}),X=new AJ.Schema(J),Y=(0,P5.makeData)({type:new $4.Struct(J),length:K,children:Z,nullCount:0});[this.schema,this.data]=qS(X,Y.children,K);break}default:throw TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=FS(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid($){return this.data.getValid($)}get($){return $r.instance.visit(this.data,$)}at($){return this.get((0,eo.wrapIndex)($,this.numRows))}set($,Q){return Qr.instance.visit(this.data,$,Q)}indexOf($,Q){return Jr.instance.visit(this.data,$,Q)}[Symbol.iterator](){return Zr.instance.visit(new CJ.Vector([this.data]))}toArray(){return[...this]}concat(...$){return new to.Table(this.schema,[this,...$])}slice($,Q){let[J]=new CJ.Vector([this.data]).slice($,Q).data;return new Q4(this.schema,J)}getChild($){var Q;return this.getChildAt((Q=this.schema.fields)===null||Q===void 0?void 0:Q.findIndex((J)=>J.name===$))}getChildAt($){if($>-1&&$<this.schema.fields.length)return new CJ.Vector([this.data.children[$]]);return null}setChild($,Q){var J;return this.setChildAt((J=this.schema.fields)===null||J===void 0?void 0:J.findIndex((Z)=>Z.name===$),Q)}setChildAt($,Q){let J=this.schema,Z=this.data;if($>-1&&$<this.numCols){if(!Q)Q=new CJ.Vector([(0,P5.makeData)({type:new $4.Null,length:this.numRows})]);let K=J.fields.slice(),X=Z.children.slice(),Y=K[$].clone({type:Q.type});[K[$],X[$]]=[Y,Q.data[0]],J=new AJ.Schema(K,new Map(this.schema.metadata)),Z=(0,P5.makeData)({type:new $4.Struct(K),children:X})}return new Q4(J,Z)}select($){let Q=this.schema.select($),J=new $4.Struct(Q.fields),Z=[];for(let K of $){let X=this.schema.fields.findIndex((Y)=>Y.name===K);if(~X)Z[X]=this.data.children[X]}return new Q4(Q,(0,P5.makeData)({type:J,length:this.numRows,children:Z}))}selectAt($){let Q=this.schema.selectAt($),J=$.map((K)=>this.data.children[K]).filter(Boolean),Z=(0,P5.makeData)({type:new $4.Struct(Q.fields),length:this.numRows,children:J});return new Q4(Q,Z)}}VS.RecordBatch=Q4;HS=Symbol.toStringTag;Q4[HS]=(($)=>{return $._nullCount=-1,$[Symbol.isConcatSpreadable]=!0,"RecordBatch"})(Q4.prototype);function qS($,Q,J=Q.reduce((Z,K)=>Math.max(Z,K.length),0)){var Z;let K=[...$.fields],X=[...Q],Y=(J+63&-64)>>3;for(let[W,q]of $.fields.entries()){let H=Q[W];if(!H||H.length!==J)K[W]=q.clone({nullable:!0}),X[W]=(Z=H===null||H===void 0?void 0:H._changeLengthAndBackfillNullBitmap(J))!==null&&Z!==void 0?Z:(0,P5.makeData)({type:q.type,length:J,nullCount:J,nullBitmap:new Uint8Array(Y)})}return[$.assign(K),(0,P5.makeData)({type:new $4.Struct(K),length:J,children:X})]}function FS($,Q,J=new Map){var Z,K;if(((Z=$===null||$===void 0?void 0:$.length)!==null&&Z!==void 0?Z:0)>0&&($===null||$===void 0?void 0:$.length)===(Q===null||Q===void 0?void 0:Q.length))for(let X=-1,Y=$.length;++X<Y;){let{type:W}=$[X],q=Q[X];for(let H of[q,...((K=q===null||q===void 0?void 0:q.dictionary)===null||K===void 0?void 0:K.data)||[]])FS(W.children,H===null||H===void 0?void 0:H.children,J);if($4.DataType.isDictionary(W)){let{id:H}=W;if(!J.has(H)){if(q===null||q===void 0?void 0:q.dictionary)J.set(H,q.dictionary)}else if(J.get(H)!==q.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id")}}return J}class US extends Q4{constructor($){let Q=$.fields.map((Z)=>(0,P5.makeData)({type:Z.type})),J=(0,P5.makeData)({type:new $4.Struct($.fields),nullCount:0,children:Q});super($,J)}}VS._InternalEmptyPlaceholderRecordBatch=US});var kS=g((AS)=>{Object.defineProperty(AS,"__esModule",{value:!0});AS.Message=void 0;var Xr=k1(),Yr=c8(),DS=IQ(),CS=QQ();class s5{constructor(){this.bb=null,this.bb_pos=0}__init($,Q){return this.bb_pos=$,this.bb=Q,this}static getRootAsMessage($,Q){return(Q||new s5).__init($.readInt32($.position())+$.position(),$)}static getSizePrefixedRootAsMessage($,Q){return $.setPosition($.position()+Xr.SIZE_PREFIX_LENGTH),(Q||new s5).__init($.readInt32($.position())+$.position(),$)}version(){let $=this.bb.__offset(this.bb_pos,4);return $?this.bb.readInt16(this.bb_pos+$):CS.MetadataVersion.V1}headerType(){let $=this.bb.__offset(this.bb_pos,6);return $?this.bb.readUint8(this.bb_pos+$):DS.MessageHeader.NONE}header($){let Q=this.bb.__offset(this.bb_pos,8);return Q?this.bb.__union($,this.bb_pos+Q):null}bodyLength(){let $=this.bb.__offset(this.bb_pos,10);return $?this.bb.readInt64(this.bb_pos+$):BigInt("0")}customMetadata($,Q){let J=this.bb.__offset(this.bb_pos,12);return J?(Q||new Yr.KeyValue).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+J)+$*4),this.bb):null}customMetadataLength(){let $=this.bb.__offset(this.bb_pos,12);return $?this.bb.__vector_len(this.bb_pos+$):0}static startMessage($){$.startObject(5)}static addVersion($,Q){$.addFieldInt16(0,Q,CS.MetadataVersion.V1)}static addHeaderType($,Q){$.addFieldInt8(1,Q,DS.MessageHeader.NONE)}static addHeader($,Q){$.addFieldOffset(2,Q,0)}static addBodyLength($,Q){$.addFieldInt64(3,Q,BigInt("0"))}static addCustomMetadata($,Q){$.addFieldOffset(4,Q,0)}static createCustomMetadataVector($,Q){$.startVector(4,Q.length,4);for(let J=Q.length-1;J>=0;J--)$.addOffset(Q[J]);return $.endVector()}static startCustomMetadataVector($,Q){$.startVector(4,Q,4)}static endMessage($){return $.endObject()}static finishMessageBuffer($,Q){$.finish(Q)}static finishSizePrefixedMessageBuffer($,Q){$.finish(Q,void 0,!0)}static createMessage($,Q,J,Z,K,X){return s5.startMessage($),s5.addVersion($,Q),s5.addHeaderType($,J),s5.addHeader($,Z),s5.addBodyLength($,K),s5.addCustomMetadata($,X),s5.endMessage($)}}AS.Message=s5});var ES=g((IS)=>{Object.defineProperty(IS,"__esModule",{value:!0});IS.instance=IS.TypeAssembler=void 0;var Wr=r0(),BS=LY(),zJ=L4(),xq=VQ(),RS=IY(),OS=EY(),PS=GY(),MS=_Y(),wS=jY(),s3=qQ(),gq=WQ(),kJ=CQ(),BJ=AQ(),yq=NQ(),fq=HQ(),SS=hY(),TS=vY(),A9=zQ(),o3=TY(),bq=FQ(),mq=UQ(),cq=DQ();class dq extends Wr.Visitor{visit($,Q){return $==null||Q==null?void 0:super.visit($,Q)}visitNull($,Q){return BS.Null.startNull(Q),BS.Null.endNull(Q)}visitInt($,Q){return zJ.Int.startInt(Q),zJ.Int.addBitWidth(Q,$.bitWidth),zJ.Int.addIsSigned(Q,$.isSigned),zJ.Int.endInt(Q)}visitFloat($,Q){return xq.FloatingPoint.startFloatingPoint(Q),xq.FloatingPoint.addPrecision(Q,$.precision),xq.FloatingPoint.endFloatingPoint(Q)}visitBinary($,Q){return RS.Binary.startBinary(Q),RS.Binary.endBinary(Q)}visitLargeBinary($,Q){return OS.LargeBinary.startLargeBinary(Q),OS.LargeBinary.endLargeBinary(Q)}visitBool($,Q){return PS.Bool.startBool(Q),PS.Bool.endBool(Q)}visitUtf8($,Q){return MS.Utf8.startUtf8(Q),MS.Utf8.endUtf8(Q)}visitLargeUtf8($,Q){return wS.LargeUtf8.startLargeUtf8(Q),wS.LargeUtf8.endLargeUtf8(Q)}visitDecimal($,Q){return s3.Decimal.startDecimal(Q),s3.Decimal.addScale(Q,$.scale),s3.Decimal.addPrecision(Q,$.precision),s3.Decimal.addBitWidth(Q,$.bitWidth),s3.Decimal.endDecimal(Q)}visitDate($,Q){return gq.Date.startDate(Q),gq.Date.addUnit(Q,$.unit),gq.Date.endDate(Q)}visitTime($,Q){return kJ.Time.startTime(Q),kJ.Time.addUnit(Q,$.unit),kJ.Time.addBitWidth(Q,$.bitWidth),kJ.Time.endTime(Q)}visitTimestamp($,Q){let J=$.timezone&&Q.createString($.timezone)||void 0;if(BJ.Timestamp.startTimestamp(Q),BJ.Timestamp.addUnit(Q,$.unit),J!==void 0)BJ.Timestamp.addTimezone(Q,J);return BJ.Timestamp.endTimestamp(Q)}visitInterval($,Q){return yq.Interval.startInterval(Q),yq.Interval.addUnit(Q,$.unit),yq.Interval.endInterval(Q)}visitDuration($,Q){return fq.Duration.startDuration(Q),fq.Duration.addUnit(Q,$.unit),fq.Duration.endDuration(Q)}visitList($,Q){return SS.List.startList(Q),SS.List.endList(Q)}visitStruct($,Q){return TS.Struct_.startStruct_(Q),TS.Struct_.endStruct_(Q)}visitUnion($,Q){A9.Union.startTypeIdsVector(Q,$.typeIds.length);let J=A9.Union.createTypeIdsVector(Q,$.typeIds);return A9.Union.startUnion(Q),A9.Union.addMode(Q,$.mode),A9.Union.addTypeIds(Q,J),A9.Union.endUnion(Q)}visitDictionary($,Q){let J=this.visit($.indices,Q);if(o3.DictionaryEncoding.startDictionaryEncoding(Q),o3.DictionaryEncoding.addId(Q,BigInt($.id)),o3.DictionaryEncoding.addIsOrdered(Q,$.isOrdered),J!==void 0)o3.DictionaryEncoding.addIndexType(Q,J);return o3.DictionaryEncoding.endDictionaryEncoding(Q)}visitFixedSizeBinary($,Q){return bq.FixedSizeBinary.startFixedSizeBinary(Q),bq.FixedSizeBinary.addByteWidth(Q,$.byteWidth),bq.FixedSizeBinary.endFixedSizeBinary(Q)}visitFixedSizeList($,Q){return mq.FixedSizeList.startFixedSizeList(Q),mq.FixedSizeList.addListSize(Q,$.listSize),mq.FixedSizeList.endFixedSizeList(Q)}visitMap($,Q){return cq.Map.startMap(Q),cq.Map.addKeysSorted(Q,$.keysSorted),cq.Map.endMap(Q)}}IS.TypeAssembler=dq;IS.instance=new dq});var fS=g((gS)=>{Object.defineProperty(gS,"__esModule",{value:!0});gS.fieldFromJSON=gS.dictionaryBatchFromJSON=gS.recordBatchFromJSON=gS.schemaFromJSON=void 0;var z9=e0(),m1=p1(),t7=e7(),a7=a1();function Hr($,Q=new Map){return new z9.Schema(Ur($,Q),RJ($.metadata),Q)}gS.schemaFromJSON=Hr;function vS($){return new t7.RecordBatch($.count,_S($.columns),xS($.columns))}gS.recordBatchFromJSON=vS;function Fr($){return new t7.DictionaryBatch(vS($.data),$.id,$.isDelta)}gS.dictionaryBatchFromJSON=Fr;function Ur($,Q){return($.fields||[]).filter(Boolean).map((J)=>z9.Field.fromJSON(J,Q))}function jS($,Q){return($.children||[]).filter(Boolean).map((J)=>z9.Field.fromJSON(J,Q))}function _S($){return($||[]).reduce((Q,J)=>[...Q,new t7.FieldNode(J.count,Vr(J.VALIDITY)),..._S(J.children)],[])}function xS($,Q=[]){for(let J=-1,Z=($||[]).length;++J<Z;){let K=$[J];K.VALIDITY&&Q.push(new t7.BufferRegion(Q.length,K.VALIDITY.length)),K.TYPE_ID&&Q.push(new t7.BufferRegion(Q.length,K.TYPE_ID.length)),K.OFFSET&&Q.push(new t7.BufferRegion(Q.length,K.OFFSET.length)),K.DATA&&Q.push(new t7.BufferRegion(Q.length,K.DATA.length)),Q=xS(K.children,Q)}return Q}function Vr($){return($||[]).reduce((Q,J)=>Q+ +(J===0),0)}function Nr($,Q){let J,Z,K,X,Y,W;if(!Q||!(X=$.dictionary))Y=LS($,jS($,Q)),K=new z9.Field($.name,Y,$.nullable,RJ($.metadata));else if(!Q.has(J=X.id))Z=(Z=X.indexType)?hS(Z):new m1.Int32,Q.set(J,Y=LS($,jS($,Q))),W=new m1.Dictionary(Y,Z,J,X.isOrdered),K=new z9.Field($.name,W,$.nullable,RJ($.metadata));else Z=(Z=X.indexType)?hS(Z):new m1.Int32,W=new m1.Dictionary(Q.get(J),Z,J,X.isOrdered),K=new z9.Field($.name,W,$.nullable,RJ($.metadata));return K||null}gS.fieldFromJSON=Nr;function RJ($=[]){return new Map($.map(({key:Q,value:J})=>[Q,J]))}function hS($){return new m1.Int($.isSigned,$.bitWidth)}function LS($,Q){let J=$.type.name;switch(J){case"NONE":return new m1.Null;case"null":return new m1.Null;case"binary":return new m1.Binary;case"largebinary":return new m1.LargeBinary;case"utf8":return new m1.Utf8;case"largeutf8":return new m1.LargeUtf8;case"bool":return new m1.Bool;case"list":return new m1.List((Q||[])[0]);case"struct":return new m1.Struct(Q||[]);case"struct_":return new m1.Struct(Q||[])}switch(J){case"int":{let Z=$.type;return new m1.Int(Z.isSigned,Z.bitWidth)}case"floatingpoint":{let Z=$.type;return new m1.Float(a7.Precision[Z.precision])}case"decimal":{let Z=$.type;return new m1.Decimal(Z.scale,Z.precision,Z.bitWidth)}case"date":{let Z=$.type;return new m1.Date_(a7.DateUnit[Z.unit])}case"time":{let Z=$.type;return new m1.Time(a7.TimeUnit[Z.unit],Z.bitWidth)}case"timestamp":{let Z=$.type;return new m1.Timestamp(a7.TimeUnit[Z.unit],Z.timezone)}case"interval":{let Z=$.type;return new m1.Interval(a7.IntervalUnit[Z.unit])}case"duration":{let Z=$.type;return new m1.Duration(a7.TimeUnit[Z.unit])}case"union":{let Z=$.type,[K,...X]=(Z.mode+"").toLowerCase(),Y=K.toUpperCase()+X.join("");return new m1.Union(a7.UnionMode[Y],Z.typeIds||[],Q||[])}case"fixedsizebinary":{let Z=$.type;return new m1.FixedSizeBinary(Z.byteWidth)}case"fixedsizelist":{let Z=$.type;return new m1.FixedSizeList(Z.listSize,(Q||[])[0])}case"map":{let Z=$.type;return new m1.Map_((Q||[])[0],Z.keysSorted)}}throw Error(`Unrecognized type: "${J}"`)}});var e7=g((pS)=>{Object.defineProperty(pS,"__esModule",{value:!0});pS.FieldNode=pS.BufferRegion=pS.DictionaryBatch=pS.RecordBatch=pS.Message=void 0;var lS=k1(),J4=BQ(),zr=L4(),e4=KQ(),k9=wY(),kr=j4(),o5=xY(),Br=MY(),Q0=t8(),$7=c8(),bS=SY(),Rr=VQ(),Or=qQ(),Pr=WQ(),Mr=CQ(),wr=AQ(),Sr=NQ(),Tr=HQ(),Ir=zQ(),Gr=FQ(),Er=UQ(),jr=DQ(),t4=kS(),B0=e0(),hr=z0(),Q7=f4(),t1=a1(),lq=ES(),PJ=fS(),Lr=lS.Builder,vr=lS.ByteBuffer,c1=p1();class $8{static fromJSON($,Q){let J=new $8(0,t1.MetadataVersion.V5,Q);return J._createHeader=_r($,Q),J}static decode($){$=new vr((0,hr.toUint8Array)($));let Q=t4.Message.getRootAsMessage($),J=Q.bodyLength(),Z=Q.version(),K=Q.headerType(),X=new $8(J,Z,K);return X._createHeader=xr(Q,K),X}static encode($){let Q=new Lr,J=-1;if($.isSchema())J=B0.Schema.encode(Q,$.header());else if($.isRecordBatch())J=M5.encode(Q,$.header());else if($.isDictionaryBatch())J=w6.encode(Q,$.header());return t4.Message.startMessage(Q),t4.Message.addVersion(Q,t1.MetadataVersion.V5),t4.Message.addHeader(Q,J),t4.Message.addHeaderType(Q,$.headerType),t4.Message.addBodyLength(Q,BigInt($.bodyLength)),t4.Message.finishMessageBuffer(Q,t4.Message.endMessage(Q)),Q.asUint8Array()}static from($,Q=0){if($ instanceof B0.Schema)return new $8(0,t1.MetadataVersion.V5,t1.MessageHeader.Schema,$);if($ instanceof M5)return new $8(Q,t1.MetadataVersion.V5,t1.MessageHeader.RecordBatch,$);if($ instanceof w6)return new $8(Q,t1.MetadataVersion.V5,t1.MessageHeader.DictionaryBatch,$);throw Error(`Unrecognized Message header: ${$}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===t1.MessageHeader.Schema}isRecordBatch(){return this.headerType===t1.MessageHeader.RecordBatch}isDictionaryBatch(){return this.headerType===t1.MessageHeader.DictionaryBatch}constructor($,Q,J,Z){this._version=Q,this._headerType=J,this.body=new Uint8Array(0),Z&&(this._createHeader=()=>Z),this._bodyLength=(0,Q7.bigIntToNumber)($)}}pS.Message=$8;class M5{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor($,Q,J){this._nodes=Q,this._buffers=J,this._length=(0,Q7.bigIntToNumber)($)}}pS.RecordBatch=M5;class w6{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor($,Q,J=!1){this._data=$,this._isDelta=J,this._id=(0,Q7.bigIntToNumber)(Q)}}pS.DictionaryBatch=w6;class Q8{constructor($,Q){this.offset=(0,Q7.bigIntToNumber)($),this.length=(0,Q7.bigIntToNumber)(Q)}}pS.BufferRegion=Q8;class J8{constructor($,Q){this.length=(0,Q7.bigIntToNumber)($),this.nullCount=(0,Q7.bigIntToNumber)(Q)}}pS.FieldNode=J8;function _r($,Q){return()=>{switch(Q){case t1.MessageHeader.Schema:return B0.Schema.fromJSON($);case t1.MessageHeader.RecordBatch:return M5.fromJSON($);case t1.MessageHeader.DictionaryBatch:return w6.fromJSON($)}throw Error(`Unrecognized Message type: { name: ${t1.MessageHeader[Q]}, type: ${Q} }`)}}function xr($,Q){return()=>{switch(Q){case t1.MessageHeader.Schema:return B0.Schema.decode($.header(new J4.Schema),new Map,$.version());case t1.MessageHeader.RecordBatch:return M5.decode($.header(new e4.RecordBatch),$.version());case t1.MessageHeader.DictionaryBatch:return w6.decode($.header(new k9.DictionaryBatch),$.version())}throw Error(`Unrecognized Message type: { name: ${t1.MessageHeader[Q]}, type: ${Q} }`)}}B0.Field.encode=ir;B0.Field.decode=pr;B0.Field.fromJSON=PJ.fieldFromJSON;B0.Schema.encode=ur;B0.Schema.decode=gr;B0.Schema.fromJSON=PJ.schemaFromJSON;M5.encode=nr;M5.decode=yr;M5.fromJSON=PJ.recordBatchFromJSON;w6.encode=sr;w6.decode=fr;w6.fromJSON=PJ.dictionaryBatchFromJSON;J8.encode=or;J8.decode=mr;Q8.encode=rr;Q8.decode=br;function gr($,Q=new Map,J=t1.MetadataVersion.V5){let Z=lr($,Q);return new B0.Schema(Z,OJ($),Q,J)}function yr($,Q=t1.MetadataVersion.V5){if($.compression()!==null)throw Error("Record batch compression not implemented");return new M5($.length(),cr($),dr($,Q))}function fr($,Q=t1.MetadataVersion.V5){return new w6(M5.decode($.data(),Q),$.id(),$.isDelta())}function br($){return new Q8($.offset(),$.length())}function mr($){return new J8($.length(),$.nullCount())}function cr($){let Q=[];for(let J,Z=-1,K=-1,X=$.nodesLength();++Z<X;)if(J=$.nodes(Z))Q[++K]=J8.decode(J);return Q}function dr($,Q){let J=[];for(let Z,K=-1,X=-1,Y=$.buffersLength();++K<Y;)if(Z=$.buffers(K)){if(Q<t1.MetadataVersion.V4)Z.bb_pos+=8*(K+1);J[++X]=Q8.decode(Z)}return J}function lr($,Q){let J=[];for(let Z,K=-1,X=-1,Y=$.fieldsLength();++K<Y;)if(Z=$.fields(K))J[++X]=B0.Field.decode(Z,Q);return J}function mS($,Q){let J=[];for(let Z,K=-1,X=-1,Y=$.childrenLength();++K<Y;)if(Z=$.children(K))J[++X]=B0.Field.decode(Z,Q);return J}function pr($,Q){let J,Z,K,X,Y,W;if(!Q||!(W=$.dictionary()))K=dS($,mS($,Q)),Z=new B0.Field($.name(),K,$.nullable(),OJ($));else if(!Q.has(J=(0,Q7.bigIntToNumber)(W.id())))X=(X=W.indexType())?cS(X):new c1.Int32,Q.set(J,K=dS($,mS($,Q))),Y=new c1.Dictionary(K,X,J,W.isOrdered()),Z=new B0.Field($.name(),Y,$.nullable(),OJ($));else X=(X=W.indexType())?cS(X):new c1.Int32,Y=new c1.Dictionary(Q.get(J),X,J,W.isOrdered()),Z=new B0.Field($.name(),Y,$.nullable(),OJ($));return Z||null}function OJ($){let Q=new Map;if($){for(let J,Z,K=-1,X=Math.trunc($.customMetadataLength());++K<X;)if((J=$.customMetadata(K))&&(Z=J.key())!=null)Q.set(Z,J.value())}return Q}function cS($){return new c1.Int($.isSigned(),$.bitWidth())}function dS($,Q){let J=$.typeType();switch(J){case Q0.Type.NONE:return new c1.Null;case Q0.Type.Null:return new c1.Null;case Q0.Type.Binary:return new c1.Binary;case Q0.Type.LargeBinary:return new c1.LargeBinary;case Q0.Type.Utf8:return new c1.Utf8;case Q0.Type.LargeUtf8:return new c1.LargeUtf8;case Q0.Type.Bool:return new c1.Bool;case Q0.Type.List:return new c1.List((Q||[])[0]);case Q0.Type.Struct_:return new c1.Struct(Q||[])}switch(J){case Q0.Type.Int:{let Z=$.type(new zr.Int);return new c1.Int(Z.isSigned(),Z.bitWidth())}case Q0.Type.FloatingPoint:{let Z=$.type(new Rr.FloatingPoint);return new c1.Float(Z.precision())}case Q0.Type.Decimal:{let Z=$.type(new Or.Decimal);return new c1.Decimal(Z.scale(),Z.precision(),Z.bitWidth())}case Q0.Type.Date:{let Z=$.type(new Pr.Date);return new c1.Date_(Z.unit())}case Q0.Type.Time:{let Z=$.type(new Mr.Time);return new c1.Time(Z.unit(),Z.bitWidth())}case Q0.Type.Timestamp:{let Z=$.type(new wr.Timestamp);return new c1.Timestamp(Z.unit(),Z.timezone())}case Q0.Type.Interval:{let Z=$.type(new Sr.Interval);return new c1.Interval(Z.unit())}case Q0.Type.Duration:{let Z=$.type(new Tr.Duration);return new c1.Duration(Z.unit())}case Q0.Type.Union:{let Z=$.type(new Ir.Union);return new c1.Union(Z.mode(),Z.typeIdsArray()||[],Q||[])}case Q0.Type.FixedSizeBinary:{let Z=$.type(new Gr.FixedSizeBinary);return new c1.FixedSizeBinary(Z.byteWidth())}case Q0.Type.FixedSizeList:{let Z=$.type(new Er.FixedSizeList);return new c1.FixedSizeList(Z.listSize(),(Q||[])[0])}case Q0.Type.Map:{let Z=$.type(new jr.Map);return new c1.Map_((Q||[])[0],Z.keysSorted())}}throw Error(`Unrecognized type: "${Q0.Type[J]}" (${J})`)}function ur($,Q){let J=Q.fields.map((X)=>B0.Field.encode($,X));J4.Schema.startFieldsVector($,J.length);let Z=J4.Schema.createFieldsVector($,J),K=!(Q.metadata&&Q.metadata.size>0)?-1:J4.Schema.createCustomMetadataVector($,[...Q.metadata].map(([X,Y])=>{let W=$.createString(`${X}`),q=$.createString(`${Y}`);return $7.KeyValue.startKeyValue($),$7.KeyValue.addKey($,W),$7.KeyValue.addValue($,q),$7.KeyValue.endKeyValue($)}));if(J4.Schema.startSchema($),J4.Schema.addFields($,Z),J4.Schema.addEndianness($,ar?bS.Endianness.Little:bS.Endianness.Big),K!==-1)J4.Schema.addCustomMetadata($,K);return J4.Schema.endSchema($)}function ir($,Q){let J=-1,Z=-1,K=-1,X=Q.type,Y=Q.typeId;if(!c1.DataType.isDictionary(X))Z=lq.instance.visit(X,$);else Y=X.dictionary.typeId,K=lq.instance.visit(X,$),Z=lq.instance.visit(X.dictionary,$);let W=(X.children||[]).map((F)=>B0.Field.encode($,F)),q=o5.Field.createChildrenVector($,W),H=!(Q.metadata&&Q.metadata.size>0)?-1:o5.Field.createCustomMetadataVector($,[...Q.metadata].map(([F,U])=>{let V=$.createString(`${F}`),N=$.createString(`${U}`);return $7.KeyValue.startKeyValue($),$7.KeyValue.addKey($,V),$7.KeyValue.addValue($,N),$7.KeyValue.endKeyValue($)}));if(Q.name)J=$.createString(Q.name);if(o5.Field.startField($),o5.Field.addType($,Z),o5.Field.addTypeType($,Y),o5.Field.addChildren($,q),o5.Field.addNullable($,!!Q.nullable),J!==-1)o5.Field.addName($,J);if(K!==-1)o5.Field.addDictionary($,K);if(H!==-1)o5.Field.addCustomMetadata($,H);return o5.Field.endField($)}function nr($,Q){let J=Q.nodes||[],Z=Q.buffers||[];e4.RecordBatch.startNodesVector($,J.length);for(let Y of J.slice().reverse())J8.encode($,Y);let K=$.endVector();e4.RecordBatch.startBuffersVector($,Z.length);for(let Y of Z.slice().reverse())Q8.encode($,Y);let X=$.endVector();return e4.RecordBatch.startRecordBatch($),e4.RecordBatch.addLength($,BigInt(Q.length)),e4.RecordBatch.addNodes($,K),e4.RecordBatch.addBuffers($,X),e4.RecordBatch.endRecordBatch($)}function sr($,Q){let J=M5.encode($,Q.data);return k9.DictionaryBatch.startDictionaryBatch($),k9.DictionaryBatch.addId($,BigInt(Q.id)),k9.DictionaryBatch.addIsDelta($,Q.isDelta),k9.DictionaryBatch.addData($,J),k9.DictionaryBatch.endDictionaryBatch($)}function or($,Q){return Br.FieldNode.createFieldNode($,BigInt(Q.length),BigInt(Q.nullCount))}function rr($,Q){return kr.Buffer.createBuffer($,BigInt(Q.offset),BigInt(Q.length))}var ar=(()=>{let $=new ArrayBuffer(2);return new DataView($).setInt16(0,256,!0),new Int16Array($)[0]===256})()});var SJ=g((tS)=>{Object.defineProperty(tS,"__esModule",{value:!0});tS.magicX2AndPadding=tS.magicAndPadding=tS.magicLength=tS.checkForMagicArrowString=tS.MAGIC=tS.MAGIC_STR=tS.PADDING=tS.JSONMessageReader=tS.AsyncMessageReader=tS.MessageReader=void 0;var J7=(s0(),J5(n0)),Z7=a1(),iS=k1(),r3=e7(),Ja=G4(),Za=vW(),nS=z0(),MJ=s4(),r5=h3(),pq=($)=>`Expected ${Z7.MessageHeader[$]} Message in stream, but was null or length 0.`,uq=($)=>`Header pointer of flatbuffer-encoded ${Z7.MessageHeader[$]} Message is null or length 0.`,sS=($,Q)=>`Expected to read ${$} metadata bytes, but only read ${Q}.`,oS=($,Q)=>`Expected to read ${$} bytes for message body, but only read ${Q}.`;class iq{constructor($){this.source=$ instanceof MJ.ByteStream?$:new MJ.ByteStream($)}[Symbol.iterator](){return this}next(){let $;if(($=this.readMetadataLength()).done)return r5.ITERATOR_DONE;if($.value===-1&&($=this.readMetadataLength()).done)return r5.ITERATOR_DONE;if(($=this.readMetadata($.value)).done)return r5.ITERATOR_DONE;return $}throw($){return this.source.throw($)}return($){return this.source.return($)}readMessage($){let Q;if((Q=this.next()).done)return null;if($!=null&&Q.value.headerType!==$)throw Error(pq($));return Q.value}readMessageBody($){if($<=0)return new Uint8Array(0);let Q=(0,nS.toUint8Array)(this.source.read($));if(Q.byteLength<$)throw Error(oS($,Q.byteLength));return Q.byteOffset%8===0&&Q.byteOffset+Q.byteLength<=Q.buffer.byteLength?Q:Q.slice()}readSchema($=!1){let Q=Z7.MessageHeader.Schema,J=this.readMessage(Q),Z=J===null||J===void 0?void 0:J.header();if($&&!Z)throw Error(uq(Q));return Z}readMetadataLength(){let $=this.source.read(tS.PADDING),Q=$&&new iS.ByteBuffer($),J=(Q===null||Q===void 0?void 0:Q.readInt32(0))||0;return{done:J===0,value:J}}readMetadata($){let Q=this.source.read($);if(!Q)return r5.ITERATOR_DONE;if(Q.byteLength<$)throw Error(sS($,Q.byteLength));return{done:!1,value:r3.Message.decode(Q)}}}tS.MessageReader=iq;class rS{constructor($,Q){this.source=$ instanceof MJ.AsyncByteStream?$:(0,Ja.isFileHandle)($)?new Za.AsyncRandomAccessFile($,Q):new MJ.AsyncByteStream($)}[Symbol.asyncIterator](){return this}next(){return J7.__awaiter(this,void 0,void 0,function*(){let $;if(($=yield this.readMetadataLength()).done)return r5.ITERATOR_DONE;if($.value===-1&&($=yield this.readMetadataLength()).done)return r5.ITERATOR_DONE;if(($=yield this.readMetadata($.value)).done)return r5.ITERATOR_DONE;return $})}throw($){return J7.__awaiter(this,void 0,void 0,function*(){return yield this.source.throw($)})}return($){return J7.__awaiter(this,void 0,void 0,function*(){return yield this.source.return($)})}readMessage($){return J7.__awaiter(this,void 0,void 0,function*(){let Q;if((Q=yield this.next()).done)return null;if($!=null&&Q.value.headerType!==$)throw Error(pq($));return Q.value})}readMessageBody($){return J7.__awaiter(this,void 0,void 0,function*(){if($<=0)return new Uint8Array(0);let Q=(0,nS.toUint8Array)(yield this.source.read($));if(Q.byteLength<$)throw Error(oS($,Q.byteLength));return Q.byteOffset%8===0&&Q.byteOffset+Q.byteLength<=Q.buffer.byteLength?Q:Q.slice()})}readSchema(){return J7.__awaiter(this,arguments,void 0,function*($=!1){let Q=Z7.MessageHeader.Schema,J=yield this.readMessage(Q),Z=J===null||J===void 0?void 0:J.header();if($&&!Z)throw Error(uq(Q));return Z})}readMetadataLength(){return J7.__awaiter(this,void 0,void 0,function*(){let $=yield this.source.read(tS.PADDING),Q=$&&new iS.ByteBuffer($),J=(Q===null||Q===void 0?void 0:Q.readInt32(0))||0;return{done:J===0,value:J}})}readMetadata($){return J7.__awaiter(this,void 0,void 0,function*(){let Q=yield this.source.read($);if(!Q)return r5.ITERATOR_DONE;if(Q.byteLength<$)throw Error(sS($,Q.byteLength));return{done:!1,value:r3.Message.decode(Q)}})}}tS.AsyncMessageReader=rS;class aS extends iq{constructor($){super(new Uint8Array(0));this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=$ instanceof r5.ArrowJSON?$:new r5.ArrowJSON($)}next(){let{_json:$}=this;if(!this._schema)return this._schema=!0,{done:!1,value:r3.Message.fromJSON($.schema,Z7.MessageHeader.Schema)};if(this._dictionaryIndex<$.dictionaries.length){let Q=$.dictionaries[this._dictionaryIndex++];return this._body=Q.data.columns,{done:!1,value:r3.Message.fromJSON(Q,Z7.MessageHeader.DictionaryBatch)}}if(this._batchIndex<$.batches.length){let Q=$.batches[this._batchIndex++];return this._body=Q.columns,{done:!1,value:r3.Message.fromJSON(Q,Z7.MessageHeader.RecordBatch)}}return this._body=[],r5.ITERATOR_DONE}readMessageBody($){return Q(this._body);function Q(J){return(J||[]).reduce((Z,K)=>[...Z,...K.VALIDITY&&[K.VALIDITY]||[],...K.TYPE_ID&&[K.TYPE_ID]||[],...K.OFFSET&&[K.OFFSET]||[],...K.DATA&&[K.DATA]||[],...Q(K.children)],[])}}readMessage($){let Q;if((Q=this.next()).done)return null;if($!=null&&Q.value.headerType!==$)throw Error(pq($));return Q.value}readSchema(){let $=Z7.MessageHeader.Schema,Q=this.readMessage($),J=Q===null||Q===void 0?void 0:Q.header();if(!Q||!J)throw Error(uq($));return J}}tS.JSONMessageReader=aS;tS.PADDING=4;tS.MAGIC_STR="ARROW1";tS.MAGIC=new Uint8Array(tS.MAGIC_STR.length);for(let $=0;$<tS.MAGIC_STR.length;$+=1)tS.MAGIC[$]=tS.MAGIC_STR.codePointAt($);function Ka($,Q=0){for(let J=-1,Z=tS.MAGIC.length;++J<Z;)if(tS.MAGIC[J]!==$[Q+J])return!1;return!0}tS.checkForMagicArrowString=Ka;tS.magicLength=tS.MAGIC.length;tS.magicAndPadding=tS.magicLength+tS.PADDING;tS.magicX2AndPadding=tS.magicLength*2+tS.PADDING});var J2=g((FT)=>{Object.defineProperty(FT,"__esModule",{value:!0});FT.AsyncRecordBatchFileReader=FT.RecordBatchFileReader=FT.AsyncRecordBatchStreamReader=FT.RecordBatchStreamReader=FT.RecordBatchReader=void 0;var d1=(s0(),J5(n0)),Fa=A6(),$T=m0(),Ua=p1(),TJ=a1(),XT=GW(),QT=R3(),JT=s4(),e3=vW(),YT=jM(),sq=r4(),Z8=h3(),S5=SJ(),w5=G4();class Z4 extends Z8.ReadableInterop{constructor($){super();this._impl=$}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw($){return this._impl.throw($)}return($){return this._impl.return($)}cancel(){return this._impl.cancel()}reset($){return this._impl.reset($),this._DOMStream=void 0,this._nodeStream=void 0,this}open($){let Q=this._impl.open($);return(0,w5.isPromise)(Q)?Q.then(()=>this):this}readRecordBatch($){return this._impl.isFile()?this._impl.readRecordBatch($):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return QT.default.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return QT.default.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode($){throw Error('"throughNode" not available in this environment')}static throughDOM($,Q){throw Error('"throughDOM" not available in this environment')}static from($){if($ instanceof Z4)return $;else if((0,w5.isArrowJSON)($))return Va($);else if((0,w5.isFileHandle)($))return Ca($);else if((0,w5.isPromise)($))return(()=>d1.__awaiter(this,void 0,void 0,function*(){return yield Z4.from(yield $)}))();else if((0,w5.isFetchResponse)($)||(0,w5.isReadableDOMStream)($)||(0,w5.isReadableNodeStream)($)||(0,w5.isAsyncIterable)($))return Da(new JT.AsyncByteStream($));return Na(new JT.ByteStream($))}static readAll($){if($ instanceof Z4)return $.isSync()?ZT($):KT($);else if((0,w5.isArrowJSON)($)||ArrayBuffer.isView($)||(0,w5.isIterable)($)||(0,w5.isIteratorResult)($))return ZT($);return KT($)}}FT.RecordBatchReader=Z4;class B9 extends Z4{constructor($){super($);this._impl=$}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return d1.__asyncGenerator(this,arguments,function*(){yield d1.__await(yield*d1.__asyncDelegator(d1.__asyncValues(this[Symbol.iterator]())))})}}FT.RecordBatchStreamReader=B9;class R9 extends Z4{constructor($){super($);this._impl=$}readAll(){return d1.__awaiter(this,void 0,void 0,function*(){var $,Q,J,Z;let K=[];try{for(var X=!0,Y=d1.__asyncValues(this),W;W=yield Y.next(),$=W.done,!$;X=!0){Z=W.value,X=!1;let q=Z;K.push(q)}}catch(q){Q={error:q}}finally{try{if(!X&&!$&&(J=Y.return))yield J.call(Y)}finally{if(Q)throw Q.error}}return K})}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}FT.AsyncRecordBatchStreamReader=R9;class IJ extends B9{constructor($){super($);this._impl=$}}FT.RecordBatchFileReader=IJ;class oq extends R9{constructor($){super($);this._impl=$}}FT.AsyncRecordBatchFileReader=oq;class rq{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor($=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=$}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset($){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=$,this.dictionaries=new Map,this}_loadRecordBatch($,Q){let J=this._loadVectors($,Q,this.schema.fields),Z=(0,Fa.makeData)({type:new Ua.Struct(this.schema.fields),length:$.length,children:J});return new sq.RecordBatch(this.schema,Z)}_loadDictionaryBatch($,Q){let{id:J,isDelta:Z}=$,{dictionaries:K,schema:X}=this,Y=K.get(J),W=X.dictionaries.get(J),q=this._loadVectors($.data,Q,[W]);return(Y&&Z?Y.concat(new $T.Vector(q)):new $T.Vector(q)).memoize()}_loadVectors($,Q,J){return new YT.VectorLoader(Q,$.nodes,$.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(J)}}class $2 extends rq{constructor($,Q){super(Q);this._reader=!(0,w5.isArrowJSON)($)?new S5.MessageReader(this._handle=$):new S5.JSONMessageReader(this._handle=$)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){if(!this.closed&&(this.closed=!0))this.reset()._reader.return(),this._reader=null,this.dictionaries=null}open($){if(!this.closed){if(this.autoDestroy=HT(this,$),!(this.schema||(this.schema=this._reader.readSchema())))this.cancel()}return this}throw($){if(!this.closed&&this.autoDestroy&&(this.closed=!0))return this.reset()._reader.throw($);return Z8.ITERATOR_DONE}return($){if(!this.closed&&this.autoDestroy&&(this.closed=!0))return this.reset()._reader.return($);return Z8.ITERATOR_DONE}next(){if(this.closed)return Z8.ITERATOR_DONE;let $,{_reader:Q}=this;while($=this._readNextMessageAndValidate())if($.isSchema())this.reset($.header());else if($.isRecordBatch()){this._recordBatchIndex++;let J=$.header(),Z=Q.readMessageBody($.bodyLength);return{done:!1,value:this._loadRecordBatch(J,Z)}}else if($.isDictionaryBatch()){this._dictionaryIndex++;let J=$.header(),Z=Q.readMessageBody($.bodyLength),K=this._loadDictionaryBatch(J,Z);this.dictionaries.set(J.id,K)}if(this.schema&&this._recordBatchIndex===0)return this._recordBatchIndex++,{done:!1,value:new sq._InternalEmptyPlaceholderRecordBatch(this.schema)};return this.return()}_readNextMessageAndValidate($){return this._reader.readMessage($)}}class Q2 extends rq{constructor($,Q){super(Q);this._reader=new S5.AsyncMessageReader(this._handle=$)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return d1.__awaiter(this,void 0,void 0,function*(){if(!this.closed&&(this.closed=!0))yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null})}open($){return d1.__awaiter(this,void 0,void 0,function*(){if(!this.closed){if(this.autoDestroy=HT(this,$),!(this.schema||(this.schema=yield this._reader.readSchema())))yield this.cancel()}return this})}throw($){return d1.__awaiter(this,void 0,void 0,function*(){if(!this.closed&&this.autoDestroy&&(this.closed=!0))return yield this.reset()._reader.throw($);return Z8.ITERATOR_DONE})}return($){return d1.__awaiter(this,void 0,void 0,function*(){if(!this.closed&&this.autoDestroy&&(this.closed=!0))return yield this.reset()._reader.return($);return Z8.ITERATOR_DONE})}next(){return d1.__awaiter(this,void 0,void 0,function*(){if(this.closed)return Z8.ITERATOR_DONE;let $,{_reader:Q}=this;while($=yield this._readNextMessageAndValidate())if($.isSchema())yield this.reset($.header());else if($.isRecordBatch()){this._recordBatchIndex++;let J=$.header(),Z=yield Q.readMessageBody($.bodyLength);return{done:!1,value:this._loadRecordBatch(J,Z)}}else if($.isDictionaryBatch()){this._dictionaryIndex++;let J=$.header(),Z=yield Q.readMessageBody($.bodyLength),K=this._loadDictionaryBatch(J,Z);this.dictionaries.set(J.id,K)}if(this.schema&&this._recordBatchIndex===0)return this._recordBatchIndex++,{done:!1,value:new sq._InternalEmptyPlaceholderRecordBatch(this.schema)};return yield this.return()})}_readNextMessageAndValidate($){return d1.__awaiter(this,void 0,void 0,function*(){return yield this._reader.readMessage($)})}}class aq extends $2{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor($,Q){super($ instanceof e3.RandomAccessFile?$:new e3.RandomAccessFile($),Q)}isSync(){return!0}isFile(){return!0}open($){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let Q of this._footer.dictionaryBatches())Q&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open($)}readRecordBatch($){var Q;if(this.closed)return null;if(!this._footer)this.open();let J=(Q=this._footer)===null||Q===void 0?void 0:Q.getRecordBatch($);if(J&&this._handle.seek(J.offset)){let Z=this._reader.readMessage(TJ.MessageHeader.RecordBatch);if(Z===null||Z===void 0?void 0:Z.isRecordBatch()){let K=Z.header(),X=this._reader.readMessageBody(Z.bodyLength);return this._loadRecordBatch(K,X)}}return null}_readDictionaryBatch($){var Q;let J=(Q=this._footer)===null||Q===void 0?void 0:Q.getDictionaryBatch($);if(J&&this._handle.seek(J.offset)){let Z=this._reader.readMessage(TJ.MessageHeader.DictionaryBatch);if(Z===null||Z===void 0?void 0:Z.isDictionaryBatch()){let K=Z.header(),X=this._reader.readMessageBody(Z.bodyLength),Y=this._loadDictionaryBatch(K,X);this.dictionaries.set(K.id,Y)}}}_readFooter(){let{_handle:$}=this,Q=$.size-S5.magicAndPadding,J=$.readInt32(Q),Z=$.readAt(Q-J,J);return XT.Footer.decode(Z)}_readNextMessageAndValidate($){var Q;if(!this._footer)this.open();if(this._footer&&this._recordBatchIndex<this.numRecordBatches){let J=(Q=this._footer)===null||Q===void 0?void 0:Q.getRecordBatch(this._recordBatchIndex);if(J&&this._handle.seek(J.offset))return this._reader.readMessage($)}return null}}class WT extends Q2{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor($,...Q){let J=typeof Q[0]!=="number"?Q.shift():void 0,Z=Q[0]instanceof Map?Q.shift():void 0;super($ instanceof e3.AsyncRandomAccessFile?$:new e3.AsyncRandomAccessFile($,J),Z)}isFile(){return!0}isAsync(){return!0}open($){let Q=Object.create(null,{open:{get:()=>super.open}});return d1.__awaiter(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let J of this._footer.dictionaryBatches())J&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield Q.open.call(this,$)})}readRecordBatch($){return d1.__awaiter(this,void 0,void 0,function*(){var Q;if(this.closed)return null;if(!this._footer)yield this.open();let J=(Q=this._footer)===null||Q===void 0?void 0:Q.getRecordBatch($);if(J&&(yield this._handle.seek(J.offset))){let Z=yield this._reader.readMessage(TJ.MessageHeader.RecordBatch);if(Z===null||Z===void 0?void 0:Z.isRecordBatch()){let K=Z.header(),X=yield this._reader.readMessageBody(Z.bodyLength);return this._loadRecordBatch(K,X)}}return null})}_readDictionaryBatch($){return d1.__awaiter(this,void 0,void 0,function*(){var Q;let J=(Q=this._footer)===null||Q===void 0?void 0:Q.getDictionaryBatch($);if(J&&(yield this._handle.seek(J.offset))){let Z=yield this._reader.readMessage(TJ.MessageHeader.DictionaryBatch);if(Z===null||Z===void 0?void 0:Z.isDictionaryBatch()){let K=Z.header(),X=yield this._reader.readMessageBody(Z.bodyLength),Y=this._loadDictionaryBatch(K,X);this.dictionaries.set(K.id,Y)}}})}_readFooter(){return d1.__awaiter(this,void 0,void 0,function*(){let{_handle:$}=this;$._pending&&(yield $._pending);let Q=$.size-S5.magicAndPadding,J=yield $.readInt32(Q),Z=yield $.readAt(Q-J,J);return XT.Footer.decode(Z)})}_readNextMessageAndValidate($){return d1.__awaiter(this,void 0,void 0,function*(){if(!this._footer)yield this.open();if(this._footer&&this._recordBatchIndex<this.numRecordBatches){let Q=this._footer.getRecordBatch(this._recordBatchIndex);if(Q&&(yield this._handle.seek(Q.offset)))return yield this._reader.readMessage($)}return null})}}class qT extends $2{constructor($,Q){super($,Q)}_loadVectors($,Q,J){return new YT.JSONVectorLoader(Q,$.nodes,$.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(J)}}function HT($,Q){return Q&&typeof Q.autoDestroy==="boolean"?Q.autoDestroy:$.autoDestroy}function*ZT($){let Q=Z4.from($);try{if(!Q.open({autoDestroy:!1}).closed)do yield Q;while(!Q.reset().open().closed)}finally{Q.cancel()}}function KT($){return d1.__asyncGenerator(this,arguments,function*(){let J=yield d1.__await(Z4.from($));try{if(!(yield d1.__await(J.open({autoDestroy:!1}))).closed)do yield yield d1.__await(J);while(!(yield d1.__await(J.reset().open())).closed)}finally{yield d1.__await(J.cancel())}})}function Va($){return new B9(new qT($))}function Na($){let Q=$.peek(S5.magicLength+7&-8);return Q&&Q.byteLength>=4?!(0,S5.checkForMagicArrowString)(Q)?new B9(new $2($)):new IJ(new aq($.read())):new B9(new $2(function*(){}()))}function Da($){return d1.__awaiter(this,void 0,void 0,function*(){let Q=yield $.peek(S5.magicLength+7&-8);return Q&&Q.byteLength>=4?!(0,S5.checkForMagicArrowString)(Q)?new R9(new Q2($)):new IJ(new aq(yield $.read())):new R9(new Q2(function(){return d1.__asyncGenerator(this,arguments,function*(){})}()))})}function Ca($){return d1.__awaiter(this,void 0,void 0,function*(){let{size:Q}=yield $.stat(),J=new e3.AsyncRandomAccessFile($,Q);if(Q>=S5.magicX2AndPadding&&(0,S5.checkForMagicArrowString)(yield J.readAt(0,S5.magicLength+7&-8)))return new oq(new WT(J));return new R9(new Q2(J))})}});var zT=g((CT)=>{Object.defineProperty(CT,"__esModule",{value:!0});CT.VectorAssembler=void 0;var Ra=m0(),Oa=r0(),VT=a1(),Pa=r4(),DT=z0(),eq=p7(),$H=e7(),tq=p1(),NT=f4();class J0 extends Oa.Visitor{static assemble(...$){let Q=(Z)=>Z.flatMap((K)=>Array.isArray(K)?Q(K):K instanceof Pa.RecordBatch?K.data.children:K.data),J=new J0;return J.visitMany(Q($)),J}constructor(){super();this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit($){if($ instanceof Ra.Vector)return this.visitMany($.data),this;let{type:Q}=$;if(!tq.DataType.isDictionary(Q)){let{length:J}=$;if(J>2147483647)throw RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(tq.DataType.isUnion(Q))this.nodes.push(new $H.FieldNode(J,0));else{let{nullCount:Z}=$;if(!tq.DataType.isNull(Q))a5.call(this,Z<=0?new Uint8Array(0):(0,eq.truncateBitmap)($.offset,J,$.nullBitmap));this.nodes.push(new $H.FieldNode(J,Z))}}return super.visit($)}visitNull($){return this}visitDictionary($){return this.visit($.clone($.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}CT.VectorAssembler=J0;function a5($){let Q=$.byteLength+7&-8;return this.buffers.push($),this.bufferRegions.push(new $H.BufferRegion(this._byteLength,Q)),this._byteLength+=Q,this}function Ma($){var Q;let{type:J,length:Z,typeIds:K,valueOffsets:X}=$;if(a5.call(this,K),J.mode===VT.UnionMode.Sparse)return QH.call(this,$);else if(J.mode===VT.UnionMode.Dense)if($.offset<=0)return a5.call(this,X),QH.call(this,$);else{let Y=new Int32Array(Z),W=Object.create(null),q=Object.create(null);for(let H,F,U=-1;++U<Z;){if((H=K[U])===void 0)continue;if((F=W[H])===void 0)F=W[H]=X[U];Y[U]=X[U]-F,q[H]=((Q=q[H])!==null&&Q!==void 0?Q:0)+1}a5.call(this,Y),this.visitMany($.children.map((H,F)=>{let U=J.typeIds[F],V=W[U],N=q[U];return H.slice(V,Math.min(Z,N))}))}return this}function wa($){let Q;if($.nullCount>=$.length)return a5.call(this,new Uint8Array(0));else if((Q=$.values)instanceof Uint8Array)return a5.call(this,(0,eq.truncateBitmap)($.offset,$.length,Q));return a5.call(this,(0,eq.packBools)($.values))}function K4($){return a5.call(this,$.values.subarray(0,$.length*$.stride))}function GJ($){let{length:Q,values:J,valueOffsets:Z}=$,K=(0,NT.bigIntToNumber)(Z[0]),X=(0,NT.bigIntToNumber)(Z[Q]),Y=Math.min(X-K,J.byteLength-K);return a5.call(this,(0,DT.rebaseValueOffsets)(-K,Q+1,Z)),a5.call(this,J.subarray(K,K+Y)),this}function JH($){let{length:Q,valueOffsets:J}=$;if(J){let{[0]:Z,[Q]:K}=J;return a5.call(this,(0,DT.rebaseValueOffsets)(-Z,Q+1,J)),this.visit($.children[0].slice(Z,K-Z))}return this.visit($.children[0])}function QH($){return this.visitMany($.type.children.map((Q,J)=>$.children[J]).filter(Boolean))[0]}J0.prototype.visitBool=wa;J0.prototype.visitInt=K4;J0.prototype.visitFloat=K4;J0.prototype.visitUtf8=GJ;J0.prototype.visitLargeUtf8=GJ;J0.prototype.visitBinary=GJ;J0.prototype.visitLargeBinary=GJ;J0.prototype.visitFixedSizeBinary=K4;J0.prototype.visitDate=K4;J0.prototype.visitTimestamp=K4;J0.prototype.visitTime=K4;J0.prototype.visitDecimal=K4;J0.prototype.visitList=JH;J0.prototype.visitStruct=QH;J0.prototype.visitUnion=Ma;J0.prototype.visitInterval=K4;J0.prototype.visitDuration=K4;J0.prototype.visitFixedSizeList=JH;J0.prototype.visitMap=JH});var OT=g((BT)=>{Object.defineProperty(BT,"__esModule",{value:!0});BT.JSONTypeAssembler=void 0;var Sa=r0(),V0=t8(),K8=a1();class kT extends Sa.Visitor{visit($){return $==null?void 0:super.visit($)}visitNull({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitInt({typeId:$,bitWidth:Q,isSigned:J}){return{name:V0.Type[$].toLowerCase(),bitWidth:Q,isSigned:J}}visitFloat({typeId:$,precision:Q}){return{name:V0.Type[$].toLowerCase(),precision:K8.Precision[Q]}}visitBinary({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitLargeBinary({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitBool({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitUtf8({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitLargeUtf8({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitDecimal({typeId:$,scale:Q,precision:J,bitWidth:Z}){return{name:V0.Type[$].toLowerCase(),scale:Q,precision:J,bitWidth:Z}}visitDate({typeId:$,unit:Q}){return{name:V0.Type[$].toLowerCase(),unit:K8.DateUnit[Q]}}visitTime({typeId:$,unit:Q,bitWidth:J}){return{name:V0.Type[$].toLowerCase(),unit:K8.TimeUnit[Q],bitWidth:J}}visitTimestamp({typeId:$,timezone:Q,unit:J}){return{name:V0.Type[$].toLowerCase(),unit:K8.TimeUnit[J],timezone:Q}}visitInterval({typeId:$,unit:Q}){return{name:V0.Type[$].toLowerCase(),unit:K8.IntervalUnit[Q]}}visitDuration({typeId:$,unit:Q}){return{name:V0.Type[$].toLocaleLowerCase(),unit:K8.TimeUnit[Q]}}visitList({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitStruct({typeId:$}){return{name:V0.Type[$].toLowerCase()}}visitUnion({typeId:$,mode:Q,typeIds:J}){return{name:V0.Type[$].toLowerCase(),mode:K8.UnionMode[Q].toUpperCase(),typeIds:[...J]}}visitDictionary($){return this.visit($.dictionary)}visitFixedSizeBinary({typeId:$,byteWidth:Q}){return{name:V0.Type[$].toLowerCase(),byteWidth:Q}}visitFixedSizeList({typeId:$,listSize:Q}){return{name:V0.Type[$].toLowerCase(),listSize:Q}}visitMap({typeId:$,keysSorted:Q}){return{name:V0.Type[$].toLowerCase(),keysSorted:Q}}}BT.JSONTypeAssembler=kT});var wT=g((PT)=>{Object.defineProperty(PT,"__esModule",{value:!0});PT.JSONVectorAssembler=void 0;var Ta=jQ(),Z2=m0(),Ia=r0(),Ga=a1(),ZH=a1(),EJ=p7(),KH=p1();class YH extends Ia.Visitor{static assemble(...$){let Q=new YH;return $.map(({schema:J,data:Z})=>{return Q.visitMany(J.fields,Z.children)})}visit({name:$},Q){let{length:J}=Q,{offset:Z,nullCount:K,nullBitmap:X}=Q,Y=KH.DataType.isDictionary(Q.type)?Q.type.indices:Q.type,W=Object.assign([],Q.buffers,{[Ga.BufferType.VALIDITY]:void 0});return Object.assign({name:$,count:J,VALIDITY:KH.DataType.isNull(Y)||KH.DataType.isUnion(Y)?void 0:K<=0?Array.from({length:J},()=>1):[...new EJ.BitIterator(X,Z,J,null,EJ.getBit)]},super.visit(Q.clone(Y,Z,J,0,W)))}visitNull(){return{}}visitBool({values:$,offset:Q,length:J}){return{DATA:[...new EJ.BitIterator($,Q,J,null,EJ.getBool)]}}visitInt($){return{DATA:$.type.bitWidth<64?[...$.values]:[...K7($.values,2)]}}visitFloat($){return{DATA:[...$.values]}}visitUtf8($){return{DATA:[...new Z2.Vector([$])],OFFSET:[...$.valueOffsets]}}visitLargeUtf8($){return{DATA:[...new Z2.Vector([$])],OFFSET:[...K7($.valueOffsets,2)]}}visitBinary($){return{DATA:[...XH(new Z2.Vector([$]))],OFFSET:[...$.valueOffsets]}}visitLargeBinary($){return{DATA:[...XH(new Z2.Vector([$]))],OFFSET:[...K7($.valueOffsets,2)]}}visitFixedSizeBinary($){return{DATA:[...XH(new Z2.Vector([$]))]}}visitDate($){return{DATA:$.type.unit===ZH.DateUnit.DAY?[...$.values]:[...K7($.values,2)]}}visitTimestamp($){return{DATA:[...K7($.values,2)]}}visitTime($){return{DATA:$.type.unit<ZH.TimeUnit.MICROSECOND?[...$.values]:[...K7($.values,2)]}}visitDecimal($){return{DATA:[...K7($.values,4)]}}visitList($){return{OFFSET:[...$.valueOffsets],children:this.visitMany($.type.children,$.children)}}visitStruct($){return{children:this.visitMany($.type.children,$.children)}}visitUnion($){return{TYPE_ID:[...$.typeIds],OFFSET:$.type.mode===ZH.UnionMode.Dense?[...$.valueOffsets]:void 0,children:this.visitMany($.type.children,$.children)}}visitInterval($){return{DATA:[...$.values]}}visitDuration($){return{DATA:[...K7($.values,2)]}}visitFixedSizeList($){return{children:this.visitMany($.type.children,$.children)}}visitMap($){return{OFFSET:[...$.valueOffsets],children:this.visitMany($.type.children,$.children)}}}PT.JSONVectorAssembler=YH;function*XH($){for(let Q of $)yield Q.reduce((J,Z)=>{return`${J}${("0"+(Z&255).toString(16)).slice(-2)}`},"").toUpperCase()}function*K7($,Q){let J=new Uint32Array($.buffer);for(let Z=-1,K=J.length/Q;++Z<K;)yield`${Ta.BN.new(J.subarray((Z+0)*Q,(Z+1)*Q),!1)}`}});var LJ=g((jT)=>{Object.defineProperty(jT,"__esModule",{value:!0});jT.RecordBatchJSONWriter=jT.RecordBatchFileWriter=jT.RecordBatchStreamWriter=jT.RecordBatchWriter=void 0;var ST=(s0(),J5(n0)),HH=D9(),Ea=SJ(),ja=m0(),ha=p1(),jJ=e7(),WH=e7(),O9=GW(),FH=a1(),TT=i3(),qH=s4(),IT=zT(),La=OT(),GT=wT(),va=z0(),hJ=r4(),_a=h3(),S6=G4();class K2 extends _a.ReadableInterop{static throughNode($){throw Error('"throughNode" not available in this environment')}static throughDOM($,Q){throw Error('"throughDOM" not available in this environment')}constructor($){super();this._position=0,this._started=!1,this._sink=new qH.AsyncByteQueue,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,(0,S6.isObject)($)||($={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof $.autoDestroy==="boolean"?$.autoDestroy:!0,this._writeLegacyIpcFormat=typeof $.writeLegacyIpcFormat==="boolean"?$.writeLegacyIpcFormat:!1}toString($=!1){return this._sink.toString($)}toUint8Array($=!1){return this._sink.toUint8Array($)}writeAll($){if((0,S6.isPromise)($))return $.then((Q)=>this.writeAll(Q));else if((0,S6.isAsyncIterable)($))return CH(this,$);return DH(this,$)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream($){return this._sink.toDOMStream($)}toNodeStream($){return this._sink.toNodeStream($)}close(){return this.reset()._sink.close()}abort($){return this.reset()._sink.abort($)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset($=this._sink,Q=null){if($===this._sink||$ instanceof qH.AsyncByteQueue)this._sink=$;else if(this._sink=new qH.AsyncByteQueue,$&&(0,S6.isWritableDOMStream)($))this.toDOMStream({type:"bytes"}).pipeTo($);else if($&&(0,S6.isWritableNodeStream)($))this.toNodeStream({objectMode:!1}).pipe($);if(this._started&&this._schema)this._writeFooter(this._schema);if(this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,!Q||!(0,TT.compareSchemas)(Q,this._schema))if(Q==null)this._position=0,this._schema=null;else this._started=!0,this._schema=Q,this._writeSchema(Q);return this}write($){let Q=null;if(!this._sink)throw Error("RecordBatchWriter is closed");else if($==null)return this.finish()&&void 0;else if($ instanceof HH.Table&&!(Q=$.schema))return this.finish()&&void 0;else if($ instanceof hJ.RecordBatch&&!(Q=$.schema))return this.finish()&&void 0;if(Q&&!(0,TT.compareSchemas)(Q,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,Q)}if($ instanceof hJ.RecordBatch){if(!($ instanceof hJ._InternalEmptyPlaceholderRecordBatch))this._writeRecordBatch($)}else if($ instanceof HH.Table)this.writeAll($.batches);else if((0,S6.isIterable)($))this.writeAll($)}_writeMessage($,Q=8){let J=Q-1,Z=jJ.Message.encode($),K=Z.byteLength,X=!this._writeLegacyIpcFormat?8:4,Y=K+X+J&~J,W=Y-K-X;if($.headerType===FH.MessageHeader.RecordBatch)this._recordBatchBlocks.push(new O9.FileBlock(Y,$.bodyLength,this._position));else if($.headerType===FH.MessageHeader.DictionaryBatch)this._dictionaryBlocks.push(new O9.FileBlock(Y,$.bodyLength,this._position));if(!this._writeLegacyIpcFormat)this._write(Int32Array.of(-1));if(this._write(Int32Array.of(Y-X)),K>0)this._write(Z);return this._writePadding(W)}_write($){if(this._started){let Q=(0,va.toUint8Array)($);if(Q&&Q.byteLength>0)this._sink.write(Q),this._position+=Q.byteLength}return this}_writeSchema($){return this._writeMessage(jJ.Message.from($))}_writeFooter($){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Ea.MAGIC)}_writePadding($){return $>0?this._write(new Uint8Array($)):this}_writeRecordBatch($){let{byteLength:Q,nodes:J,bufferRegions:Z,buffers:K}=IT.VectorAssembler.assemble($),X=new WH.RecordBatch($.numRows,J,Z),Y=jJ.Message.from(X,Q);return this._writeDictionaries($)._writeMessage(Y)._writeBodyBuffers(K)}_writeDictionaryBatch($,Q,J=!1){let{byteLength:Z,nodes:K,bufferRegions:X,buffers:Y}=IT.VectorAssembler.assemble(new ja.Vector([$])),W=new WH.RecordBatch($.length,K,X),q=new WH.DictionaryBatch(W,Q,J),H=jJ.Message.from(q,Z);return this._writeMessage(H)._writeBodyBuffers(Y)}_writeBodyBuffers($){let Q,J,Z;for(let K=-1,X=$.length;++K<X;)if((Q=$[K])&&(J=Q.byteLength)>0){if(this._write(Q),(Z=(J+7&-8)-J)>0)this._writePadding(Z)}return this}_writeDictionaries($){var Q,J;for(let[Z,K]of $.dictionaries){let X=(Q=K===null||K===void 0?void 0:K.data)!==null&&Q!==void 0?Q:[],Y=this._seenDictionaries.get(Z),W=(J=this._dictionaryDeltaOffsets.get(Z))!==null&&J!==void 0?J:0;if(!Y||Y.data[0]!==X[0])for(let[q,H]of X.entries())this._writeDictionaryBatch(H,Z,q>0);else if(W<X.length)for(let q of X.slice(W))this._writeDictionaryBatch(q,Z,!0);this._seenDictionaries.set(Z,K),this._dictionaryDeltaOffsets.set(Z,X.length)}return this}}jT.RecordBatchWriter=K2;class UH extends K2{static writeAll($,Q){let J=new UH(Q);if((0,S6.isPromise)($))return $.then((Z)=>J.writeAll(Z));else if((0,S6.isAsyncIterable)($))return CH(J,$);return DH(J,$)}}jT.RecordBatchStreamWriter=UH;class VH extends K2{static writeAll($){let Q=new VH;if((0,S6.isPromise)($))return $.then((J)=>Q.writeAll(J));else if((0,S6.isAsyncIterable)($))return CH(Q,$);return DH(Q,$)}constructor(){super();this._autoDestroy=!0}_writeSchema($){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch($,Q,J=!1){if(!J&&this._seenDictionaries.has(Q))throw Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch($,Q,J)}_writeFooter($){let Q=O9.Footer.encode(new O9.Footer($,FH.MetadataVersion.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter($)._write(Q)._write(Int32Array.of(Q.byteLength))._writeMagic()}}jT.RecordBatchFileWriter=VH;class NH extends K2{static writeAll($){return new NH().writeAll($)}constructor(){super();this._autoDestroy=!0,this._recordBatches=[],this._recordBatchesWithDictionaries=[]}_writeMessage(){return this}_writeFooter($){return this}_writeSchema($){return this._write(`{
  "schema": ${JSON.stringify({fields:$.fields.map((Q)=>ET(Q))},null,2)}`)}_writeDictionaries($){if($.dictionaries.size>0)this._recordBatchesWithDictionaries.push($);return this}_writeDictionaryBatch($,Q,J=!1){return this._write(this._dictionaryBlocks.length===0?"    ":`,
    `),this._write(xa($,Q,J)),this._dictionaryBlocks.push(new O9.FileBlock(0,0,0)),this}_writeRecordBatch($){return this._writeDictionaries($),this._recordBatches.push($),this}close(){if(this._recordBatchesWithDictionaries.length>0){this._write(`,
  "dictionaries": [
`);for(let $ of this._recordBatchesWithDictionaries)super._writeDictionaries($);this._write(`
  ]`)}if(this._recordBatches.length>0){for(let $=-1,Q=this._recordBatches.length;++$<Q;)this._write($===0?`,
  "batches": [
    `:`,
    `),this._write(ga(this._recordBatches[$])),this._recordBatchBlocks.push(new O9.FileBlock(0,0,0));this._write(`
  ]`)}if(this._schema)this._write(`
}`);return this._recordBatchesWithDictionaries=[],this._recordBatches=[],super.close()}}jT.RecordBatchJSONWriter=NH;function DH($,Q){let J=Q;if(Q instanceof HH.Table)J=Q.batches,$.reset(void 0,Q.schema);for(let Z of J)$.write(Z);return $.finish()}function CH($,Q){return ST.__awaiter(this,void 0,void 0,function*(){var J,Z,K,X,Y,W,q;try{for(J=!0,Z=ST.__asyncValues(Q);K=yield Z.next(),X=K.done,!X;J=!0){q=K.value,J=!1;let H=q;$.write(H)}}catch(H){Y={error:H}}finally{try{if(!J&&!X&&(W=Z.return))yield W.call(Z)}finally{if(Y)throw Y.error}}return $.finish()})}function ET({name:$,type:Q,nullable:J}){let Z=new La.JSONTypeAssembler;return{name:$,nullable:J,type:Z.visit(Q),children:(Q.children||[]).map((K)=>ET(K)),dictionary:!ha.DataType.isDictionary(Q)?void 0:{id:Q.id,isOrdered:Q.isOrdered,indexType:Z.visit(Q.indices)}}}function xa($,Q,J=!1){let[Z]=GT.JSONVectorAssembler.assemble(new hJ.RecordBatch({[Q]:$}));return JSON.stringify({id:Q,isDelta:J,data:{count:$.length,columns:Z}},null,2)}function ga($){let[Q]=GT.JSONVectorAssembler.assemble($);return JSON.stringify({count:$.numRows,columns:Q},null,2)}});var gT=g((_T)=>{Object.defineProperty(_T,"__esModule",{value:!0});_T.toDOMStream=void 0;var vJ=(s0(),J5(n0)),vT=z0(),LT=G4();function ma($,Q){if((0,LT.isAsyncIterable)($))return da($,Q);if((0,LT.isIterable)($))return ca($,Q);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable")}_T.toDOMStream=ma;function ca($,Q){let J=null,Z=(Q===null||Q===void 0?void 0:Q.type)==="bytes"||!1,K=(Q===null||Q===void 0?void 0:Q.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},Q),{start(Y){X(Y,J||(J=$[Symbol.iterator]()))},pull(Y){J?X(Y,J):Y.close()},cancel(){((J===null||J===void 0?void 0:J.return)&&J.return()||!0)&&(J=null)}}),Object.assign({highWaterMark:Z?K:void 0},Q));function X(Y,W){let q,H=null,F=Y.desiredSize||null;while(!(H=W.next(Z?F:null)).done){if(ArrayBuffer.isView(H.value)&&(q=(0,vT.toUint8Array)(H.value)))F!=null&&Z&&(F=F-q.byteLength+1),H.value=q;if(Y.enqueue(H.value),F!=null&&--F<=0)return}Y.close()}}function da($,Q){let J=null,Z=(Q===null||Q===void 0?void 0:Q.type)==="bytes"||!1,K=(Q===null||Q===void 0?void 0:Q.highWaterMark)||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},Q),{start(Y){return vJ.__awaiter(this,void 0,void 0,function*(){yield X(Y,J||(J=$[Symbol.asyncIterator]()))})},pull(Y){return vJ.__awaiter(this,void 0,void 0,function*(){J?yield X(Y,J):Y.close()})},cancel(){return vJ.__awaiter(this,void 0,void 0,function*(){((J===null||J===void 0?void 0:J.return)&&(yield J.return())||!0)&&(J=null)})}}),Object.assign({highWaterMark:Z?K:void 0},Q));function X(Y,W){return vJ.__awaiter(this,void 0,void 0,function*(){let q,H=null,F=Y.desiredSize||null;while(!(H=yield W.next(Z?F:null)).done){if(ArrayBuffer.isView(H.value)&&(q=(0,vT.toUint8Array)(H.value)))F!=null&&Z&&(F=F-q.byteLength+1),H.value=q;if(Y.enqueue(H.value),F!=null&&--F<=0)return}Y.close()})}}});var cT=g((bT)=>{Object.defineProperty(bT,"__esModule",{value:!0});bT.BuilderTransform=bT.builderThroughDOMStream=void 0;var la=(s0(),J5(n0)),pa=_3();function ua($){return new AH($)}bT.builderThroughDOMStream=ua;class AH{constructor($){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:Q,["writableStrategy"]:J,["queueingStrategy"]:Z="count"}=$,K=la.__rest($,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=(0,pa.makeBuilder)(K),this._getSize=Z!=="bytes"?yT:fT;let{["highWaterMark"]:X=Z==="bytes"?Math.pow(2,14):1000}=Object.assign({},Q),{["highWaterMark"]:Y=Z==="bytes"?Math.pow(2,14):1000}=Object.assign({},J);this.readable=new ReadableStream({["cancel"]:()=>{this._builder.clear()},["pull"]:(W)=>{this._maybeFlush(this._builder,this._controller=W)},["start"]:(W)=>{this._maybeFlush(this._builder,this._controller=W)}},{highWaterMark:X,size:Z!=="bytes"?yT:fT}),this.writable=new WritableStream({["abort"]:()=>{this._builder.clear()},["write"]:()=>{this._maybeFlush(this._builder,this._controller)},["close"]:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:Y,size:(W)=>this._writeValueAndReturnChunkSize(W)})}_writeValueAndReturnChunkSize($){let Q=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append($)),this._bufferedSize-Q}_maybeFlush($,Q){if(Q==null)return;if(this._bufferedSize>=Q.desiredSize)++this._numChunks&&this._enqueue(Q,$.toVector());if($.finished){if($.length>0||this._numChunks===0)++this._numChunks&&this._enqueue(Q,$.toVector());if(!this._finished&&(this._finished=!0))this._enqueue(Q,null)}}_enqueue($,Q){this._bufferedSize=0,this._controller=null,Q==null?$.close():$.enqueue(Q)}}bT.BuilderTransform=AH;var yT=($)=>{var Q;return(Q=$===null||$===void 0?void 0:$.length)!==null&&Q!==void 0?Q:0},fT=($)=>{var Q;return(Q=$===null||$===void 0?void 0:$.byteLength)!==null&&Q!==void 0?Q:0}});var pT=g((dT)=>{Object.defineProperty(dT,"__esModule",{value:!0});dT.recordBatchReaderThroughDOMStream=void 0;var X2=(s0(),J5(n0)),na=s4(),sa=J2();function oa($,Q){let J=new na.AsyncByteQueue,Z=null,K=new ReadableStream({cancel(){return X2.__awaiter(this,void 0,void 0,function*(){yield J.close()})},start(W){return X2.__awaiter(this,void 0,void 0,function*(){yield Y(W,Z||(Z=yield X()))})},pull(W){return X2.__awaiter(this,void 0,void 0,function*(){Z?yield Y(W,Z):W.close()})}});return{writable:new WritableStream(J,Object.assign({highWaterMark:Math.pow(2,14)},$)),readable:K};function X(){return X2.__awaiter(this,void 0,void 0,function*(){return yield(yield sa.RecordBatchReader.from(J)).open(Q)})}function Y(W,q){return X2.__awaiter(this,void 0,void 0,function*(){let H=W.desiredSize,F=null;while(!(F=yield q.next()).done)if(W.enqueue(F.value),H!=null&&--H<=0)return;W.close()})}}dT.recordBatchReaderThroughDOMStream=oa});var nT=g((uT)=>{Object.defineProperty(uT,"__esModule",{value:!0});uT.recordBatchWriterThroughDOMStream=void 0;var _J=(s0(),J5(n0)),ra=s4();function aa($,Q){let J=new this($),Z=new ra.AsyncByteStream(J),K=new ReadableStream({cancel(){return _J.__awaiter(this,void 0,void 0,function*(){yield Z.cancel()})},pull(Y){return _J.__awaiter(this,void 0,void 0,function*(){yield X(Y)})},start(Y){return _J.__awaiter(this,void 0,void 0,function*(){yield X(Y)})}},Object.assign({highWaterMark:Math.pow(2,14)},Q));return{writable:new WritableStream(J,$),readable:K};function X(Y){return _J.__awaiter(this,void 0,void 0,function*(){let W=null,q=Y.desiredSize;while(W=yield Z.read(q||null))if(Y.enqueue(W),q!=null&&(q-=W.byteLength)<=0)return;Y.close()})}}uT.recordBatchWriterThroughDOMStream=aa});var eT=g((aT)=>{Object.defineProperty(aT,"__esModule",{value:!0});aT.tableToIPC=aT.tableFromIPC=void 0;var sT=D9(),ta=G4(),ea=J2(),oT=LJ();function rT($){let Q=ea.RecordBatchReader.from($);if((0,ta.isPromise)(Q))return Q.then((J)=>rT(J));if(Q.isAsync())return Q.readAll().then((J)=>new sT.Table(J));return new sT.Table(Q.readAll())}aT.tableFromIPC=rT;function $t($,Q="stream"){return(Q==="stream"?oT.RecordBatchStreamWriter:oT.RecordBatchFileWriter).writeAll($).toUint8Array(!0)}aT.tableToIPC=$t});var wH=g((_)=>{Object.defineProperty(_,"__esModule",{value:!0});_.DenseUnion=_.Union=_.Struct=_.List=_.Decimal=_.TimeNanosecond=_.TimeMicrosecond=_.TimeMillisecond=_.TimeSecond=_.Time=_.TimestampNanosecond=_.TimestampMicrosecond=_.TimestampMillisecond=_.TimestampSecond=_.Timestamp=_.DateMillisecond=_.DateDay=_.Date_=_.FixedSizeBinary=_.LargeBinary=_.Binary=_.LargeUtf8=_.Utf8=_.Float64=_.Float32=_.Float16=_.Float=_.Uint64=_.Uint32=_.Uint16=_.Uint8=_.Int64=_.Int32=_.Int16=_.Int8=_.Int=_.Bool=_.Null=_.DataType=_.makeData=_.Data=_.MetadataVersion=_.IntervalUnit=_.UnionMode=_.Precision=_.TimeUnit=_.DateUnit=_.BufferType=_.Type=_.MessageHeader=void 0;_.TimeBuilder=_.Uint64Builder=_.Uint32Builder=_.Uint16Builder=_.Uint8Builder=_.Int64Builder=_.Int32Builder=_.Int16Builder=_.Int8Builder=_.IntBuilder=_.Float64Builder=_.Float32Builder=_.Float16Builder=_.FloatBuilder=_.FixedSizeBinaryBuilder=_.DictionaryBuilder=_.DecimalBuilder=_.DateMillisecondBuilder=_.DateDayBuilder=_.DateBuilder=_.NullBuilder=_.BoolBuilder=_.builderThroughAsyncIterable=_.builderThroughIterable=_.tableFromJSON=_.vectorFromArray=_.makeBuilder=_.Builder=_.StructRow=_.MapRow=_.Field=_.Schema=_.Visitor=_.makeVector=_.Vector=_.tableFromArrays=_.makeTable=_.Table=_.Map_=_.FixedSizeList=_.DurationNanosecond=_.DurationMicrosecond=_.DurationMillisecond=_.DurationSecond=_.Duration=_.IntervalYearMonth=_.IntervalDayTime=_.Interval=_.Dictionary=_.SparseUnion=void 0;_.util=_.RecordBatch=_.Message=_.JSONMessageReader=_.AsyncMessageReader=_.MessageReader=_.tableFromIPC=_.tableToIPC=_.RecordBatchJSONWriter=_.RecordBatchStreamWriter=_.RecordBatchFileWriter=_.RecordBatchWriter=_.AsyncRecordBatchStreamReader=_.AsyncRecordBatchFileReader=_.RecordBatchStreamReader=_.RecordBatchFileReader=_.RecordBatchReader=_.AsyncByteQueue=_.AsyncByteStream=_.ByteStream=_.DenseUnionBuilder=_.SparseUnionBuilder=_.UnionBuilder=_.StructBuilder=_.MapBuilder=_.FixedSizeListBuilder=_.ListBuilder=_.LargeBinaryBuilder=_.BinaryBuilder=_.LargeUtf8Builder=_.Utf8Builder=_.DurationNanosecondBuilder=_.DurationMicrosecondBuilder=_.DurationMillisecondBuilder=_.DurationSecondBuilder=_.DurationBuilder=_.IntervalYearMonthBuilder=_.IntervalDayTimeBuilder=_.IntervalBuilder=_.TimestampNanosecondBuilder=_.TimestampMicrosecondBuilder=_.TimestampMillisecondBuilder=_.TimestampSecondBuilder=_.TimestampBuilder=_.TimeNanosecondBuilder=_.TimeMicrosecondBuilder=_.TimeMillisecondBuilder=_.TimeSecondBuilder=void 0;var Jt=IQ();Object.defineProperty(_,"MessageHeader",{enumerable:!0,get:function(){return Jt.MessageHeader}});var X7=a1();Object.defineProperty(_,"Type",{enumerable:!0,get:function(){return X7.Type}});Object.defineProperty(_,"BufferType",{enumerable:!0,get:function(){return X7.BufferType}});Object.defineProperty(_,"DateUnit",{enumerable:!0,get:function(){return X7.DateUnit}});Object.defineProperty(_,"TimeUnit",{enumerable:!0,get:function(){return X7.TimeUnit}});Object.defineProperty(_,"Precision",{enumerable:!0,get:function(){return X7.Precision}});Object.defineProperty(_,"UnionMode",{enumerable:!0,get:function(){return X7.UnionMode}});Object.defineProperty(_,"IntervalUnit",{enumerable:!0,get:function(){return X7.IntervalUnit}});Object.defineProperty(_,"MetadataVersion",{enumerable:!0,get:function(){return X7.MetadataVersion}});var $I=A6();Object.defineProperty(_,"Data",{enumerable:!0,get:function(){return $I.Data}});Object.defineProperty(_,"makeData",{enumerable:!0,get:function(){return $I.makeData}});var X1=p1();Object.defineProperty(_,"DataType",{enumerable:!0,get:function(){return X1.DataType}});Object.defineProperty(_,"Null",{enumerable:!0,get:function(){return X1.Null}});Object.defineProperty(_,"Bool",{enumerable:!0,get:function(){return X1.Bool}});Object.defineProperty(_,"Int",{enumerable:!0,get:function(){return X1.Int}});Object.defineProperty(_,"Int8",{enumerable:!0,get:function(){return X1.Int8}});Object.defineProperty(_,"Int16",{enumerable:!0,get:function(){return X1.Int16}});Object.defineProperty(_,"Int32",{enumerable:!0,get:function(){return X1.Int32}});Object.defineProperty(_,"Int64",{enumerable:!0,get:function(){return X1.Int64}});Object.defineProperty(_,"Uint8",{enumerable:!0,get:function(){return X1.Uint8}});Object.defineProperty(_,"Uint16",{enumerable:!0,get:function(){return X1.Uint16}});Object.defineProperty(_,"Uint32",{enumerable:!0,get:function(){return X1.Uint32}});Object.defineProperty(_,"Uint64",{enumerable:!0,get:function(){return X1.Uint64}});Object.defineProperty(_,"Float",{enumerable:!0,get:function(){return X1.Float}});Object.defineProperty(_,"Float16",{enumerable:!0,get:function(){return X1.Float16}});Object.defineProperty(_,"Float32",{enumerable:!0,get:function(){return X1.Float32}});Object.defineProperty(_,"Float64",{enumerable:!0,get:function(){return X1.Float64}});Object.defineProperty(_,"Utf8",{enumerable:!0,get:function(){return X1.Utf8}});Object.defineProperty(_,"LargeUtf8",{enumerable:!0,get:function(){return X1.LargeUtf8}});Object.defineProperty(_,"Binary",{enumerable:!0,get:function(){return X1.Binary}});Object.defineProperty(_,"LargeBinary",{enumerable:!0,get:function(){return X1.LargeBinary}});Object.defineProperty(_,"FixedSizeBinary",{enumerable:!0,get:function(){return X1.FixedSizeBinary}});Object.defineProperty(_,"Date_",{enumerable:!0,get:function(){return X1.Date_}});Object.defineProperty(_,"DateDay",{enumerable:!0,get:function(){return X1.DateDay}});Object.defineProperty(_,"DateMillisecond",{enumerable:!0,get:function(){return X1.DateMillisecond}});Object.defineProperty(_,"Timestamp",{enumerable:!0,get:function(){return X1.Timestamp}});Object.defineProperty(_,"TimestampSecond",{enumerable:!0,get:function(){return X1.TimestampSecond}});Object.defineProperty(_,"TimestampMillisecond",{enumerable:!0,get:function(){return X1.TimestampMillisecond}});Object.defineProperty(_,"TimestampMicrosecond",{enumerable:!0,get:function(){return X1.TimestampMicrosecond}});Object.defineProperty(_,"TimestampNanosecond",{enumerable:!0,get:function(){return X1.TimestampNanosecond}});Object.defineProperty(_,"Time",{enumerable:!0,get:function(){return X1.Time}});Object.defineProperty(_,"TimeSecond",{enumerable:!0,get:function(){return X1.TimeSecond}});Object.defineProperty(_,"TimeMillisecond",{enumerable:!0,get:function(){return X1.TimeMillisecond}});Object.defineProperty(_,"TimeMicrosecond",{enumerable:!0,get:function(){return X1.TimeMicrosecond}});Object.defineProperty(_,"TimeNanosecond",{enumerable:!0,get:function(){return X1.TimeNanosecond}});Object.defineProperty(_,"Decimal",{enumerable:!0,get:function(){return X1.Decimal}});Object.defineProperty(_,"List",{enumerable:!0,get:function(){return X1.List}});Object.defineProperty(_,"Struct",{enumerable:!0,get:function(){return X1.Struct}});Object.defineProperty(_,"Union",{enumerable:!0,get:function(){return X1.Union}});Object.defineProperty(_,"DenseUnion",{enumerable:!0,get:function(){return X1.DenseUnion}});Object.defineProperty(_,"SparseUnion",{enumerable:!0,get:function(){return X1.SparseUnion}});Object.defineProperty(_,"Dictionary",{enumerable:!0,get:function(){return X1.Dictionary}});Object.defineProperty(_,"Interval",{enumerable:!0,get:function(){return X1.Interval}});Object.defineProperty(_,"IntervalDayTime",{enumerable:!0,get:function(){return X1.IntervalDayTime}});Object.defineProperty(_,"IntervalYearMonth",{enumerable:!0,get:function(){return X1.IntervalYearMonth}});Object.defineProperty(_,"Duration",{enumerable:!0,get:function(){return X1.Duration}});Object.defineProperty(_,"DurationSecond",{enumerable:!0,get:function(){return X1.DurationSecond}});Object.defineProperty(_,"DurationMillisecond",{enumerable:!0,get:function(){return X1.DurationMillisecond}});Object.defineProperty(_,"DurationMicrosecond",{enumerable:!0,get:function(){return X1.DurationMicrosecond}});Object.defineProperty(_,"DurationNanosecond",{enumerable:!0,get:function(){return X1.DurationNanosecond}});Object.defineProperty(_,"FixedSizeList",{enumerable:!0,get:function(){return X1.FixedSizeList}});Object.defineProperty(_,"Map_",{enumerable:!0,get:function(){return X1.Map_}});var kH=D9();Object.defineProperty(_,"Table",{enumerable:!0,get:function(){return kH.Table}});Object.defineProperty(_,"makeTable",{enumerable:!0,get:function(){return kH.makeTable}});Object.defineProperty(_,"tableFromArrays",{enumerable:!0,get:function(){return kH.tableFromArrays}});var QI=m0();Object.defineProperty(_,"Vector",{enumerable:!0,get:function(){return QI.Vector}});Object.defineProperty(_,"makeVector",{enumerable:!0,get:function(){return QI.makeVector}});var Zt=r0();Object.defineProperty(_,"Visitor",{enumerable:!0,get:function(){return Zt.Visitor}});var JI=e0();Object.defineProperty(_,"Schema",{enumerable:!0,get:function(){return JI.Schema}});Object.defineProperty(_,"Field",{enumerable:!0,get:function(){return JI.Field}});var Kt=T3();Object.defineProperty(_,"MapRow",{enumerable:!0,get:function(){return Kt.MapRow}});var Xt=uQ();Object.defineProperty(_,"StructRow",{enumerable:!0,get:function(){return Xt.StructRow}});var Yt=o1();Object.defineProperty(_,"Builder",{enumerable:!0,get:function(){return Yt.Builder}});var Y2=_3();Object.defineProperty(_,"makeBuilder",{enumerable:!0,get:function(){return Y2.makeBuilder}});Object.defineProperty(_,"vectorFromArray",{enumerable:!0,get:function(){return Y2.vectorFromArray}});Object.defineProperty(_,"tableFromJSON",{enumerable:!0,get:function(){return Y2.tableFromJSON}});Object.defineProperty(_,"builderThroughIterable",{enumerable:!0,get:function(){return Y2.builderThroughIterable}});Object.defineProperty(_,"builderThroughAsyncIterable",{enumerable:!0,get:function(){return Y2.builderThroughAsyncIterable}});var Wt=yW();Object.defineProperty(_,"BoolBuilder",{enumerable:!0,get:function(){return Wt.BoolBuilder}});var qt=Wq();Object.defineProperty(_,"NullBuilder",{enumerable:!0,get:function(){return qt.NullBuilder}});var BH=cW();Object.defineProperty(_,"DateBuilder",{enumerable:!0,get:function(){return BH.DateBuilder}});Object.defineProperty(_,"DateDayBuilder",{enumerable:!0,get:function(){return BH.DateDayBuilder}});Object.defineProperty(_,"DateMillisecondBuilder",{enumerable:!0,get:function(){return BH.DateMillisecondBuilder}});var Ht=lW();Object.defineProperty(_,"DecimalBuilder",{enumerable:!0,get:function(){return Ht.DecimalBuilder}});var Ft=pW();Object.defineProperty(_,"DictionaryBuilder",{enumerable:!0,get:function(){return Ft.DictionaryBuilder}});var Ut=iW();Object.defineProperty(_,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return Ut.FixedSizeBinaryBuilder}});var xJ=sW();Object.defineProperty(_,"FloatBuilder",{enumerable:!0,get:function(){return xJ.FloatBuilder}});Object.defineProperty(_,"Float16Builder",{enumerable:!0,get:function(){return xJ.Float16Builder}});Object.defineProperty(_,"Float32Builder",{enumerable:!0,get:function(){return xJ.Float32Builder}});Object.defineProperty(_,"Float64Builder",{enumerable:!0,get:function(){return xJ.Float64Builder}});var X4=Kq();Object.defineProperty(_,"IntBuilder",{enumerable:!0,get:function(){return X4.IntBuilder}});Object.defineProperty(_,"Int8Builder",{enumerable:!0,get:function(){return X4.Int8Builder}});Object.defineProperty(_,"Int16Builder",{enumerable:!0,get:function(){return X4.Int16Builder}});Object.defineProperty(_,"Int32Builder",{enumerable:!0,get:function(){return X4.Int32Builder}});Object.defineProperty(_,"Int64Builder",{enumerable:!0,get:function(){return X4.Int64Builder}});Object.defineProperty(_,"Uint8Builder",{enumerable:!0,get:function(){return X4.Uint8Builder}});Object.defineProperty(_,"Uint16Builder",{enumerable:!0,get:function(){return X4.Uint16Builder}});Object.defineProperty(_,"Uint32Builder",{enumerable:!0,get:function(){return X4.Uint32Builder}});Object.defineProperty(_,"Uint64Builder",{enumerable:!0,get:function(){return X4.Uint64Builder}});var W2=kq();Object.defineProperty(_,"TimeBuilder",{enumerable:!0,get:function(){return W2.TimeBuilder}});Object.defineProperty(_,"TimeSecondBuilder",{enumerable:!0,get:function(){return W2.TimeSecondBuilder}});Object.defineProperty(_,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return W2.TimeMillisecondBuilder}});Object.defineProperty(_,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return W2.TimeMicrosecondBuilder}});Object.defineProperty(_,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return W2.TimeNanosecondBuilder}});var q2=Nq();Object.defineProperty(_,"TimestampBuilder",{enumerable:!0,get:function(){return q2.TimestampBuilder}});Object.defineProperty(_,"TimestampSecondBuilder",{enumerable:!0,get:function(){return q2.TimestampSecondBuilder}});Object.defineProperty(_,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return q2.TimestampMillisecondBuilder}});Object.defineProperty(_,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return q2.TimestampMicrosecondBuilder}});Object.defineProperty(_,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return q2.TimestampNanosecondBuilder}});var RH=tW();Object.defineProperty(_,"IntervalBuilder",{enumerable:!0,get:function(){return RH.IntervalBuilder}});Object.defineProperty(_,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return RH.IntervalDayTimeBuilder}});Object.defineProperty(_,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return RH.IntervalYearMonthBuilder}});var H2=Zq();Object.defineProperty(_,"DurationBuilder",{enumerable:!0,get:function(){return H2.DurationBuilder}});Object.defineProperty(_,"DurationSecondBuilder",{enumerable:!0,get:function(){return H2.DurationSecondBuilder}});Object.defineProperty(_,"DurationMillisecondBuilder",{enumerable:!0,get:function(){return H2.DurationMillisecondBuilder}});Object.defineProperty(_,"DurationMicrosecondBuilder",{enumerable:!0,get:function(){return H2.DurationMicrosecondBuilder}});Object.defineProperty(_,"DurationNanosecondBuilder",{enumerable:!0,get:function(){return H2.DurationNanosecondBuilder}});var Vt=Oq();Object.defineProperty(_,"Utf8Builder",{enumerable:!0,get:function(){return Vt.Utf8Builder}});var Nt=Mq();Object.defineProperty(_,"LargeUtf8Builder",{enumerable:!0,get:function(){return Nt.LargeUtf8Builder}});var Dt=qJ();Object.defineProperty(_,"BinaryBuilder",{enumerable:!0,get:function(){return Dt.BinaryBuilder}});var Ct=HJ();Object.defineProperty(_,"LargeBinaryBuilder",{enumerable:!0,get:function(){return Ct.LargeBinaryBuilder}});var At=Xq();Object.defineProperty(_,"ListBuilder",{enumerable:!0,get:function(){return At.ListBuilder}});var zt=nW();Object.defineProperty(_,"FixedSizeListBuilder",{enumerable:!0,get:function(){return zt.FixedSizeListBuilder}});var kt=Yq();Object.defineProperty(_,"MapBuilder",{enumerable:!0,get:function(){return kt.MapBuilder}});var Bt=qq();Object.defineProperty(_,"StructBuilder",{enumerable:!0,get:function(){return Bt.StructBuilder}});var OH=Bq();Object.defineProperty(_,"UnionBuilder",{enumerable:!0,get:function(){return OH.UnionBuilder}});Object.defineProperty(_,"SparseUnionBuilder",{enumerable:!0,get:function(){return OH.SparseUnionBuilder}});Object.defineProperty(_,"DenseUnionBuilder",{enumerable:!0,get:function(){return OH.DenseUnionBuilder}});var PH=s4();Object.defineProperty(_,"ByteStream",{enumerable:!0,get:function(){return PH.ByteStream}});Object.defineProperty(_,"AsyncByteStream",{enumerable:!0,get:function(){return PH.AsyncByteStream}});Object.defineProperty(_,"AsyncByteQueue",{enumerable:!0,get:function(){return PH.AsyncByteQueue}});var F2=J2();Object.defineProperty(_,"RecordBatchReader",{enumerable:!0,get:function(){return F2.RecordBatchReader}});Object.defineProperty(_,"RecordBatchFileReader",{enumerable:!0,get:function(){return F2.RecordBatchFileReader}});Object.defineProperty(_,"RecordBatchStreamReader",{enumerable:!0,get:function(){return F2.RecordBatchStreamReader}});Object.defineProperty(_,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return F2.AsyncRecordBatchFileReader}});Object.defineProperty(_,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return F2.AsyncRecordBatchStreamReader}});var gJ=LJ();Object.defineProperty(_,"RecordBatchWriter",{enumerable:!0,get:function(){return gJ.RecordBatchWriter}});Object.defineProperty(_,"RecordBatchFileWriter",{enumerable:!0,get:function(){return gJ.RecordBatchFileWriter}});Object.defineProperty(_,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return gJ.RecordBatchStreamWriter}});Object.defineProperty(_,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return gJ.RecordBatchJSONWriter}});var ZI=eT();Object.defineProperty(_,"tableToIPC",{enumerable:!0,get:function(){return ZI.tableToIPC}});Object.defineProperty(_,"tableFromIPC",{enumerable:!0,get:function(){return ZI.tableFromIPC}});var MH=SJ();Object.defineProperty(_,"MessageReader",{enumerable:!0,get:function(){return MH.MessageReader}});Object.defineProperty(_,"AsyncMessageReader",{enumerable:!0,get:function(){return MH.AsyncMessageReader}});Object.defineProperty(_,"JSONMessageReader",{enumerable:!0,get:function(){return MH.JSONMessageReader}});var Rt=e7();Object.defineProperty(_,"Message",{enumerable:!0,get:function(){return Rt.Message}});var Ot=r4();Object.defineProperty(_,"RecordBatch",{enumerable:!0,get:function(){return Ot.RecordBatch}});var Pt=jQ(),Mt=xW(),wt=p7(),St=S3(),Tt=z0(),It=q9(),Gt=M3(),zH=i3();_.util=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Pt),Mt),wt),St),Tt),It),Gt),{compareSchemas:zH.compareSchemas,compareFields:zH.compareFields,compareTypes:zH.compareTypes})});var yJ=g((v)=>{Object.defineProperty(v,"__esModule",{value:!0});v.Union=v.StructRow=v.Struct=v.List=v.Decimal=v.TimeNanosecond=v.TimeMicrosecond=v.TimeMillisecond=v.TimeSecond=v.Time=v.TimestampNanosecond=v.TimestampMicrosecond=v.TimestampMillisecond=v.TimestampSecond=v.Timestamp=v.DateMillisecond=v.DateDay=v.Date_=v.FixedSizeBinary=v.LargeBinary=v.Binary=v.LargeUtf8=v.Utf8=v.Float64=v.Float32=v.Float16=v.Float=v.Uint64=v.Uint32=v.Uint16=v.Uint8=v.Int64=v.Int32=v.Int16=v.Int8=v.Int=v.Bool=v.Null=v.DataType=v.makeData=v.Data=v.BufferType=v.UnionMode=v.Type=v.TimeUnit=v.Precision=v.MetadataVersion=v.MessageHeader=v.IntervalUnit=v.DateUnit=void 0;v.LargeBinaryBuilder=v.BinaryBuilder=v.builderThroughAsyncIterable=v.builderThroughIterable=v.makeBuilder=v.Builder=v.util=v.RecordBatch=v.Message=v.JSONMessageReader=v.AsyncMessageReader=v.MessageReader=v.tableToIPC=v.tableFromIPC=v.RecordBatchJSONWriter=v.RecordBatchStreamWriter=v.RecordBatchFileWriter=v.RecordBatchWriter=v.AsyncRecordBatchStreamReader=v.AsyncRecordBatchFileReader=v.RecordBatchStreamReader=v.RecordBatchFileReader=v.RecordBatchReader=v.AsyncByteQueue=v.AsyncByteStream=v.ByteStream=v.tableFromJSON=v.vectorFromArray=v.makeVector=v.Vector=v.Visitor=v.Field=v.Schema=v.tableFromArrays=v.makeTable=v.Table=v.MapRow=v.Map_=v.FixedSizeList=v.DurationNanosecond=v.DurationMicrosecond=v.DurationMillisecond=v.DurationSecond=v.Duration=v.IntervalYearMonth=v.IntervalDayTime=v.Interval=v.Dictionary=v.SparseUnion=v.DenseUnion=void 0;v.LargeUtf8Builder=v.Utf8Builder=v.SparseUnionBuilder=v.DenseUnionBuilder=v.UnionBuilder=v.TimeNanosecondBuilder=v.TimeMicrosecondBuilder=v.TimeMillisecondBuilder=v.TimeSecondBuilder=v.TimeBuilder=v.TimestampNanosecondBuilder=v.TimestampMicrosecondBuilder=v.TimestampMillisecondBuilder=v.TimestampSecondBuilder=v.TimestampBuilder=v.StructBuilder=v.NullBuilder=v.MapBuilder=v.ListBuilder=v.Uint64Builder=v.Uint32Builder=v.Uint16Builder=v.Uint8Builder=v.Int64Builder=v.Int32Builder=v.Int16Builder=v.Int8Builder=v.IntBuilder=v.DurationNanosecondBuilder=v.DurationMicrosecondBuilder=v.DurationMillisecondBuilder=v.DurationSecondBuilder=v.DurationBuilder=v.IntervalYearMonthBuilder=v.IntervalDayTimeBuilder=v.IntervalBuilder=v.Float64Builder=v.Float32Builder=v.Float16Builder=v.FloatBuilder=v.FixedSizeListBuilder=v.FixedSizeBinaryBuilder=v.DictionaryBuilder=v.DecimalBuilder=v.DateMillisecondBuilder=v.DateDayBuilder=v.DateBuilder=v.BoolBuilder=void 0;var ht=R3(),Lt=o1(),SH=J2(),TH=LJ(),vt=gT(),_t=cT(),IH=pT(),GH=nT();ht.default.toDOMStream=vt.toDOMStream;Lt.Builder.throughDOM=_t.builderThroughDOMStream;SH.RecordBatchReader.throughDOM=IH.recordBatchReaderThroughDOMStream;SH.RecordBatchFileReader.throughDOM=IH.recordBatchReaderThroughDOMStream;SH.RecordBatchStreamReader.throughDOM=IH.recordBatchReaderThroughDOMStream;TH.RecordBatchWriter.throughDOM=GH.recordBatchWriterThroughDOMStream;TH.RecordBatchFileWriter.throughDOM=GH.recordBatchWriterThroughDOMStream;TH.RecordBatchStreamWriter.throughDOM=GH.recordBatchWriterThroughDOMStream;var m=wH();Object.defineProperty(v,"DateUnit",{enumerable:!0,get:function(){return m.DateUnit}});Object.defineProperty(v,"IntervalUnit",{enumerable:!0,get:function(){return m.IntervalUnit}});Object.defineProperty(v,"MessageHeader",{enumerable:!0,get:function(){return m.MessageHeader}});Object.defineProperty(v,"MetadataVersion",{enumerable:!0,get:function(){return m.MetadataVersion}});Object.defineProperty(v,"Precision",{enumerable:!0,get:function(){return m.Precision}});Object.defineProperty(v,"TimeUnit",{enumerable:!0,get:function(){return m.TimeUnit}});Object.defineProperty(v,"Type",{enumerable:!0,get:function(){return m.Type}});Object.defineProperty(v,"UnionMode",{enumerable:!0,get:function(){return m.UnionMode}});Object.defineProperty(v,"BufferType",{enumerable:!0,get:function(){return m.BufferType}});Object.defineProperty(v,"Data",{enumerable:!0,get:function(){return m.Data}});Object.defineProperty(v,"makeData",{enumerable:!0,get:function(){return m.makeData}});Object.defineProperty(v,"DataType",{enumerable:!0,get:function(){return m.DataType}});Object.defineProperty(v,"Null",{enumerable:!0,get:function(){return m.Null}});Object.defineProperty(v,"Bool",{enumerable:!0,get:function(){return m.Bool}});Object.defineProperty(v,"Int",{enumerable:!0,get:function(){return m.Int}});Object.defineProperty(v,"Int8",{enumerable:!0,get:function(){return m.Int8}});Object.defineProperty(v,"Int16",{enumerable:!0,get:function(){return m.Int16}});Object.defineProperty(v,"Int32",{enumerable:!0,get:function(){return m.Int32}});Object.defineProperty(v,"Int64",{enumerable:!0,get:function(){return m.Int64}});Object.defineProperty(v,"Uint8",{enumerable:!0,get:function(){return m.Uint8}});Object.defineProperty(v,"Uint16",{enumerable:!0,get:function(){return m.Uint16}});Object.defineProperty(v,"Uint32",{enumerable:!0,get:function(){return m.Uint32}});Object.defineProperty(v,"Uint64",{enumerable:!0,get:function(){return m.Uint64}});Object.defineProperty(v,"Float",{enumerable:!0,get:function(){return m.Float}});Object.defineProperty(v,"Float16",{enumerable:!0,get:function(){return m.Float16}});Object.defineProperty(v,"Float32",{enumerable:!0,get:function(){return m.Float32}});Object.defineProperty(v,"Float64",{enumerable:!0,get:function(){return m.Float64}});Object.defineProperty(v,"Utf8",{enumerable:!0,get:function(){return m.Utf8}});Object.defineProperty(v,"LargeUtf8",{enumerable:!0,get:function(){return m.LargeUtf8}});Object.defineProperty(v,"Binary",{enumerable:!0,get:function(){return m.Binary}});Object.defineProperty(v,"LargeBinary",{enumerable:!0,get:function(){return m.LargeBinary}});Object.defineProperty(v,"FixedSizeBinary",{enumerable:!0,get:function(){return m.FixedSizeBinary}});Object.defineProperty(v,"Date_",{enumerable:!0,get:function(){return m.Date_}});Object.defineProperty(v,"DateDay",{enumerable:!0,get:function(){return m.DateDay}});Object.defineProperty(v,"DateMillisecond",{enumerable:!0,get:function(){return m.DateMillisecond}});Object.defineProperty(v,"Timestamp",{enumerable:!0,get:function(){return m.Timestamp}});Object.defineProperty(v,"TimestampSecond",{enumerable:!0,get:function(){return m.TimestampSecond}});Object.defineProperty(v,"TimestampMillisecond",{enumerable:!0,get:function(){return m.TimestampMillisecond}});Object.defineProperty(v,"TimestampMicrosecond",{enumerable:!0,get:function(){return m.TimestampMicrosecond}});Object.defineProperty(v,"TimestampNanosecond",{enumerable:!0,get:function(){return m.TimestampNanosecond}});Object.defineProperty(v,"Time",{enumerable:!0,get:function(){return m.Time}});Object.defineProperty(v,"TimeSecond",{enumerable:!0,get:function(){return m.TimeSecond}});Object.defineProperty(v,"TimeMillisecond",{enumerable:!0,get:function(){return m.TimeMillisecond}});Object.defineProperty(v,"TimeMicrosecond",{enumerable:!0,get:function(){return m.TimeMicrosecond}});Object.defineProperty(v,"TimeNanosecond",{enumerable:!0,get:function(){return m.TimeNanosecond}});Object.defineProperty(v,"Decimal",{enumerable:!0,get:function(){return m.Decimal}});Object.defineProperty(v,"List",{enumerable:!0,get:function(){return m.List}});Object.defineProperty(v,"Struct",{enumerable:!0,get:function(){return m.Struct}});Object.defineProperty(v,"StructRow",{enumerable:!0,get:function(){return m.StructRow}});Object.defineProperty(v,"Union",{enumerable:!0,get:function(){return m.Union}});Object.defineProperty(v,"DenseUnion",{enumerable:!0,get:function(){return m.DenseUnion}});Object.defineProperty(v,"SparseUnion",{enumerable:!0,get:function(){return m.SparseUnion}});Object.defineProperty(v,"Dictionary",{enumerable:!0,get:function(){return m.Dictionary}});Object.defineProperty(v,"Interval",{enumerable:!0,get:function(){return m.Interval}});Object.defineProperty(v,"IntervalDayTime",{enumerable:!0,get:function(){return m.IntervalDayTime}});Object.defineProperty(v,"IntervalYearMonth",{enumerable:!0,get:function(){return m.IntervalYearMonth}});Object.defineProperty(v,"Duration",{enumerable:!0,get:function(){return m.Duration}});Object.defineProperty(v,"DurationSecond",{enumerable:!0,get:function(){return m.DurationSecond}});Object.defineProperty(v,"DurationMillisecond",{enumerable:!0,get:function(){return m.DurationMillisecond}});Object.defineProperty(v,"DurationMicrosecond",{enumerable:!0,get:function(){return m.DurationMicrosecond}});Object.defineProperty(v,"DurationNanosecond",{enumerable:!0,get:function(){return m.DurationNanosecond}});Object.defineProperty(v,"FixedSizeList",{enumerable:!0,get:function(){return m.FixedSizeList}});Object.defineProperty(v,"Map_",{enumerable:!0,get:function(){return m.Map_}});Object.defineProperty(v,"MapRow",{enumerable:!0,get:function(){return m.MapRow}});Object.defineProperty(v,"Table",{enumerable:!0,get:function(){return m.Table}});Object.defineProperty(v,"makeTable",{enumerable:!0,get:function(){return m.makeTable}});Object.defineProperty(v,"tableFromArrays",{enumerable:!0,get:function(){return m.tableFromArrays}});Object.defineProperty(v,"Schema",{enumerable:!0,get:function(){return m.Schema}});Object.defineProperty(v,"Field",{enumerable:!0,get:function(){return m.Field}});Object.defineProperty(v,"Visitor",{enumerable:!0,get:function(){return m.Visitor}});Object.defineProperty(v,"Vector",{enumerable:!0,get:function(){return m.Vector}});Object.defineProperty(v,"makeVector",{enumerable:!0,get:function(){return m.makeVector}});Object.defineProperty(v,"vectorFromArray",{enumerable:!0,get:function(){return m.vectorFromArray}});Object.defineProperty(v,"tableFromJSON",{enumerable:!0,get:function(){return m.tableFromJSON}});Object.defineProperty(v,"ByteStream",{enumerable:!0,get:function(){return m.ByteStream}});Object.defineProperty(v,"AsyncByteStream",{enumerable:!0,get:function(){return m.AsyncByteStream}});Object.defineProperty(v,"AsyncByteQueue",{enumerable:!0,get:function(){return m.AsyncByteQueue}});Object.defineProperty(v,"RecordBatchReader",{enumerable:!0,get:function(){return m.RecordBatchReader}});Object.defineProperty(v,"RecordBatchFileReader",{enumerable:!0,get:function(){return m.RecordBatchFileReader}});Object.defineProperty(v,"RecordBatchStreamReader",{enumerable:!0,get:function(){return m.RecordBatchStreamReader}});Object.defineProperty(v,"AsyncRecordBatchFileReader",{enumerable:!0,get:function(){return m.AsyncRecordBatchFileReader}});Object.defineProperty(v,"AsyncRecordBatchStreamReader",{enumerable:!0,get:function(){return m.AsyncRecordBatchStreamReader}});Object.defineProperty(v,"RecordBatchWriter",{enumerable:!0,get:function(){return m.RecordBatchWriter}});Object.defineProperty(v,"RecordBatchFileWriter",{enumerable:!0,get:function(){return m.RecordBatchFileWriter}});Object.defineProperty(v,"RecordBatchStreamWriter",{enumerable:!0,get:function(){return m.RecordBatchStreamWriter}});Object.defineProperty(v,"RecordBatchJSONWriter",{enumerable:!0,get:function(){return m.RecordBatchJSONWriter}});Object.defineProperty(v,"tableFromIPC",{enumerable:!0,get:function(){return m.tableFromIPC}});Object.defineProperty(v,"tableToIPC",{enumerable:!0,get:function(){return m.tableToIPC}});Object.defineProperty(v,"MessageReader",{enumerable:!0,get:function(){return m.MessageReader}});Object.defineProperty(v,"AsyncMessageReader",{enumerable:!0,get:function(){return m.AsyncMessageReader}});Object.defineProperty(v,"JSONMessageReader",{enumerable:!0,get:function(){return m.JSONMessageReader}});Object.defineProperty(v,"Message",{enumerable:!0,get:function(){return m.Message}});Object.defineProperty(v,"RecordBatch",{enumerable:!0,get:function(){return m.RecordBatch}});Object.defineProperty(v,"util",{enumerable:!0,get:function(){return m.util}});Object.defineProperty(v,"Builder",{enumerable:!0,get:function(){return m.Builder}});Object.defineProperty(v,"makeBuilder",{enumerable:!0,get:function(){return m.makeBuilder}});Object.defineProperty(v,"builderThroughIterable",{enumerable:!0,get:function(){return m.builderThroughIterable}});Object.defineProperty(v,"builderThroughAsyncIterable",{enumerable:!0,get:function(){return m.builderThroughAsyncIterable}});var H1=wH();Object.defineProperty(v,"BinaryBuilder",{enumerable:!0,get:function(){return H1.BinaryBuilder}});Object.defineProperty(v,"LargeBinaryBuilder",{enumerable:!0,get:function(){return H1.LargeBinaryBuilder}});Object.defineProperty(v,"BoolBuilder",{enumerable:!0,get:function(){return H1.BoolBuilder}});Object.defineProperty(v,"DateBuilder",{enumerable:!0,get:function(){return H1.DateBuilder}});Object.defineProperty(v,"DateDayBuilder",{enumerable:!0,get:function(){return H1.DateDayBuilder}});Object.defineProperty(v,"DateMillisecondBuilder",{enumerable:!0,get:function(){return H1.DateMillisecondBuilder}});Object.defineProperty(v,"DecimalBuilder",{enumerable:!0,get:function(){return H1.DecimalBuilder}});Object.defineProperty(v,"DictionaryBuilder",{enumerable:!0,get:function(){return H1.DictionaryBuilder}});Object.defineProperty(v,"FixedSizeBinaryBuilder",{enumerable:!0,get:function(){return H1.FixedSizeBinaryBuilder}});Object.defineProperty(v,"FixedSizeListBuilder",{enumerable:!0,get:function(){return H1.FixedSizeListBuilder}});Object.defineProperty(v,"FloatBuilder",{enumerable:!0,get:function(){return H1.FloatBuilder}});Object.defineProperty(v,"Float16Builder",{enumerable:!0,get:function(){return H1.Float16Builder}});Object.defineProperty(v,"Float32Builder",{enumerable:!0,get:function(){return H1.Float32Builder}});Object.defineProperty(v,"Float64Builder",{enumerable:!0,get:function(){return H1.Float64Builder}});Object.defineProperty(v,"IntervalBuilder",{enumerable:!0,get:function(){return H1.IntervalBuilder}});Object.defineProperty(v,"IntervalDayTimeBuilder",{enumerable:!0,get:function(){return H1.IntervalDayTimeBuilder}});Object.defineProperty(v,"IntervalYearMonthBuilder",{enumerable:!0,get:function(){return H1.IntervalYearMonthBuilder}});Object.defineProperty(v,"DurationBuilder",{enumerable:!0,get:function(){return H1.DurationBuilder}});Object.defineProperty(v,"DurationSecondBuilder",{enumerable:!0,get:function(){return H1.DurationSecondBuilder}});Object.defineProperty(v,"DurationMillisecondBuilder",{enumerable:!0,get:function(){return H1.DurationMillisecondBuilder}});Object.defineProperty(v,"DurationMicrosecondBuilder",{enumerable:!0,get:function(){return H1.DurationMicrosecondBuilder}});Object.defineProperty(v,"DurationNanosecondBuilder",{enumerable:!0,get:function(){return H1.DurationNanosecondBuilder}});Object.defineProperty(v,"IntBuilder",{enumerable:!0,get:function(){return H1.IntBuilder}});Object.defineProperty(v,"Int8Builder",{enumerable:!0,get:function(){return H1.Int8Builder}});Object.defineProperty(v,"Int16Builder",{enumerable:!0,get:function(){return H1.Int16Builder}});Object.defineProperty(v,"Int32Builder",{enumerable:!0,get:function(){return H1.Int32Builder}});Object.defineProperty(v,"Int64Builder",{enumerable:!0,get:function(){return H1.Int64Builder}});Object.defineProperty(v,"Uint8Builder",{enumerable:!0,get:function(){return H1.Uint8Builder}});Object.defineProperty(v,"Uint16Builder",{enumerable:!0,get:function(){return H1.Uint16Builder}});Object.defineProperty(v,"Uint32Builder",{enumerable:!0,get:function(){return H1.Uint32Builder}});Object.defineProperty(v,"Uint64Builder",{enumerable:!0,get:function(){return H1.Uint64Builder}});Object.defineProperty(v,"ListBuilder",{enumerable:!0,get:function(){return H1.ListBuilder}});Object.defineProperty(v,"MapBuilder",{enumerable:!0,get:function(){return H1.MapBuilder}});Object.defineProperty(v,"NullBuilder",{enumerable:!0,get:function(){return H1.NullBuilder}});Object.defineProperty(v,"StructBuilder",{enumerable:!0,get:function(){return H1.StructBuilder}});Object.defineProperty(v,"TimestampBuilder",{enumerable:!0,get:function(){return H1.TimestampBuilder}});Object.defineProperty(v,"TimestampSecondBuilder",{enumerable:!0,get:function(){return H1.TimestampSecondBuilder}});Object.defineProperty(v,"TimestampMillisecondBuilder",{enumerable:!0,get:function(){return H1.TimestampMillisecondBuilder}});Object.defineProperty(v,"TimestampMicrosecondBuilder",{enumerable:!0,get:function(){return H1.TimestampMicrosecondBuilder}});Object.defineProperty(v,"TimestampNanosecondBuilder",{enumerable:!0,get:function(){return H1.TimestampNanosecondBuilder}});Object.defineProperty(v,"TimeBuilder",{enumerable:!0,get:function(){return H1.TimeBuilder}});Object.defineProperty(v,"TimeSecondBuilder",{enumerable:!0,get:function(){return H1.TimeSecondBuilder}});Object.defineProperty(v,"TimeMillisecondBuilder",{enumerable:!0,get:function(){return H1.TimeMillisecondBuilder}});Object.defineProperty(v,"TimeMicrosecondBuilder",{enumerable:!0,get:function(){return H1.TimeMicrosecondBuilder}});Object.defineProperty(v,"TimeNanosecondBuilder",{enumerable:!0,get:function(){return H1.TimeNanosecondBuilder}});Object.defineProperty(v,"UnionBuilder",{enumerable:!0,get:function(){return H1.UnionBuilder}});Object.defineProperty(v,"DenseUnionBuilder",{enumerable:!0,get:function(){return H1.DenseUnionBuilder}});Object.defineProperty(v,"SparseUnionBuilder",{enumerable:!0,get:function(){return H1.SparseUnionBuilder}});Object.defineProperty(v,"Utf8Builder",{enumerable:!0,get:function(){return H1.Utf8Builder}});Object.defineProperty(v,"LargeUtf8Builder",{enumerable:!0,get:function(){return H1.LargeUtf8Builder}})});var U2=g((yH1,MI)=>{var{create:ft,defineProperty:bJ,getOwnPropertyDescriptor:bt,getOwnPropertyNames:mt,getPrototypeOf:ct}=Object,dt=Object.prototype.hasOwnProperty,lt=($,Q)=>()=>(Q||$((Q={exports:{}}).exports,Q),Q.exports),pt=($,Q)=>{for(var J in Q)bJ($,J,{get:Q[J],enumerable:!0})},XI=($,Q,J,Z)=>{if(Q&&typeof Q=="object"||typeof Q=="function")for(let K of mt(Q))!dt.call($,K)&&K!==J&&bJ($,K,{get:()=>Q[K],enumerable:!(Z=bt(Q,K))||Z.enumerable});return $},xH=($,Q,J)=>(J=$!=null?ft(ct($)):{},XI(Q||!$||!$.__esModule?bJ(J,"default",{value:$,enumerable:!0}):J,$)),ut=($)=>XI(bJ({},"__esModule",{value:!0}),$),it=lt(($,Q)=>{Q.exports=Worker}),YI={};pt(YI,{AsyncDuckDB:()=>Je,AsyncDuckDBConnection:()=>DI,AsyncDuckDBDispatcher:()=>Ke,AsyncPreparedStatement:()=>CI,AsyncResultStreamIterator:()=>gH,ConsoleLogger:()=>st,DuckDBAccessMode:()=>WI,DuckDBDataProtocol:()=>kI,IsArrowBuffer:()=>et,IsDuckDBWasmRetry:()=>$e,LogEvent:()=>UI,LogLevel:()=>HI,LogOrigin:()=>VI,LogTopic:()=>FI,PACKAGE_NAME:()=>BI,PACKAGE_VERSION:()=>RI,PACKAGE_VERSION_MAJOR:()=>He,PACKAGE_VERSION_MINOR:()=>Fe,PACKAGE_VERSION_PATCH:()=>Ue,StatusCode:()=>NI,TokenType:()=>qI,VoidLogger:()=>nt,WorkerRequestType:()=>AI,WorkerResponseType:()=>zI,WorkerTask:()=>G1,createWorker:()=>ze,getJsDelivrBundles:()=>De,getLogEventLabel:()=>rt,getLogLevelLabel:()=>ot,getLogOriginLabel:()=>tt,getLogTopicLabel:()=>at,getPlatformFeatures:()=>PI,isFirefox:()=>Ve,isNode:()=>bH,isSafari:()=>Ne,selectBundle:()=>Ce});MI.exports=ut(YI);var WI=(($)=>($[$.UNDEFINED=0]="UNDEFINED",$[$.AUTOMATIC=1]="AUTOMATIC",$[$.READ_ONLY=2]="READ_ONLY",$[$.READ_WRITE=3]="READ_WRITE",$))(WI||{}),qI=(($)=>($[$.IDENTIFIER=0]="IDENTIFIER",$[$.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",$[$.STRING_CONSTANT=2]="STRING_CONSTANT",$[$.OPERATOR=3]="OPERATOR",$[$.KEYWORD=4]="KEYWORD",$[$.COMMENT=5]="COMMENT",$))(qI||{}),HI=(($)=>($[$.NONE=0]="NONE",$[$.DEBUG=1]="DEBUG",$[$.INFO=2]="INFO",$[$.WARNING=3]="WARNING",$[$.ERROR=4]="ERROR",$))(HI||{}),FI=(($)=>($[$.NONE=0]="NONE",$[$.CONNECT=1]="CONNECT",$[$.DISCONNECT=2]="DISCONNECT",$[$.OPEN=3]="OPEN",$[$.QUERY=4]="QUERY",$[$.INSTANTIATE=5]="INSTANTIATE",$))(FI||{}),UI=(($)=>($[$.NONE=0]="NONE",$[$.OK=1]="OK",$[$.ERROR=2]="ERROR",$[$.START=3]="START",$[$.RUN=4]="RUN",$[$.CAPTURE=5]="CAPTURE",$))(UI||{}),VI=(($)=>($[$.NONE=0]="NONE",$[$.WEB_WORKER=1]="WEB_WORKER",$[$.NODE_WORKER=2]="NODE_WORKER",$[$.BINDINGS=3]="BINDINGS",$[$.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",$))(VI||{}),nt=class{log($){}},st=class{constructor($=2){this.level=$}log($){$.level>=this.level&&console.log($)}};function ot($){switch($){case 0:return"NONE";case 1:return"DEBUG";case 2:return"INFO";case 3:return"WARNING";case 4:return"ERROR";default:return"?"}}function rt($){switch($){case 0:return"NONE";case 1:return"OK";case 2:return"ERROR";case 3:return"START";case 4:return"RUN";case 5:return"CAPTURE";default:return"?"}}function at($){switch($){case 1:return"CONNECT";case 2:return"DISCONNECT";case 5:return"INSTANTIATE";case 3:return"OPEN";case 4:return"QUERY";default:return"?"}}function tt($){switch($){case 0:return"NONE";case 1:return"WEB WORKER";case 2:return"NODE WORKER";case 3:return"DUCKDB BINDINGS";case 4:return"DUCKDB";default:return"?"}}var NI=(($)=>($[$.SUCCESS=0]="SUCCESS",$[$.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",$[$.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",$))(NI||{});function et($){return $<=255}function $e($){return $===256}var X8=xH(yJ()),DI=class{constructor($,Q){this._bindings=$,this._conn=Q}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe($){return $(this._bindings,this._conn)}async query($){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:$});let Q=await this._bindings.runQuery(this._conn,$),J=X8.RecordBatchReader.from(Q);return console.assert(J.isSync(),"Reader is not sync"),console.assert(J.isFile(),"Reader is not file"),new X8.Table(J)}async send($,Q=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:$});let J=await this._bindings.startPendingQuery(this._conn,$,Q);for(;J==null;)J=await this._bindings.pollPendingQuery(this._conn);let Z=new gH(this._bindings,this._conn,J),K=await X8.RecordBatchReader.from(Z);return console.assert(K.isAsync()),console.assert(K.isStream()),K}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames($){return await this._bindings.getTableNames(this._conn,$)}async prepare($){let Q=await this._bindings.createPrepared(this._conn,$);return new CI(this._bindings,this._conn,Q)}async insertArrowTable($,Q){let J=X8.tableToIPC($,"stream");await this.insertArrowFromIPCStream(J,Q)}async insertArrowFromIPCStream($,Q){await this._bindings.insertArrowFromIPCStream(this._conn,$,Q)}async insertCSVFromPath($,Q){await this._bindings.insertCSVFromPath(this._conn,$,Q)}async insertJSONFromPath($,Q){await this._bindings.insertJSONFromPath(this._conn,$,Q)}},gH=class{constructor($,Q,J){this.db=$,this.conn=Q,this.header=J,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let $=null;for(this._inFlight!=null&&($=await this._inFlight,this._inFlight=null);$==null;)$=await this.db.fetchQueryResults(this.conn);return this._depleted=$.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:$}}[Symbol.asyncIterator](){return this}},CI=class{constructor($,Q,J){this.bindings=$,this.connectionId=Q,this.statementId=J}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...$){let Q=await this.bindings.runPrepared(this.connectionId,this.statementId,$),J=X8.RecordBatchReader.from(Q);return console.assert(J.isSync()),console.assert(J.isFile()),new X8.Table(J)}async send(...$){let Q=await this.bindings.sendPrepared(this.connectionId,this.statementId,$),J=new gH(this.bindings,this.connectionId,Q),Z=await X8.RecordBatchReader.from(J);return console.assert(Z.isAsync()),console.assert(Z.isStream()),Z}},AI=(($)=>($.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",$.CLOSE_PREPARED="CLOSE_PREPARED",$.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",$.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",$.CONNECT="CONNECT",$.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",$.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",$.CREATE_PREPARED="CREATE_PREPARED",$.DISCONNECT="DISCONNECT",$.DROP_FILE="DROP_FILE",$.DROP_FILES="DROP_FILES",$.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",$.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",$.FLUSH_FILES="FLUSH_FILES",$.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",$.GET_TABLE_NAMES="GET_TABLE_NAMES",$.GET_VERSION="GET_VERSION",$.GLOB_FILE_INFOS="GLOB_FILE_INFOS",$.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",$.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",$.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",$.INSTANTIATE="INSTANTIATE",$.OPEN="OPEN",$.PING="PING",$.POLL_PENDING_QUERY="POLL_PENDING_QUERY",$.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",$.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",$.REGISTER_FILE_URL="REGISTER_FILE_URL",$.RESET="RESET",$.RUN_PREPARED="RUN_PREPARED",$.RUN_QUERY="RUN_QUERY",$.SEND_PREPARED="SEND_PREPARED",$.START_PENDING_QUERY="START_PENDING_QUERY",$.TOKENIZE="TOKENIZE",$))(AI||{}),zI=(($)=>($.CONNECTION_INFO="CONNECTION_INFO",$.ERROR="ERROR",$.FEATURE_FLAGS="FEATURE_FLAGS",$.FILE_BUFFER="FILE_BUFFER",$.FILE_INFOS="FILE_INFOS",$.FILE_SIZE="FILE_SIZE",$.FILE_STATISTICS="FILE_STATISTICS",$.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",$.LOG="LOG",$.PROGRESS_UPDATE="PROGRESS_UPDATE",$.OK="OK",$.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",$.QUERY_PLAN="QUERY_PLAN",$.QUERY_RESULT="QUERY_RESULT",$.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",$.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",$.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",$.REGISTERED_FILE="REGISTERED_FILE",$.SCRIPT_TOKENS="SCRIPT_TOKENS",$.SUCCESS="SUCCESS",$.TABLE_NAMES="TABLE_NAMES",$.VERSION_STRING="VERSION_STRING",$))(zI||{}),G1=class{constructor($,Q){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=$,this.data=Q,this.promise=new Promise((J,Z)=>{this.promiseResolver=J,this.promiseRejecter=Z})}},I1=xH(yJ());function fJ($){switch($.typeId){case I1.Type.Binary:return{sqlType:"binary"};case I1.Type.Bool:return{sqlType:"bool"};case I1.Type.Date:return{sqlType:"date"};case I1.Type.DateDay:return{sqlType:"date32[d]"};case I1.Type.DateMillisecond:return{sqlType:"date64[ms]"};case I1.Type.Decimal:{let Q=$;return{sqlType:"decimal",precision:Q.precision,scale:Q.scale}}case I1.Type.Float:return{sqlType:"float"};case I1.Type.Float16:return{sqlType:"float16"};case I1.Type.Float32:return{sqlType:"float32"};case I1.Type.Float64:return{sqlType:"float64"};case I1.Type.Int:return{sqlType:"int32"};case I1.Type.Int16:return{sqlType:"int16"};case I1.Type.Int32:return{sqlType:"int32"};case I1.Type.Int64:return{sqlType:"int64"};case I1.Type.Uint16:return{sqlType:"uint16"};case I1.Type.Uint32:return{sqlType:"uint32"};case I1.Type.Uint64:return{sqlType:"uint64"};case I1.Type.Uint8:return{sqlType:"uint8"};case I1.Type.IntervalDayTime:return{sqlType:"interval[dt]"};case I1.Type.IntervalYearMonth:return{sqlType:"interval[m]"};case I1.Type.List:return{sqlType:"list",valueType:fJ($.valueType)};case I1.Type.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:$.byteWidth};case I1.Type.Null:return{sqlType:"null"};case I1.Type.Utf8:return{sqlType:"utf8"};case I1.Type.Struct:return{sqlType:"struct",fields:$.children.map((Q)=>_H(Q.name,Q.type))};case I1.Type.Map:{let Q=$;return{sqlType:"map",keyType:fJ(Q.keyType),valueType:fJ(Q.valueType)}}case I1.Type.Time:return{sqlType:"time[s]"};case I1.Type.TimeMicrosecond:return{sqlType:"time[us]"};case I1.Type.TimeMillisecond:return{sqlType:"time[ms]"};case I1.Type.TimeNanosecond:return{sqlType:"time[ns]"};case I1.Type.TimeSecond:return{sqlType:"time[s]"};case I1.Type.Timestamp:return{sqlType:"timestamp",timezone:$.timezone||void 0};case I1.Type.TimestampSecond:return{sqlType:"timestamp[s]",timezone:$.timezone||void 0};case I1.Type.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:$.timezone||void 0};case I1.Type.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:$.timezone||void 0};case I1.Type.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:$.timezone||void 0}}throw Error("unsupported arrow type: ".concat($.toString()))}function _H($,Q){let J=fJ(Q);return J.name=$,J}var Qe=new TextEncoder,Je=class{constructor($,Q=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=$,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),Q!=null&&this.attach(Q)}get logger(){return this._logger}attach($){this._worker=$,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((Q,J)=>{this._workerShutdownResolver=Q})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask($,Q=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!");return}let J=this._nextMessageId++;return this._pendingRequests.set(J,$),this._worker.postMessage({messageId:J,type:$.type,data:$.data},Q),await $.promise}onMessage($){var Q;let J=$.data;switch(J.type){case"PROGRESS_UPDATE":{for(let K of this._onExecutionProgress)K(J.data);return}case"LOG":{this._logger.log(J.data);return}case"INSTANTIATE_PROGRESS":{for(let K of this._onInstantiationProgress)K(J.data);return}}let Z=this._pendingRequests.get(J.requestId);if(!Z){console.warn("unassociated response: [".concat(J.requestId,", ").concat(J.type.toString(),"]"));return}if(this._pendingRequests.delete(J.requestId),J.type=="ERROR"){let K=Error(J.data.message);K.name=J.data.name,(Q=Object.getOwnPropertyDescriptor(K,"stack"))!=null&&Q.writable&&(K.stack=J.data.stack),Z.promiseRejecter(K);return}switch(Z.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(J.type=="OK"){Z.promiseResolver(J.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],J.type=="OK"){Z.promiseResolver(J.data);return}break;case"GLOB_FILE_INFOS":if(J.type=="FILE_INFOS"){Z.promiseResolver(J.data);return}break;case"GET_VERSION":if(J.type=="VERSION_STRING"){Z.promiseResolver(J.data);return}break;case"GET_FEATURE_FLAGS":if(J.type=="FEATURE_FLAGS"){Z.promiseResolver(J.data);return}break;case"GET_TABLE_NAMES":if(J.type=="TABLE_NAMES"){Z.promiseResolver(J.data);return}break;case"TOKENIZE":if(J.type=="SCRIPT_TOKENS"){Z.promiseResolver(J.data);return}break;case"COPY_FILE_TO_BUFFER":if(J.type=="FILE_BUFFER"){Z.promiseResolver(J.data);return}break;case"EXPORT_FILE_STATISTICS":if(J.type=="FILE_STATISTICS"){Z.promiseResolver(J.data);return}break;case"CONNECT":if(J.type=="CONNECTION_INFO"){Z.promiseResolver(J.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(J.type=="QUERY_RESULT"){Z.promiseResolver(J.data);return}break;case"SEND_PREPARED":if(J.type=="QUERY_RESULT_HEADER"){Z.promiseResolver(J.data);return}break;case"START_PENDING_QUERY":if(J.type=="QUERY_RESULT_HEADER_OR_NULL"){Z.promiseResolver(J.data);return}break;case"POLL_PENDING_QUERY":if(J.type=="QUERY_RESULT_HEADER_OR_NULL"){Z.promiseResolver(J.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],J.type=="SUCCESS"){Z.promiseResolver(J.data);return}break;case"FETCH_QUERY_RESULTS":if(J.type=="QUERY_RESULT_CHUNK"){Z.promiseResolver(J.data);return}break;case"CREATE_PREPARED":if(J.type=="PREPARED_STATEMENT_ID"){Z.promiseResolver(J.data);return}break}Z.promiseRejecter(Error("unexpected response type: ".concat(J.type.toString())))}onError($){console.error($),console.error("error in duckdb worker: ".concat($.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}async reset(){let $=new G1("RESET",null);return await this.postTask($)}async ping(){let $=new G1("PING",null);await this.postTask($)}async dropFile($){let Q=new G1("DROP_FILE",$);return await this.postTask(Q)}async dropFiles(){let $=new G1("DROP_FILES",null);return await this.postTask($)}async flushFiles(){let $=new G1("FLUSH_FILES",null);return await this.postTask($)}async instantiate($,Q=null,J=(Z)=>{}){this._onInstantiationProgress.push(J);let Z=new G1("INSTANTIATE",[$,Q]);return await this.postTask(Z)}async getVersion(){let $=new G1("GET_VERSION",null);return await this.postTask($)}async getFeatureFlags(){let $=new G1("GET_FEATURE_FLAGS",null);return await this.postTask($)}async open($){let Q=new G1("OPEN",$);await this.postTask(Q)}async tokenize($){let Q=new G1("TOKENIZE",$);return await this.postTask(Q)}async connectInternal(){let $=new G1("CONNECT",null);return await this.postTask($)}async connect(){let $=await this.connectInternal();return new DI(this,$)}async disconnect($){let Q=new G1("DISCONNECT",$);await this.postTask(Q)}async runQuery($,Q){let J=new G1("RUN_QUERY",[$,Q]);return await this.postTask(J)}async startPendingQuery($,Q,J=!1){let Z=new G1("START_PENDING_QUERY",[$,Q,J]);return await this.postTask(Z)}async pollPendingQuery($){let Q=new G1("POLL_PENDING_QUERY",$);return await this.postTask(Q)}async cancelPendingQuery($){let Q=new G1("CANCEL_PENDING_QUERY",$);return await this.postTask(Q)}async fetchQueryResults($){let Q=new G1("FETCH_QUERY_RESULTS",$);return await this.postTask(Q)}async getTableNames($,Q){let J=new G1("GET_TABLE_NAMES",[$,Q]);return await this.postTask(J)}async createPrepared($,Q){let J=new G1("CREATE_PREPARED",[$,Q]);return await this.postTask(J)}async closePrepared($,Q){let J=new G1("CLOSE_PREPARED",[$,Q]);await this.postTask(J)}async runPrepared($,Q,J){let Z=new G1("RUN_PREPARED",[$,Q,J]);return await this.postTask(Z)}async sendPrepared($,Q,J){let Z=new G1("SEND_PREPARED",[$,Q,J]);return await this.postTask(Z)}async globFiles($){let Q=new G1("GLOB_FILE_INFOS",$);return await this.postTask(Q)}async registerFileText($,Q){let J=Qe.encode(Q);await this.registerFileBuffer($,J)}async registerFileURL($,Q,J,Z){Q===void 0&&(Q=$);let K=new G1("REGISTER_FILE_URL",[$,Q,J,Z]);await this.postTask(K)}async registerEmptyFileBuffer($){}async registerFileBuffer($,Q){let J=new G1("REGISTER_FILE_BUFFER",[$,Q]);await this.postTask(J,[Q.buffer])}async registerFileHandle($,Q,J,Z){let K=new G1("REGISTER_FILE_HANDLE",[$,Q,J,Z]);await this.postTask(K,[])}async registerOPFSFileName($){let Q=new G1("REGISTER_OPFS_FILE_NAME",[$]);await this.postTask(Q,[])}async collectFileStatistics($,Q){let J=new G1("COLLECT_FILE_STATISTICS",[$,Q]);await this.postTask(J,[])}async exportFileStatistics($){let Q=new G1("EXPORT_FILE_STATISTICS",$);return await this.postTask(Q,[])}async copyFileToBuffer($){let Q=new G1("COPY_FILE_TO_BUFFER",$);return await this.postTask(Q)}async copyFileToPath($,Q){let J=new G1("COPY_FILE_TO_PATH",[$,Q]);await this.postTask(J)}async insertArrowFromIPCStream($,Q,J){if(Q.length==0)return;let Z=new G1("INSERT_ARROW_FROM_IPC_STREAM",[$,Q,J]);await this.postTask(Z,[Q.buffer])}async insertCSVFromPath($,Q,J){if(J.columns!==void 0){let K=[];for(let X in J.columns){let Y=J.columns[X];K.push(_H(X,Y))}J.columnsFlat=K,delete J.columns}let Z=new G1("IMPORT_CSV_FROM_PATH",[$,Q,J]);await this.postTask(Z)}async insertJSONFromPath($,Q,J){if(J.columns!==void 0){let K=[];for(let X in J.columns){let Y=J.columns[X];K.push(_H(X,Y))}J.columnsFlat=K,delete J.columns}let Z=new G1("IMPORT_JSON_FROM_PATH",[$,Q,J]);await this.postTask(Z)}};function Ze(){let $=new TextDecoder;return(Q)=>(typeof SharedArrayBuffer<"u"&&Q.buffer instanceof SharedArrayBuffer&&(Q=new Uint8Array(Q)),$.decode(Q))}var gH1=Ze(),kI=(($)=>($[$.BUFFER=0]="BUFFER",$[$.NODE_FS=1]="NODE_FS",$[$.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",$[$.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",$[$.HTTP=4]="HTTP",$[$.S3=5]="S3",$))(kI||{}),Ke=class{constructor(){this._bindings=null,this._nextMessageId=0}log($){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:$},[])}sendOK($){this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"OK",data:null},[])}failWith($,Q){let J={name:Q.name,message:Q.message,stack:Q.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"ERROR",data:J},[])}async onMessage($){switch($.type){case"PING":this.sendOK($);return;case"INSTANTIATE":this._bindings!=null&&this.failWith($,Error("duckdb already initialized"));try{this._bindings=await this.instantiate($.data[0],$.data[1],(Q)=>{this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"INSTANTIATE_PROGRESS",data:Q},[])}),this.sendOK($)}catch(Q){console.log(Q),this._bindings=null,this.failWith($,Q)}return;default:break}if(!this._bindings)return this.failWith($,Error("duckdb is not initialized"));try{switch($.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK($);break;case"OPEN":{let Q=$.data.path;Q!=null&&Q.startsWith("opfs://")&&(await this._bindings.prepareDBFileHandle(Q,3),$.data.useDirectIO=!0),this._bindings.open($.data),this.sendOK($);break}case"DROP_FILE":this._bindings.dropFile($.data),this.sendOK($);break;case"DROP_FILES":this._bindings.dropFiles(),this.sendOK($);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK($);break;case"CONNECT":{let Q=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"CONNECTION_INFO",data:Q.useUnsafe((J,Z)=>Z)},[]);break}case"DISCONNECT":this._bindings.disconnect($.data),this.sendOK($);break;case"CREATE_PREPARED":{let Q=this._bindings.createPrepared($.data[0],$.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"PREPARED_STATEMENT_ID",data:Q},[]);break}case"CLOSE_PREPARED":{this._bindings.closePrepared($.data[0],$.data[1]),this.sendOK($);break}case"RUN_PREPARED":{let Q=this._bindings.runPrepared($.data[0],$.data[1],$.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT",data:Q},[Q.buffer]);break}case"RUN_QUERY":{let Q=this._bindings.runQuery($.data[0],$.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT",data:Q},[Q.buffer]);break}case"SEND_PREPARED":{let Q=this._bindings.sendPrepared($.data[0],$.data[1],$.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT_HEADER",data:Q},[Q.buffer]);break}case"START_PENDING_QUERY":{let Q=this._bindings.startPendingQuery($.data[0],$.data[1],$.data[2]),J=[];Q&&J.push(Q.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:Q},J);break}case"POLL_PENDING_QUERY":{let Q=this._bindings.pollPendingQuery($.data),J=[];Q&&J.push(Q.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:Q},J);break}case"CANCEL_PENDING_QUERY":{let Q=this._bindings.cancelPendingQuery($.data);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"SUCCESS",data:Q},[]);break}case"FETCH_QUERY_RESULTS":{let Q=this._bindings.fetchQueryResults($.data),J=Q?[Q.buffer]:[];this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"QUERY_RESULT_CHUNK",data:Q},J);break}case"GET_TABLE_NAMES":{let Q=this._bindings.getTableNames($.data[0],$.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"TABLE_NAMES",data:Q},[]);break}case"GLOB_FILE_INFOS":{let Q=this._bindings.globFiles($.data);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"FILE_INFOS",data:Q},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL($.data[0],$.data[1],$.data[2],$.data[3]),this.sendOK($);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer($.data[0],$.data[1]),this.sendOK($);break;case"REGISTER_FILE_HANDLE":await this._bindings.registerFileHandleAsync($.data[0],$.data[1],$.data[2],$.data[3]),this.sendOK($);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath($.data[0],$.data[1]),this.sendOK($);break;case"COPY_FILE_TO_BUFFER":{let Q=this._bindings.copyFileToBuffer($.data);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"FILE_BUFFER",data:Q},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics($.data[0],$.data[1]),this.sendOK($);break;case"REGISTER_OPFS_FILE_NAME":this._bindings.registerOPFSFileName($.data[0]),this.sendOK($);break;case"EXPORT_FILE_STATISTICS":{this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics($.data)},[]);break}case"INSERT_ARROW_FROM_IPC_STREAM":{this._bindings.insertArrowFromIPCStream($.data[0],$.data[1],$.data[2]),this.sendOK($);break}case"IMPORT_CSV_FROM_PATH":{this._bindings.insertCSVFromPath($.data[0],$.data[1],$.data[2]),this.sendOK($);break}case"IMPORT_JSON_FROM_PATH":{this._bindings.insertJSONFromPath($.data[0],$.data[1],$.data[2]),this.sendOK($);break}case"TOKENIZE":{let Q=this._bindings.tokenize($.data);this.postMessage({messageId:this._nextMessageId++,requestId:$.messageId,type:"SCRIPT_TOKENS",data:Q},[]);break}}}catch(Q){return console.log(Q),this.failWith($,Q)}}},Xe=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),Ye=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),We=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),qe=()=>(async($)=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate($)}catch(Q){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),yH={name:"@duckdb/duckdb-wasm",version:"1.30.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"apache-arrow":"^17.0.0"},devDependencies:{"@types/emscripten":"^1.39.10","@types/jasmine":"^5.1.4","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0",esbuild:"^0.20.2",eslint:"^8.57.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.34.0","fast-glob":"^3.3.2",jasmine:"^5.1.0","jasmine-core":"^5.1.2","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.11.1",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-firefox-launcher":"^2.1.3","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-spec-reporter":"^0.0.36","make-dir":"^4.0.0",nyc:"^15.1.0",prettier:"^3.2.5",puppeteer:"^22.8.0",rimraf:"^5.0.5",s3rver:"^3.7.1",typedoc:"^0.25.13",typescript:"^5.3.3","wasm-feature-detect":"^1.6.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",format:'prettier --write "**/*.+(js|ts)"',report:"node ./coverage.mjs","test:node":"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/tests-*","!dist/duckdb-browser-mvp.worker.js.map","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,path:!1,perf_hooks:!1,os:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-node-blocking.d.ts",import:"./dist/duckdb-node-blocking.mjs",require:"./dist/duckdb-node-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}},BI=yH.name,RI=yH.version,fH=yH.version.split("."),He=fH[0],Fe=fH[1],Ue=fH[2],bH=()=>typeof navigator>"u",OI=()=>bH()?"node":navigator.userAgent,Ve=()=>OI().includes("Firefox"),Ne=()=>/^((?!chrome|android).)*safari/i.test(OI());function De(){let $="https://cdn.jsdelivr.net/npm/".concat(BI,"@").concat(RI,"/dist/");return{mvp:{mainModule:"".concat($,"duckdb-mvp.wasm"),mainWorker:"".concat($,"duckdb-browser-mvp.worker.js")},eh:{mainModule:"".concat($,"duckdb-eh.wasm"),mainWorker:"".concat($,"duckdb-browser-eh.worker.js")}}}var EH=null,jH=null,hH=null,LH=null,vH=null;async function PI(){return EH==null&&(EH=typeof BigInt64Array<"u"),jH==null&&(jH=await Ye()),hH==null&&(hH=await qe()),LH==null&&(LH=await We()),vH==null&&(vH=await Xe()),{bigInt64Array:EH,crossOriginIsolated:bH()||globalThis.crossOriginIsolated||!1,wasmExceptions:jH,wasmSIMD:LH,wasmThreads:hH,wasmBulkMemory:vH}}async function Ce($){let Q=await PI();if(Q.wasmExceptions){if(Q.wasmSIMD&&Q.wasmThreads&&Q.crossOriginIsolated&&$.coi)return{mainModule:$.coi.mainModule,mainWorker:$.coi.mainWorker,pthreadWorker:$.coi.pthreadWorker};if($.eh)return{mainModule:$.eh.mainModule,mainWorker:$.eh.mainWorker,pthreadWorker:null}}return{mainModule:$.mvp.mainModule,mainWorker:$.mvp.mainWorker,pthreadWorker:null}}var Ae=xH(it());async function ze($){let Q=new Request($),J=await fetch(Q),Z=URL.createObjectURL(await J.blob());return new Ae.default(Z)}});var mH=g((Le)=>{var Z0=A0(Z5(),1);function P9(){return P9=Object.assign||function($){for(var Q=1;Q<arguments.length;Q++){var J=arguments[Q];for(var Z in J)if(Object.prototype.hasOwnProperty.call(J,Z))$[Z]=J[Z]}return $},P9.apply(this,arguments)}var iH1=typeof Symbol<"u"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator",nH1=typeof Symbol<"u"?Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")):"@@asyncIterator";function ke($,Q){try{var J=$()}catch(Z){return Q(!0,Z)}if(J&&J.then)return J.then(Q.bind(null,!1),Q.bind(null,!0));return Q(!1,value)}var Be=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?Z0.useLayoutEffect:Z0.useEffect,Re=function(Q){var J=Z0.useRef(Q);return Be(function(){J.current=Q}),Z0.useCallback(function(){return J.current},[J])},Oe={status:"not-requested",loading:!1,result:void 0,error:void 0},SI={status:"loading",loading:!0,result:void 0,error:void 0},Pe=function(Q){return SI},Me=function(Q,J){return{status:"success",loading:!1,result:Q,error:void 0}},we=function(Q,J){return{status:"error",loading:!1,result:void 0,error:Q}},wI=function(){},Se={initialState:function(Q){return Q&&Q.executeOnMount?SI:Oe},executeOnMount:!0,executeOnUpdate:!0,setLoading:Pe,setResult:Me,setError:we,onSuccess:wI,onError:wI},Te=function(Q){return P9({},Se,{},Q)},Ie=function(Q){var J=Z0.useState(function(){return Q.initialState(Q)}),Z=J[0],K=J[1],X=Z0.useCallback(function(){return K(Q.initialState(Q))},[K,Q]),Y=Z0.useCallback(function(){return K(Q.setLoading(Z))},[Z,K]),W=Z0.useCallback(function(F){return K(Q.setResult(F,Z))},[Z,K]),q=Z0.useCallback(function(F){return K(Q.setError(F,Z))},[Z,K]),H=Z0.useCallback(function(F){return K(P9({},Z,{},F))},[Z,K]);return{value:Z,set:K,merge:H,reset:X,setLoading:Y,setResult:W,setError:q}},Ge=function(){var Q=Z0.useRef(!1);return Z0.useEffect(function(){return Q.current=!0,function(){Q.current=!1}},[]),function(){return Q.current}},Ee=function(){var Q=Z0.useRef(null);return{set:function(Z){return Q.current=Z},get:function(){return Q.current},is:function(Z){return Q.current===Z}}},TI=function(Q,J,Z){!J&&(J=[]);var K=Te(Z),X=Z0.useState(null),Y=X[0],W=X[1],q=Ie(K),H=Ge(),F=Ee(),U=function(M){return H()&&F.is(M)},V=function(){for(var M=arguments.length,P=Array(M),O=0;O<M;O++)P[O]=arguments[O];var G=function(){try{return Promise.resolve(Q.apply(void 0,P))}catch(L){return Promise.reject(L)}}();return W(P),F.set(G),q.setLoading(),G.then(function(L){if(U(G))q.setResult(L);K.onSuccess(L,{isCurrent:function(){return F.is(G)}})},function(L){if(U(G))q.setError(L);K.onError(L,{isCurrent:function(){return F.is(G)}})}),G},N=Re(V),D=Z0.useCallback(function(){return N().apply(void 0,arguments)},[N]),z=!H();return Z0.useEffect(function(){var B=function(){return N().apply(void 0,J)};z&&K.executeOnMount&&B(),!z&&K.executeOnUpdate&&B()},J),P9({},q.value,{set:q.set,merge:q.merge,reset:q.reset,execute:D,currentPromise:F.get(),currentParams:Y})};function II($,Q,J){return TI($,Q,J)}var je=function(Q,J,Z){var K=Z0.useRef(),X=function(){for(var W=arguments.length,q=Array(W),H=0;H<W;H++)q[H]=arguments[H];try{if(K.current)K.current.abort();var F=new AbortController;return K.current=F,Promise.resolve(ke(function(){return Promise.resolve(Q.apply(void 0,[F.signal].concat(q)))},function(U,V){if(K.current===F)K.current=void 0;if(U)throw V;return V}))}catch(U){return Promise.reject(U)}};return II(X,J,Z)},he=function(Q,J){return TI(Q,[],P9({},J,{executeOnMount:!1,executeOnUpdate:!1}))};Le.useAsync=II;Le.useAsyncAbortable=je;Le.useAsyncCallback=he});var lI=g((oH1,dI)=>{var{create:ge,defineProperty:dJ,getOwnPropertyDescriptor:ye,getOwnPropertyNames:fe,getPrototypeOf:be}=Object,me=Object.prototype.hasOwnProperty,ce=($,Q)=>{for(var J in Q)dJ($,J,{get:Q[J],enumerable:!0})},GI=($,Q,J,Z)=>{if(Q&&typeof Q==="object"||typeof Q==="function"){for(let K of fe(Q))if(!me.call($,K)&&K!==J)dJ($,K,{get:()=>Q[K],enumerable:!(Z=ye(Q,K))||Z.enumerable})}return $},EI=($,Q,J)=>(J=$!=null?ge(be($)):{},GI(Q||!$||!$.__esModule?dJ(J,"default",{value:$,enumerable:!0}):J,$)),de=($)=>GI(dJ({},"__esModule",{value:!0}),$),K0=($,Q,J)=>{return new Promise((Z,K)=>{var X=(q)=>{try{W(J.next(q))}catch(H){K(H)}},Y=(q)=>{try{W(J.throw(q))}catch(H){K(H)}},W=(q)=>q.done?Z(q.value):Promise.resolve(q.value).then(X,Y);W((J=J.apply($,Q)).next())})},jI={};ce(jI,{ARROW_MIME_TYPE:()=>xI,AsyncDuckDB:()=>le.AsyncDuckDB,CSV_MIME_TYPE:()=>fI,InsertFileError:()=>M9,PARQUET_MIME_TYPE:()=>bI,arrayBufferToArrow:()=>iH,arrowToArrayBuffer:()=>yI,arrowToJSON:()=>J11,cardinalities:()=>$11,drop:()=>ee,exportArrow:()=>Z11,exportCsv:()=>K11,exportParquet:()=>X11,getDuckDB:()=>LI,getTempFilename:()=>N2,initializeDuckDb:()=>hI,insertArrow:()=>dH,insertArrowTable:()=>cI,insertCSV:()=>cH,insertFile:()=>H11,insertParquet:()=>lH,isArrow:()=>Q11,isArrowFile:()=>gI,isParquetFile:()=>mI,runQuery:()=>T5,useDuckDb:()=>vI,useDuckDbQuery:()=>ae});dI.exports=de(jI);var le=U2(),pe=mH(),mJ=EI(U2()),ue=U2(),ie="\x1B[31m",ne="\x1B[0m",se=($,Q,J=void 0)=>{let K=(J!=null?J:performance.now())-Q,X;switch(!0){case K>=1000:X=`${(K/1000).toFixed(1)}s`;break;case K>=1:X=`${K.toFixed(0)}ms`;break;default:X=`${K.toFixed(3)}ms`;break}return`${ie}[${X}] ${ne}${$}`},pH=($,Q,J=void 0)=>{console.debug(se($,Q,J))},cJ,V2;function hI($){return K0(this,null,function*(){let{debug:Q=!1,config:J}=$||{};if(cJ=Q,V2===void 0)V2=oe(J);return V2})}var oe=($)=>K0(null,null,function*(){let Q=performance.now(),J=mJ.getJsDelivrBundles(),Z=yield mJ.selectBundle(J),K=URL.createObjectURL(new Blob([`importScripts("${Z.mainWorker}");`],{type:"text/javascript"})),X=new Worker(K),Y=cJ?new mJ.ConsoleLogger:new mJ.VoidLogger,W=new ue.AsyncDuckDB(Y,X);if(yield W.instantiate(Z.mainModule,Z.pthreadWorker),URL.revokeObjectURL(K),$){if($.path){let H=yield(yield fetch($.path)).arrayBuffer(),F=$.path.match(/[^/]*$/);if(F)$.path=F[0];yield W.registerFileBuffer($.path,new Uint8Array(H))}yield W.open($)}if(cJ){if(pH("DuckDB initialized",Q),$)console.debug(`DuckDbConfig: ${JSON.stringify($,null,2)}`)}return W}),LI=()=>K0(null,null,function*(){if(V2)return V2;return yield hI()}),vI=()=>{let{result:$,loading:Q,error:J}=(0,pe.useAsync)(()=>K0(null,null,function*(){return yield LI()}),[]);return{db:$,loading:Q,error:J}},re=mH(),T5=($,Q)=>K0(null,null,function*(){let J=performance.now(),Z=yield $.connect(),K=yield Z.query(Q);return yield Z.close(),cJ&&pH(`Run query: ${Q}`,J),K}),ae=($)=>{let{db:Q}=vI(),{result:J,loading:Z,error:K}=(0,re.useAsync)(()=>K0(null,null,function*(){if(!Q||!$)return;return yield T5(Q,$)}),[Q,$]);return{arrow:J,loading:Z,error:K}},te=($,Q)=>K0(null,null,function*(){let J=yield T5($,`select table_type from information_schema.tables where table_name = '${Q}'`);if(J.numRows===1){let Z=J.get(0),K=Z==null?void 0:Z.toArray()[0];switch(K){case"BASE TABLE":return"Table";case"VIEW":return"View";default:throw Error(`Unexpected table type: ${K}`)}}return}),ee=($,Q)=>K0(null,null,function*(){let J=yield te($,Q);if(J==="Table")yield T5($,`drop table if exists "${Q}"`);else if(J==="View")yield T5($,`drop view if exists "${Q}"`)}),_I=($,Q)=>K0(null,null,function*(){let J=yield T5($,`select column_name, data_type from information_schema.columns where table_name = '${Q}'`),Z=new Map;for(let K=0;K<J.numRows;K++){let X=J.get(K);if(X){let[Y,W]=X.toArray();Z.set(Y,W)}}return Z}),$11=($,Q)=>K0(null,null,function*(){let J=yield _I($,Q),Z=Array.from(J.keys()),X=(yield T5($,`select count(distinct columns(*)) from "${Q}"`)).get(0);if(!X)throw Error(`Expected a single row of cardinalities: ${Q}`);let Y=X.toArray();if(Y.length!==Z.length)throw Error(`Unexpected length mismatch: ${Q}`);let W={};for(let q=0;q<Z.length;q++)W[Z[q]]=Y[q];return W}),N2=()=>{let $=Date.now().toString(),Q=Math.random().toString(36).substring(2);return`file-${$}-${Q}`},uH=yJ(),xI="application/vnd.apache.arrow.file",Q11=($)=>$ instanceof uH.Table,gI=($)=>K0(null,null,function*(){try{let Q=yield $.arrayBuffer();return iH(Q),!0}catch(Q){}return!1}),iH=($)=>{return(0,uH.tableFromIPC)(new Uint8Array($))},yI=($)=>{return(0,uH.tableToIPC)($,"file").buffer};function J11($){let Q=[];for(let J=0;J<$.numRows;J++){let Z=$.get(J);if(Z)Q.push(Z.toJSON())}return Q}var fI="text/csv",bI="application/vnd.apache.parquet",mI=($)=>K0(null,null,function*(){return(yield $.slice(0,4).text()).startsWith("PAR1")}),Z11=($,Q,J)=>K0(null,null,function*(){let Z=J||nH(Q,"arrow"),K=yield T5($,`SELECT * FROM '${Q}'`),X=yI(K);return new File([X],Z,{type:xI})}),K11=($,Q,J,Z=",")=>K0(null,null,function*(){let K=J||nH(Q,"csv"),X=N2();yield T5($,`COPY '${Q}' TO '${X}' WITH (HEADER 1, DELIMITER '${Z}')`);let Y=yield $.copyFileToBuffer(X);return yield $.dropFile(X),new File([Y],K,{type:fI})}),X11=($,Q,J,Z="zstd")=>K0(null,null,function*(){let K=J||nH(Q,"parquet"),X=N2();yield T5($,`COPY '${Q}' TO '${X}' (FORMAT PARQUET, COMPRESSION ${Z})`);let Y=yield $.copyFileToBuffer(X);return yield $.dropFile(X),new File([Y],K,{type:bI})}),Y11=($,Q)=>{let J=$.split("."),Z=J.length>1?J.pop():"",K=J.join(".");if(Q.includes(Z))return K;return $},nH=($,Q)=>{return`${Y11($,["arrow","csv","parquet"])}.${Q}`},W11=EI(U2()),q11=($,Q)=>K0(null,null,function*(){let J=yield _I($,Q),Z=Array.from(J.keys());for(let K=0;K<Z.length;K++){let X=Z[K];if(X.toLowerCase().includes("year"))yield T5($,`ALTER TABLE "${Q}" ALTER COLUMN "${X}" SET DATA TYPE VARCHAR`)}}),M9=class extends Error{constructor($,Q){super(Q);this.title=$,this.name="InsertFileError"}},H11=($,Q,J,Z=!1)=>K0(null,null,function*(){let K=performance.now();if(yield F11($,Q,J),Z)pH(`Imported ${Q.name}`,K)}),F11=($,Q,J)=>K0(null,null,function*(){try{let Z=J||Q.name;if(yield mI(Q)){yield lH($,Q,Z);return}if(yield gI(Q)){yield dH($,Q,Z);return}switch(Q.name.toLowerCase().split(".").at(-1)){case"arrow":yield dH($,Q,Z);return;case"parquet":yield lH($,Q,Z);return;case"csv":yield cH($,Q,Z);return}return yield cH($,Q,Z)}catch(Z){if(console.error(Z),Z instanceof M9)throw Z;else throw new M9("Invalid file type","Only CSV, Parquet, or Arrow files are supported")}}),cH=($,Q,J)=>K0(null,null,function*(){try{let Z=yield Q.text(),K=N2();yield $.registerFileText(K,Z);let X=yield $.connect();yield X.insertCSVFromPath(K,{name:J,schema:"main",detect:!0}),yield X.close(),$.dropFile(K),yield q11($,J)}catch(Z){if(console.error(Z),Q.type==="text/csv"||Q.name.toLowerCase().endsWith(".csv"))throw new M9("CSV import failed","Sorry, we couldn't import that CSV. Please try again.");throw Z}}),dH=($,Q,J)=>K0(null,null,function*(){try{let Z=yield Q.arrayBuffer(),K=iH(Z);yield cI($,K,J)}catch(Z){throw console.error(Z),new M9("Arrow import failed","Sorry, we couldn't import that file")}}),cI=($,Q,J)=>K0(null,null,function*(){let Z=yield $.connect();yield Z.insertArrowTable(Q,{name:J}),yield Z.close()}),lH=($,Q,J)=>K0(null,null,function*(){try{let Z=`${N2()}.parquet`;yield $.registerFileHandle(Z,Q,W11.DuckDBDataProtocol.BROWSER_FILEREADER,!0),yield T5($,`CREATE TABLE '${J}' AS SELECT * FROM '${Z}'`),yield $.dropFile(Z)}catch(Z){throw console.error(Z),new M9("Parquet import failed","Sorry, we couldn't import that file")}})});var D2=g((U11)=>{var Y8=A0(Z5(),1);(function(){function $(c){if(c==null)return null;if(typeof c==="function")return c.$$typeof===i?null:c.displayName||c.name||null;if(typeof c==="string")return c;switch(c){case D:return"Fragment";case B:return"Profiler";case z:return"StrictMode";case G:return"Suspense";case L:return"SuspenseList";case p:return"Activity"}if(typeof c==="object")switch(typeof c.tag==="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),c.$$typeof){case N:return"Portal";case P:return(c.displayName||"Context")+".Provider";case M:return(c._context.displayName||"Context")+".Consumer";case O:var B1=c.render;return c=c.displayName,c||(c=B1.displayName||B1.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case b:return B1=c.displayName||null,B1!==null?B1:$(c.type)||"Memo";case d:B1=c._payload,c=c._init;try{return $(c(B1))}catch(u1){}}return null}function Q(c){return""+c}function J(c){try{Q(c);var B1=!1}catch(i6){B1=!0}if(B1){B1=console;var u1=B1.error,w0=typeof Symbol==="function"&&Symbol.toStringTag&&c[Symbol.toStringTag]||c.constructor.name||"Object";return u1.call(B1,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",w0),Q(c)}}function Z(c){if(c===D)return"<>";if(typeof c==="object"&&c!==null&&c.$$typeof===d)return"<...>";try{var B1=$(c);return B1?"<"+B1+">":"<...>"}catch(u1){return"<...>"}}function K(){var c=l.A;return c===null?null:c.getOwner()}function X(){return Error("react-stack-top-frame")}function Y(c){if(N1.call(c,"key")){var B1=Object.getOwnPropertyDescriptor(c,"key").get;if(B1&&B1.isReactWarning)return!1}return c.key!==void 0}function W(c,B1){function u1(){D1||(D1=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",B1))}u1.isReactWarning=!0,Object.defineProperty(c,"key",{get:u1,configurable:!0})}function q(){var c=$(this.type);return F0[c]||(F0[c]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),c=this.props.ref,c!==void 0?c:null}function H(c,B1,u1,w0,i6,n6,w4,G7){return u1=n6.ref,c={$$typeof:V,type:c,key:B1,props:n6,_owner:i6},(u1!==void 0?u1:null)!==null?Object.defineProperty(c,"ref",{enumerable:!1,get:q}):Object.defineProperty(c,"ref",{enumerable:!1,value:null}),c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(c,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(c,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:w4}),Object.defineProperty(c,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:G7}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}function F(c,B1,u1,w0,i6,n6,w4,G7){var q0=B1.children;if(q0!==void 0)if(w0)if(Y1(q0)){for(w0=0;w0<q0.length;w0++)U(q0[w0]);Object.freeze&&Object.freeze(q0)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else U(q0);if(N1.call(B1,"key")){q0=$(c);var S4=Object.keys(B1).filter(function(l$){return l$!=="key"});w0=0<S4.length?"{key: someKey, "+S4.join(": ..., ")+": ...}":"{key: someKey}",u6[q0+w0]||(S4=0<S4.length?"{"+S4.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,w0,q0,S4,q0),u6[q0+w0]=!0)}if(q0=null,u1!==void 0&&(J(u1),q0=""+u1),Y(B1)&&(J(B1.key),q0=""+B1.key),"key"in B1){u1={};for(var y8 in B1)y8!=="key"&&(u1[y8]=B1[y8])}else u1=B1;return q0&&W(u1,typeof c==="function"?c.displayName||c.name||"Unknown":c),H(c,q0,n6,i6,K(),u1,w4,G7)}function U(c){typeof c==="object"&&c!==null&&c.$$typeof===V&&c._store&&(c._store.validated=1)}var V=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),P=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),i=Symbol.for("react.client.reference"),l=Y8.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N1=Object.prototype.hasOwnProperty,Y1=Array.isArray,a=console.createTask?console.createTask:function(){return null};Y8={react_stack_bottom_frame:function(c){return c()}};var D1,F0={},d5=Y8.react_stack_bottom_frame.bind(Y8,X)(),F6=a(Z(X)),u6={};U11.Fragment=D,U11.jsxDEV=function(c,B1,u1,w0,i6,n6){var w4=1e4>l.recentlyCreatedOwnerStacks++;return F(c,B1,u1,w0,i6,n6,w4?Error("react-stack-top-frame"):d5,w4?a(Z(c)):F6)}})()});function QF1({children:$}){let{db:Q}=pI.useDuckDb(),[J,Z]=w9.useState(0),K=()=>Z((X)=>X+1);return nI.jsxDEV(uI.Provider,{value:{db:Q,tableVersion:J,refreshTables:K},children:$},void 0,!1,void 0,this)}function iI(){let $=w9.useContext(uI);if(!$)throw Error("useDuckDB must be used within a DuckDBProvider");return $}var w9,pI,nI,uI;var sI=C(()=>{w9=A0(Z5(),1),pI=A0(lI(),1),nI=A0(D2(),1),uI=w9.createContext(null)});function Y7($,Q){if(!$)throw Error(Q||"loader assertion failed.")}var T6,V11,N11,D11,C11,W8,oI,A11;var rI=C(()=>{T6={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},V11=T6.self||T6.window||T6.global||{},N11=T6.window||T6.self||T6.global||{},D11=T6.global||T6.self||T6.window||{},C11=T6.document||{},W8=Boolean(typeof process!=="object"||String(process)!=="[object process]"||!0),oI=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),A11=oI&&parseFloat(oI[1])||0});var lJ,z11,pJ,k11,sH;var oH=C(()=>{lJ=globalThis,z11=globalThis.document||{},pJ=globalThis.process||{},k11=globalThis.console,sH=globalThis.navigator||{}});function uJ($){if(typeof window<"u"&&window.process?.type==="renderer")return!0;if(typeof process<"u"&&Boolean(process.versions?.electron))return!0;let Q=typeof navigator<"u"&&navigator.userAgent,J=$||Q;return Boolean(J&&J.indexOf("Electron")>=0)}function d0(){return!(typeof process==="object"&&String(process)==="[object process]"&&!process?.browser)||uJ()}var rH=()=>{};function aH($){if(!$&&!d0())return"Node";if(uJ($))return"Electron";if(($||sH.userAgent||"").indexOf("Edge")>-1)return"Edge";if(globalThis.chrome)return"Chrome";if(globalThis.safari)return"Safari";if(globalThis.mozInnerScreenX)return"Firefox";return"Unknown"}var aI=C(()=>{rH();oH()});var tH="4.1.0";var W7=C(()=>{oH();rH();aI()});function R11($){try{let Q=window[$],J="__storage_test__";return Q.setItem("__storage_test__","__storage_test__"),Q.removeItem("__storage_test__"),Q}catch(Q){return null}}class eH{constructor($,Q,J="sessionStorage"){this.storage=R11(J),this.id=$,this.config=Q,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration($){if(Object.assign(this.config,$),this.storage){let Q=JSON.stringify(this.config);this.storage.setItem(this.id,Q)}}_loadConfiguration(){let $={};if(this.storage){let Q=this.storage.getItem(this.id);$=Q?JSON.parse(Q):{}}return Object.assign(this.config,$),this}}function tI($){let Q;if($<10)Q=`${$.toFixed(2)}ms`;else if($<100)Q=`${$.toFixed(1)}ms`;else if($<1000)Q=`${$.toFixed(0)}ms`;else Q=`${($/1000).toFixed(2)}s`;return Q}function eI($,Q=8){let J=Math.max(Q-$.length,0);return`${" ".repeat(J)}${$}`}function $G($){if(typeof $!=="string")return $;return $=$.toUpperCase(),iJ[$]||iJ.WHITE}function QG($,Q,J){if(!d0&&typeof $==="string"){if(Q)$=`\x1B[${$G(Q)}m${$}\x1B[39m`;if(J)$=`\x1B[${$G(J)+O11}m${$}\x1B[49m`}return $}var iJ,O11=10;var JG=C(()=>{W7();(function($){$[$.BLACK=30]="BLACK",$[$.RED=31]="RED",$[$.GREEN=32]="GREEN",$[$.YELLOW=33]="YELLOW",$[$.BLUE=34]="BLUE",$[$.MAGENTA=35]="MAGENTA",$[$.CYAN=36]="CYAN",$[$.WHITE=37]="WHITE",$[$.BRIGHT_BLACK=90]="BRIGHT_BLACK",$[$.BRIGHT_RED=91]="BRIGHT_RED",$[$.BRIGHT_GREEN=92]="BRIGHT_GREEN",$[$.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",$[$.BRIGHT_BLUE=94]="BRIGHT_BLUE",$[$.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",$[$.BRIGHT_CYAN=96]="BRIGHT_CYAN",$[$.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(iJ||(iJ={}))});function ZG($,Q=["constructor"]){let J=Object.getPrototypeOf($),Z=Object.getOwnPropertyNames(J),K=$;for(let X of Z){let Y=K[X];if(typeof Y==="function"){if(!Q.find((W)=>X===W))K[X]=Y.bind($)}}}function C2($,Q){if(!$)throw Error(Q||"Assertion failed")}function q8(){let $;if(d0()&&lJ.performance)$=lJ?.performance?.now?.();else if("hrtime"in pJ){let Q=pJ?.hrtime?.();$=Q[0]*1000+Q[1]/1e6}else $=Date.now();return $}var KG=C(()=>{W7()});function T9(){}class W5{constructor({id:$}={id:""}){this.VERSION=tH,this._startTs=q8(),this._deltaTs=q8(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=$,this.userData={},this._storage=new eH(`__probe-${this.id}__`,P11),this.timeStamp(`${this.id} started`),ZG(this),Object.seal(this)}set level($){this.setLevel($)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((q8()-this._startTs).toPrecision(10))}getDelta(){return Number((q8()-this._deltaTs).toPrecision(10))}set priority($){this.level=$}get priority(){return this.level}getPriority(){return this.level}enable($=!0){return this._storage.setConfiguration({enabled:$}),this}setLevel($){return this._storage.setConfiguration({level:$}),this}get($){return this._storage.config[$]}set($,Q){this._storage.setConfiguration({[$]:Q})}settings(){if(console.table)console.table(this._storage.config);else console.log(this._storage.config)}assert($,Q){if(!$)throw Error(Q||"Assertion failed")}warn($){return this._getLogFunction(0,$,S9.warn,arguments,YG)}error($){return this._getLogFunction(0,$,S9.error,arguments)}deprecated($,Q){return this.warn(`\`${$}\` is deprecated and will be removed in a later version. Use \`${Q}\` instead`)}removed($,Q){return this.error(`\`${$}\` has been removed. Use \`${Q}\` instead`)}probe($,Q){return this._getLogFunction($,Q,S9.log,arguments,{time:!0,once:!0})}log($,Q){return this._getLogFunction($,Q,S9.debug,arguments)}info($,Q){return this._getLogFunction($,Q,console.info,arguments)}once($,Q){return this._getLogFunction($,Q,S9.debug||S9.info,arguments,YG)}table($,Q,J){if(Q)return this._getLogFunction($,Q,console.table||T9,J&&[J],{tag:w11(Q)});return T9}time($,Q){return this._getLogFunction($,Q,console.time?console.time:console.info)}timeEnd($,Q){return this._getLogFunction($,Q,console.timeEnd?console.timeEnd:console.info)}timeStamp($,Q){return this._getLogFunction($,Q,console.timeStamp||T9)}group($,Q,J={collapsed:!1}){let Z=WG({logLevel:$,message:Q,opts:J}),{collapsed:K}=J;return Z.method=(K?console.groupCollapsed:console.group)||console.info,this._getLogFunction(Z)}groupCollapsed($,Q,J={}){return this.group($,Q,Object.assign({},J,{collapsed:!0}))}groupEnd($){return this._getLogFunction($,"",console.groupEnd||T9)}withGroup($,Q,J){this.group($,Q)();try{J()}finally{this.groupEnd($)()}}trace(){if(console.trace)console.trace()}_shouldLog($){return this.isEnabled()&&this.getLevel()>=qG($)}_getLogFunction($,Q,J,Z,K){if(this._shouldLog($)){K=WG({logLevel:$,message:Q,args:Z,opts:K}),J=J||K.method,C2(J),K.total=this.getTotal(),K.delta=this.getDelta(),this._deltaTs=q8();let X=K.tag||K.message;if(K.once&&X)if(!XG[X])XG[X]=q8();else return T9;return Q=M11(this.id,K.message,K),J.bind(console,Q,...K.args)}return T9}}function qG($){if(!$)return 0;let Q;switch(typeof $){case"number":Q=$;break;case"object":Q=$.logLevel||$.priority||0;break;default:return 0}return C2(Number.isFinite(Q)&&Q>=0),Q}function WG($){let{logLevel:Q,message:J}=$;$.logLevel=qG(Q);let Z=$.args?Array.from($.args):[];while(Z.length&&Z.shift()!==J);switch(typeof Q){case"string":case"function":if(J!==void 0)Z.unshift(J);$.message=Q;break;case"object":Object.assign($,Q);break;default:}if(typeof $.message==="function")$.message=$.message();let K=typeof $.message;return C2(K==="string"||K==="object"),Object.assign($,{args:Z},$.opts)}function M11($,Q,J){if(typeof Q==="string"){let Z=J.time?eI(tI(J.total)):"";Q=J.time?`${$}: ${Z}  ${Q}`:`${$}: ${Q}`,Q=QG(Q,J.color,J.background)}return Q}function w11($){for(let Q in $)for(let J in $[Q])return J||"untitled";return"empty"}var S9,P11,XG,YG;var $F=C(()=>{W7();JG();KG();S9={debug:d0()?console.debug||console.log:console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},P11={enabled:!0,level:0};XG={},YG={once:!0};W5.VERSION=tH});var HG=C(()=>{globalThis.probe={}});var xF1;var A2=C(()=>{$F();$F();HG();xF1=new W5({id:"@probe.gl/log"})});function T11(){let $=new W5({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=$,globalThis.loaders.version=S11,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=$,$}var QF="4.3.3",S11,JF;var FG=C(()=>{A2();S11=QF[0]>="0"&&QF[0]<="9"?`v${QF}`:"";JF=T11()});function ZF($,Q){return UG($||{},Q)}function UG($,Q,J=0){if(J>3)return Q;let Z={...$};for(let[K,X]of Object.entries(Q))if(X&&typeof X==="object"&&!Array.isArray(X))Z[K]=UG(Z[K]||{},Q[K],J+1);else Z[K]=Q[K];return Z}function I11(){if(!globalThis._loadersgl_?.version)globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3";return globalThis._loadersgl_.version}var VG="latest",KF;var XF=C(()=>{KF=I11()});function l0($,Q){if(!$)throw Error(Q||"loaders.gl assertion failed.")}var I6,pF1,uF1,iF1,nF1,I5,DG,NG,sF1;var z2=C(()=>{I6={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},pF1=I6.self||I6.window||I6.global||{},uF1=I6.window||I6.self||I6.global||{},iF1=I6.global||I6.self||I6.window||{},nF1=I6.document||{},I5=typeof process!=="object"||String(process)!=="[object process]"||!0,DG=typeof window<"u"&&typeof window.orientation<"u",NG=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),sF1=NG&&parseFloat(NG[1])||0});class nJ{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor($,Q){this.name=$,this.workerThread=Q,this.result=new Promise((J,Z)=>{this._resolve=J,this._reject=Z})}postMessage($,Q){this.workerThread.postMessage({source:"loaders.gl",type:$,payload:Q})}done($){l0(this.isRunning),this.isRunning=!1,this._resolve($)}error($){l0(this.isRunning),this.isRunning=!1,this._reject($)}}var CG=()=>{};class k2{terminate(){}}function AG($){l0($.source&&!$.url||!$.source&&$.url);let Q=YF.get($.source||$.url);if(!Q){if($.url)Q=G11($.url),YF.set($.url,Q);if($.source)Q=zG($.source),YF.set($.source,Q)}return l0(Q),Q}function G11($){if(!$.startsWith("http"))return $;let Q=E11($);return zG(Q)}function zG($){let Q=new Blob([$],{type:"application/javascript"});return URL.createObjectURL(Q)}function E11($){return`try {
  importScripts('${$}');
} catch (error) {
  console.error(error);
  throw error;
}`}var YF;var kG=C(()=>{YF=new Map});function WF($,Q=!0,J){let Z=J||new Set;if(!$);else if(BG($))Z.add($);else if(BG($.buffer))Z.add($.buffer);else if(ArrayBuffer.isView($));else if(Q&&typeof $==="object")for(let K in $)WF($[K],Q,Z);return J===void 0?Array.from(Z):[]}function BG($){if(!$)return!1;if($ instanceof ArrayBuffer)return!0;if(typeof MessagePort<"u"&&$ instanceof MessagePort)return!0;if(typeof ImageBitmap<"u"&&$ instanceof ImageBitmap)return!0;if(typeof OffscreenCanvas<"u"&&$ instanceof OffscreenCanvas)return!0;return!1}class H8{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&I5||typeof k2<"u"&&!I5}constructor($){let{name:Q,source:J,url:Z}=$;l0(J||Z),this.name=Q,this.source=J,this.url=Z,this.onMessage=qF,this.onError=(K)=>console.log(K),this.worker=I5?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=qF,this.onError=qF,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage($,Q){Q=Q||WF($),this.worker.postMessage($,Q)}_getErrorFromErrorEvent($){let Q="Failed to load ";if(Q+=`worker ${this.name} from ${this.url}. `,$.message)Q+=`${$.message} in `;if($.lineno)Q+=`:${$.lineno}:${$.colno}`;return Error(Q)}_createBrowserWorker(){this._loadableURL=AG({source:this.source,url:this.url});let $=new Worker(this._loadableURL,{name:this.name});return $.onmessage=(Q)=>{if(!Q.data)this.onError(Error("No data received"));else this.onMessage(Q.data)},$.onerror=(Q)=>{this.onError(this._getErrorFromErrorEvent(Q)),this.terminated=!0},$.onmessageerror=(Q)=>console.error(Q),$}_createNodeWorker(){let $;if(this.url){let J=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;$=new k2(J,{eval:!1})}else if(this.source)$=new k2(this.source,{eval:!0});else throw Error("no worker");return $.on("message",(Q)=>{this.onMessage(Q)}),$.on("error",(Q)=>{this.onError(Q)}),$.on("exit",(Q)=>{}),$}}var qF=()=>{};var HF=C(()=>{z2();kG()});class sJ{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return H8.isSupported()}constructor($){this.source=$.source,this.url=$.url,this.setProps($)}destroy(){this.idleQueue.forEach(($)=>$.destroy()),this.isDestroyed=!0}setProps($){if(this.props={...this.props,...$},$.name!==void 0)this.name=$.name;if($.maxConcurrency!==void 0)this.maxConcurrency=$.maxConcurrency;if($.maxMobileConcurrency!==void 0)this.maxMobileConcurrency=$.maxMobileConcurrency;if($.reuseWorkers!==void 0)this.reuseWorkers=$.reuseWorkers;if($.onDebug!==void 0)this.onDebug=$.onDebug}async startJob($,Q=(Z,K,X)=>Z.done(X),J=(Z,K)=>Z.error(K)){let Z=new Promise((K)=>{return this.jobQueue.push({name:$,onMessage:Q,onError:J,onStart:K}),this});return this._startQueuedJob(),await Z}async _startQueuedJob(){if(!this.jobQueue.length)return;let $=this._getAvailableWorker();if(!$)return;let Q=this.jobQueue.shift();if(Q){this.onDebug({message:"Starting job",name:Q.name,workerThread:$,backlog:this.jobQueue.length});let J=new nJ(Q.name,$);$.onMessage=(Z)=>Q.onMessage(J,Z.type,Z.payload),$.onError=(Z)=>Q.onError(J,Z),Q.onStart(J);try{await J.result}catch(Z){console.error(`Worker exception: ${Z}`)}finally{this.returnWorkerToQueue($)}}}returnWorkerToQueue($){if(!I5||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency())$.destroy(),this.count--;else this.idleQueue.push($);if(!this.isDestroyed)this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let $=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new H8({name:$,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return DG?this.maxMobileConcurrency:this.maxConcurrency}}var RG=C(()=>{z2();HF();CG()});class t5{props;workerPools=new Map;static _workerFarm;static isSupported(){return H8.isSupported()}static getWorkerFarm($={}){return t5._workerFarm=t5._workerFarm||new t5({}),t5._workerFarm.setProps($),t5._workerFarm}constructor($){this.props={...j11},this.setProps($),this.workerPools=new Map}destroy(){for(let $ of this.workerPools.values())$.destroy();this.workerPools=new Map}setProps($){this.props={...this.props,...$};for(let Q of this.workerPools.values())Q.setProps(this._getWorkerPoolProps())}getWorkerPool($){let{name:Q,source:J,url:Z}=$,K=this.workerPools.get(Q);if(!K)K=new sJ({name:Q,source:J,url:Z}),K.setProps(this._getWorkerPoolProps()),this.workerPools.set(Q,K);return K}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}var j11;var OG=C(()=>{RG();HF();j11={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}}});function FF($,Q={}){let J=Q[$.id]||{},Z=I5?`${$.id}-worker.js`:`${$.id}-worker-node.js`,K=J.workerUrl;if(!K&&$.id==="compression")K=Q.workerUrl;if(Q._workerType==="test")if(I5)K=`modules/${$.module}/dist/${Z}`;else K=`modules/${$.module}/src/workers/${$.id}-worker-node.ts`;if(!K){let X=$.version;if(X==="latest")X=VG;let Y=X?`@${X}`:"";K=`https://unpkg.com/@loaders.gl/${$.module}${Y}/dist/${Z}`}return l0(K),K}var PG=C(()=>{z2();XF()});function UF($,Q=KF){l0($,"no worker provided");let J=$.version;if(!Q||!J)return!1;return!0}var MG=C(()=>{XF()});var VF=C(()=>{z2();OG();PG();MG()});function NF($,Q){if(!t5.isSupported())return!1;if(!I5&&!Q?._nodeWorkers)return!1;return $.worker&&Q?.worker}async function DF($,Q,J,Z,K){let X=$.id,Y=FF($,J),q=t5.getWorkerFarm(J).getWorkerPool({name:X,url:Y});J=JSON.parse(JSON.stringify(J)),Z=JSON.parse(JSON.stringify(Z||{}));let H=await q.startJob("process-on-worker",h11.bind(null,K));return H.postMessage("process",{input:Q,options:J,context:Z}),await(await H.result).result}async function h11($,Q,J,Z){switch(J){case"done":Q.done(Z);break;case"error":Q.error(Error(Z.error));break;case"process":let{id:K,input:X,options:Y}=Z;try{let W=await $(X,Y);Q.postMessage("done",{id:K,result:W})}catch(W){let q=W instanceof Error?W.message:"unknown error";Q.postMessage("error",{id:K,error:q})}break;default:console.warn(`parse-with-worker unknown message ${J}`)}}var wG=C(()=>{VF()});function CF($,Q,J){if(J=J||$.byteLength,$.byteLength<J||Q.byteLength<J)return!1;let Z=new Uint8Array($),K=new Uint8Array(Q);for(let X=0;X<Z.length;++X)if(Z[X]!==K[X])return!1;return!0}function AF(...$){return SG($)}function SG($){let Q=$.map((X)=>X instanceof ArrayBuffer?new Uint8Array(X):X),J=Q.reduce((X,Y)=>X+Y.byteLength,0),Z=new Uint8Array(J),K=0;for(let X of Q)Z.set(X,K),K+=X.byteLength;return Z.buffer}async function zF($){let Q=[];for await(let J of $)Q.push(J);return AF(...Q)}var TG=()=>{};function B2(){let $;if(typeof window<"u"&&window.performance)$=window.performance.now();else if(typeof process<"u"&&process.hrtime){let Q=process.hrtime();$=Q[0]*1000+Q[1]/1e6}else $=Date.now();return $}class I9{constructor($,Q){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=$,this.type=Q,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize($){return this.sampleSize=$,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount($){return this._count+=$,this._samples++,this._checkSampling(),this}subtractCount($){return this._count-=$,this._samples++,this._checkSampling(),this}addTime($){return this._time+=$,this.lastTiming=$,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=B2(),this._timerPending=!0,this}timeEnd(){if(!this._timerPending)return this;return this.addTime(B2()-this._startTime),this._timerPending=!1,this._checkSampling(),this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1000):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1000):0}_checkSampling(){if(this._samples===this.sampleSize)this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0}}var kF=()=>{};class e5{constructor($){this.stats={},this.id=$.id,this.stats={},this._initializeStats($.stats),Object.seal(this)}get($,Q="count"){return this._getOrCreate({name:$,type:Q})}get size(){return Object.keys(this.stats).length}reset(){for(let $ of Object.values(this.stats))$.reset();return this}forEach($){for(let Q of Object.values(this.stats))$(Q)}getTable(){let $={};return this.forEach((Q)=>{$[Q.name]={time:Q.time||0,count:Q.count||0,average:Q.getAverageTime()||0,hz:Q.getHz()||0}}),$}_initializeStats($=[]){$.forEach((Q)=>this._getOrCreate(Q))}_getOrCreate($){let{name:Q,type:J}=$,Z=this.stats[Q];if(!Z){if($ instanceof I9)Z=$;else Z=new I9(Q,J);this.stats[Q]=Z}return Z}}var IG=C(()=>{kF()});var R2=C(()=>{IG();kF()});function BF($){for(let Q in GG)if($.startsWith(Q)){let J=GG[Q];$=$.replace(Q,J)}if(!$.startsWith("http://")&&!$.startsWith("https://"))$=`${L11}${$}`;return $}var L11="",GG;var EG=C(()=>{GG={}});function jG($){return $}function hG($){return $&&typeof $==="object"&&$.isBuffer}function oJ($){if(hG($))return jG($);if($ instanceof ArrayBuffer)return $;if(ArrayBuffer.isView($)){if($.byteOffset===0&&$.byteLength===$.buffer.byteLength)return $.buffer;return $.buffer.slice($.byteOffset,$.byteOffset+$.byteLength)}if(typeof $==="string"){let Q=$;return new TextEncoder().encode(Q).buffer}if($&&typeof $==="object"&&$._toArrayBuffer)return $._toArrayBuffer();throw Error("toArrayBuffer")}var LG=()=>{};function vG(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();let $=window.location?.pathname;return $?.slice(0,$.lastIndexOf("/")+1)||""}var F8={};E7(F8,{resolve:()=>y11,join:()=>g11,filename:()=>_11,dirname:()=>x11});function _11($){let Q=$?$.lastIndexOf("/"):-1;return Q>=0?$.substr(Q+1):""}function x11($){let Q=$?$.lastIndexOf("/"):-1;return Q>=0?$.substr(0,Q):""}function g11(...$){return $=$.map((J,Z)=>{if(Z)J=J.replace(new RegExp("^/"),"");if(Z!==$.length-1)J=J.replace(new RegExp("/$"),"");return J}),$.join("/")}function y11(...$){let Q=[];for(let X=0;X<$.length;X++)Q[X]=$[X];let J="",Z=!1,K;for(let X=Q.length-1;X>=-1&&!Z;X--){let Y;if(X>=0)Y=Q[X];else{if(K===void 0)K=vG();Y=K}if(Y.length===0)continue;J=`${Y}/${J}`,Z=Y.charCodeAt(0)===O2}if(J=f11(J,!Z),Z)return`/${J}`;else if(J.length>0)return J;return"."}function f11($,Q){let J="",Z=-1,K=0,X,Y=!1;for(let W=0;W<=$.length;++W){if(W<$.length)X=$.charCodeAt(W);else if(X===O2)break;else X=O2;if(X===O2){if(Z===W-1||K===1);else if(Z!==W-1&&K===2){if(J.length<2||!Y||J.charCodeAt(J.length-1)!==RF||J.charCodeAt(J.length-2)!==RF){if(J.length>2){let q=J.length-1,H=q;for(;H>=0;--H)if(J.charCodeAt(H)===O2)break;if(H!==q){J=H===-1?"":J.slice(0,H),Z=W,K=0,Y=!1;continue}}else if(J.length===2||J.length===1){J="",Z=W,K=0,Y=!1;continue}}if(Q){if(J.length>0)J+="/..";else J="..";Y=!0}}else{let q=$.slice(Z+1,W);if(J.length>0)J+=`/${q}`;else J=q;Y=!1}Z=W,K=0}else if(X===RF&&K!==-1)++K;else K=-1}return J}var O2=47,RF=46;var _G=()=>{};var G5=C(()=>{rI();FG();wG();TG();EG();LG();_G()});var b11=($)=>typeof $==="boolean",P2=($)=>typeof $==="function",U8=($)=>$!==null&&typeof $==="object",OF=($)=>U8($)&&$.constructor==={}.constructor,xG=($)=>Boolean($)&&typeof $[Symbol.iterator]==="function",gG=($)=>$&&typeof $[Symbol.asyncIterator]==="function",E5=($)=>typeof Response<"u"&&$ instanceof Response||$&&$.arrayBuffer&&$.text&&$.json,j5=($)=>typeof Blob<"u"&&$ instanceof Blob,yG=($)=>$&&typeof $==="object"&&$.isBuffer,m11=($)=>typeof ReadableStream<"u"&&$ instanceof ReadableStream||U8($)&&P2($.tee)&&P2($.cancel)&&P2($.getReader),c11=($)=>U8($)&&P2($.read)&&P2($.pipe)&&b11($.readable),rJ=($)=>m11($)||c11($);var PF;var fG=C(()=>{PF=class PF extends Error{constructor($,Q){super($);this.reason=Q.reason,this.url=Q.url,this.response=Q.response}reason;url;response}});function MF($,Q){if($.toLowerCase()===Q.toLowerCase())return!0;return!1}function bG($){let Q=l11.exec($);if(Q)return Q[1];return $}function wF($){let Q=d11.exec($);if(Q)return Q[1];return""}var d11,l11;var SF=C(()=>{d11=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,l11=/^([-\w.]+\/[-\w.+]+)/});function cG($){let Q=$.match(mG);return Q&&Q[0]}function G9($){return $.replace(mG,"")}function dG($){if($.length<50)return $;let Q=$.slice($.length-15);return`${$.substr(0,32)}...${Q}`}var mG;var M2=C(()=>{mG=/\?.*/});function V8($){if(E5($))return $.url;if(j5($))return $.name||"";if(typeof $==="string")return $;return""}function w2($){if(E5($)){let Q=$,J=Q.headers.get("content-type")||"",Z=G9(Q.url);return bG(J)||wF(Z)}if(j5($))return $.type||"";if(typeof $==="string")return wF($);return""}function lG($){if(E5($))return $.headers["content-length"]||-1;if(j5($))return $.size;if(typeof $==="string")return $.length;if($ instanceof ArrayBuffer)return $.byteLength;if(ArrayBuffer.isView($))return $.byteLength;return-1}var aJ=C(()=>{SF();M2()});async function tJ($){if(E5($))return $;let Q={},J=lG($);if(J>=0)Q["content-length"]=String(J);let Z=V8($),K=w2($);if(K)Q["content-type"]=K;let X=await u11($);if(X)Q["x-first-bytes"]=X;if(typeof $==="string")$=new TextEncoder().encode($);let Y=new Response($,{headers:Q});return Object.defineProperty(Y,"url",{value:Z}),Y}async function pG($){if(!$.ok)throw await p11($)}async function p11($){let Q=dG($.url),J=`Failed to fetch resource (${$.status}) ${$.statusText}: ${Q}`;J=J.length>100?`${J.slice(0,100)}...`:J;let Z={reason:$.statusText,url:$.url,response:$};try{let K=$.headers.get("Content-Type");Z.reason=!$.bodyUsed&&K?.includes("application/json")?await $.json():await $.text()}catch(K){}return new PF(J,Z)}async function u11($){if(typeof $==="string")return`data:,${$.slice(0,5)}`;if($ instanceof Blob){let J=$.slice(0,5);return await new Promise((Z)=>{let K=new FileReader;K.onload=(X)=>Z(X?.target?.result),K.readAsDataURL(J)})}if($ instanceof ArrayBuffer){let J=$.slice(0,5);return`data:base64,${i11(J)}`}return null}function i11($){let Q="",J=new Uint8Array($);for(let Z=0;Z<J.byteLength;Z++)Q+=String.fromCharCode(J[Z]);return btoa(Q)}var TF=C(()=>{fG();aJ();M2()});function n11($){return!s11($)&&!o11($)}function s11($){return $.startsWith("http:")||$.startsWith("https:")}function o11($){return $.startsWith("data:")}async function IF($,Q){if(typeof $==="string"){let J=BF($);if(n11(J)){if(globalThis.loaders?.fetchNode)return globalThis.loaders?.fetchNode(J,Q)}return await fetch(J,Q)}return await tJ($)}var uG=C(()=>{G5();TF()});class EF{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class jF{console;constructor(){this.console=console}log(...$){return this.console.log.bind(this.console,...$)}info(...$){return this.console.info.bind(this.console,...$)}warn(...$){return this.console.warn.bind(this.console,...$)}error(...$){return this.console.error.bind(this.console,...$)}}var GF;var hF=C(()=>{A2();GF=new W5({id:"loaders.gl"})});var LF,iG;var nG=C(()=>{G5();hF();LF={fetch:null,mimeType:void 0,nothrow:!1,log:new jF,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:W8,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},iG={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"}});function vF(){globalThis.loaders=globalThis.loaders||{};let{loaders:$}=globalThis;if(!$._state)$._state={};return $._state}function _F(){let $=vF();return $.globalOptions=$.globalOptions||{...LF},$.globalOptions}function rG($,Q,J,Z){return J=J||[],J=Array.isArray(J)?J:[J],r11($,J),t11(Q,$,Z)}function r11($,Q){sG($,null,LF,iG,Q);for(let J of Q){let Z=$&&$[J.id]||{},K=J.options&&J.options[J.id]||{},X=J.deprecatedOptions&&J.deprecatedOptions[J.id]||{};sG(Z,J.id,K,X,Q)}}function sG($,Q,J,Z,K){let X=Q||"Top level",Y=Q?`${Q}.`:"";for(let W in $){let q=!Q&&U8($[W]),H=W==="baseUri"&&!Q,F=W==="workerUrl"&&Q;if(!(W in J)&&!H&&!F){if(W in Z)GF.warn(`${X} loader option '${Y}${W}' no longer supported, use '${Z[W]}'`)();else if(!q){let U=a11(W,K);GF.warn(`${X} loader option '${Y}${W}' not recognized. ${U}`)()}}}}function a11($,Q){let J=$.toLowerCase(),Z="";for(let K of Q)for(let X in K.options){if($===X)return`Did you mean '${K.id}.${X}'?`;let Y=X.toLowerCase();if(J.startsWith(Y)||Y.startsWith(J))Z=Z||`Did you mean '${K.id}.${X}'?`}return Z}function t11($,Q,J){let K={...$.options||{}};if(e11(K,J),K.log===null)K.log=new EF;return oG(K,_F()),oG(K,Q),K}function oG($,Q){for(let J in Q)if(J in Q){let Z=Q[J];if(OF(Z)&&OF($[J]))$[J]={...$[J],...Q[J]};else $[J]=Q[J]}}function e11($,Q){if(Q&&!("baseUri"in $))$.baseUri=Q}var eJ=C(()=>{hF();nG()});function S2($){if(!$)return!1;if(Array.isArray($))$=$[0];return Array.isArray($?.extensions)}function T2($){Y7($,"null loader"),Y7(S2($),"invalid loader");let Q;if(Array.isArray($))Q=$[1],$=$[0],$={...$,options:{...$.options,...Q}};if($?.parseTextSync||$?.parseText)$.text=!0;if(!$.text)$.binary=!0;return $}var I2=C(()=>{G5()});function xF($){let Q=aG();$=Array.isArray($)?$:[$];for(let J of $){let Z=T2(J);if(!Q.find((K)=>Z===K))Q.unshift(Z)}}function tG(){return aG()}var aG=()=>{let $=vF();return $.loaderRegistry=$.loaderRegistry||[],$.loaderRegistry};var gF=C(()=>{I2();eJ()});async function QE($,Q=[],J,Z){if(!JE($))return null;let K=eG($,Q,{...J,nothrow:!0},Z);if(K)return K;if(j5($))$=await $.slice(0,10).arrayBuffer(),K=eG($,Q,J,Z);if(!K&&!J?.nothrow)throw Error(ZE($));return K}function eG($,Q=[],J,Z){if(!JE($))return null;if(Q&&!Array.isArray(Q))return T2(Q);let K=[];if(Q)K=K.concat(Q);if(!J?.ignoreRegisteredLoaders)K.push(...tG());J01(K);let X=Q01($,K,J,Z);if(!X&&!J?.nothrow)throw Error(ZE($));return X}function Q01($,Q,J,Z){let K=V8($),X=w2($),Y=G9(K)||Z?.url,W=null,q="";if(J?.mimeType)W=yF(Q,J?.mimeType),q=`match forced by supplied MIME type ${J?.mimeType}`;if(W=W||Z01(Q,Y),q=q||(W?`matched url ${Y}`:""),W=W||yF(Q,X),q=q||(W?`matched MIME type ${X}`:""),W=W||X01(Q,$),q=q||(W?`matched initial data ${KE($)}`:""),J?.fallbackMimeType)W=W||yF(Q,J?.fallbackMimeType),q=q||(W?`matched fallback MIME type ${X}`:"");if(q)JF.log(1,`selectLoader selected ${W?.name}: ${q}.`);return W}function JE($){if($ instanceof Response){if($.status===204)return!1}return!0}function ZE($){let Q=V8($),J=w2($),Z="No valid loader found (";Z+=Q?`${F8.filename(Q)}, `:"no url provided, ",Z+=`MIME type: ${J?`"${J}"`:"not provided"}, `;let K=$?KE($):"";return Z+=K?` first bytes: "${K}"`:"first bytes: not available",Z+=")",Z}function J01($){for(let Q of $)T2(Q)}function Z01($,Q){let J=Q&&$01.exec(Q),Z=J&&J[1];return Z?K01($,Z):null}function K01($,Q){Q=Q.toLowerCase();for(let J of $)for(let Z of J.extensions)if(Z.toLowerCase()===Q)return J;return null}function yF($,Q){for(let J of $){if(J.mimeTypes?.some((Z)=>MF(Q,Z)))return J;if(MF(Q,`application/x.${J.id}`))return J}return null}function X01($,Q){if(!Q)return null;for(let J of $)if(typeof Q==="string"){if(Y01(Q,J))return J}else if(ArrayBuffer.isView(Q)){if($E(Q.buffer,Q.byteOffset,J))return J}else if(Q instanceof ArrayBuffer){if($E(Q,0,J))return J}return null}function Y01($,Q){if(Q.testText)return Q.testText($);return(Array.isArray(Q.tests)?Q.tests:[Q.tests]).some((Z)=>$.startsWith(Z))}function $E($,Q,J){return(Array.isArray(J.tests)?J.tests:[J.tests]).some((K)=>W01($,Q,J,K))}function W01($,Q,J,Z){if(Z instanceof ArrayBuffer)return CF(Z,$,Z.byteLength);switch(typeof Z){case"function":return Z($);case"string":let K=fF($,Q,Z.length);return Z===K;default:return!1}}function KE($,Q=5){if(typeof $==="string")return $.slice(0,Q);else if(ArrayBuffer.isView($))return fF($.buffer,$.byteOffset,Q);else if($ instanceof ArrayBuffer)return fF($,0,Q);return""}function fF($,Q,J){if($.byteLength<Q+J)return"";let Z=new DataView($),K="";for(let X=0;X<J;X++)K+=String.fromCharCode(Z.getUint8(Q+X));return K}var $01;var XE=C(()=>{G5();I2();aJ();SF();gF();M2();$01=/\.([^.]+)$/});function*YE($,Q){let J=Q?.chunkSize||262144,Z=0,K=new TextEncoder;while(Z<$.length){let X=Math.min($.length-Z,J),Y=$.slice(Z,Z+X);Z+=X,yield K.encode(Y)}}function*WE($,Q={}){let{chunkSize:J=262144}=Q,Z=0;while(Z<$.byteLength){let K=Math.min($.byteLength-Z,J),X=new ArrayBuffer(K),Y=new Uint8Array($,Z,K);new Uint8Array(X).set(Y),Z+=K,yield X}}async function*qE($,Q){let J=Q?.chunkSize||1048576,Z=0;while(Z<$.size){let K=Z+J,X=await $.slice(Z,K).arrayBuffer();Z=K,yield X}}function bF($,Q){return W8?q01($,Q):H01($,Q)}async function*q01($,Q){let J=$.getReader(),Z;try{while(!0){let K=Z||J.read();if(Q?._streamReadAhead)Z=J.read();let{done:X,value:Y}=await K;if(X)return;yield oJ(Y)}}catch(K){J.releaseLock()}}async function*H01($,Q){for await(let J of $)yield oJ(J)}var HE=C(()=>{G5()});function FE($,Q){if(typeof $==="string")return YE($,Q);if($ instanceof ArrayBuffer)return WE($,Q);if(j5($))return qE($,Q);if(rJ($))return bF($,Q);if(E5($))return bF($.body,Q);throw Error("makeIterator")}var UE=C(()=>{HE()});function F01($,Q,J){if(Q.text&&typeof $==="string")return $;if(yG($))$=$.buffer;if($ instanceof ArrayBuffer){let Z=$;if(Q.text&&!Q.binary)return new TextDecoder("utf8").decode(Z);return Z}if(ArrayBuffer.isView($)){if(Q.text&&!Q.binary)return new TextDecoder("utf8").decode($);let Z=$.buffer,K=$.byteLength||$.length;if($.byteOffset!==0||K!==Z.byteLength)Z=Z.slice($.byteOffset,$.byteOffset+K);return Z}throw Error(VE)}async function NE($,Q,J){let Z=$ instanceof ArrayBuffer||ArrayBuffer.isView($);if(typeof $==="string"||Z)return F01($,Q,J);if(j5($))$=await tJ($);if(E5($)){let K=$;return await pG(K),Q.binary?await K.arrayBuffer():await K.text()}if(rJ($))$=FE($,J);if(xG($)||gG($))return zF($);throw Error(VE)}var VE="Cannot convert supplied data type";var DE=C(()=>{G5();UE();TF()});function $Z($,Q){let J=_F(),Z=$||J;if(typeof Z.fetch==="function")return Z.fetch;if(U8(Z.fetch))return(K)=>IF(K,Z.fetch);if(Q?.fetch)return Q?.fetch;return IF}var mF=C(()=>{uG();eJ()});function CE($,Q,J){if(J)return J;let Z={fetch:$Z(Q,$),...$};if(Z.url){let K=G9(Z.url);Z.baseUrl=K,Z.queryString=cG(Z.url),Z.filename=F8.filename(K),Z.baseUrl=F8.dirname(K)}if(!Array.isArray(Z.loaders))Z.loaders=null;return Z}function AE($,Q){if($&&!Array.isArray($))return $;let J;if($)J=Array.isArray($)?$:[$];if(Q&&Q.loaders){let Z=Array.isArray(Q.loaders)?Q.loaders:[Q.loaders];J=J?[...J,...Z]:Z}return J&&J.length?J:void 0}var zE=C(()=>{mF();M2();G5()});async function G2($,Q,J,Z){if(Q&&!Array.isArray(Q)&&!S2(Q))Z=void 0,J=Q,Q=void 0;$=await $,J=J||{};let K=V8($),Y=AE(Q,Z),W=await QE($,Y,J);if(!W)return null;return J=rG(J,W,Y,K),Z=CE({url:K,_parse:G2,loaders:Y},J,Z||null),await U01(W,$,J,Z)}async function U01($,Q,J,Z){if(UF($),J=ZF($.options,J),E5(Q)){let X=Q,{ok:Y,redirected:W,status:q,statusText:H,type:F,url:U}=X,V=Object.fromEntries(X.headers.entries());Z.response={headers:V,ok:Y,redirected:W,status:q,statusText:H,type:F,url:U}}Q=await NE(Q,$,J);let K=$;if(K.parseTextSync&&typeof Q==="string")return K.parseTextSync(Q,J,Z);if(NF($,J))return await DF($,Q,J,Z,G2);if(K.parseText&&typeof Q==="string")return await K.parseText(Q,J,Z);if(K.parse)return await K.parse(Q,J,Z);throw l0(!K.parseSync),Error(`${$.id} loader - no parser found and worker is disabled`)}var kE=C(()=>{G5();VF();I2();eJ();DE();zE();aJ();XE()});async function q7($,Q,J,Z){let K,X;if(!Array.isArray(Q)&&!S2(Q))K=[],X=Q,Z=void 0;else K=Q,X=J;let Y=$Z(X),W=$;if(typeof $==="string")W=await Y($);if(j5($))W=await Y($);return Array.isArray(K)?await G2(W,K,X):await G2(W,K,X)}var BE=C(()=>{I2();mF();kE()});var E2=C(()=>{gF();BE()});var RE="4.3.3";function OE($){switch($){case"auto":return dF||cF||lF;case"imagebitmap":return dF;case"image":return cF;case"data":return lF;default:throw Error(`@loaders.gl/images: image ${$} not supported in this environment`)}}function PE(){if(dF)return"imagebitmap";if(cF)return"image";if(lF)return"data";throw Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}var V01,cF,dF,N01,lF;var ME=C(()=>{G5();V01=globalThis.loaders?.parseImageNode,cF=typeof Image<"u",dF=typeof ImageBitmap<"u",N01=Boolean(V01),lF=W8?!0:N01});function D01($){let Q=C01($);if(!Q)throw Error("Not an image");return Q}function wE($){switch(D01($)){case"data":return $;case"image":case"imagebitmap":let Q=document.createElement("canvas"),J=Q.getContext("2d");if(!J)throw Error("getImageData");return Q.width=$.width,Q.height=$.height,J.drawImage($,0,0),J.getImageData(0,0,$.width,$.height);default:throw Error("getImageData")}}function C01($){if(typeof ImageBitmap<"u"&&$ instanceof ImageBitmap)return"imagebitmap";if(typeof Image<"u"&&$ instanceof Image)return"image";if($&&typeof $==="object"&&$.data&&$.width&&$.height)return"data";return null}function QZ($){return $&&(A01.test($)||z01.test($))}function SE($,Q){if(QZ(Q)){let Z=new TextDecoder().decode($);try{if(typeof unescape==="function"&&typeof encodeURIComponent==="function")Z=unescape(encodeURIComponent(Z))}catch(X){throw Error(X.message)}return`data:image/svg+xml;base64,${btoa(Z)}`}return pF($,Q)}function pF($,Q){if(QZ(Q))throw Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array($)])}var A01,z01;var uF=C(()=>{A01=/^data:image\/svg\+xml/,z01=/\.svg((\?|#).*)?$/});async function JZ($,Q,J){let Z=SE($,J),K=self.URL||self.webkitURL,X=typeof Z!=="string"&&K.createObjectURL(Z);try{return await k01(X||Z,Q)}finally{if(X)K.revokeObjectURL(X)}}async function k01($,Q){let J=new Image;if(J.src=$,Q.image&&Q.image.decode&&J.decode)return await J.decode(),J;return await new Promise((Z,K)=>{try{J.onload=()=>Z(J),J.onerror=(X)=>{let Y=X instanceof Error?X.message:"error";K(Error(Y))}}catch(X){K(X)}})}var iF=C(()=>{uF()});async function IE($,Q,J){let Z;if(QZ(J))Z=await JZ($,Q,J);else Z=pF($,J);let K=Q&&Q.imagebitmap;return await R01(Z,K)}async function R01($,Q=null){if(O01(Q)||!TE)Q=null;if(Q)try{return await createImageBitmap($,Q)}catch(J){console.warn(J),TE=!1}return await createImageBitmap($)}function O01($){for(let Q in $||B01)return!1;return!0}var B01,TE=!0;var GE=C(()=>{uF();iF();B01={}});function EE($){if(!S01($,"ftyp",4))return null;if(($[8]&96)===0)return null;return P01($)}function P01($){switch(M01($,8,12).replace("\x00"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function M01($,Q,J){return String.fromCharCode(...$.slice(Q,J))}function w01($){return[...$].map((Q)=>Q.charCodeAt(0))}function S01($,Q,J=0){let Z=w01(Q);for(let K=0;K<Z.length;++K)if(Z[K]!==$[K+J])return!1;return!0}function ZZ($){let Q=h2($);return I01(Q)||j01(Q)||G01(Q)||E01(Q)||T01(Q)}function T01($){let Q=new Uint8Array($ instanceof DataView?$.buffer:$),J=EE(Q);if(!J)return null;return{mimeType:J.mimeType,width:0,height:0}}function I01($){let Q=h2($);if(!(Q.byteLength>=24&&Q.getUint32(0,G6)===2303741511))return null;return{mimeType:"image/png",width:Q.getUint32(16,G6),height:Q.getUint32(20,G6)}}function G01($){let Q=h2($);if(!(Q.byteLength>=10&&Q.getUint32(0,G6)===1195984440))return null;return{mimeType:"image/gif",width:Q.getUint16(6,j2),height:Q.getUint16(8,j2)}}function E01($){let Q=h2($);if(!(Q.byteLength>=14&&Q.getUint16(0,G6)===16973&&Q.getUint32(2,j2)===Q.byteLength))return null;return{mimeType:"image/bmp",width:Q.getUint32(18,j2),height:Q.getUint32(22,j2)}}function j01($){let Q=h2($);if(!(Q.byteLength>=3&&Q.getUint16(0,G6)===65496&&Q.getUint8(2)===255))return null;let{tableMarkers:Z,sofMarkers:K}=h01(),X=2;while(X+9<Q.byteLength){let Y=Q.getUint16(X,G6);if(K.has(Y))return{mimeType:"image/jpeg",height:Q.getUint16(X+5,G6),width:Q.getUint16(X+7,G6)};if(!Z.has(Y))return null;X+=2,X+=Q.getUint16(X,G6)}return null}function h01(){let $=new Set([65499,65476,65484,65501,65534]);for(let J=65504;J<65520;++J)$.add(J);return{tableMarkers:$,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function h2($){if($ instanceof DataView)return $;if(ArrayBuffer.isView($))return new DataView($.buffer);if($ instanceof ArrayBuffer)return new DataView($);throw Error("toDataView")}var G6=!1,j2=!0;var nF=()=>{};async function jE($,Q){let{mimeType:J}=ZZ($)||{},Z=globalThis.loaders?.parseImageNode;return Y7(Z),await Z($,J)}var hE=C(()=>{G5();nF()});async function LE($,Q,J){Q=Q||{};let K=(Q.image||{}).type||"auto",{url:X}=J||{},Y=L01(K),W;switch(Y){case"imagebitmap":W=await IE($,Q,X);break;case"image":W=await JZ($,Q,X);break;case"data":W=await jE($,Q);break;default:Y7(!1)}if(K==="data")W=wE(W);return W}function L01($){switch($){case"auto":case"data":return PE();default:return OE($),$}}var vE=C(()=>{G5();ME();iF();GE();hE()});var v01,_01,x01,sF;var _E=C(()=>{vE();nF();v01=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],_01=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],x01={image:{type:"auto",decode:!0}},sF={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:RE,mimeTypes:_01,extensions:v01,parse:LE,tests:[($)=>Boolean(ZZ(new DataView($)))],options:x01}});var xE=C(()=>{_E()});var g01,r;var T0=C(()=>{A2();g01=new W5({id:"deck"}),r=g01});var H7,gE=($)=>({"layer.changeFlag":(Q,J,Z)=>{$.log(3,`${Q.id} ${J}: `,Z[J])()},"layer.initialize":(Q)=>{$.log(1,`Initializing ${Q}`)()},"layer.update":(Q,J)=>{if(J){let Z=Q.getChangeFlags();$.log(2,`Updating ${Q} because: ${Object.keys(Z).filter((K)=>Z[K]).join(", ")}`)()}else $.log(4,`${Q} does not need update`)()},"layer.matched":(Q,J)=>{if(J)$.log(4,`Matched ${Q}, state transfered`)()},"layer.finalize":(Q)=>{$.log(1,`Finalizing ${Q}`)()},"compositeLayer.renderLayers":(Q,J,Z)=>{if(J)$.log(2,`Composite layer rendered new subLayers ${Q}`,Z)();else $.log(4,`Composite layer reused subLayers ${Q}`,Z)()},"layerManager.setLayers":(Q,J,Z)=>{if(J)$.log(2,`Updating ${Z.length} deck layers`)()},"layerManager.activateViewport":(Q,J)=>{$.log(3,"Viewport changed",J)()},"attributeManager.invalidate":(Q,J,Z)=>{$.log(1,Z?`invalidated attributes ${Z} (${J}) for ${Q.id}`:`invalidated all attributes for ${Q.id}`)()},"attributeManager.updateStart":(Q)=>{H7.attributeUpdateMessages.length=0,H7.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(Q,J)=>{let Z=Math.round(Date.now()-H7.attributeManagerUpdateStart);$.groupCollapsed(2,`Updated attributes for ${J} instances in ${Q.id} in ${Z}ms`)();for(let K of H7.attributeUpdateMessages)$.log(3,K)();$.groupEnd(2)()},"attribute.updateStart":(Q)=>{H7.attributeUpdateStart=Date.now()},"attribute.allocate":(Q,J)=>{let Z=`${Q.id} allocated ${J}`;H7.attributeUpdateMessages.push(Z)},"attribute.updateEnd":(Q,J)=>{let Z=Math.round(Date.now()-H7.attributeUpdateStart),K=`${Q.id} updated ${J} in ${Z}ms`;H7.attributeUpdateMessages.push(K)},"deckRenderer.renderLayers":(Q,J,Z)=>{let{pass:K,redrawReason:X,stats:Y}=Z;for(let W of J){let{totalCount:q,visibleCount:H,compositeCount:F,pickableCount:U}=W,N=q-F-H;if($.log(2,`RENDER #${Q.renderCount}   ${H} (of ${q} layers) to ${K} because ${X}   (${N} hidden, ${F} composite ${U} pickable)`)(),Y)Y.get("Redraw Layers").add(H)}}});var yE=C(()=>{H7={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]}});function fE($){KZ=$}function X0($,Q,J,Z){if(r.level>0&&KZ[$])KZ[$].call(null,Q,J,Z)}var KZ;var N8=C(()=>{T0();yE();KZ={};KZ=gE(r)});function y01($){let Q=$[0],J=$[$.length-1];return Q==="{"&&J==="}"||Q==="["&&J==="]"}var bE;var mE=C(()=>{bE={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:y01,parseTextSync:JSON.parse}});function f01(){let Q=globalThis.deck&&globalThis.deck.VERSION;if(Q&&Q!=="9.1.15")throw Error(`deck.gl - multiple versions detected: ${Q} vs 9.1.15`);if(!Q)r.log(1,"deck.gl 9.1.15")(),globalThis.deck={...globalThis.deck,VERSION:"9.1.15",version:"9.1.15",log:r,_registerLoggers:fE},xF([bE,[sF,{imagebitmap:{premultiplyAlpha:"none"}}]]);return"9.1.15"}var cE;var dE=C(()=>{E2();xE();T0();N8();mE();cE=f01()});function XZ($,Q){if(!$)throw Error(Q||"shadertools: assertion failed.")}function pE($){let Q={};for(let[J,Z]of Object.entries($))Q[J]=b01(Z);return Q}function b01($){let Q=lE($);if(Q!=="object")return{value:$,...oF[Q],type:Q};if(typeof $==="object"){if(!$)return{type:"object",value:null};if($.type!==void 0)return{...$,...oF[$.type],type:$.type};if($.value===void 0)return{type:"object",value:$};return Q=lE($.value),{...$,...oF[Q],type:Q}}throw Error("props")}function lE($){if(Array.isArray($)||ArrayBuffer.isView($))return"array";return typeof $}var oF;var uE=C(()=>{oF={number:{type:"number",validate($,Q){return Number.isFinite($)&&typeof Q==="object"&&(Q.max===void 0||$<=Q.max)&&(Q.min===void 0||$>=Q.min)}},array:{type:"array",validate($,Q){return Array.isArray($)||ArrayBuffer.isView($)}}}});var iE=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,nE=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`;function rE($){let Q={vertex:{},fragment:{}};for(let J in $){let Z=$[J],K=c01(J);if(typeof Z==="string")Z={order:0,injection:Z};Q[K][J]=Z}return Q}function c01($){let Q=$.slice(0,2);switch(Q){case"vs":return"vertex";case"fs":return"fragment";default:throw Error(Q)}}function v2($,Q,J,Z=!1){let K=Q==="vertex";for(let X in J){let Y=J[X];Y.sort((q,H)=>q.order-H.order),rF.length=Y.length;for(let q=0,H=Y.length;q<H;++q)rF[q]=Y[q].injection;let W=`${rF.join(`
`)}
`;switch(X){case"vs:#decl":if(K)$=$.replace(L2,W);break;case"vs:#main-start":if(K)$=$.replace(sE,(q)=>q+W);break;case"vs:#main-end":if(K)$=$.replace(oE,(q)=>W+q);break;case"fs:#decl":if(!K)$=$.replace(L2,W);break;case"fs:#main-start":if(!K)$=$.replace(sE,(q)=>q+W);break;case"fs:#main-end":if(!K)$=$.replace(oE,(q)=>W+q);break;default:$=$.replace(X,(q)=>q+W)}}if($=$.replace(L2,""),Z)$=$.replace(/\}\s*$/,(X)=>X+m01[Q]);return $}var m01,sE,oE,rF,L2="__LUMA_INJECT_DECLARATIONS__";var aF=C(()=>{m01={vertex:iE,fragment:nE},sE=/void\s+main\s*\([^)]*\)\s*\{\n?/,oE=/}\n?[^{}]*$/,rF=[]});function E9($){$.map((Q)=>d01(Q))}function d01($){if($.instance)return;E9($.dependencies||[]);let{propTypes:Q={},deprecations:J=[],inject:Z={}}=$,K={normalizedInjections:rE(Z),parsedDeprecations:l01(J)};if(Q)K.propValidators=pE(Q);$.instance=K;let X={};if(Q)X=Object.entries(Q).reduce((Y,[W,q])=>{let H=q?.value;if(H)Y[W]=H;return Y},{});$.defaultUniforms={...$.defaultUniforms,...X}}function tF($,Q,J){$.deprecations?.forEach((Z)=>{if(Z.regex?.test(Q))if(Z.deprecated)J.deprecated(Z.old,Z.new)();else J.removed(Z.old,Z.new)()})}function l01($){return $.forEach((Q)=>{switch(Q.type){case"function":Q.regex=new RegExp(`\\b${Q.old}\\(`);break;default:Q.regex=new RegExp(`${Q.type} ${Q.old};`)}}),$}var YZ=C(()=>{uE();aF()});function j9($){E9($);let Q={},J={};aE({modules:$,level:0,moduleMap:Q,moduleDepth:J});let Z=Object.keys(J).sort((K,X)=>J[X]-J[K]).map((K)=>Q[K]);return E9(Z),Z}function aE($){let{modules:Q,level:J,moduleMap:Z,moduleDepth:K}=$;if(J>=5)throw Error("Possible loop in shader dependency graph");for(let X of Q)if(Z[X.name]=X,K[X.name]===void 0||K[X.name]<J)K[X.name]=J;for(let X of Q)if(X.dependencies)aE({modules:X.dependencies,level:J+1,moduleMap:Z,moduleDepth:K})}var eF=C(()=>{YZ()});function tE($){switch($?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function $j($,Q){if(Number($.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(Q){case"vertex":return $=eE($,p01),$;case"fragment":return $=eE($,u01),$;default:throw Error(Q)}}function eE($,Q){for(let[J,Z]of Q)$=$.replace(J,Z);return $}function $U($){return new RegExp(`\\b${$}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}var Qj,p01,u01;var Jj=C(()=>{Qj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],p01=[...Qj,[$U("attribute"),"in $1"],[$U("varying"),"out $1"]],u01=[...Qj,[$U("varying"),"in $1"]]});function QU($,Q){let J="";for(let Z in $){let K=$[Z];if(J+=`void ${K.signature} {
`,K.header)J+=`  ${K.header}`;if(Q[Z]){let X=Q[Z];X.sort((Y,W)=>Y.order-W.order);for(let Y of X)J+=`  ${Y.injection}
`}if(K.footer)J+=`  ${K.footer}`;J+=`}
`}return J}function JU($){let Q={vertex:{},fragment:{}};for(let J of $){let Z,K;if(typeof J!=="string")Z=J,K=Z.hook;else Z={},K=J;K=K.trim();let[X,Y]=K.split(":"),W=K.replace(/\(.+/,""),q=Object.assign(Z,{signature:Y});switch(X){case"vs":Q.vertex[W]=q;break;case"fs":Q.fragment[W]=q;break;default:throw Error(X)}}return Q}function Zj($,Q){return{name:i01($,Q),language:"glsl",version:n01($)}}function i01($,Q="unnamed"){let Z=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec($);return Z?Z[1]:Q}function n01($){let Q=100,J=$.match(/[^\s]+/g);if(J&&J.length>=2&&J[0]==="#version"){let Z=parseInt(J[1],10);if(Number.isFinite(Z))Q=Z}if(Q!==100&&Q!==300)throw Error(`Invalid GLSL version ${Q}`);return Q}function Yj($){let Q=j9($.modules||[]);return{source:o01($.platformInfo,{...$,source:$.source,stage:"vertex",modules:Q}),getUniforms:qj(Q)}}function Wj($){let{vs:Q,fs:J}=$,Z=j9($.modules||[]);return{vs:Kj($.platformInfo,{...$,source:Q,stage:"vertex",modules:Z}),fs:Kj($.platformInfo,{...$,source:J,stage:"fragment",modules:Z}),getUniforms:qj(Z)}}function o01($,Q){let{source:J,stage:Z,modules:K,hookFunctions:X=[],inject:Y={},log:W}=Q;XZ(typeof J==="string","shader source must be a string");let q=J,H="",F=JU(X),U={},V={},N={};for(let z in Y){let B=typeof Y[z]==="string"?{injection:Y[z],order:0}:Y[z],M=/^(v|f)s:(#)?([\w-]+)$/.exec(z);if(M){let P=M[2],O=M[3];if(P)if(O==="decl")V[z]=[B];else N[z]=[B];else U[z]=[B]}else N[z]=[B]}let D=K;for(let z of D){if(W)tF(z,q,W);let B=Hj(z,"wgsl");H+=B;let M=z.injections?.[Z]||{};for(let P in M){let O=/^(v|f)s:#([\w-]+)$/.exec(P);if(O){let L=O[2]==="decl"?V:N;L[P]=L[P]||[],L[P].push(M[P])}else U[P]=U[P]||[],U[P].push(M[P])}}return H+=Xj,H=v2(H,Z,V),H+=QU(F[Z],U),H+=q,H=v2(H,Z,N),H}function Kj($,Q){let{id:J,source:Z,stage:K,language:X="glsl",modules:Y,defines:W={},hookFunctions:q=[],inject:H={},prologue:F=!0,log:U}=Q;XZ(typeof Z==="string","shader source must be a string");let V=X==="glsl"?Zj(Z).version:-1,N=$.shaderLanguageVersion,D=V===100?"#version 100":"#version 300 es",B=Z.split(`
`).slice(1).join(`
`),M={};Y.forEach((d)=>{Object.assign(M,d.defines)}),Object.assign(M,W);let P="";switch(X){case"wgsl":break;case"glsl":P=F?`${D}

// ----- PROLOGUE -------------------------
${r01({id:J,source:Z,stage:K})}
${`#define SHADER_TYPE_${K.toUpperCase()}`}

${tE($)}
${K==="fragment"?s01:""}

// ----- APPLICATION DEFINES -------------------------

${a01(M)}

`:`${D}
`;break}let O=JU(q),G={},L={},b={};for(let d in H){let p=typeof H[d]==="string"?{injection:H[d],order:0}:H[d],i=/^(v|f)s:(#)?([\w-]+)$/.exec(d);if(i){let l=i[2],N1=i[3];if(l)if(N1==="decl")L[d]=[p];else b[d]=[p];else G[d]=[p]}else b[d]=[p]}for(let d of Y){if(U)tF(d,B,U);let p=Hj(d,K);P+=p;let i=d.instance?.normalizedInjections[K]||{};for(let l in i){let N1=/^(v|f)s:#([\w-]+)$/.exec(l);if(N1){let a=N1[2]==="decl"?L:b;a[l]=a[l]||[],a[l].push(i[l])}else G[l]=G[l]||[],G[l].push(i[l])}}if(P+="// ----- MAIN SHADER SOURCE -------------------------",P+=Xj,P=v2(P,K,L),P+=QU(O[K],G),P+=B,P=v2(P,K,b),X==="glsl"&&V!==N)P=$j(P,K);return P.trim()}function qj($){return function(J){let Z={};for(let K of $){let X=K.getUniforms?.(J,Z);Object.assign(Z,X)}return Z}}function r01($){let{id:Q,source:J,stage:Z}=$;return Q&&J.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${Q}_${Z}`:""}function a01($={}){let Q="";for(let J in $){let Z=$[J];if(Z||Number.isFinite(Z))Q+=`#define ${J.toUpperCase()} ${$[J]}
`}return Q}function Hj($,Q){let J;switch(Q){case"vertex":J=$.vs||"";break;case"fragment":J=$.fs||"";break;case"wgsl":J=$.source||"";break;default:XZ(!1)}if(!$.name)throw Error("Shader module must have a name");let Z=$.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),K=`// ----- MODULE ${$.name} ---------------

`;if(Q!=="wgsl")K+=`#define MODULE_${Z}
`;return K+=`${J}
`,K}var Xj,s01=`precision highp float;
`;var Fj=C(()=>{eF();aF();Jj();YZ();Xj=`

${L2}
`});function Uj($,Q){let J=$.split(`
`),Z=[],K=!0,X=null;for(let Y of J){let W=Y.match(t01),q=Y.match(e01);if(W)X=W[1],K=Boolean(Q?.defines?.[X]);else if(q)K=!0;else if(K)Z.push(Y)}return Z.join(`
`)}var t01,e01;var Vj=C(()=>{t01=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,e01=/^\s*\#\s*endif\s*$/});class E6{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return E6.defaultShaderAssembler=E6.defaultShaderAssembler||new E6,E6.defaultShaderAssembler}addDefaultModule($){if(!this._defaultModules.find((Q)=>Q.name===(typeof $==="string"?$:$.name)))this._defaultModules.push($)}removeDefaultModule($){let Q=typeof $==="string"?$:$.name;this._defaultModules=this._defaultModules.filter((J)=>J.name!==Q)}addShaderHook($,Q){if(Q)$=Object.assign(Q,{hook:$});this._hookFunctions.push($)}assembleWGSLShader($){let Q=this._getModuleList($.modules),J=this._hookFunctions,{source:Z,getUniforms:K}=Yj({...$,source:$.source,modules:Q,hookFunctions:J});return{source:$.platformInfo.shaderLanguage==="wgsl"?Uj(Z):Z,getUniforms:K,modules:Q}}assembleGLSLShaderPair($){let Q=this._getModuleList($.modules),J=this._hookFunctions;return{...Wj({...$,vs:$.vs,fs:$.fs,modules:Q,hookFunctions:J}),modules:Q}}_getModuleList($=[]){let Q=Array(this._defaultModules.length+$.length),J={},Z=0;for(let K=0,X=this._defaultModules.length;K<X;++K){let Y=this._defaultModules[K],W=Y.name;Q[Z++]=Y,J[W]=!0}for(let K=0,X=$.length;K<X;++K){let Y=$[K],W=Y.name;if(!J[W])Q[Z++]=Y,J[W]=!0}return Q.length=Z,E9(Q),Q}}var Nj=C(()=>{YZ();Fj();Vj()});function ZU($){let{input:Q,inputChannels:J,output:Z}=$||{};if(!Q)return`#version 300 es
out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`;if(!J)throw Error("inputChannels");let K=$51(J),X=Dj(Q,J);return`#version 300 es
in ${K} ${Q};
out vec4 ${Z};
void main() {
  ${Z} = ${X};
}`}function $51($){switch($){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw Error(`invalid channels: ${$}`)}}function Dj($,Q){switch(Q){case 1:return`vec4(${$}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${$}, 0.0, 1.0)`;case 3:return`vec4(${$}, 1.0)`;case 4:return $;default:throw Error(`invalid channels: ${Q}`)}}class Cj{stats=new Map;getStats($){return this.get($)}get($){if(!this.stats.has($))this.stats.set($,new e5({id:$}));return this.stats.get($)}}var WZ;var KU=C(()=>{R2();WZ=new Cj});var f;var j6=C(()=>{A2();f=new W5({id:"luma.gl"})});function F7($="id"){XU[$]=XU[$]||1;let Q=XU[$]++;return`${$}-${Q}`}var XU;var _2=C(()=>{XU={}});function Q51($,Q){let J={...Q};for(let Z in $)if($[Z]!==void 0)J[Z]=$[Z];return J}var C1;var p0=C(()=>{_2();C1=class C1{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor($,Q,J){if(!$)throw Error("no device");this._device=$,this.props=Q51(Q,J);let Z=this.props.id!=="undefined"?this.props.id:F7(this[Symbol.toStringTag]);this.props.id=Z,this.id=Z,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource($){this._attachedResources.add($)}detachResource($){this._attachedResources.delete($)}destroyAttachedResource($){if(this._attachedResources.delete($))$.destroy()}destroyAttachedResources(){for(let $ of Object.values(this._attachedResources))$.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let $=this._device.statsManager.getStats("Resource Counts"),Q=this[Symbol.toStringTag];$.get(`${Q}s Active`).decrementCount()}trackAllocatedMemory($,Q=this[Symbol.toStringTag]){let J=this._device.statsManager.getStats("Resource Counts");J.get("GPU Memory").addCount($),J.get(`${Q} Memory`).addCount($),this.allocatedBytes=$}trackDeallocatedMemory($=this[Symbol.toStringTag]){let Q=this._device.statsManager.getStats("Resource Counts");Q.get("GPU Memory").subtractCount(this.allocatedBytes),Q.get(`${$} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let $=this._device.statsManager.getStats("Resource Counts"),Q=this[Symbol.toStringTag];$.get("Resources Created").incrementCount(),$.get(`${Q}s Created`).incrementCount(),$.get(`${Q}s Active`).incrementCount()}}});var M1;var qZ=C(()=>{p0();M1=class M1 extends C1{static defaultProps={...C1.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor($,Q){let J={...Q};if((Q.usage||0)&M1.INDEX&&!Q.indexType){if(Q.data instanceof Uint32Array)J.indexType="uint32";else if(Q.data instanceof Uint16Array)J.indexType="uint16"}delete J.data;super($,J,M1.defaultProps);this.usage=J.usage||0,this.indexType=J.indexType,this.updateTimestamp=$.incrementTimestamp()}clone($){return this.device.createBuffer({...this.props,...$})}readSyncWebGL($,Q){throw Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData($,Q,J){let Z=ArrayBuffer.isView($)?$.buffer:$,K=Math.min($?$.byteLength:J,M1.DEBUG_DATA_MAX_LENGTH);if(Z===null)this.debugData=new ArrayBuffer(K);else if(Q===0&&J===Z.byteLength)this.debugData=Z.slice(0,K);else this.debugData=Z.slice(Q,Q+K)}}});function HZ($){let Q=Aj[$],J=J51(Q),Z=$.includes("norm"),K=!Z&&!$.startsWith("float"),X=$.startsWith("s");return{dataType:Aj[$],byteLength:J,integer:K,signed:X,normalized:Z}}function J51($){return Z51[$]}var Aj,Z51;var YU=C(()=>{Aj={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},Z51={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4}});function FZ($){let Q=K51[$];if(!Q)throw Error(`Unsupported texture format ${$}`);return Q}var K51;var WU=C(()=>{K51={r8unorm:{},r8snorm:{render:"snorm8-renderable-webgl"},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:"snorm8-renderable-webgl"},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:"float16-renderable-webgl",filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:"norm16-renderable-webgl"},"r16snorm-webgl":{f:"snorm16-renderable-webgl"},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:"snorm8-renderable-webgl"},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:"float16-renderable-webgl",filter:"float16-filterable-webgl"},"rg16unorm-webgl":{render:"norm16-renderable-webgl"},"rg16snorm-webgl":{render:"snorm16-renderable-webgl"},r32uint:{},r32sint:{},r32float:{render:"float32-renderable-webgl",filter:"float32-filterable"},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:"float32-renderable-webgl"},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:"norm16-renderable-webgl"},"rgb16snorm-webgl":{f:"norm16-renderable-webgl"},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:"float32-filterable"},rgba16uint:{},rgba16sint:{},rgba16float:{render:"float16-renderable-webgl",filter:"float16-filterable-webgl"},"rgba16unorm-webgl":{render:"norm16-renderable-webgl"},"rgba16snorm-webgl":{render:"snorm16-renderable-webgl"},"rgb32float-webgl":{render:"float32-renderable-webgl",filter:"float32-filterable"},rgba32uint:{},rgba32sint:{},rgba32float:{render:"float32-renderable-webgl",filter:"float32-filterable"},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:"texture-compression-bc"},"bc1-rgb-unorm-srgb-webgl":{f:"texture-compression-bc"},"bc1-rgba-unorm":{f:"texture-compression-bc"},"bc1-rgba-unorm-srgb":{f:"texture-compression-bc"},"bc2-rgba-unorm":{f:"texture-compression-bc"},"bc2-rgba-unorm-srgb":{f:"texture-compression-bc"},"bc3-rgba-unorm":{f:"texture-compression-bc"},"bc3-rgba-unorm-srgb":{f:"texture-compression-bc"},"bc4-r-unorm":{f:"texture-compression-bc"},"bc4-r-snorm":{f:"texture-compression-bc"},"bc5-rg-unorm":{f:"texture-compression-bc"},"bc5-rg-snorm":{f:"texture-compression-bc"},"bc6h-rgb-ufloat":{f:"texture-compression-bc"},"bc6h-rgb-float":{f:"texture-compression-bc"},"bc7-rgba-unorm":{f:"texture-compression-bc"},"bc7-rgba-unorm-srgb":{f:"texture-compression-bc"},"etc2-rgb8unorm":{f:"texture-compression-etc2"},"etc2-rgb8unorm-srgb":{f:"texture-compression-etc2"},"etc2-rgb8a1unorm":{f:"texture-compression-etc2"},"etc2-rgb8a1unorm-srgb":{f:"texture-compression-etc2"},"etc2-rgba8unorm":{f:"texture-compression-etc2"},"etc2-rgba8unorm-srgb":{f:"texture-compression-etc2"},"eac-r11unorm":{f:"texture-compression-etc2"},"eac-r11snorm":{f:"texture-compression-etc2"},"eac-rg11unorm":{f:"texture-compression-etc2"},"eac-rg11snorm":{f:"texture-compression-etc2"},"astc-4x4-unorm":{f:"texture-compression-astc"},"astc-4x4-unorm-srgb":{f:"texture-compression-astc"},"astc-5x4-unorm":{f:"texture-compression-astc"},"astc-5x4-unorm-srgb":{f:"texture-compression-astc"},"astc-5x5-unorm":{f:"texture-compression-astc"},"astc-5x5-unorm-srgb":{f:"texture-compression-astc"},"astc-6x5-unorm":{f:"texture-compression-astc"},"astc-6x5-unorm-srgb":{f:"texture-compression-astc"},"astc-6x6-unorm":{f:"texture-compression-astc"},"astc-6x6-unorm-srgb":{f:"texture-compression-astc"},"astc-8x5-unorm":{f:"texture-compression-astc"},"astc-8x5-unorm-srgb":{f:"texture-compression-astc"},"astc-8x6-unorm":{f:"texture-compression-astc"},"astc-8x6-unorm-srgb":{f:"texture-compression-astc"},"astc-8x8-unorm":{f:"texture-compression-astc"},"astc-8x8-unorm-srgb":{f:"texture-compression-astc"},"astc-10x5-unorm":{f:"texture-compression-astc"},"astc-10x5-unorm-srgb":{f:"texture-compression-astc"},"astc-10x6-unorm":{f:"texture-compression-astc"},"astc-10x6-unorm-srgb":{f:"texture-compression-astc"},"astc-10x8-unorm":{f:"texture-compression-astc"},"astc-10x8-unorm-srgb":{f:"texture-compression-astc"},"astc-10x10-unorm":{f:"texture-compression-astc"},"astc-10x10-unorm-srgb":{f:"texture-compression-astc"},"astc-12x10-unorm":{f:"texture-compression-astc"},"astc-12x10-unorm-srgb":{f:"texture-compression-astc"},"astc-12x12-unorm":{f:"texture-compression-astc"},"astc-12x12-unorm-srgb":{f:"texture-compression-astc"},"pvrtc-rgb4unorm-webgl":{f:"texture-compression-pvrtc-webgl"},"pvrtc-rgba4unorm-webgl":{f:"texture-compression-pvrtc-webgl"},"pvrtc-rbg2unorm-webgl":{f:"texture-compression-pvrtc-webgl"},"pvrtc-rgba2unorm-webgl":{f:"texture-compression-pvrtc-webgl"},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:"texture-compression-atc-webgl"},"atc-rgba-unorm-webgl":{f:"texture-compression-atc-webgl"},"atc-rgbai-unorm-webgl":{f:"texture-compression-atc-webgl"}}});function qU($){return X51.some((Q)=>$.startsWith(Q))}function h9($){let Q=W51($);if(qU($)){Q.channels="rgb",Q.components=3,Q.bytesPerPixel=1,Q.srgb=!1,Q.compressed=!0;let Z=q51($);if(Z)Q.blockWidth=Z.blockWidth,Q.blockHeight=Z.blockHeight}let J=Y51.exec($);if(J){let[,Z,K,X,Y,W]=J,q=`${X}${K}`,H=HZ(q),F=H.byteLength*8,U=Z.length,V=[F,U>=2?F:0,U>=3?F:0,U>=4?F:0];if(Q={format:$,attachment:Q.attachment,dataType:H.dataType,components:U,channels:Z,integer:H.integer,signed:H.signed,normalized:H.normalized,bitsPerChannel:V,bytesPerPixel:H.byteLength*Z.length,packed:Q.packed,srgb:Q.srgb},W==="-webgl")Q.webgl=!0;if(Y==="-srgb")Q.srgb=!0}if($.endsWith("-webgl"))Q.webgl=!0;if($.endsWith("-srgb"))Q.srgb=!0;return Q}function W51($){let Q=FZ($),J=Q.bytesPerPixel||1,Z=Q.bitsPerChannel||[8,8,8,8];return delete Q.bitsPerChannel,delete Q.bytesPerPixel,delete Q.f,delete Q.render,delete Q.filter,delete Q.blend,delete Q.store,{...Q,format:$,attachment:Q.attachment||"color",channels:Q.channels||"r",components:Q.components||Q.channels?.length||1,bytesPerPixel:J,bitsPerChannel:Z,dataType:Q.dataType||"uint8",srgb:Q.srgb??!1,packed:Q.packed??!1,webgl:Q.webgl??!1,integer:Q.integer??!1,signed:Q.signed??!1,normalized:Q.normalized??!1,compressed:Q.compressed??!1}}function q51($){let J=/.*-(\d+)x(\d+)-.*/.exec($);if(J){let[,Z,K]=J;return{blockWidth:Number(Z),blockHeight:Number(K)}}return null}var X51,Y51;var UZ=C(()=>{YU();WU();X51=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Y51=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/});function zj($){let Q=FZ($),J={format:$,create:Q.f??!0,render:Q.render??!0,filter:Q.filter??!0,blend:Q.blend??!0,store:Q.store??!0},Z=h9($),K=$.startsWith("depth")||$.startsWith("stencil"),X=Z?.signed,Y=Z?.integer,W=Z?.webgl;return J.render&&=!X,J.filter&&=!K&&!X&&!Y&&!W,J}var kj=C(()=>{UZ();WU()});class VZ{}var NZ,h5;var HU=C(()=>{KU();j6();_2();qZ();UZ();kj();NZ=class NZ{features;disabledFeatures;constructor($=[],Q){this.features=new Set($),this.disabledFeatures=Q||{}}*[Symbol.iterator](){yield*this.features}has($){return!this.disabledFeatures?.[$]&&this.features.has($)}};h5=class h5{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:($)=>f.error($.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:f.get("debug")||void 0,debugShaders:f.get("debug-shaders")||void 0,debugFramebuffers:Boolean(f.get("debug-framebuffers")),debugWebGL:Boolean(f.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor($){this.props={...h5.defaultProps,...$},this.id=this.props.id||F7(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=WZ;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities($){let Q=zj($),J=(X)=>(typeof X==="string"?this.features.has(X):X)??!0,Z=J(Q.create),K={format:$,create:Z,render:Z&&J(Q.render),filter:Z&&J(Q.filter),blend:Z&&J(Q.blend),store:Z&&J(Q.store)};return this._getDeviceSpecificTextureFormatCapabilities(K)}isTextureFormatSupported($,Q){return this.getTextureFormatCapabilities($).create}isTextureFormatFilterable($){return this.getTextureFormatCapabilities($).filter}isTextureFormatRenderable($){return this.getTextureFormatCapabilities($).render}isTextureFormatCompressed($){return qU($)}loseDevice(){return!1}reportError($){this.props.onError($)}getDefaultCanvasContext(){if(!this.canvasContext)throw Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder($={}){throw Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError($){this.props.onError($)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL($,Q){throw Error("not implemented")}readPixelsToBufferWebGL($,Q){throw Error("not implemented")}setParametersWebGL($){throw Error("not implemented")}getParametersWebGL($){throw Error("not implemented")}withParametersWebGL($,Q){throw Error("not implemented")}clearWebGL($){throw Error("not implemented")}resetWebGL(){throw Error("not implemented")}static _getCanvasContextProps($){return $.createCanvasContext===!0?{}:$.createCanvasContext}_normalizeBufferProps($){if($ instanceof ArrayBuffer||ArrayBuffer.isView($))$={data:$};let Q={...$};if(($.usage||0)&M1.INDEX&&!$.indexType)if($.data instanceof Uint32Array)Q.indexType="uint32";else if($.data instanceof Uint16Array)Q.indexType="uint16";else f.warn("indices buffer content must be of integer type")();return Q}}});function V51(){if(F51()||typeof window>"u")return Promise.resolve();return new Promise(($)=>{window.addEventListener("load",()=>$())})}var H51,F51=()=>H51&&document.readyState==="complete",U51="set luma.log.level=1 (or higher) to trace rendering",Bj="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",L9,v9;var Rj=C(()=>{W7();HU();KU();j6();H51=d0()&&typeof document<"u";L9=class L9{static defaultProps={...h5.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=V51().then(()=>{f.probe(2,"DOM is loaded")()});stats=WZ;log=f;VERSION="9.1.10";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw f.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),f.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),Error("luma.gl - multiple versions detected: see console log");f.error("This version of luma.gl has already been initialized")()}f.log(1,`${this.VERSION} - ${U51}`)(),globalThis.luma=this}registerAdapters($){for(let Q of $)this.preregisteredAdapters.set(Q.type,Q)}getSupportedAdapters($=[]){let Q=this.getAdapterMap($);return Array.from(Q).map(([,J])=>J).filter((J)=>J.isSupported?.()).map((J)=>J.type)}getBestAvailableAdapter($=[]){let Q=this.getAdapterMap($);if(Q.get("webgpu")?.isSupported?.())return"webgpu";if(Q.get("webgl")?.isSupported?.())return"webgl";return null}setDefaultDeviceProps($){Object.assign(L9.defaultProps,$)}async createDevice($={}){if($={...L9.defaultProps,...$},$.waitForPageLoad)await L9.pageLoaded;let Q=this.getAdapterMap($.adapters),J=$.type||"";if(J==="best-available")J=this.getBestAvailableAdapter($.adapters)||J;let X=await(this.getAdapterMap($.adapters)||Q).get(J)?.create?.($);if(X)return X;throw Error(Bj)}async attachDevice($){let Q=this.getAdapterMap($.adapters),J="";if($.handle instanceof WebGL2RenderingContext)J="webgl";if($.createCanvasContext)await L9.pageLoaded;if($.handle===null)J="unknown";let K=await Q.get(J)?.attach?.(null);if(K)return K;throw Error(Bj)}enforceWebGL2($=!0,Q=[]){let Z=this.getAdapterMap(Q).get("webgl");if(!Z)f.warn("enforceWebGL2: webgl adapter not found")();Z?.enforceWebGL2?.($)}getAdapterMap($=[]){let Q=new Map(this.preregisteredAdapters);for(let J of $)Q.set(J.type,J);return Q}registerDevices($){f.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(let Q of $){let J=Q.adapter;if(J)this.preregisteredAdapters.set(J.type,J)}}};v9=new L9});class DZ{}function N51($){if(typeof $==="string"){let Q=document.getElementById($);if(!Q)throw Error(`${$} is not an HTML element`);return Q}else if($)return $;return document.body}function D51($){let Q=document.getElementById($);if(!(Q instanceof HTMLCanvasElement))throw Error("Object is not a canvas element");return Q}function C51($){let{width:Q,height:J}=$,Z=document.createElement("canvas");return Z.id=F7("lumagl-auto-created-canvas"),Z.width=Q||1,Z.height=J||1,Z.style.width=Number.isFinite(Q)?`${Q}px`:"100%",Z.style.height=Number.isFinite(J)?`${J}px`:"100%",Z}function A51($,Q,J,Z,K){let X=$,Y=Oj(X[0],Q,J),W=Pj(X[1],Q,Z,K),q=Oj(X[0]+1,Q,J),H=q===J-1?q:q-1;q=Pj(X[1]+1,Q,Z,K);let F;if(K)q=q===0?q:q+1,F=W,W=q;else F=q===Z-1?q:q-1;return{x:Y,y:W,width:Math.max(H-Y+1,1),height:Math.max(F-W+1,1)}}function Oj($,Q,J){return Math.min(Math.round($*Q),J-1)}function Pj($,Q,J,Z){return Z?Math.max(0,J-1-Math.round($*Q)):Math.min(Math.round($*Q),J-1)}var x2;var Mj=C(()=>{W7();j6();_2();x2=class x2{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor($){if(this.props={...x2.defaultProps,...$},$=this.props,!d0()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(!$.canvas){let Q=C51($),J=N51($?.container||null);if(J.insertBefore(Q,J.firstChild),this.canvas=Q,!$?.visible)this.canvas.style.visibility="hidden"}else if(typeof $.canvas==="string")this.canvas=D51($.canvas);else this.canvas=$.canvas;if(this.canvas instanceof HTMLCanvasElement)this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas;else this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas;if(this.canvas instanceof HTMLCanvasElement&&$.autoResize)this.resizeObserver=new ResizeObserver((Q)=>{for(let J of Q)if(J.target===this.canvas)this.update()}),this.resizeObserver.observe(this.canvas)}getDevicePixelRatio($){if(typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas)return 1;if($=$===void 0?this.props.useDevicePixels:$,!$||$<=0)return 1;if($===!0)return typeof window<"u"&&window.devicePixelRatio||1;return $}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":let $=this.getDevicePixelRatio(),Q=this.canvas;return Q.parentElement?[Q.clientWidth*$,Q.clientHeight*$]:[this.canvas.width,this.canvas.height];default:throw Error(this.type)}}getAspect(){let[$,Q]=this.getPixelSize();return $/Q}cssToDeviceRatio(){try{let[$]=this.getDrawingBufferSize(),Q=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return Q?$/Q:1}catch{return 1}}cssToDevicePixels($,Q=!0){let J=this.cssToDeviceRatio(),[Z,K]=this.getDrawingBufferSize();return A51($,J,Z,K,Q)}setDevicePixelRatio($,Q={}){if(!this.htmlCanvas)return;let J="width"in Q?Q.width:this.htmlCanvas.clientWidth,Z="height"in Q?Q.height:this.htmlCanvas.clientHeight;if(!J||!Z)f.log(1,"Canvas clientWidth/clientHeight is 0")(),$=1,J=this.htmlCanvas.width||1,Z=this.htmlCanvas.height||1;let K=this._canvasSizeInfo;if(K.clientWidth!==J||K.clientHeight!==Z||K.devicePixelRatio!==$){let X=$,Y=Math.floor(J*X),W=Math.floor(Z*X);if(this.htmlCanvas.width=Y,this.htmlCanvas.height=W,this.device.gl){let[H,F]=this.getDrawingBufferSize();if(H!==Y||F!==W)X=Math.min(H/J,F/Z),this.htmlCanvas.width=Math.floor(J*X),this.htmlCanvas.height=Math.floor(Z*X),f.warn("Device pixel ratio clamped")();this._canvasSizeInfo.clientWidth=J,this._canvasSizeInfo.clientHeight=Z,this._canvasSizeInfo.devicePixelRatio=$}}}getDrawingBufferSize(){let $=this.device.gl;if(!$)return this.getPixelSize();return[$.drawingBufferWidth,$.drawingBufferHeight]}_setAutoCreatedCanvasId($){if(this.htmlCanvas?.id==="lumagl-auto-created-canvas")this.htmlCanvas.id=$}}});var E1;var FU=C(()=>{p0();E1=class E1 extends C1{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...C1.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor($,Q){Q=E1.normalizeProps($,Q);super($,Q,E1.defaultProps);if(this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){let J=E1.getTextureDataSize(this.props.data);this.width=J?.width||1,this.height=J?.height||1}if(this.props.mipmaps&&this.props.mipLevels===void 0)this.props.mipLevels="pyramid";this.mipLevels=this.props.mipLevels==="pyramid"?E1.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=$.incrementTimestamp()}clone($){return this.device.createTexture({...this.props,...$})}static isExternalImage($){return typeof ImageData<"u"&&$ instanceof ImageData||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap||typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&$ instanceof HTMLVideoElement||typeof VideoFrame<"u"&&$ instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&$ instanceof OffscreenCanvas}static getExternalImageSize($){if(typeof ImageData<"u"&&$ instanceof ImageData||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&$ instanceof OffscreenCanvas)return{width:$.width,height:$.height};if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement)return{width:$.naturalWidth,height:$.naturalHeight};if(typeof HTMLVideoElement<"u"&&$ instanceof HTMLVideoElement)return{width:$.videoWidth,height:$.videoHeight};if(typeof VideoFrame<"u"&&$ instanceof VideoFrame)return{width:$.displayWidth,height:$.displayHeight};throw Error("Unknown image type")}static isTextureLevelData($){let Q=$?.data;return ArrayBuffer.isView(Q)}static getTextureDataSize($){if(!$)return null;if(ArrayBuffer.isView($))return null;if(Array.isArray($))return E1.getTextureDataSize($[0]);if(E1.isExternalImage($))return E1.getExternalImageSize($);if($&&typeof $==="object"&&$.constructor===Object){let J=Object.values($)[0];return{width:J.width,height:J.height}}throw Error("texture size deduction failed")}static normalizeTextureData($,Q){let J;if(ArrayBuffer.isView($))J=[{data:$,width:Q.width,height:Q.height}];else if(!Array.isArray($))J=[$];else J=$;return J}static getMipLevelCount($,Q){return Math.floor(Math.log2(Math.max($,Q)))+1}static getCubeFaceDepth($){switch($){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw Error($)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps($,Q){let J={...Q},Z=$?.props?._resourceDefaults?.texture||{};Object.assign(J,Z);let{width:K,height:X}=J;if(typeof K==="number")J.width=Math.max(1,Math.ceil(K));if(typeof X==="number")J.height=Math.max(1,Math.ceil(X));return J}}});var D8;var wj=C(()=>{p0();D8=class D8 extends C1{static defaultProps={...C1.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor($,Q){super($,Q,D8.defaultProps)}}});function Tj($,Q,J){let Z="",K=Q.split(/\r?\n/),X=$.slice().sort((Y,W)=>Y.lineNum-W.lineNum);switch(J?.showSourceCode||"no"){case"all":let Y=0;for(let W=1;W<=K.length;W++){Z+=Ij(K[W-1],W,J);while(X.length>Y&&X[Y].lineNum===W){let q=X[Y++];Z+=Sj(q,K,q.lineNum,{...J,inlineSource:!1})}}return Z;case"issues":case"no":for(let W of $)Z+=Sj(W,K,W.lineNum,{inlineSource:J?.showSourceCode!=="no"});return Z}}function Sj($,Q,J,Z){if(Z?.inlineSource){let X=z51(Q,J),Y=$.linePos>0?`${" ".repeat($.linePos+5)}^^^
`:"";return`
${X}${Y}${$.type.toUpperCase()}: ${$.message}

`}let K=$.type==="error"?"red":"#8B4000";return Z?.html?`<div class='luma-compiler-log-error' style="color:${K};"><b> ${$.type.toUpperCase()}: ${$.message}</b></div>`:`${$.type.toUpperCase()}: ${$.message}`}function z51($,Q,J){let Z="";for(let K=Q-2;K<=Q;K++){let X=$[K-1];if(X!==void 0)Z+=Ij(X,Q,J)}return Z}function Ij($,Q,J){let Z=J?.html?B51($):$;return`${k51(String(Q),4)}: ${Z}${J?.html?"<br/>":`
`}`}function k51($,Q){let J="";for(let Z=$.length;Z<Q;++Z)J+=" ";return J+$}function B51($){return $.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function R51($){return Gj($.source)||$.id||F7(`unnamed ${$.stage}-shader`)}function Gj($,Q="unnamed"){let Z=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec($);return Z?Z[1]:Q}var C8;var Ej=C(()=>{p0();_2();C8=class C8 extends C1{static defaultProps={...C1.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor($,Q){Q={...Q,debugShaders:Q.debugShaders||$.props.debugShaders||"errors"};super($,{id:R51(Q),...Q},C8.defaultProps);this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){let $=this.props.debugShaders;switch($){case"never":return;case"errors":if(this.compilationStatus==="success")return;break;case"warnings":case"always":break}let Q=await this.getCompilationInfo();if($==="warnings"&&Q?.length===0)return;this._displayShaderLog(Q)}_displayShaderLog($){if(typeof document>"u"||!document?.createElement)return;let Q=Gj(this.source),J=`${this.stage} ${Q}`,Z=Tj($,this.source,{showSourceCode:"all",html:!0}),K=this.getTranslatedSource();if(K)Z+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${K}</pre></code>`;let X=document.createElement("Button");X.innerHTML=`
<h1>Shader Compilation Error in ${J}</h1><br /><br />
<code style="user-select:text;"><pre>
${Z}
</pre></code>`,X.style.top="10px",X.style.left="10px",X.style.position="absolute",X.style.zIndex="9999",X.style.width="100%",X.style.textAlign="left",document.body.appendChild(X),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),X.onclick=()=>{let W=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(W)}}}});var U7;var jj=C(()=>{p0();U7=class U7 extends C1{static defaultProps={...C1.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor($,Q){Q=U7.normalizeProps($,Q);super($,Q,U7.defaultProps)}static normalizeProps($,Q){let J=$?.props?._resourceDefaults?.sampler||{};return{...Q,...J}}}});var A8;var hj=C(()=>{p0();FU();j6();A8=class A8 extends C1{static defaultProps={...C1.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor($,Q={}){super($,Q,A8.defaultProps);this.width=this.props.width,this.height=this.props.height}clone($){let Q=this.colorAttachments.map((Z)=>Z.texture.clone($)),J=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone($);return this.device.createFramebuffer({...this.props,colorAttachments:Q,depthStencilAttachment:J})}resize($){let Q=!$;if($){let[J,Z]=Array.isArray($)?$:[$.width,$.height];Q=Q||Z!==this.height||J!==this.width,this.width=J,this.height=Z}if(Q)f.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height)}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((Q,J)=>{if(typeof Q==="string"){let Z=this.createColorTexture(Q,J);return this.attachResource(Z),Z.view}if(Q instanceof E1)return Q.view;return Q});let $=this.props.depthStencilAttachment;if($)if(typeof $==="string"){let Q=this.createDepthStencilTexture($);this.attachResource(Q),this.depthStencilAttachment=Q.view}else if($ instanceof E1)this.depthStencilAttachment=$.view;else this.depthStencilAttachment=$}createColorTexture($,Q){return this.device.createTexture({id:`${this.id}-color-attachment-${Q}`,usage:E1.RENDER_ATTACHMENT,format:$,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture($){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:E1.RENDER_ATTACHMENT,format:$,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments($,Q){for(let J=0;J<this.colorAttachments.length;++J)if(this.colorAttachments[J]){let Z=this.colorAttachments[J].texture.clone({width:$,height:Q});this.destroyAttachedResource(this.colorAttachments[J]),this.colorAttachments[J]=Z.view,this.attachResource(Z.view)}if(this.depthStencilAttachment){let J=this.depthStencilAttachment.texture.clone({width:$,height:Q});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=J.view,this.attachResource(J)}this.updateAttachments()}}});var h6;var Lj=C(()=>{p0();h6=class h6 extends C1{static defaultProps={...C1.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor($,Q){super($,Q,h6.defaultProps);this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL($){throw Error("Use uniform blocks")}}});var Y4;var vj=C(()=>{p0();Y4=class Y4 extends C1{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...C1.defaultProps,framebuffer:null,parameters:void 0,clearColor:Y4.defaultClearColor,clearColors:void 0,clearDepth:Y4.defaultClearDepth,clearStencil:Y4.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor($,Q){Q=Y4.normalizeProps($,Q);super($,Q,Y4.defaultProps)}static normalizeProps($,Q){return{...$.props._resourceDefaults?.renderPass,...Q}}}});var _9;var _j=C(()=>{p0();_9=class _9 extends C1{static defaultProps={...C1.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor($,Q){super($,Q,_9.defaultProps);this.shaderLayout=Q.shaderLayout}}});var g2;var xj=C(()=>{p0();g2=class g2 extends C1{static defaultProps={...C1.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor($,Q){super($,Q,g2.defaultProps)}}});var y2;var gj=C(()=>{p0();y2=class y2 extends C1{static defaultProps={...C1.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor($,Q){super($,Q,y2.defaultProps)}}});function yj($){let[Q,J]=P51[$],Z=Q==="i32"||Q==="u32",K=Q!=="u32",X=M51[Q]*J,Y=O51(Q,J);return{dataType:Q,components:J,defaultVertexFormat:Y,byteLength:X,integer:Z,signed:K}}function O51($,Q){let J;switch($){case"f32":J="float32";break;case"i32":J="sint32";break;case"u32":J="uint32";break;case"f16":return Q<=2?"float16x2":"float16x4"}if(Q===1)return J;return`${J}x${Q}`}var P51,M51;var fj=C(()=>{P51={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},M51={f32:4,f16:2,i32:4,u32:4}});function UU($){let Q;if($.endsWith("-webgl"))$.replace("-webgl",""),Q=!0;let[J,Z]=$.split("x"),K=J,X=Z?parseInt(Z):1,Y=HZ(K),W={type:K,components:X,byteLength:Y.byteLength*X,integer:Y.integer,signed:Y.signed,normalized:Y.normalized};if(Q)W.webglOnly=!0;return W}var bj=C(()=>{YU()});function CZ($,Q){let J={};for(let Z of $.attributes){let K=w51($,Q,Z.name);if(K)J[Z.name]=K}return J}function mj($,Q,J=16){let Z=CZ($,Q),K=Array(J).fill(null);for(let X of Object.values(Z))K[X.location]=X;return K}function w51($,Q,J){let Z=S51($,J),K=T51(Q,J);if(!Z)return null;let X=yj(Z.type),Y=K?.vertexFormat||X.defaultVertexFormat,W=UU(Y);return{attributeName:K?.attributeName||Z.name,bufferName:K?.bufferName||Z.name,location:Z.location,shaderType:Z.type,shaderDataType:X.dataType,shaderComponents:X.components,vertexFormat:Y,bufferDataType:W.type,bufferComponents:W.components,normalized:W.normalized,integer:X.integer,stepMode:K?.stepMode||Z.stepMode||"vertex",byteOffset:K?.byteOffset||0,byteStride:K?.byteStride||0}}function S51($,Q){let J=$.attributes.find((Z)=>Z.name===Q);if(!J)f.warn(`shader layout attribute "${Q}" not present in shader`);return J||null}function T51($,Q){I51($);let J=G51($,Q);if(J)return J;if(J=E51($,Q),J)return J;return f.warn(`layout for attribute "${Q}" not present in buffer layout`),null}function I51($){for(let Q of $)if(Q.attributes&&Q.format||!Q.attributes&&!Q.format)f.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function G51($,Q){for(let J of $)if(J.format&&J.name===Q)return{attributeName:J.name,bufferName:Q,stepMode:J.stepMode,vertexFormat:J.format,byteOffset:0,byteStride:J.byteStride||0};return null}function E51($,Q){for(let J of $){let Z=J.byteStride;if(typeof J.byteStride!=="number")for(let X of J.attributes||[]){let Y=UU(X.format);Z+=Y.byteLength}let K=J.attributes?.find((X)=>X.attribute===Q);if(K)return{attributeName:K.attribute,bufferName:J.name,stepMode:J.stepMode,vertexFormat:K.format,byteOffset:K.byteOffset,byteStride:Z}}return null}var VU=C(()=>{j6();fj();bj()});var f2;var cj=C(()=>{VU();p0();f2=class f2 extends C1{static defaultProps={...C1.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor($,Q){super($,Q,f2.defaultProps);this.maxVertexAttributes=$.limits.maxVertexAttributes,this.attributes=Array(this.maxVertexAttributes).fill(null);let{shaderLayout:J,bufferLayout:Z}=Q.renderPipeline||{};if(!J||!Z)throw Error("VertexArray");this.attributeInfos=mj(J,Z,this.maxVertexAttributes)}setConstantWebGL($,Q){this.device.reportError(Error("constant attributes not supported"))}}});var b2;var dj=C(()=>{p0();b2=class b2 extends C1{static defaultProps={...C1.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor($,Q){super($,Q,b2.defaultProps)}}});var m2;var lj=C(()=>{p0();m2=class m2 extends C1{static defaultProps={...C1.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor($,Q){super($,Q,m2.defaultProps)}}});function pj($){return j51[$]}function uj($,Q){switch(Q){case 1:return $;case 2:return $+$%2;default:return $+(4-$%4)%4}}var j51;var ij=C(()=>{j51={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}}});function NU($){if(!AZ||AZ.byteLength<$)AZ=new ArrayBuffer($);return AZ}function DU($,Q){let J=NU($.BYTES_PER_ELEMENT*Q);return new $(J,0,Q)}var AZ;function h51($){return ArrayBuffer.isView($)&&!($ instanceof DataView)}function x9($){if(Array.isArray($))return $.length===0||typeof $[0]==="number";return h51($)}class CU{layout={};byteLength;constructor($){let Q=0;for(let[Z,K]of Object.entries($)){let X=pj(K),{type:Y,components:W}=X;Q=uj(Q,W);let q=Q;Q+=W,this.layout[Z]={type:Y,size:W,offset:q}}Q+=(4-Q%4)%4;let J=Q*4;this.byteLength=Math.max(J,nj)}getData($){let Q=Math.max(this.byteLength,nj),J=NU(Q),Z={i32:new Int32Array(J),u32:new Uint32Array(J),f32:new Float32Array(J),f16:new Uint16Array(J)};for(let[K,X]of Object.entries($)){let Y=this.layout[K];if(!Y){f.warn(`Supplied uniform value ${K} not present in uniform block layout`)();continue}let{type:W,size:q,offset:H}=Y,F=Z[W];if(q===1){if(typeof X!=="number"&&typeof X!=="boolean"){f.warn(`Supplied value for single component uniform ${K} is not a number: ${X}`)();continue}F[H]=Number(X)}else{if(!x9(X)){f.warn(`Supplied value for multi component / array uniform ${K} is not a numeric array: ${X}`)();continue}F.set(X,H)}}return new Uint8Array(J)}has($){return Boolean(this.layout[$])}get($){return this.layout[$]}}var nj=1024;var sj=C(()=>{ij();j6()});function oj($,Q,J=16){if($!==Q)return!1;let Z=$,K=Q;if(!x9(Z))return!1;if(x9(K)&&Z.length===K.length){for(let X=0;X<Z.length;++X)if(K[X]!==Z[X])return!1}return!0}function rj($){if(x9($))return $.slice();return $}var aj=()=>{};class AU{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor($){if(this.name=$?.name||"unnamed",$?.name&&$?.shaderLayout){let Q=$?.shaderLayout.bindings?.find((Z)=>Z.type==="uniform"&&Z.name===$?.name);if(!Q)throw Error($?.name);let J=Q;for(let Z of J.uniforms||[])this.bindingLayout[Z.name]=Z}}setUniforms($){for(let[Q,J]of Object.entries($))if(this._setUniform(Q,J),!this.needsRedraw)this.setNeedsRedraw(`${this.name}.${Q}=${J}`)}setNeedsRedraw($){this.needsRedraw=this.needsRedraw||$}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform($,Q){if(oj(this.uniforms[$],Q))return;this.uniforms[$]=rj(Q),this.modifiedUniforms[$]=!0,this.modified=!0}}var tj=C(()=>{aj()});class zZ{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor($){for(let[Q,J]of Object.entries($)){let Z=Q,K=new CU(J.uniformTypes||{});this.uniformBufferLayouts.set(Z,K);let X=new AU({name:Q});X.setUniforms(J.defaultUniforms||{}),this.uniformBlocks.set(Z,X)}}destroy(){for(let $ of this.uniformBuffers.values())$.destroy()}setUniforms($){for(let[Q,J]of Object.entries($))this.uniformBlocks.get(Q)?.setUniforms(J);this.updateUniformBuffers()}getUniformBufferByteLength($){return this.uniformBufferLayouts.get($)?.byteLength||0}getUniformBufferData($){let Q=this.uniformBlocks.get($)?.getAllUniforms()||{};return this.uniformBufferLayouts.get($)?.getData(Q)}createUniformBuffer($,Q,J){if(J)this.setUniforms(J);let Z=this.getUniformBufferByteLength(Q),K=$.createBuffer({usage:M1.UNIFORM|M1.COPY_DST,byteLength:Z}),X=this.getUniformBufferData(Q);return K.write(X),K}getManagedUniformBuffer($,Q){if(!this.uniformBuffers.get(Q)){let J=this.getUniformBufferByteLength(Q),Z=$.createBuffer({usage:M1.UNIFORM|M1.COPY_DST,byteLength:J});this.uniformBuffers.set(Q,Z)}return this.uniformBuffers.get(Q)}updateUniformBuffers(){let $=!1;for(let Q of this.uniformBlocks.keys()){let J=this.updateUniformBuffer(Q);$||=J}if($)f.log(3,`UniformStore.updateUniformBuffers(): ${$}`)();return $}updateUniformBuffer($){let Q=this.uniformBlocks.get($),J=this.uniformBuffers.get($),Z=!1;if(J&&Q?.needsRedraw){Z||=Q.needsRedraw;let K=this.getUniformBufferData($);J=this.uniformBuffers.get($),J?.write(K);let X=this.uniformBlocks.get($)?.getAllUniforms();f.log(4,`Writing to uniform buffer ${String($)}`,K,X)()}return Z}}var ej=C(()=>{qZ();j6();tj();sj()});function kZ($){let Q=ArrayBuffer.isView($)?$.constructor:$;switch(Q){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw Error(Q.constructor.name)}}function c2($){switch($){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw Error($)}}function zU($,Q,J){if(!Q||Q>4)throw Error(`size ${Q}`);let Z=Q,K=kZ($);if(K==="uint8"&&J&&Z===1)return"unorm8-webgl";if(K==="uint8"&&J&&Z===3)return"unorm8x3-webgl";if(K==="uint8"||K==="sint8"){if(Z===1||Z===3)throw Error(`size: ${Q}`);if(J)K=K.replace("int","norm");return`${K}x${Z}`}if(K==="uint16"||K==="sint16"){if(Z===1||Z===3)throw Error(`size: ${Q}`);if(J)K=K.replace("int","norm");return`${K}x${Z}`}if(Z===1)return K;return`${K}x${Z}`}class g9{bufferLayouts;constructor($){this.bufferLayouts=$}getBufferLayout($){return this.bufferLayouts.find((Q)=>Q.name===$)||null}getAttributeNamesForBuffer($){return $.attributes?$.attributes?.map((Q)=>Q.attribute):[$.name]}mergeBufferLayouts($,Q){let J=[...$];for(let Z of Q){let K=J.findIndex((X)=>X.name===Z.name);if(K<0)J.push(Z);else J[K]=Z}return J}getBufferIndex($){let Q=this.bufferLayouts.findIndex((J)=>J.name===$);if(Q===-1)f.warn(`BufferLayout: Missing buffer for "${$}".`)();return Q}}var $h=C(()=>{j6()});function kU($,Q){let J=Object.fromEntries($.attributes.map((K)=>[K.name,K.location])),Z=Q.slice();return Z.sort((K,X)=>{let Y=K.attributes?K.attributes.map((F)=>F.attribute):[K.name],W=X.attributes?X.attributes.map((F)=>F.attribute):[X.name],q=Math.min(...Y.map((F)=>J[F])),H=Math.min(...W.map((F)=>J[F]));return q-H}),Z}var O1=C(()=>{Rj();HU();Mj();qZ();FU();wj();Ej();jj();hj();Lj();vj();_j();xj();gj();cj();dj();lj();ej();UZ();j6();$h();VU()});class q5{constructor($,Q){this.name=$,this.attributes=Q,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class OU{constructor($,Q,J){this.name=$,this.type=Q,this.attributes=J,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class d2{constructor($,Q,J,Z,K,X,Y){this.name=$,this.type=Q,this.group=J,this.binding=Z,this.attributes=K,this.resourceType=X,this.access=Y}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Zh{constructor($,Q){this.name=$,this.type=Q}}class Kh{constructor($,Q,J,Z){this.name=$,this.type=Q,this.locationType=J,this.location=Z,this.interpolation=null}}class PU{constructor($,Q,J,Z){this.name=$,this.type=Q,this.locationType=J,this.location=Z}}class Xh{constructor($,Q,J,Z){this.name=$,this.type=Q,this.attributes=J,this.id=Z}}class Yh{constructor($,Q,J){this.name=$,this.type=Q,this.attributes=J}}class Wh{constructor($,Q=null,J){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=$,this.stage=Q,this.attributes=J}}class qh{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function L51($){var Q=(32768&$)>>15,J=(31744&$)>>10,Z=1023&$;return J==0?(Q?-1:1)*Math.pow(2,-14)*(Z/Math.pow(2,10)):J==31?Z?NaN:1/0*(Q?-1:1):(Q?-1:1)*Math.pow(2,J-15)*(1+Z/Math.pow(2,10))}function _51($){Hh[0]=$;let Q=v51[0],J=Q>>31&1,Z=Q>>23&255,K=8388607&Q;if(Z===255)return h0[0]=J<<15|31744|(K!==0?512:0),h0[0];if(Z===0){if(K===0)return h0[0]=J<<15,h0[0];K|=8388608;let X=113;for(;!(8388608&K);)K<<=1,X--;return Z=127-X,K&=8388607,Z>0?(K=(K>>126-Z)+(K>>127-Z&1),h0[0]=J<<15|Z<<10|K>>13,h0[0]):(h0[0]=J<<15,h0[0])}return Z=Z-127+15,Z>=31?(h0[0]=J<<15|31744,h0[0]):Z<=0?Z<-10?(h0[0]=J<<15,h0[0]):(K=(8388608|K)>>1-Z,h0[0]=J<<15|K>>13,h0[0]):(K>>=13,h0[0]=J<<15|Z<<10|K,h0[0])}function Qh($){let Q=112+($>>6&31)<<23|(63&$)<<17;return IU[0]=Q,Fh[0]}function x51($,Q,J,Z,K,X,Y,W,q){let H=Z*(Y>>=K)*(X>>=K)+J*Y+Q*W;switch(q){case"r8unorm":return[h1($,H,"8unorm",1)[0]];case"r8snorm":return[h1($,H,"8snorm",1)[0]];case"r8uint":return[h1($,H,"8uint",1)[0]];case"r8sint":return[h1($,H,"8sint",1)[0]];case"rg8unorm":{let F=h1($,H,"8unorm",2);return[F[0],F[1]]}case"rg8snorm":{let F=h1($,H,"8snorm",2);return[F[0],F[1]]}case"rg8uint":{let F=h1($,H,"8uint",2);return[F[0],F[1]]}case"rg8sint":{let F=h1($,H,"8sint",2);return[F[0],F[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{let F=h1($,H,"8unorm",4);return[F[0],F[1],F[2],F[3]]}case"rgba8snorm":{let F=h1($,H,"8snorm",4);return[F[0],F[1],F[2],F[3]]}case"rgba8uint":{let F=h1($,H,"8uint",4);return[F[0],F[1],F[2],F[3]]}case"rgba8sint":{let F=h1($,H,"8sint",4);return[F[0],F[1],F[2],F[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{let F=h1($,H,"8unorm",4);return[F[2],F[1],F[0],F[3]]}case"r16uint":return[h1($,H,"16uint",1)[0]];case"r16sint":return[h1($,H,"16sint",1)[0]];case"r16float":return[h1($,H,"16float",1)[0]];case"rg16uint":{let F=h1($,H,"16uint",2);return[F[0],F[1]]}case"rg16sint":{let F=h1($,H,"16sint",2);return[F[0],F[1]]}case"rg16float":{let F=h1($,H,"16float",2);return[F[0],F[1]]}case"rgba16uint":{let F=h1($,H,"16uint",4);return[F[0],F[1],F[2],F[3]]}case"rgba16sint":{let F=h1($,H,"16sint",4);return[F[0],F[1],F[2],F[3]]}case"rgba16float":{let F=h1($,H,"16float",4);return[F[0],F[1],F[2],F[3]]}case"r32uint":return[h1($,H,"32uint",1)[0]];case"r32sint":return[h1($,H,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[h1($,H,"32float",1)[0]];case"rg32uint":{let F=h1($,H,"32uint",2);return[F[0],F[1]]}case"rg32sint":{let F=h1($,H,"32sint",2);return[F[0],F[1]]}case"rg32float":{let F=h1($,H,"32float",2);return[F[0],F[1]]}case"rgba32uint":{let F=h1($,H,"32uint",4);return[F[0],F[1],F[2],F[3]]}case"rgba32sint":{let F=h1($,H,"32sint",4);return[F[0],F[1],F[2],F[3]]}case"rgba32float":{let F=h1($,H,"32float",4);return[F[0],F[1],F[2],F[3]]}case"rg11b10ufloat":{let F=new Uint32Array($.buffer,H,1)[0],U=(4192256&F)>>11,V=(4290772992&F)>>22;return[Qh(2047&F),Qh(U),function(N){let D=112+(N>>5&31)<<23|(31&N)<<18;return IU[0]=D,Fh[0]}(V),1]}}return null}function h1($,Q,J,Z){let K=[0,0,0,0];for(let X=0;X<Z;++X)switch(J){case"8unorm":K[X]=$[Q]/255,Q++;break;case"8snorm":K[X]=$[Q]/255*2-1,Q++;break;case"8uint":K[X]=$[Q],Q++;break;case"8sint":K[X]=$[Q]-127,Q++;break;case"16uint":K[X]=$[Q]|$[Q+1]<<8,Q+=2;break;case"16sint":K[X]=($[Q]|$[Q+1]<<8)-32768,Q+=2;break;case"16float":K[X]=L51($[Q]|$[Q+1]<<8),Q+=2;break;case"32uint":case"32sint":K[X]=$[Q]|$[Q+1]<<8|$[Q+2]<<16|$[Q+3]<<24,Q+=4;break;case"32float":K[X]=new Float32Array($.buffer,Q,1)[0],Q+=4}return K}function v1($,Q,J,Z,K){for(let X=0;X<Z;++X)switch(J){case"8unorm":$[Q]=255*K[X],Q++;break;case"8snorm":$[Q]=0.5*(K[X]+1)*255,Q++;break;case"8uint":$[Q]=K[X],Q++;break;case"8sint":$[Q]=K[X]+127,Q++;break;case"16uint":new Uint16Array($.buffer,Q,1)[0]=K[X],Q+=2;break;case"16sint":new Int16Array($.buffer,Q,1)[0]=K[X],Q+=2;break;case"16float":{let Y=_51(K[X]);new Uint16Array($.buffer,Q,1)[0]=Y,Q+=2;break}case"32uint":new Uint32Array($.buffer,Q,1)[0]=K[X],Q+=4;break;case"32sint":new Int32Array($.buffer,Q,1)[0]=K[X],Q+=4;break;case"32float":new Float32Array($.buffer,Q,1)[0]=K[X],Q+=4}return K}class _5{constructor(){this.id=_5._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search($){$(this)}searchBlock($,Q){if($){Q(s2.instance);for(let J of $)J instanceof Array?this.searchBlock(J,Q):J.search(Q);Q(o2.instance)}}constEvaluate($,Q){throw Error("Cannot evaluate node")}constEvaluateString($){return this.constEvaluate($).toString()}}class v5{constructor($,Q){this.parent=null,this.typeInfo=$,this.parent=Q,this.id=v5._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue($,Q,J,Z){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData($,Q,J){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}function g51($,Q,J){let Z=Q.length;return Z===2?J==="f32"?new R(new Float32Array(Q),$.getTypeInfo("vec2f")):J==="i32"||J==="bool"?new R(new Int32Array(Q),$.getTypeInfo("vec2i")):J==="u32"?new R(new Uint32Array(Q),$.getTypeInfo("vec2u")):J==="f16"?new R(new Float32Array(Q),$.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${J}`),null):Z===3?J==="f32"?new R(new Float32Array(Q),$.getTypeInfo("vec3f")):J==="i32"||J==="bool"?new R(new Int32Array(Q),$.getTypeInfo("vec3i")):J==="u32"?new R(new Uint32Array(Q),$.getTypeInfo("vec3u")):J==="f16"?new R(new Float32Array(Q),$.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${J}`),null):Z===4?J==="f32"?new R(new Float32Array(Q),$.getTypeInfo("vec4f")):J==="i32"||J==="bool"?new R(new Int32Array(Q),$.getTypeInfo("vec4i")):J==="u32"?new R(new Uint32Array(Q),$.getTypeInfo("vec4u")):J==="f16"?new R(new Float32Array(Q),$.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${J}`),null):(console.error(`getSubData: Invalid vector size ${Q.length}`),null)}class I{constructor($,Q,J){this.name=$,this.type=Q,this.rule=J}toString(){return this.name}}class k{}class TU{constructor($,Q,J,Z,K){this.type=$,this.lexeme=Q,this.line=J,this.start=Z,this.end=K}toString(){return this.lexeme}isTemplateType(){return k.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==k.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class zh{constructor($){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=$!=null?$:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new TU(k.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let $=this._advance();if($==`
`)return this._line++,!0;if(this._isWhitespace($))return!0;if($=="/"){if(this._peekAhead()=="/"){for(;$!=`
`;){if(this._isAtEnd())return!0;$=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let X=1;for(;X>0;){if(this._isAtEnd())return!0;if($=this._advance(),$==`
`)this._line++;else if($=="*"){if(this._peekAhead()=="/"&&(this._advance(),X--,X==0))return!0}else $=="/"&&this._peekAhead()=="*"&&(this._advance(),X++)}return!0}}let Q=k.simpleTokens[$];if(Q)return this._addToken(Q),!0;let J=k.none,Z=this._isAlpha($),K=$==="_";if(this._isAlphaNumeric($)){let X=this._peekAhead();for(;this._isAlphaNumeric(X);)$+=this._advance(),X=this._peekAhead()}if(Z){let X=k.keywords[$];if(X)return this._addToken(X),!0}if(Z||K)return this._addToken(k.tokens.ident),!0;for(;;){let X=this._findType($),Y=this._peekAhead();if($=="-"&&this._tokens.length>0){if(Y=="=")return this._current++,$+=Y,this._addToken(k.tokens.minus_equal),!0;if(Y=="-")return this._current++,$+=Y,this._addToken(k.tokens.minus_minus),!0;let W=this._tokens.length-1;if((k.literal_or_ident.indexOf(this._tokens[W].type)!=-1||this._tokens[W].type==k.tokens.paren_right)&&Y!=">")return this._addToken(X),!0}if($==">"&&(Y==">"||Y=="=")){let W=!1,q=this._tokens.length-1;for(let H=0;H<5&&q>=0&&k.assignment_operators.indexOf(this._tokens[q].type)===-1;++H,--q)if(this._tokens[q].type===k.tokens.less_than){q>0&&this._tokens[q-1].isArrayOrTemplateType()&&(W=!0);break}if(W)return this._addToken(X),!0}if(X===k.none){let W=$,q=0,H=2;for(let F=0;F<H;++F)if(W+=this._peekAhead(F),X=this._findType(W),X!==k.none){q=F;break}if(X===k.none)return J!==k.none&&(this._current--,this._addToken(J),!0);$=W,this._current+=q+1}if(J=X,this._isAtEnd())break;$+=this._advance()}return J!==k.none&&(this._addToken(J),!0)}_findType($){for(let J in k.regexTokens){let Z=k.regexTokens[J];if(this._match($,Z.rule))return Z}return k.literalTokens[$]||k.none}_match($,Q){let J=Q.exec($);return J&&J.index==0&&J[0]==$}_isAtEnd(){return this._current>=this._source.length}_isAlpha($){return!this._isNumeric($)&&!this._isWhitespace($)&&$!=="_"&&$!=="."&&$!=="("&&$!==")"&&$!=="["&&$!=="]"&&$!=="{"&&$!=="}"&&$!==","&&$!==";"&&$!==":"&&$!=="="&&$!=="!"&&$!=="<"&&$!==">"&&$!=="+"&&$!=="-"&&$!=="*"&&$!=="/"&&$!=="%"&&$!=="&"&&$!=="|"&&$!=="^"&&$!=="~"&&$!=="@"&&$!=="#"&&$!=="?"&&$!=="'"&&$!=="`"&&$!=='"'&&$!=="\\"&&$!==`
`&&$!=="\r"&&$!=="\t"&&$!=="\x00"}_isNumeric($){return $>="0"&&$<="9"}_isAlphaNumeric($){return this._isAlpha($)||this._isNumeric($)||$==="_"}_isWhitespace($){return $==" "||$=="\t"||$=="\r"}_advance($=0){let Q=this._source[this._current];return $=$||0,$++,this._current+=$,Q}_peekAhead($=0){return $=$||0,this._current+$>=this._source.length?"\x00":this._source[this._current+$]}_addToken($){let Q=this._source.substring(this._start,this._current);this._tokens.push(new TU($,Q,this._line,this._start,this._current))}}function s($){return Array.isArray($)||($==null?void 0:$.buffer)instanceof ArrayBuffer}function Jh($,Q,J){if(Q===J)return $;if(Q==="f32"){if(J==="i32"||J==="x32")return PZ[0]=$,y51[0];if(J==="u32")return PZ[0]=$,f51[0]}else if(Q==="i32"||Q==="x32"){if(J==="f32")return MZ[0]=$,b51[0];if(J==="u32")return MZ[0]=$,m51[0]}else if(Q==="u32"){if(J==="f32")return wZ[0]=$,c51[0];if(J==="i32"||J==="x32")return wZ[0]=$,d51[0]}return console.error(`Unsupported cast from ${Q} to ${J}`),$}class kh{constructor($){this.resources=null,this.inUse=!1,this.info=null,this.node=$}}class p2{constructor($,Q){this.align=$,this.size=Q}}class _6{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new qh,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture($){return $.name=="texture_storage_1d"||$.name=="texture_storage_2d"||$.name=="texture_storage_2d_array"||$.name=="texture_storage_3d"}updateAST($){for(let Q of $)Q instanceof c9&&this._functions.set(Q.name,new kh(Q));for(let Q of $)if(Q instanceof L6){let J=this.getTypeInfo(Q,null);J instanceof q4&&this.structs.push(J)}for(let Q of $)if(Q instanceof IZ)this.aliases.push(this._getAliasInfo(Q));else{if(Q instanceof SZ){let J=Q,Z=this._getAttributeNum(J.attributes,"id",0),K=J.type!=null?this.getTypeInfo(J.type,J.attributes):null;this.overrides.push(new Xh(J.name,K,J.attributes,Z));continue}if(this._isUniformVar(Q)){let J=Q,Z=this._getAttributeNum(J.attributes,"group",0),K=this._getAttributeNum(J.attributes,"binding",0),X=this.getTypeInfo(J.type,J.attributes),Y=new d2(J.name,X,Z,K,J.attributes,V7.Uniform,J.access);Y.access||(Y.access="read"),this.uniforms.push(Y);continue}if(this._isStorageVar(Q)){let J=Q,Z=this._getAttributeNum(J.attributes,"group",0),K=this._getAttributeNum(J.attributes,"binding",0),X=this.getTypeInfo(J.type,J.attributes),Y=this._isStorageTexture(X),W=new d2(J.name,X,Z,K,J.attributes,Y?V7.StorageTexture:V7.Storage,J.access);W.access||(W.access="read"),this.storage.push(W);continue}if(this._isTextureVar(Q)){let J=Q,Z=this._getAttributeNum(J.attributes,"group",0),K=this._getAttributeNum(J.attributes,"binding",0),X=this.getTypeInfo(J.type,J.attributes),Y=this._isStorageTexture(X),W=new d2(J.name,X,Z,K,J.attributes,Y?V7.StorageTexture:V7.Texture,J.access);W.access||(W.access="read"),Y?this.storage.push(W):this.textures.push(W);continue}if(this._isSamplerVar(Q)){let J=Q,Z=this._getAttributeNum(J.attributes,"group",0),K=this._getAttributeNum(J.attributes,"binding",0),X=this.getTypeInfo(J.type,J.attributes),Y=new d2(J.name,X,Z,K,J.attributes,V7.Sampler,J.access);this.samplers.push(Y);continue}}for(let Q of $)if(Q instanceof c9){let J=this._getAttribute(Q,"vertex"),Z=this._getAttribute(Q,"fragment"),K=this._getAttribute(Q,"compute"),X=J||Z||K,Y=new Wh(Q.name,X==null?void 0:X.name,Q.attributes);Y.attributes=Q.attributes,Y.startLine=Q.startLine,Y.endLine=Q.endLine,this.functions.push(Y),this._functions.get(Q.name).info=Y,X&&(this._functions.get(Q.name).inUse=!0,Y.inUse=!0,Y.resources=this._findResources(Q,!!X),Y.inputs=this._getInputs(Q.args),Y.outputs=this._getOutputs(Q.returnType),this.entry[X.name].push(Y)),Y.arguments=Q.args.map((W)=>new Yh(W.name,this.getTypeInfo(W.type,W.attributes),W.attributes)),Y.returnType=Q.returnType?this.getTypeInfo(Q.returnType,Q.attributes):null;continue}for(let Q of this._functions.values())Q.info&&(Q.info.inUse=Q.inUse,this._addCalls(Q.node,Q.info.calls));for(let Q of this._functions.values())Q.node.search((J)=>{var Z,K,X;if(J instanceof uU){if(J.value)if(s(J.value))for(let Y of J.value)for(let W of this.overrides)Y===W.name&&((Z=Q.info)===null||Z===void 0||Z.overrides.push(W));else for(let Y of this.overrides)J.value===Y.name&&((K=Q.info)===null||K===void 0||K.overrides.push(Y))}else if(J instanceof $5)for(let Y of this.overrides)J.name===Y.name&&((X=Q.info)===null||X===void 0||X.overrides.push(Y))});for(let Q of this.uniforms)this._markStructsInUse(Q.type);for(let Q of this.storage)this._markStructsInUse(Q.type)}getFunctionInfo($){for(let Q of this.functions)if(Q.name==$)return Q;return null}getStructInfo($){for(let Q of this.structs)if(Q.name==$)return Q;return null}getOverrideInfo($){for(let Q of this.overrides)if(Q.name==$)return Q;return null}_markStructsInUse($){if($)if($.isStruct){if($.inUse=!0,$.members)for(let Q of $.members)this._markStructsInUse(Q.type)}else if($.isArray)this._markStructsInUse($.format);else if($.isTemplate)$.format&&this._markStructsInUse($.format);else{let Q=this._getAlias($.name);Q&&this._markStructsInUse(Q)}}_addCalls($,Q){var J;for(let Z of $.calls){let K=(J=this._functions.get(Z.name))===null||J===void 0?void 0:J.info;K&&Q.add(K)}}findResource($,Q,J){if(J){for(let Z of this.entry.compute)if(Z.name===J){for(let K of Z.resources)if(K.group==$&&K.binding==Q)return K}for(let Z of this.entry.vertex)if(Z.name===J){for(let K of Z.resources)if(K.group==$&&K.binding==Q)return K}for(let Z of this.entry.fragment)if(Z.name===J){for(let K of Z.resources)if(K.group==$&&K.binding==Q)return K}}for(let Z of this.uniforms)if(Z.group==$&&Z.binding==Q)return Z;for(let Z of this.storage)if(Z.group==$&&Z.binding==Q)return Z;for(let Z of this.textures)if(Z.group==$&&Z.binding==Q)return Z;for(let Z of this.samplers)if(Z.group==$&&Z.binding==Q)return Z;return null}_findResource($){for(let Q of this.uniforms)if(Q.name==$)return Q;for(let Q of this.storage)if(Q.name==$)return Q;for(let Q of this.textures)if(Q.name==$)return Q;for(let Q of this.samplers)if(Q.name==$)return Q;return null}_markStructsFromAST($){let Q=this.getTypeInfo($,null);this._markStructsInUse(Q)}_findResources($,Q){let J=[],Z=this,K=[];return $.search((X)=>{if(X instanceof s2)K.push({});else if(X instanceof o2)K.pop();else if(X instanceof v6){let Y=X;Q&&Y.type!==null&&this._markStructsFromAST(Y.type),K.length>0&&(K[K.length-1][Y.name]=Y)}else if(X instanceof $6){let Y=X;Q&&Y.type!==null&&this._markStructsFromAST(Y.type)}else if(X instanceof b9){let Y=X;Q&&Y.type!==null&&this._markStructsFromAST(Y.type),K.length>0&&(K[K.length-1][Y.name]=Y)}else if(X instanceof $5){let Y=X;if(K.length>0){if(K[K.length-1][Y.name])return}let W=Z._findResource(Y.name);W&&J.push(W)}else if(X instanceof GZ){let Y=X,W=Z._functions.get(Y.name);W&&(Q&&(W.inUse=!0),$.calls.add(W.node),W.resources===null&&(W.resources=Z._findResources(W.node,Q)),J.push(...W.resources))}else if(X instanceof TZ){let Y=X,W=Z._functions.get(Y.name);W&&(Q&&(W.inUse=!0),$.calls.add(W.node),W.resources===null&&(W.resources=Z._findResources(W.node,Q)),J.push(...W.resources))}}),[...new Map(J.map((X)=>[X.name,X])).values()]}getBindGroups(){let $=[];function Q(J,Z){J>=$.length&&($.length=J+1),$[J]===void 0&&($[J]=[]),Z>=$[J].length&&($[J].length=Z+1)}for(let J of this.uniforms)Q(J.group,J.binding),$[J.group][J.binding]=J;for(let J of this.storage)Q(J.group,J.binding),$[J.group][J.binding]=J;for(let J of this.textures)Q(J.group,J.binding),$[J.group][J.binding]=J;for(let J of this.samplers)Q(J.group,J.binding),$[J.group][J.binding]=J;return $}_getOutputs($,Q=void 0){if(Q===void 0&&(Q=[]),$ instanceof L6)this._getStructOutputs($,Q);else{let J=this._getOutputInfo($);J!==null&&Q.push(J)}return Q}_getStructOutputs($,Q){for(let J of $.members)if(J.type instanceof L6)this._getStructOutputs(J.type,Q);else{let Z=this._getAttribute(J,"location")||this._getAttribute(J,"builtin");if(Z!==null){let K=this.getTypeInfo(J.type,J.type.attributes),X=this._parseInt(Z.value),Y=new PU(J.name,K,Z.name,X);Q.push(Y)}}}_getOutputInfo($){let Q=this._getAttribute($,"location")||this._getAttribute($,"builtin");if(Q!==null){let J=this.getTypeInfo($,$.attributes),Z=this._parseInt(Q.value);return new PU("",J,Q.name,Z)}return null}_getInputs($,Q=void 0){Q===void 0&&(Q=[]);for(let J of $)if(J.type instanceof L6)this._getStructInputs(J.type,Q);else{let Z=this._getInputInfo(J);Z!==null&&Q.push(Z)}return Q}_getStructInputs($,Q){for(let J of $.members)if(J.type instanceof L6)this._getStructInputs(J.type,Q);else{let Z=this._getInputInfo(J);Z!==null&&Q.push(Z)}}_getInputInfo($){let Q=this._getAttribute($,"location")||this._getAttribute($,"builtin");if(Q!==null){let J=this._getAttribute($,"interpolation"),Z=this.getTypeInfo($.type,$.attributes),K=this._parseInt(Q.value),X=new Kh($.name,Z,Q.name,K);return J!==null&&(X.interpolation=this._parseString(J.value)),X}return null}_parseString($){return $ instanceof Array&&($=$[0]),$}_parseInt($){$ instanceof Array&&($=$[0]);let Q=parseInt($);return isNaN(Q)?$:Q}_getAlias($){for(let Q of this.aliases)if(Q.name==$)return Q.type;return null}_getAliasInfo($){return new Zh($.name,this.getTypeInfo($.type,null))}getTypeInfoByName($){for(let Q of this.structs)if(Q.name==$)return Q;for(let Q of this.aliases)if(Q.name==$)return Q.type;return null}getTypeInfo($,Q=null){if(this._types.has($))return this._types.get($);if($ instanceof i2){let Z=$.type?this.getTypeInfo($.type,$.attributes):null,K=new BZ($.name,Z,Q);return this._types.set($,K),this._updateTypeInfo(K),K}if($ instanceof m9){let Z=$,K=Z.format?this.getTypeInfo(Z.format,Z.attributes):null,X=new H4(Z.name,Q);return X.format=K,X.count=Z.count,this._types.set($,X),this._updateTypeInfo(X),X}if($ instanceof L6){let Z=$,K=new q4(Z.name,Q);K.startLine=Z.startLine,K.endLine=Z.endLine;for(let X of Z.members){let Y=this.getTypeInfo(X.type,X.attributes);K.members.push(new OU(X.name,Y,X.attributes))}return this._types.set($,K),this._updateTypeInfo(K),K}if($ instanceof f9){let Z=$,K=Z.format instanceof y,X=Z.format?K?this.getTypeInfo(Z.format,null):new q5(Z.format,null):null,Y=new N7(Z.name,X,Q,Z.access);return this._types.set($,Y),this._updateTypeInfo(Y),Y}if($ instanceof E){let Z=$,K=Z.format?this.getTypeInfo(Z.format,null):null,X=new N7(Z.name,K,Q,Z.access);return this._types.set($,X),this._updateTypeInfo(X),X}let J=new q5($.name,Q);return this._types.set($,J),this._updateTypeInfo(J),J}_updateTypeInfo($){var Q,J,Z;let K=this._getTypeSize($);if($.size=(Q=K==null?void 0:K.size)!==null&&Q!==void 0?Q:0,$ instanceof H4&&$.format){let X=this._getTypeSize($.format);$.stride=Math.max((J=X==null?void 0:X.size)!==null&&J!==void 0?J:0,(Z=X==null?void 0:X.align)!==null&&Z!==void 0?Z:0),this._updateTypeInfo($.format)}$ instanceof BZ&&this._updateTypeInfo($.format),$ instanceof q4&&this._updateStructInfo($)}_updateStructInfo($){var Q;let J=0,Z=0,K=0,X=0;for(let Y=0,W=$.members.length;Y<W;++Y){let q=$.members[Y],H=this._getTypeSize(q);if(!H)continue;(Q=this._getAlias(q.type.name))!==null&&Q!==void 0||q.type;let{align:F,size:U}=H;J=this._roundUp(F,J+Z),Z=U,K=J,X=Math.max(X,F),q.offset=J,q.size=U,this._updateTypeInfo(q.type)}$.size=this._roundUp(X,K+Z),$.align=X}_getTypeSize($){var Q,J;if($==null)return null;let Z=this._getAttributeNum($.attributes,"size",0),K=this._getAttributeNum($.attributes,"align",0);if($ instanceof OU&&($=$.type),$ instanceof q5){let X=this._getAlias($.name);X!==null&&($=X)}{let X=_6._typeInfo[$.name];if(X!==void 0){let Y=((Q=$.format)===null||Q===void 0?void 0:Q.name)==="f16"?2:1;return new p2(Math.max(K,X.align/Y),Math.max(Z,X.size/Y))}}{let X=_6._typeInfo[$.name.substring(0,$.name.length-1)];if(X){let Y=$.name[$.name.length-1]==="h"?2:1;return new p2(Math.max(K,X.align/Y),Math.max(Z,X.size/Y))}}if($ instanceof H4){let X=$,Y=8,W=8,q=this._getTypeSize(X.format);return q!==null&&(W=q.size,Y=q.align),W=X.count*this._getAttributeNum((J=$==null?void 0:$.attributes)!==null&&J!==void 0?J:null,"stride",this._roundUp(Y,W)),Z&&(W=Z),new p2(Math.max(K,Y),Math.max(Z,W))}if($ instanceof q4){let X=0,Y=0,W=0,q=0,H=0;for(let F of $.members){let U=this._getTypeSize(F.type);U!==null&&(X=Math.max(U.align,X),W=this._roundUp(U.align,W+q),q=U.size,H=W)}return Y=this._roundUp(X,H+q),new p2(Math.max(K,X),Math.max(Z,Y))}return null}_isUniformVar($){return $ instanceof v6&&$.storage=="uniform"}_isStorageVar($){return $ instanceof v6&&$.storage=="storage"}_isTextureVar($){return $ instanceof v6&&$.type!==null&&_6._textureTypes.indexOf($.type.name)!=-1}_isSamplerVar($){return $ instanceof v6&&$.type!==null&&_6._samplerTypes.indexOf($.type.name)!=-1}_getAttribute($,Q){let J=$;if(!J||!J.attributes)return null;let Z=J.attributes;for(let K of Z)if(K.name==Q)return K;return null}_getAttributeNum($,Q,J){if($===null)return J;for(let Z of $)if(Z.name==Q){let K=Z!==null&&Z.value!==null?Z.value:J;return K instanceof Array&&(K=K[0]),typeof K=="number"?K:typeof K=="string"?parseInt(K):J}return J}_roundUp($,Q){return Math.ceil(Q/$)*$}}class nU{constructor($,Q,J){this.id=iU++,this.name=$,this.value=Q,this.node=J}clone(){return new nU(this.name,this.value,this.node)}}class sU{constructor($){this.id=iU++,this.name=$.name,this.node=$}clone(){return new sU(this.node)}}class oU{constructor($){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=iU++,$&&(this.parent=$,this.currentFunctionName=$.currentFunctionName)}getVariable($){var Q;return this.variables.has($)?(Q=this.variables.get($))!==null&&Q!==void 0?Q:null:this.parent?this.parent.getVariable($):null}getFunction($){var Q;return this.functions.has($)?(Q=this.functions.get($))!==null&&Q!==void 0?Q:null:this.parent?this.parent.getFunction($):null}createVariable($,Q,J){this.variables.set($,new nU($,Q,J!=null?J:null))}setVariable($,Q,J){let Z=this.getVariable($);Z!==null?Z.value=Q:this.createVariable($,Q,J)}getVariableValue($){var Q;let J=this.getVariable($);return(Q=J==null?void 0:J.value)!==null&&Q!==void 0?Q:null}clone(){return new oU(this)}}class Bh{evalExpression($,Q){return null}getTypeInfo($){return null}getVariableName($,Q){return""}}class Rh{constructor($){this.exec=$}getTypeInfo($){return this.exec.getTypeInfo($)}All($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=!0;if(J instanceof R)return J.data.forEach((K)=>{K||(Z=!1)}),new w(Z?1:0,this.getTypeInfo("bool"));throw Error(`All() expects a vector argument. Line ${$.line}`)}Any($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R){let Z=J.data.some((K)=>K);return new w(Z?1:0,this.getTypeInfo("bool"))}throw Error(`Any() expects a vector argument. Line ${$.line}`)}Select($,Q){let J=this.exec.evalExpression($.args[2],Q);if(!(J instanceof w))throw Error(`Select() expects a bool condition. Line ${$.line}`);return J.value?this.exec.evalExpression($.args[1],Q):this.exec.evalExpression($.args[0],Q)}ArrayLength($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.evalExpression(J,Q);if(Z instanceof Y0&&Z.typeInfo.size===0){let K=Z.typeInfo,X=Z.buffer.byteLength/K.stride;return new w(X,this.getTypeInfo("u32"))}return new w(Z.typeInfo.size,this.getTypeInfo("u32"))}Abs($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.abs(K)),J.typeInfo);let Z=J;return new w(Math.abs(Z.value),Z.typeInfo)}Acos($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.acos(K)),J.typeInfo);return new w(Math.acos(J.value),J.typeInfo)}Acosh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.acosh(K)),J.typeInfo);return new w(Math.acosh(J.value),J.typeInfo)}Asin($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.asin(K)),J.typeInfo);return new w(Math.asin(J.value),J.typeInfo)}Asinh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.asinh(K)),J.typeInfo);return new w(Math.asinh(J.value),J.typeInfo)}Atan($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.atan(K)),J.typeInfo);return new w(Math.atan(J.value),J.typeInfo)}Atanh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.atanh(K)),J.typeInfo);return new w(Math.atanh(J.value),J.typeInfo)}Atan2($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R)return new R(J.data.map((Y,W)=>Math.atan2(Y,Z.data[W])),J.typeInfo);let K=J,X=Z;return new w(Math.atan2(K.value,X.value),J.typeInfo)}Ceil($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.ceil(K)),J.typeInfo);return new w(Math.ceil(J.value),J.typeInfo)}_clamp($,Q,J){return Math.min(Math.max($,Q),J)}Clamp($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(J instanceof R&&Z instanceof R&&K instanceof R)return new R(J.data.map((q,H)=>this._clamp(q,Z.data[H],K.data[H])),J.typeInfo);let X=J,Y=Z,W=K;return new w(this._clamp(X.value,Y.value,W.value),J.typeInfo)}Cos($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.cos(K)),J.typeInfo);return new w(Math.cos(J.value),J.typeInfo)}Cosh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.cosh(K)),J.typeInfo);return new w(Math.cos(J.value),J.typeInfo)}CountLeadingZeros($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.clz32(K)),J.typeInfo);return new w(Math.clz32(J.value),J.typeInfo)}_countOneBits($){let Q=0;for(;$!==0;)1&$&&Q++,$>>=1;return Q}CountOneBits($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>this._countOneBits(K)),J.typeInfo);let Z=J;return new w(this._countOneBits(Z.value),J.typeInfo)}_countTrailingZeros($){if($===0)return 32;let Q=0;for(;!(1&$);)$>>=1,Q++;return Q}CountTrailingZeros($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>this._countTrailingZeros(K)),J.typeInfo);let Z=J;return new w(this._countTrailingZeros(Z.value),J.typeInfo)}Cross($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R){if(J.data.length!==3||Z.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${$.line}`),null;let K=J.data,X=Z.data;return new R([K[1]*X[2]-X[1]*K[2],K[2]*X[0]-X[2]*K[0],K[0]*X[1]-X[0]*K[1]],J.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${$.line}`),null}Degrees($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=180/Math.PI;if(J instanceof R)return new R(J.data.map((K)=>K*Z),J.typeInfo);return new w(J.value*Z,this.getTypeInfo("f32"))}Determinant($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof F1){let Z=J.data,K=J.typeInfo.getTypeName(),X=K.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(K==="mat2x2"||K==="mat2x2f"||K==="mat2x2h")return new w(Z[0]*Z[3]-Z[1]*Z[2],X);if(K==="mat2x3"||K==="mat2x3f"||K==="mat2x3h")return new w(Z[0]*(Z[4]*Z[8]-Z[5]*Z[7])-Z[1]*(Z[3]*Z[8]-Z[5]*Z[6])+Z[2]*(Z[3]*Z[7]-Z[4]*Z[6]),X);if(K==="mat2x4"||K==="mat2x4f"||K==="mat2x4h")console.error(`TODO: Determinant for ${K}`);else if(K==="mat3x2"||K==="mat3x2f"||K==="mat3x2h")console.error(`TODO: Determinant for ${K}`);else{if(K==="mat3x3"||K==="mat3x3f"||K==="mat3x3h")return new w(Z[0]*(Z[4]*Z[8]-Z[5]*Z[7])-Z[1]*(Z[3]*Z[8]-Z[5]*Z[6])+Z[2]*(Z[3]*Z[7]-Z[4]*Z[6]),X);K==="mat3x4"||K==="mat3x4f"||K==="mat3x4h"||K==="mat4x2"||K==="mat4x2f"||K==="mat4x2h"||K==="mat4x3"||K==="mat4x3f"||K==="mat4x3h"?console.error(`TODO: Determinant for ${K}`):K!=="mat4x4"&&K!=="mat4x4f"&&K!=="mat4x4h"||console.error(`TODO: Determinant for ${K}`)}}return console.error(`Determinant expects a matrix argument. Line ${$.line}`),null}Distance($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R){let Y=0;for(let W=0;W<J.data.length;++W)Y+=(J.data[W]-Z.data[W])*(J.data[W]-Z.data[W]);return new w(Math.sqrt(Y),this.getTypeInfo("f32"))}let K=J,X=Z;return new w(Math.abs(K.value-X.value),J.typeInfo)}_dot($,Q){let J=0;for(let Z=0;Z<$.length;++Z)J+=Q[Z]*$[Z];return J}Dot($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);return J instanceof R&&Z instanceof R?new w(this._dot(J.data,Z.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${$.line}`),null)}Dot4U8Packed($,Q){return console.error(`TODO: dot4U8Packed. Line ${$.line}`),null}Dot4I8Packed($,Q){return console.error(`TODO: dot4I8Packed. Line ${$.line}`),null}Exp($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.exp(K)),J.typeInfo);return new w(Math.exp(J.value),J.typeInfo)}Exp2($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.pow(2,K)),J.typeInfo);return new w(Math.pow(2,J.value),J.typeInfo)}ExtractBits($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(Z.typeInfo.name!=="u32"&&Z.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${$.line}`),null;if(K.typeInfo.name!=="u32"&&K.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${$.line}`),null;let X=Z.value,Y=K.value;if(J instanceof R)return new R(J.data.map((q)=>q>>X&(1<<Y)-1),J.typeInfo);if(J.typeInfo.name!=="i32"&&J.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${$.line}`),null;let W=J.value;return new w(W>>X&(1<<Y)-1,this.getTypeInfo("i32"))}FaceForward($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(J instanceof R&&Z instanceof R&&K instanceof R){let X=this._dot(Z.data,K.data);return new R(X<0?Array.from(J.data):J.data.map((Y)=>-Y),J.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${$.line}`),null}_firstLeadingBit($){return $===0?-1:31-Math.clz32($)}FirstLeadingBit($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>this._firstLeadingBit(K)),J.typeInfo);let Z=J;return new w(this._firstLeadingBit(Z.value),J.typeInfo)}_firstTrailingBit($){return $===0?-1:Math.log2($&-$)}FirstTrailingBit($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>this._firstTrailingBit(K)),J.typeInfo);let Z=J;return new w(this._firstTrailingBit(Z.value),J.typeInfo)}Floor($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.floor(K)),J.typeInfo);return new w(Math.floor(J.value),J.typeInfo)}Fma($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(J instanceof R&&Z instanceof R&&K instanceof R)return J.data.length!==Z.data.length||J.data.length!==K.data.length?(console.error(`Fma() expects vectors of the same length. Line ${$.line}`),null):new R(J.data.map((q,H)=>q*Z.data[H]+K.data[H]),J.typeInfo);let X=J,Y=Z,W=K;return new w(X.value*Y.value+W.value,X.typeInfo)}Fract($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>K-Math.floor(K)),J.typeInfo);let Z=J;return new w(Z.value-Math.floor(Z.value),J.typeInfo)}Frexp($,Q){return console.error(`TODO: frexp. Line ${$.line}`),null}InsertBits($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q),X=this.exec.evalExpression($.args[3],Q);if(K.typeInfo.name!=="u32"&&K.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${$.line}`),null;let Y=K.value,W=(1<<X.value)-1<<Y,q=~W;if(J instanceof R&&Z instanceof R)return new R(J.data.map((U,V)=>U&q|Z.data[V]<<Y&W),J.typeInfo);let H=J.value,F=Z.value;return new w(H&q|F<<Y&W,J.typeInfo)}InverseSqrt($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>1/Math.sqrt(K)),J.typeInfo);return new w(1/Math.sqrt(J.value),J.typeInfo)}Ldexp($,Q){return console.error(`TODO: ldexp. Line ${$.line}`),null}Length($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R){let K=0;return J.data.forEach((X)=>{K+=X*X}),new w(Math.sqrt(K),this.getTypeInfo("f32"))}return new w(Math.abs(J.value),J.typeInfo)}Log($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.log(K)),J.typeInfo);return new w(Math.log(J.value),J.typeInfo)}Log2($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.log2(K)),J.typeInfo);return new w(Math.log2(J.value),J.typeInfo)}Max($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R)return new R(J.data.map((Y,W)=>Math.max(Y,Z.data[W])),J.typeInfo);let K=J,X=Z;return new w(Math.max(K.value,X.value),J.typeInfo)}Min($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R)return new R(J.data.map((Y,W)=>Math.min(Y,Z.data[W])),J.typeInfo);let K=J,X=Z;return new w(Math.min(K.value,X.value),J.typeInfo)}Mix($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(J instanceof R&&Z instanceof R&&K instanceof R)return new R(J.data.map((W,q)=>J.data[q]*(1-K.data[q])+Z.data[q]*K.data[q]),J.typeInfo);let X=Z,Y=K;return new w(J.value*(1-Y.value)+X.value*Y.value,J.typeInfo)}Modf($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R)return new R(J.data.map((X,Y)=>X%Z.data[Y]),J.typeInfo);let K=Z;return new w(J.value%K.value,J.typeInfo)}Normalize($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R){let Z=this.Length($,Q).value;return new R(J.data.map((K)=>K/Z),J.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${$.line}`),null}Pow($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R)return new R(J.data.map((Y,W)=>Math.pow(Y,Z.data[W])),J.typeInfo);let K=J,X=Z;return new w(Math.pow(K.value,X.value),J.typeInfo)}QuantizeToF16($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((Z)=>Z),J.typeInfo);return new w(J.value,J.typeInfo)}Radians($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((Z)=>Z*Math.PI/180),J.typeInfo);return new w(J.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(J instanceof R&&Z instanceof R){let K=this._dot(J.data,Z.data);return new R(J.data.map((X,Y)=>X-2*K*Z.data[Y]),J.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${$.line}`),null}Refract($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(J instanceof R&&Z instanceof R&&K instanceof w){let X=this._dot(Z.data,J.data);return new R(J.data.map((Y,W)=>{let q=1-K.value*K.value*(1-X*X);if(q<0)return 0;let H=Math.sqrt(q);return K.value*Y-(K.value*X+H)*Z.data[W]}),J.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${$.line}`),null}ReverseBits($,Q){return console.error(`TODO: reverseBits. Line ${$.line}`),null}Round($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.round(K)),J.typeInfo);return new w(Math.round(J.value),J.typeInfo)}Saturate($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.min(Math.max(K,0),1)),J.typeInfo);return new w(Math.min(Math.max(J.value,0),1),J.typeInfo)}Sign($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.sign(K)),J.typeInfo);return new w(Math.sign(J.value),J.typeInfo)}Sin($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.sin(K)),J.typeInfo);return new w(Math.sin(J.value),J.typeInfo)}Sinh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.sinh(K)),J.typeInfo);return new w(Math.sinh(J.value),J.typeInfo)}_smoothstep($,Q,J){let Z=Math.min(Math.max((J-$)/(Q-$),0),1);return Z*Z*(3-2*Z)}SmoothStep($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q),K=this.exec.evalExpression($.args[2],Q);if(K instanceof R&&J instanceof R&&Z instanceof R)return new R(K.data.map((q,H)=>this._smoothstep(J.data[H],Z.data[H],q)),K.typeInfo);let X=J,Y=Z,W=K;return new w(this._smoothstep(X.value,Y.value,W.value),K.typeInfo)}Sqrt($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.sqrt(K)),J.typeInfo);return new w(Math.sqrt(J.value),J.typeInfo)}Step($,Q){let J=this.exec.evalExpression($.args[0],Q),Z=this.exec.evalExpression($.args[1],Q);if(Z instanceof R&&J instanceof R)return new R(Z.data.map((X,Y)=>X<J.data[Y]?0:1),Z.typeInfo);let K=J;return new w(Z.value<K.value?0:1,K.typeInfo)}Tan($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.tan(K)),J.typeInfo);return new w(Math.tan(J.value),J.typeInfo)}Tanh($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.tanh(K)),J.typeInfo);return new w(Math.tanh(J.value),J.typeInfo)}_getTransposeType($){let Q=$.getTypeName();return Q==="mat2x2f"||Q==="mat2x2h"?$:Q==="mat2x3f"?this.getTypeInfo("mat3x2f"):Q==="mat2x3h"?this.getTypeInfo("mat3x2h"):Q==="mat2x4f"?this.getTypeInfo("mat4x2f"):Q==="mat2x4h"?this.getTypeInfo("mat4x2h"):Q==="mat3x2f"?this.getTypeInfo("mat2x3f"):Q==="mat3x2h"?this.getTypeInfo("mat2x3h"):Q==="mat3x3f"||Q==="mat3x3h"?$:Q==="mat3x4f"?this.getTypeInfo("mat4x3f"):Q==="mat3x4h"?this.getTypeInfo("mat4x3h"):Q==="mat4x2f"?this.getTypeInfo("mat2x4f"):Q==="mat4x2h"?this.getTypeInfo("mat2x4h"):Q==="mat4x3f"?this.getTypeInfo("mat3x4f"):Q==="mat4x3h"?this.getTypeInfo("mat3x4h"):(Q==="mat4x4f"||Q==="mat4x4h"||console.error(`Invalid matrix type ${Q}`),$)}Transpose($,Q){let J=this.exec.evalExpression($.args[0],Q);if(!(J instanceof F1))return console.error(`Transpose() expects a matrix argument. Line ${$.line}`),null;let Z=this._getTransposeType(J.typeInfo);if(J.typeInfo.name==="mat2x2"||J.typeInfo.name==="mat2x2f"||J.typeInfo.name==="mat2x2h"){let K=J.data;return new F1([K[0],K[2],K[1],K[3]],Z)}if(J.typeInfo.name==="mat2x3"||J.typeInfo.name==="mat2x3f"||J.typeInfo.name==="mat2x3h"){let K=J.data;return new F1([K[0],K[3],K[6],K[1],K[4],K[7]],Z)}if(J.typeInfo.name==="mat2x4"||J.typeInfo.name==="mat2x4f"||J.typeInfo.name==="mat2x4h"){let K=J.data;return new F1([K[0],K[4],K[8],K[12],K[1],K[5],K[9],K[13]],Z)}if(J.typeInfo.name==="mat3x2"||J.typeInfo.name==="mat3x2f"||J.typeInfo.name==="mat3x2h"){let K=J.data;return new F1([K[0],K[3],K[1],K[4],K[2],K[5]],Z)}if(J.typeInfo.name==="mat3x3"||J.typeInfo.name==="mat3x3f"||J.typeInfo.name==="mat3x3h"){let K=J.data;return new F1([K[0],K[3],K[6],K[1],K[4],K[7],K[2],K[5],K[8]],Z)}if(J.typeInfo.name==="mat3x4"||J.typeInfo.name==="mat3x4f"||J.typeInfo.name==="mat3x4h"){let K=J.data;return new F1([K[0],K[4],K[8],K[12],K[1],K[5],K[9],K[13],K[2],K[6],K[10],K[14]],Z)}if(J.typeInfo.name==="mat4x2"||J.typeInfo.name==="mat4x2f"||J.typeInfo.name==="mat4x2h"){let K=J.data;return new F1([K[0],K[4],K[1],K[5],K[2],K[6]],Z)}if(J.typeInfo.name==="mat4x3"||J.typeInfo.name==="mat4x3f"||J.typeInfo.name==="mat4x3h"){let K=J.data;return new F1([K[0],K[4],K[8],K[1],K[5],K[9],K[2],K[6],K[10]],Z)}if(J.typeInfo.name==="mat4x4"||J.typeInfo.name==="mat4x4f"||J.typeInfo.name==="mat4x4h"){let K=J.data;return new F1([K[0],K[4],K[8],K[12],K[1],K[5],K[9],K[13],K[2],K[6],K[10],K[14],K[3],K[7],K[11],K[15]],Z)}return console.error(`Invalid matrix type ${J.typeInfo.name}`),null}Trunc($,Q){let J=this.exec.evalExpression($.args[0],Q);if(J instanceof R)return new R(J.data.map((K)=>Math.trunc(K)),J.typeInfo);return new w(Math.trunc(J.value),J.typeInfo)}Dpdx($,Q){return console.error(`TODO: dpdx. Line ${$.line}`),null}DpdxCoarse($,Q){return console.error(`TODO: dpdxCoarse. Line ${$.line}`),null}DpdxFine($,Q){return console.error("TODO: dpdxFine"),null}Dpdy($,Q){return console.error("TODO: dpdy"),null}DpdyCoarse($,Q){return console.error("TODO: dpdyCoarse"),null}DpdyFine($,Q){return console.error("TODO: dpdyFine"),null}Fwidth($,Q){return console.error("TODO: fwidth"),null}FwidthCoarse($,Q){return console.error("TODO: fwidthCoarse"),null}FwidthFine($,Q){return console.error("TODO: fwidthFine"),null}TextureDimensions($,Q){let J=$.args[0],Z=$.args.length>1?this.exec.evalExpression($.args[1],Q).value:0;if(J instanceof $5){let K=J.name,X=Q.getVariableValue(K);if(X instanceof W4){if(Z<0||Z>=X.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${$.line}`),null;let Y=X.getMipLevelSize(Z),W=X.dimension;return W==="1d"?new w(Y[0],this.getTypeInfo("u32")):W==="3d"?new R(Y,this.getTypeInfo("vec3u")):W==="2d"?new R(Y.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${W} not found. Line ${$.line}`),null)}return console.error(`Texture ${K} not found. Line ${$.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${$.line}`),null}TextureGather($,Q){return console.error("TODO: textureGather"),null}TextureGatherCompare($,Q){return console.error("TODO: textureGatherCompare"),null}TextureLoad($,Q){let J=$.args[0],Z=this.exec.evalExpression($.args[1],Q),K=$.args.length>2?this.exec.evalExpression($.args[2],Q).value:0;if(!(Z instanceof R)||Z.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${$.line}`),null;if(J instanceof $5){let X=J.name,Y=Q.getVariableValue(X);if(Y instanceof W4){let W=Math.floor(Z.data[0]),q=Math.floor(Z.data[1]);if(W<0||W>=Y.width||q<0||q>=Y.height)return console.error(`Texture ${X} out of bounds. Line ${$.line}`),null;let H=Y.getPixel(W,q,0,K);return H===null?(console.error(`Invalid texture format for textureLoad. Line ${$.line}`),null):new R(H,this.getTypeInfo("vec4f"))}return console.error(`Texture ${X} not found. Line ${$.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${$.line}`),null}TextureNumLayers($,Q){let J=$.args[0];if(J instanceof $5){let Z=J.name,K=Q.getVariableValue(Z);return K instanceof W4?new w(K.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${Z} not found. Line ${$.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${$.line}`),null}TextureNumLevels($,Q){let J=$.args[0];if(J instanceof $5){let Z=J.name,K=Q.getVariableValue(Z);return K instanceof W4?new w(K.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${Z} not found. Line ${$.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${$.line}`),null}TextureNumSamples($,Q){let J=$.args[0];if(J instanceof $5){let Z=J.name,K=Q.getVariableValue(Z);return K instanceof W4?new w(K.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${Z} not found. Line ${$.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${$.line}`),null}TextureSample($,Q){return console.error("TODO: textureSample"),null}TextureSampleBias($,Q){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare($,Q){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel($,Q){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad($,Q){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel($,Q){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge($,Q){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore($,Q){let J=$.args[0],Z=this.exec.evalExpression($.args[1],Q),K=$.args.length===4?this.exec.evalExpression($.args[2],Q).value:0,X=$.args.length===4?this.exec.evalExpression($.args[3],Q).data:this.exec.evalExpression($.args[2],Q).data;if(X.length!==4)return console.error(`Invalid value argument for textureStore. Line ${$.line}`),null;if(!(Z instanceof R)||Z.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${$.line}`),null;if(J instanceof $5){let Y=J.name,W=Q.getVariableValue(Y);if(W instanceof W4){let q=W.getMipLevelSize(0),H=Math.floor(Z.data[0]),F=Math.floor(Z.data[1]);return H<0||H>=q[0]||F<0||F>=q[1]?(console.error(`Texture ${Y} out of bounds. Line ${$.line}`),null):(W.setPixel(H,F,0,K,Array.from(X)),null)}return console.error(`Texture ${Y} not found. Line ${$.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${$.line}`),null}AtomicLoad($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q);return Q.getVariable(Z).value.getSubData(this.exec,J.postfix,Q)}AtomicStore($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q);return W instanceof w&&Y instanceof w&&(W.value=Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),null}AtomicAdd($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value+=Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicSub($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value-=Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicMax($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=Math.max(W.value,Y.value)),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicMin($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=Math.min(W.value,Y.value)),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicAnd($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=W.value&Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicOr($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=W.value|Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicXor($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=W.value^Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicExchange($,Q){let J=$.args[0];J instanceof H0&&(J=J.right);let Z=this.exec.getVariableName(J,Q),K=Q.getVariable(Z),X=$.args[1],Y=this.exec.evalExpression(X,Q),W=K.value.getSubData(this.exec,J.postfix,Q),q=new w(W.value,W.typeInfo);return W instanceof w&&Y instanceof w&&(W.value=Y.value),K.value instanceof Y0&&K.value.setDataValue(this.exec,W,J.postfix,Q),q}AtomicCompareExchangeWeak($,Q){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm($,Q){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm($,Q){return console.error("TODO: pack4x8unorm"),null}Pack4xI8($,Q){return console.error("TODO: pack4xI8"),null}Pack4xU8($,Q){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp($,Q){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp($,Q){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm($,Q){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm($,Q){return console.error("TODO: pack2x16unorm"),null}Pack2x16float($,Q){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm($,Q){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm($,Q){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8($,Q){return console.error("TODO: unpack4xI8"),null}Unpack4xU8($,Q){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm($,Q){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm($,Q){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float($,Q){return console.error("TODO: unpack2x16float"),null}StorageBarrier($,Q){return null}TextureBarrier($,Q){return null}WorkgroupBarrier($,Q){return null}WorkgroupUniformLoad($,Q){return null}SubgroupAdd($,Q){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd($,Q){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd($,Q){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll($,Q){return console.error("TODO: subgroupAll"),null}SubgroupAnd($,Q){return console.error("TODO: subgroupAnd"),null}SubgroupAny($,Q){return console.error("TODO: subgroupAny"),null}SubgroupBallot($,Q){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast($,Q){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst($,Q){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect($,Q){return console.error("TODO: subgroupElect"),null}SubgroupMax($,Q){return console.error("TODO: subgroupMax"),null}SubgroupMin($,Q){return console.error("TODO: subgroupMin"),null}SubgroupMul($,Q){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul($,Q){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul($,Q){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr($,Q){return console.error("TODO: subgroupOr"),null}SubgroupShuffle($,Q){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown($,Q){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp($,Q){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor($,Q){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor($,Q){return console.error("TODO: subgroupXor"),null}QuadBroadcast($,Q){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal($,Q){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX($,Q){return console.error("TODO: quadSwapX"),null}QuadSwapY($,Q){return console.error("TODO: quadSwapY"),null}}class Oh{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Ph{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Oh,this._exec=new L0,this._forwardTypeCount=0}parse($){this._initialize($),this._deferArrayCountEval.length=0;let Q=[];for(;!this._isAtEnd();){let J=this._global_decl_or_directive();if(!J)break;Q.push(J)}if(this._deferArrayCountEval.length>0){for(let J of this._deferArrayCountEval){let{arrayType:Z,countNode:K}=J;if(K instanceof $5){let X=K.name,Y=this._context.constants.get(X);if(Y)try{let W=Y.constEvaluate(this._exec);Z.count=W}catch(W){}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(let J of Q)J.search((Z)=>{Z instanceof SU||Z instanceof i2?Z.type=this._forwardType(Z.type):Z instanceof m9?Z.format=this._forwardType(Z.format):Z instanceof v6||Z instanceof b9||Z instanceof u2?Z.type=this._forwardType(Z.type):Z instanceof c9?Z.returnType=this._forwardType(Z.returnType):Z instanceof wU&&(Z.type=this._forwardType(Z.type))});return Q}_forwardType($){if($ instanceof MU){let Q=this._getType($.name);if(Q)return Q}else $ instanceof i2?$.type=this._forwardType($.type):$ instanceof m9&&($.format=this._forwardType($.format));return $}_initialize($){if($)if(typeof $=="string"){let Q=new zh($);this._tokens=Q.scanTokens()}else this._tokens=$;else this._tokens=[];this._current=0}_updateNode($,Q){return $.line=Q!=null?Q:this._currentLine,$}_error($,Q){return{token:$,message:Q,toString:()=>`${Q}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==k.eof}_match($){if($ instanceof I)return!!this._check($)&&(this._advance(),!0);for(let Q=0,J=$.length;Q<J;++Q){let Z=$[Q];if(this._check(Z))return this._advance(),!0}return!1}_consume($,Q){if(this._check($))return this._advance();throw this._error(this._peek(),`${Q}. Line:${this._currentLine}`)}_check($){if(this._isAtEnd())return!1;let Q=this._peek();if($ instanceof Array){let J=Q.type,Z=!1;for(let K of $){if(J===K)return!0;K===k.tokens.name&&(Z=!0)}if(Z){let K=k.tokens.name.rule.exec(Q.lexeme);if(K&&K.index==0&&K[0]==Q.lexeme)return!0}return!1}if(Q.type===$)return!0;if($===k.tokens.name){let J=k.tokens.name.rule.exec(Q.lexeme);return J&&J.index==0&&J[0]==Q.lexeme}return!1}_advance(){var $,Q;return this._currentLine=(Q=($=this._peek())===null||$===void 0?void 0:$.line)!==null&&Q!==void 0?Q:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(k.tokens.semicolon)&&!this._isAtEnd(););if(this._match(k.keywords.alias)){let Q=this._type_alias();return this._consume(k.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([Q]),Q}if(this._match(k.keywords.diagnostic)){let Q=this._diagnostic();return this._consume(k.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([Q]),Q}if(this._match(k.keywords.requires)){let Q=this._requires_directive();return this._consume(k.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([Q]),Q}if(this._match(k.keywords.enable)){let Q=this._enable_directive();return this._consume(k.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([Q]),Q}let $=this._attribute();if(this._check(k.keywords.var)){let Q=this._global_variable_decl();return Q!=null&&(Q.attributes=$),this._consume(k.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([Q]),Q}if(this._check(k.keywords.override)){let Q=this._override_variable_decl();return Q!=null&&(Q.attributes=$),this._consume(k.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([Q]),Q}if(this._check(k.keywords.let)){let Q=this._global_let_decl();return Q!=null&&(Q.attributes=$),this._consume(k.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([Q]),Q}if(this._check(k.keywords.const)){let Q=this._global_const_decl();return Q!=null&&(Q.attributes=$),this._consume(k.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([Q]),Q}if(this._check(k.keywords.struct)){let Q=this._struct_decl();return Q!=null&&(Q.attributes=$),this._exec.reflection.updateAST([Q]),Q}if(this._check(k.keywords.fn)){let Q=this._function_decl();return Q!=null&&(Q.attributes=$),this._exec.reflection.updateAST([Q]),Q}return null}_function_decl(){if(!this._match(k.keywords.fn))return null;let $=this._currentLine,Q=this._consume(k.tokens.ident,"Expected function name.").toString();this._consume(k.tokens.paren_left,"Expected '(' for function arguments.");let J=[];if(!this._check(k.tokens.paren_right))do{if(this._check(k.tokens.paren_right))break;let Y=this._attribute(),W=this._consume(k.tokens.name,"Expected argument name.").toString();this._consume(k.tokens.colon,"Expected ':' for argument type.");let q=this._attribute(),H=this._type_decl();H!=null&&(H.attributes=q,J.push(this._updateNode(new wU(W,H,Y))))}while(this._match(k.tokens.comma));this._consume(k.tokens.paren_right,"Expected ')' after function arguments.");let Z=null;if(this._match(k.tokens.arrow)){let Y=this._attribute();Z=this._type_decl(),Z!=null&&(Z.attributes=Y)}let K=this._compound_statement(),X=this._currentLine;return this._updateNode(new c9(Q,J,Z,K,$,X),$)}_compound_statement(){let $=[];for(this._consume(k.tokens.brace_left,"Expected '{' for block.");!this._check(k.tokens.brace_right);){let Q=this._statement();Q!==null&&$.push(Q)}return this._consume(k.tokens.brace_right,"Expected '}' for block."),$}_statement(){for(;this._match(k.tokens.semicolon)&&!this._isAtEnd(););if(this._check(k.tokens.attr)&&this._attribute(),this._check(k.keywords.if))return this._if_statement();if(this._check(k.keywords.switch))return this._switch_statement();if(this._check(k.keywords.loop))return this._loop_statement();if(this._check(k.keywords.for))return this._for_statement();if(this._check(k.keywords.while))return this._while_statement();if(this._check(k.keywords.continuing))return this._continuing_statement();if(this._check(k.keywords.static_assert))return this._static_assert_statement();if(this._check(k.tokens.brace_left))return this._compound_statement();let $=null;if(this._check(k.keywords.return))$=this._return_statement();else if(this._check([k.keywords.var,k.keywords.let,k.keywords.const]))$=this._variable_statement();else if(this._match(k.keywords.discard))$=this._updateNode(new Ch);else if(this._match(k.keywords.break)){let Q=this._updateNode(new yU);if(this._currentLoop.length>0){let J=this._currentLoop[this._currentLoop.length-1];Q.loopId=J.id}$=Q,this._check(k.keywords.if)&&(this._advance(),Q.condition=this._optional_paren_expression())}else if(this._match(k.keywords.continue)){let Q=this._updateNode(new fU);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${Q.line}`);{let J=this._currentLoop[this._currentLoop.length-1];Q.loopId=J.id}$=Q}else $=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return $!=null&&this._consume(k.tokens.semicolon,"Expected ';' after statement."),$}_static_assert_statement(){if(!this._match(k.keywords.static_assert))return null;let $=this._currentLine,Q=this._optional_paren_expression();return this._updateNode(new Vh(Q),$)}_while_statement(){if(!this._match(k.keywords.while))return null;let $=this._updateNode(new GU(null,null));return this._currentLoop.push($),$.condition=this._optional_paren_expression(),this._check(k.tokens.attr)&&this._attribute(),$.body=this._compound_statement(),this._currentLoop.pop(),$}_continuing_statement(){let $=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(k.keywords.continuing))return null;let Q=this._currentLine,J=this._compound_statement();return this._updateNode(new RZ(J,$),Q)}_for_statement(){if(!this._match(k.keywords.for))return null;this._consume(k.tokens.paren_left,"Expected '('.");let $=this._updateNode(new EU(null,null,null,null));return this._currentLoop.push($),$.init=this._check(k.tokens.semicolon)?null:this._for_init(),this._consume(k.tokens.semicolon,"Expected ';'."),$.condition=this._check(k.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(k.tokens.semicolon,"Expected ';'."),$.increment=this._check(k.tokens.paren_right)?null:this._for_increment(),this._consume(k.tokens.paren_right,"Expected ')'."),this._check(k.tokens.attr)&&this._attribute(),$.body=this._compound_statement(),this._currentLoop.pop(),$}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(k.keywords.var)){let $=this._variable_decl();if($===null)throw this._error(this._peek(),"Variable declaration expected.");let Q=null;return this._match(k.tokens.equal)&&(Q=this._short_circuit_or_expression()),this._updateNode(new v6($.name,$.type,$.storage,$.access,Q),$.line)}if(this._match(k.keywords.let)){let $=this._currentLine,Q=this._consume(k.tokens.name,"Expected name for let.").toString(),J=null;if(this._match(k.tokens.colon)){let K=this._attribute();J=this._type_decl(),J!=null&&(J.attributes=K)}this._consume(k.tokens.equal,"Expected '=' for let.");let Z=this._short_circuit_or_expression();return this._updateNode(new b9(Q,J,null,null,Z),$)}if(this._match(k.keywords.const)){let $=this._currentLine,Q=this._consume(k.tokens.name,"Expected name for const.").toString(),J=null;if(this._match(k.tokens.colon)){let K=this._attribute();J=this._type_decl(),J!=null&&(J.attributes=K)}this._consume(k.tokens.equal,"Expected '=' for const.");let Z=this._short_circuit_or_expression();return J===null&&Z instanceof N0&&(J=Z.type),this._updateNode(new u2(Q,J,null,null,Z),$)}return null}_increment_decrement_statement(){let $=this._current,Q=this._unary_expression();if(Q==null)return null;if(!this._check(k.increment_operators))return this._current=$,null;let J=this._consume(k.increment_operators,"Expected increment operator");return this._updateNode(new jU(J.type===k.tokens.plus_plus?y9.increment:y9.decrement,Q))}_assignment_statement(){let $=null,Q=this._currentLine;if(this._check(k.tokens.brace_right))return null;let J=this._match(k.tokens.underscore);if(J||($=this._unary_expression()),!J&&$==null)return null;let Z=this._consume(k.assignment_operators,"Expected assignment operator."),K=this._short_circuit_or_expression();return this._updateNode(new hU(l2.parse(Z.lexeme),$,K),Q)}_func_call_statement(){if(!this._check(k.tokens.ident))return null;let $=this._currentLine,Q=this._current,J=this._consume(k.tokens.ident,"Expected function name."),Z=this._argument_expression_list();return Z===null?(this._current=Q,null):this._updateNode(new TZ(J.lexeme,Z),$)}_loop_statement(){if(!this._match(k.keywords.loop))return null;this._check(k.tokens.attr)&&this._attribute(),this._consume(k.tokens.brace_left,"Expected '{' for loop.");let $=this._updateNode(new LU([],null));this._currentLoop.push($);let Q=this._statement();for(;Q!==null;){if(Array.isArray(Q))for(let J of Q)$.body.push(J);else $.body.push(Q);if(Q instanceof RZ){$.continuing=Q;break}Q=this._statement()}return this._currentLoop.pop(),this._consume(k.tokens.brace_right,"Expected '}' for loop."),$}_switch_statement(){if(!this._match(k.keywords.switch))return null;let $=this._updateNode(new vU(null,[]));if(this._currentLoop.push($),$.condition=this._optional_paren_expression(),this._check(k.tokens.attr)&&this._attribute(),this._consume(k.tokens.brace_left,"Expected '{' for switch."),$.cases=this._switch_body(),$.cases==null||$.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(k.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),$}_switch_body(){let $=[],Q=!1;for(;this._check([k.keywords.default,k.keywords.case]);){if(this._match(k.keywords.case)){let J=this._case_selectors();for(let K of J)if(K instanceof n2){if(Q)throw this._error(this._previous(),"Multiple default cases in switch statement.");Q=!0;break}this._match(k.tokens.colon),this._check(k.tokens.attr)&&this._attribute(),this._consume(k.tokens.brace_left,"Exected '{' for switch case.");let Z=this._case_body();this._consume(k.tokens.brace_right,"Exected '}' for switch case."),$.push(this._updateNode(new lU(J,Z)))}if(this._match(k.keywords.default)){if(Q)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(k.tokens.colon),this._check(k.tokens.attr)&&this._attribute(),this._consume(k.tokens.brace_left,"Exected '{' for switch default.");let J=this._case_body();this._consume(k.tokens.brace_right,"Exected '}' for switch default."),$.push(this._updateNode(new pU(J)))}}return $}_case_selectors(){let $=[];for(this._match(k.keywords.default)?$.push(this._updateNode(new n2)):$.push(this._shift_expression());this._match(k.tokens.comma);)this._match(k.keywords.default)?$.push(this._updateNode(new n2)):$.push(this._shift_expression());return $}_case_body(){if(this._match(k.keywords.fallthrough))return this._consume(k.tokens.semicolon,"Expected ';'"),[];let $=this._statement();if($==null)return[];$ instanceof Array||($=[$]);let Q=this._case_body();return Q.length==0?$:[...$,Q[0]]}_if_statement(){if(!this._match(k.keywords.if))return null;let $=this._currentLine,Q=this._optional_paren_expression();this._check(k.tokens.attr)&&this._attribute();let J=this._compound_statement(),Z=[];this._match_elseif()&&(this._check(k.tokens.attr)&&this._attribute(),Z=this._elseif_statement(Z));let K=null;return this._match(k.keywords.else)&&(this._check(k.tokens.attr)&&this._attribute(),K=this._compound_statement()),this._updateNode(new _U(Q,J,Z,K),$)}_match_elseif(){return this._tokens[this._current].type===k.keywords.else&&this._tokens[this._current+1].type===k.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement($=[]){let Q=this._optional_paren_expression(),J=this._compound_statement();return $.push(this._updateNode(new Ah(Q,J))),this._match_elseif()&&(this._check(k.tokens.attr)&&this._attribute(),this._elseif_statement($)),$}_return_statement(){if(!this._match(k.keywords.return))return null;let $=this._short_circuit_or_expression();return this._updateNode(new xU($))}_short_circuit_or_expression(){let $=this._short_circuit_and_expr();for(;this._match(k.tokens.or_or);)$=this._updateNode(new L5(this._previous().toString(),$,this._short_circuit_and_expr()));return $}_short_circuit_and_expr(){let $=this._inclusive_or_expression();for(;this._match(k.tokens.and_and);)$=this._updateNode(new L5(this._previous().toString(),$,this._inclusive_or_expression()));return $}_inclusive_or_expression(){let $=this._exclusive_or_expression();for(;this._match(k.tokens.or);)$=this._updateNode(new L5(this._previous().toString(),$,this._exclusive_or_expression()));return $}_exclusive_or_expression(){let $=this._and_expression();for(;this._match(k.tokens.xor);)$=this._updateNode(new L5(this._previous().toString(),$,this._and_expression()));return $}_and_expression(){let $=this._equality_expression();for(;this._match(k.tokens.and);)$=this._updateNode(new L5(this._previous().toString(),$,this._equality_expression()));return $}_equality_expression(){let $=this._relational_expression();return this._match([k.tokens.equal_equal,k.tokens.not_equal])?this._updateNode(new L5(this._previous().toString(),$,this._relational_expression())):$}_relational_expression(){let $=this._shift_expression();for(;this._match([k.tokens.less_than,k.tokens.greater_than,k.tokens.less_than_equal,k.tokens.greater_than_equal]);)$=this._updateNode(new L5(this._previous().toString(),$,this._shift_expression()));return $}_shift_expression(){let $=this._additive_expression();for(;this._match([k.tokens.shift_left,k.tokens.shift_right]);)$=this._updateNode(new L5(this._previous().toString(),$,this._additive_expression()));return $}_additive_expression(){let $=this._multiplicative_expression();for(;this._match([k.tokens.plus,k.tokens.minus]);)$=this._updateNode(new L5(this._previous().toString(),$,this._multiplicative_expression()));return $}_multiplicative_expression(){let $=this._unary_expression();for(;this._match([k.tokens.star,k.tokens.forward_slash,k.tokens.modulo]);)$=this._updateNode(new L5(this._previous().toString(),$,this._unary_expression()));return $}_unary_expression(){return this._match([k.tokens.minus,k.tokens.bang,k.tokens.tilde,k.tokens.star,k.tokens.and])?this._updateNode(new H0(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){let $=this._primary_expression(),Q=this._postfix_expression();return Q&&($.postfix=Q),$}_postfix_expression(){if(this._match(k.tokens.bracket_left)){let $=this._short_circuit_or_expression();this._consume(k.tokens.bracket_right,"Expected ']'.");let Q=this._updateNode(new k8($)),J=this._postfix_expression();return J&&(Q.postfix=J),Q}if(this._match(k.tokens.period)){let $=this._consume(k.tokens.name,"Expected member name."),Q=this._postfix_expression(),J=this._updateNode(new D7($.lexeme));return Q&&(J.postfix=Q),J}return null}_getStruct($){if(this._context.aliases.has($))return this._context.aliases.get($).type;if(this._context.structs.has($))return this._context.structs.get($);return null}_getType($){let Q=this._getStruct($);if(Q!==null)return Q;switch($){case"void":return y.void;case"bool":return y.bool;case"i32":return y.i32;case"u32":return y.u32;case"f32":return y.f32;case"f16":return y.f16;case"vec2f":return E.vec2f;case"vec3f":return E.vec3f;case"vec4f":return E.vec4f;case"vec2i":return E.vec2i;case"vec3i":return E.vec3i;case"vec4i":return E.vec4i;case"vec2u":return E.vec2u;case"vec3u":return E.vec3u;case"vec4u":return E.vec4u;case"vec2h":return E.vec2h;case"vec3h":return E.vec3h;case"vec4h":return E.vec4h;case"mat2x2f":return E.mat2x2f;case"mat2x3f":return E.mat2x3f;case"mat2x4f":return E.mat2x4f;case"mat3x2f":return E.mat3x2f;case"mat3x3f":return E.mat3x3f;case"mat3x4f":return E.mat3x4f;case"mat4x2f":return E.mat4x2f;case"mat4x3f":return E.mat4x3f;case"mat4x4f":return E.mat4x4f;case"mat2x2h":return E.mat2x2h;case"mat2x3h":return E.mat2x3h;case"mat2x4h":return E.mat2x4h;case"mat3x2h":return E.mat3x2h;case"mat3x3h":return E.mat3x3h;case"mat3x4h":return E.mat3x4h;case"mat4x2h":return E.mat4x2h;case"mat4x3h":return E.mat4x3h;case"mat4x4h":return E.mat4x4h;case"mat2x2i":return E.mat2x2i;case"mat2x3i":return E.mat2x3i;case"mat2x4i":return E.mat2x4i;case"mat3x2i":return E.mat3x2i;case"mat3x3i":return E.mat3x3i;case"mat3x4i":return E.mat3x4i;case"mat4x2i":return E.mat4x2i;case"mat4x3i":return E.mat4x3i;case"mat4x4i":return E.mat4x4i;case"mat2x2u":return E.mat2x2u;case"mat2x3u":return E.mat2x3u;case"mat2x4u":return E.mat2x4u;case"mat3x2u":return E.mat3x2u;case"mat3x3u":return E.mat3x3u;case"mat3x4u":return E.mat3x4u;case"mat4x2u":return E.mat4x2u;case"mat4x3u":return E.mat4x3u;case"mat4x4u":return E.mat4x4u}return null}_validateTypeRange($,Q){if(Q.name==="i32"){if($<-2147483648||$>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${$}. Line: ${this._currentLine}.`)}else if(Q.name==="u32"&&($<0||$>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${$}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(k.tokens.ident)){let J=this._previous().toString();if(this._check(k.tokens.paren_left)){let Z=this._argument_expression_list(),K=this._getType(J);return K!==null?this._updateNode(new $6(K,Z)):this._updateNode(new GZ(J,Z))}if(this._context.constants.has(J)){let Z=this._context.constants.get(J);return this._updateNode(new bU(J,Z.value))}return this._updateNode(new $5(J))}if(this._match(k.tokens.int_literal)){let J=this._previous().toString(),Z=J.endsWith("i")||J.endsWith("i")?y.i32:J.endsWith("u")||J.endsWith("U")?y.u32:y.x32,K=parseInt(J);return this._validateTypeRange(K,Z),this._updateNode(new N0(new w(K,this._exec.getTypeInfo(Z)),Z))}if(this._match(k.tokens.uint_literal)){let J=parseInt(this._previous().toString());return this._validateTypeRange(J,y.u32),this._updateNode(new N0(new w(J,this._exec.getTypeInfo(y.u32)),y.u32))}if(this._match([k.tokens.decimal_float_literal,k.tokens.hex_float_literal])){let J=this._previous().toString(),Z=J.endsWith("h");Z&&(J=J.substring(0,J.length-1));let K=parseFloat(J);this._validateTypeRange(K,Z?y.f16:y.f32);let X=Z?y.f16:y.f32;return this._updateNode(new N0(new w(K,this._exec.getTypeInfo(X)),X))}if(this._match([k.keywords.true,k.keywords.false])){let J=this._previous().toString()===k.keywords.true.rule;return this._updateNode(new N0(new w(J?1:0,this._exec.getTypeInfo(y.bool)),y.bool))}if(this._check(k.tokens.paren_left))return this._paren_expression();if(this._match(k.keywords.bitcast)){this._consume(k.tokens.less_than,"Expected '<'.");let J=this._type_decl();this._consume(k.tokens.greater_than,"Expected '>'.");let Z=this._paren_expression();return this._updateNode(new mU(J,Z))}let $=this._type_decl(),Q=this._argument_expression_list();return this._updateNode(new $6($,Q))}_argument_expression_list(){if(!this._match(k.tokens.paren_left))return null;let $=[];do{if(this._check(k.tokens.paren_right))break;let Q=this._short_circuit_or_expression();$.push(Q)}while(this._match(k.tokens.comma));return this._consume(k.tokens.paren_right,"Expected ')' for agument list"),$}_optional_paren_expression(){this._match(k.tokens.paren_left);let $=this._short_circuit_or_expression();return this._match(k.tokens.paren_right),$}_paren_expression(){this._consume(k.tokens.paren_left,"Expected '('.");let $=this._short_circuit_or_expression();return this._consume(k.tokens.paren_right,"Expected ')'."),$}_struct_decl(){if(!this._match(k.keywords.struct))return null;let $=this._currentLine,Q=this._consume(k.tokens.ident,"Expected name for struct.").toString();this._consume(k.tokens.brace_left,"Expected '{' for struct body.");let J=[];for(;!this._check(k.tokens.brace_right);){let X=this._attribute(),Y=this._consume(k.tokens.name,"Expected variable name.").toString();this._consume(k.tokens.colon,"Expected ':' for struct member type.");let W=this._attribute(),q=this._type_decl();q!=null&&(q.attributes=W),this._check(k.tokens.brace_right)?this._match(k.tokens.comma):this._consume(k.tokens.comma,"Expected ',' for struct member."),J.push(this._updateNode(new SU(Y,q,X)))}this._consume(k.tokens.brace_right,"Expected '}' after struct body.");let Z=this._currentLine,K=this._updateNode(new L6(Q,J,$,Z),$);return this._context.structs.set(Q,K),K}_global_variable_decl(){let $=this._variable_decl();if(!$)return null;if(this._match(k.tokens.equal)){let Q=this._const_expression();$.value=Q}if($.type!==null&&$.value instanceof N0){if($.value.type.name!=="x32"){if($.type.getTypeName()!==$.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${$.value.type.name} to ${$.type.name}. Line:${this._currentLine}`)}$.value.isScalar&&this._validateTypeRange($.value.scalarValue,$.type),$.value.type=$.type}else $.type===null&&$.value instanceof N0&&($.type=$.value.type.name==="x32"?y.i32:$.value.type,$.value.isScalar&&this._validateTypeRange($.value.scalarValue,$.type));return $}_override_variable_decl(){let $=this._override_decl();return $&&this._match(k.tokens.equal)&&($.value=this._const_expression()),$}_global_const_decl(){var $;if(!this._match(k.keywords.const))return null;let Q=this._consume(k.tokens.name,"Expected variable name"),J=this._currentLine,Z=null;if(this._match(k.tokens.colon)){let W=this._attribute();Z=this._type_decl(),Z!=null&&(Z.attributes=W)}let K=null;this._consume(k.tokens.equal,"const declarations require an assignment");let X=this._short_circuit_or_expression();try{let W=[y.f32],q=X.constEvaluate(this._exec,W);q instanceof w&&this._validateTypeRange(q.value,W[0]),W[0]instanceof E&&W[0].format===null&&q.typeInfo instanceof N7&&q.typeInfo.format!==null&&(q.typeInfo.format.name==="f16"?W[0].format=y.f16:q.typeInfo.format.name==="f32"?W[0].format=y.f32:q.typeInfo.format.name==="i32"?W[0].format=y.i32:q.typeInfo.format.name==="u32"?W[0].format=y.u32:q.typeInfo.format.name==="bool"?W[0].format=y.bool:console.error(`TODO: impelement template format type ${q.typeInfo.format.name}`)),K=this._updateNode(new N0(q,W[0])),this._exec.context.setVariable(Q.toString(),q)}catch(W){K=X}if(Z!==null&&K instanceof N0){if(K.type.name!=="x32"){if(Z.getTypeName()!==K.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${K.type.name} to ${Z.name}. Line:${this._currentLine}`)}K.type=Z,K.isScalar&&this._validateTypeRange(K.scalarValue,K.type)}else Z===null&&K instanceof N0&&(Z=($=K==null?void 0:K.type)!==null&&$!==void 0?$:y.f32,Z===y.x32&&(Z=y.i32));let Y=this._updateNode(new u2(Q.toString(),Z,"","",K),J);return this._context.constants.set(Y.name,Y),Y}_global_let_decl(){if(!this._match(k.keywords.let))return null;let $=this._currentLine,Q=this._consume(k.tokens.name,"Expected variable name"),J=null;if(this._match(k.tokens.colon)){let K=this._attribute();J=this._type_decl(),J!=null&&(J.attributes=K)}let Z=null;if(this._match(k.tokens.equal)&&(Z=this._const_expression()),J!==null&&Z instanceof N0){if(Z.type.name!=="x32"){if(J.getTypeName()!==Z.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${Z.type.name} to ${J.name}. Line:${this._currentLine}`)}Z.type=J}else J===null&&Z instanceof N0&&(J=Z.type.name==="x32"?y.i32:Z.type);return Z instanceof N0&&Z.isScalar&&this._validateTypeRange(Z.scalarValue,J),this._updateNode(new b9(Q.toString(),J,"","",Z),$)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(k.keywords.var))return null;let $=this._currentLine,Q="",J="";this._match(k.tokens.less_than)&&(Q=this._consume(k.storage_class,"Expected storage_class.").toString(),this._match(k.tokens.comma)&&(J=this._consume(k.access_mode,"Expected access_mode.").toString()),this._consume(k.tokens.greater_than,"Expected '>'."));let Z=this._consume(k.tokens.name,"Expected variable name"),K=null;if(this._match(k.tokens.colon)){let X=this._attribute();K=this._type_decl(),K!=null&&(K.attributes=X)}return this._updateNode(new v6(Z.toString(),K,Q,J,null),$)}_override_decl(){if(!this._match(k.keywords.override))return null;let $=this._consume(k.tokens.name,"Expected variable name"),Q=null;if(this._match(k.tokens.colon)){let J=this._attribute();Q=this._type_decl(),Q!=null&&(Q.attributes=J)}return this._updateNode(new SZ($.toString(),Q,null))}_diagnostic(){this._consume(k.tokens.paren_left,"Expected '('");let $=this._consume(k.tokens.ident,"Expected severity control name.");this._consume(k.tokens.comma,"Expected ','");let Q=this._consume(k.tokens.ident,"Expected diagnostic rule name.").toString();if(this._match(k.tokens.period))Q+=`.${this._consume(k.tokens.ident,"Expected diagnostic message.").toString()}`;return this._consume(k.tokens.paren_right,"Expected ')'"),this._updateNode(new gU($.toString(),Q))}_enable_directive(){let $=this._consume(k.tokens.ident,"identity expected.");return this._updateNode(new Nh($.toString()))}_requires_directive(){let $=[this._consume(k.tokens.ident,"identity expected.").toString()];for(;this._match(k.tokens.comma);){let Q=this._consume(k.tokens.ident,"identity expected.");$.push(Q.toString())}return this._updateNode(new Dh($))}_type_alias(){let $=this._consume(k.tokens.ident,"identity expected.");this._consume(k.tokens.equal,"Expected '=' for type alias.");let Q=this._type_decl();if(Q===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(Q.name)&&(Q=this._context.aliases.get(Q.name).type);let J=this._updateNode(new IZ($.toString(),Q));return this._context.aliases.set(J.name,J),J}_type_decl(){if(this._check([k.tokens.ident,...k.texel_format,k.keywords.bool,k.keywords.f32,k.keywords.i32,k.keywords.u32])){let J=this._advance().toString();if(this._context.structs.has(J))return this._context.structs.get(J);if(this._context.aliases.has(J))return this._context.aliases.get(J).type;if(!this._getType(J)){let Z=this._updateNode(new MU(J));return this._forwardTypeCount++,Z}return this._updateNode(new y(J))}let $=this._texture_sampler_types();if($)return $;if(this._check(k.template_types)){let J=this._advance().toString(),Z=null,K=null;return this._match(k.tokens.less_than)&&(Z=this._type_decl(),K=null,this._match(k.tokens.comma)&&(K=this._consume(k.access_mode,"Expected access_mode for pointer").toString()),this._consume(k.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new E(J,Z,K))}if(this._match(k.keywords.ptr)){let J=this._previous().toString();this._consume(k.tokens.less_than,"Expected '<' for pointer.");let Z=this._consume(k.storage_class,"Expected storage_class for pointer");this._consume(k.tokens.comma,"Expected ',' for pointer.");let K=this._type_decl(),X=null;return this._match(k.tokens.comma)&&(X=this._consume(k.access_mode,"Expected access_mode for pointer").toString()),this._consume(k.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new i2(J,Z.toString(),K,X))}let Q=this._attribute();if(this._match(k.keywords.array)){let J=null,Z=-1,K=this._previous(),X=null;if(this._match(k.tokens.less_than)){J=this._type_decl(),this._context.aliases.has(J.name)&&(J=this._context.aliases.get(J.name).type);let W="";if(this._match(k.tokens.comma)){X=this._shift_expression();try{W=X.constEvaluate(this._exec).toString(),X=null}catch(q){W="1"}}this._consume(k.tokens.greater_than,"Expected '>' for array."),Z=W?parseInt(W):0}let Y=this._updateNode(new m9(K.toString(),Q,J,Z));return X&&this._deferArrayCountEval.push({arrayType:Y,countNode:X}),Y}return null}_texture_sampler_types(){if(this._match(k.sampler_type))return this._updateNode(new f9(this._previous().toString(),null,null));if(this._match(k.depth_texture_type))return this._updateNode(new f9(this._previous().toString(),null,null));if(this._match(k.sampled_texture_type)||this._match(k.multisampled_texture_type)){let $=this._previous();this._consume(k.tokens.less_than,"Expected '<' for sampler type.");let Q=this._type_decl();return this._consume(k.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new f9($.toString(),Q,null))}if(this._match(k.storage_texture_type)){let $=this._previous();this._consume(k.tokens.less_than,"Expected '<' for sampler type.");let Q=this._consume(k.texel_format,"Invalid texel format.").toString();this._consume(k.tokens.comma,"Expected ',' after texel format.");let J=this._consume(k.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(k.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new f9($.toString(),Q,J))}return null}_attribute(){let $=[];for(;this._match(k.tokens.attr);){let Q=this._consume(k.attribute_name,"Expected attribute name"),J=this._updateNode(new uU(Q.toString(),null));if(this._match(k.tokens.paren_left)){if(J.value=this._consume(k.literal_or_ident,"Expected attribute value").toString(),this._check(k.tokens.comma)){this._advance();do{let Z=this._consume(k.literal_or_ident,"Expected attribute value").toString();J.value instanceof Array||(J.value=[J.value]),J.value.push(Z)}while(this._match(k.tokens.comma))}this._consume(k.tokens.paren_right,"Expected ')'")}$.push(J)}return $.length==0?null:$}}var q4,H4,BZ,N7,V7,Hh,v51,h0,IU,Fh,BU,s2,o2,Uh,i1,c9,Vh,GU,RZ,EU,v6,SZ,b9,u2,y9,l2,j,T,jU,hU,TZ,LU,vU,_U,xU,Nh,Dh,gU,IZ,Ch,yU,fU,y,MU,L6,E,i2,m9,f9,x5,D7,$6,GZ,$5,bU,N0,mU,k8,cU,H0,L5,dU,n2,lU,pU,wU,Ah,SU,uU,OZ,z8,w,R,F1,Y0,W4,PZ,y51,f51,MZ,b51,m51,wZ,c51,d51,iU=0,RU,u0,L0,rU;var Mh=C(()=>{q4=class q4 extends q5{constructor($,Q){super($,Q),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}};H4=class H4 extends q5{constructor($,Q){super($,Q),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}};BZ=class BZ extends q5{constructor($,Q,J){super($,J),this.format=Q}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}};N7=class N7 extends q5{constructor($,Q,J,Z){super($,J),this.format=Q,this.access=Z}get isTemplate(){return!0}getTypeName(){let $=this.name;if(this.format!==null){if($==="vec2"||$==="vec3"||$==="vec4"||$==="mat2x2"||$==="mat2x3"||$==="mat2x4"||$==="mat3x2"||$==="mat3x3"||$==="mat3x4"||$==="mat4x2"||$==="mat4x3"||$==="mat4x4"){if(this.format.name==="f32")return $+="f",$;if(this.format.name==="i32")return $+="i",$;if(this.format.name==="u32")return $+="u",$;if(this.format.name==="bool")return $+="b",$;if(this.format.name==="f16")return $+="h",$}$+=`<${this.format.name}>`}else if($==="vec2"||$==="vec3"||$==="vec4")return $;return $}};(($)=>{$[$.Uniform=0]="Uniform",$[$.Storage=1]="Storage",$[$.Texture=2]="Texture",$[$.Sampler=3]="Sampler",$[$.StorageTexture=4]="StorageTexture"})(V7||(V7={}));Hh=new Float32Array(1),v51=new Int32Array(Hh.buffer),h0=new Uint16Array(1);IU=new Uint32Array(1),Fh=new Float32Array(IU.buffer,0,1);BU={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};_5._id=0;s2=class s2 extends _5{};s2.instance=new s2;o2=class o2 extends _5{};o2.instance=new o2;Uh=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);i1=class i1 extends _5{constructor(){super()}};c9=class c9 extends i1{constructor($,Q,J,Z,K,X){super(),this.calls=new Set,this.name=$,this.args=Q,this.returnType=J,this.body=Z,this.startLine=K,this.endLine=X}get astNodeType(){return"function"}search($){if(this.attributes)for(let Q of this.attributes)$(Q);$(this);for(let Q of this.args)$(Q);this.searchBlock(this.body,$)}};Vh=class Vh extends i1{constructor($){super(),this.expression=$}get astNodeType(){return"staticAssert"}search($){this.expression.search($)}};GU=class GU extends i1{constructor($,Q){super(),this.condition=$,this.body=Q}get astNodeType(){return"while"}search($){this.condition.search($),this.searchBlock(this.body,$)}};RZ=class RZ extends i1{constructor($,Q){super(),this.body=$,this.loopId=Q}get astNodeType(){return"continuing"}search($){this.searchBlock(this.body,$)}};EU=class EU extends i1{constructor($,Q,J,Z){super(),this.init=$,this.condition=Q,this.increment=J,this.body=Z}get astNodeType(){return"for"}search($){var Q,J,Z;(Q=this.init)===null||Q===void 0||Q.search($),(J=this.condition)===null||J===void 0||J.search($),(Z=this.increment)===null||Z===void 0||Z.search($),this.searchBlock(this.body,$)}};v6=class v6 extends i1{constructor($,Q,J,Z,K){super(),this.attributes=null,this.name=$,this.type=Q,this.storage=J,this.access=Z,this.value=K}get astNodeType(){return"var"}search($){var Q;$(this),(Q=this.value)===null||Q===void 0||Q.search($)}};SZ=class SZ extends i1{constructor($,Q,J){super(),this.attributes=null,this.name=$,this.type=Q,this.value=J}get astNodeType(){return"override"}search($){var Q;(Q=this.value)===null||Q===void 0||Q.search($)}};b9=class b9 extends i1{constructor($,Q,J,Z,K){super(),this.attributes=null,this.name=$,this.type=Q,this.storage=J,this.access=Z,this.value=K}get astNodeType(){return"let"}search($){var Q;$(this),(Q=this.value)===null||Q===void 0||Q.search($)}};u2=class u2 extends i1{constructor($,Q,J,Z,K){super(),this.attributes=null,this.name=$,this.type=Q,this.storage=J,this.access=Z,this.value=K}get astNodeType(){return"const"}constEvaluate($,Q){return this.value.constEvaluate($,Q)}search($){var Q;$(this),(Q=this.value)===null||Q===void 0||Q.search($)}};(($)=>{$.increment="++",$.decrement="--"})(y9||(y9={})),(($)=>{$.parse=function(Q){let J=Q;if(J=="parse")throw Error("Invalid value for IncrementOperator");return $[J]}})(y9||(y9={}));jU=class jU extends i1{constructor($,Q){super(),this.operator=$,this.variable=Q}get astNodeType(){return"increment"}search($){this.variable.search($)}};(($)=>{$.assign="=",$.addAssign="+=",$.subtractAssin="-=",$.multiplyAssign="*=",$.divideAssign="/=",$.moduloAssign="%=",$.andAssign="&=",$.orAssign="|=",$.xorAssign="^=",$.shiftLeftAssign="<<=",$.shiftRightAssign=">>="})(l2||(l2={})),(($)=>{$.parse=function(Q){let J=Q;if(J=="parse")throw Error("Invalid value for AssignOperator");return J}})(l2||(l2={}));hU=class hU extends i1{constructor($,Q,J){super(),this.operator=$,this.variable=Q,this.value=J}get astNodeType(){return"assign"}search($){this.variable.search($),this.value.search($)}};TZ=class TZ extends i1{constructor($,Q){super(),this.name=$,this.args=Q}get astNodeType(){return"call"}isBuiltin(){return Uh.has(this.name)}search($){for(let Q of this.args)Q.search($);$(this)}};LU=class LU extends i1{constructor($,Q){super(),this.body=$,this.continuing=Q}get astNodeType(){return"loop"}search($){var Q;this.searchBlock(this.body,$),(Q=this.continuing)===null||Q===void 0||Q.search($)}};vU=class vU extends i1{constructor($,Q){super(),this.condition=$,this.cases=Q}get astNodeType(){return"switch"}search($){$(this);for(let Q of this.cases)Q.search($)}};_U=class _U extends i1{constructor($,Q,J,Z){super(),this.condition=$,this.body=Q,this.elseif=J,this.else=Z}get astNodeType(){return"if"}search($){this.condition.search($),this.searchBlock(this.body,$),this.searchBlock(this.elseif,$),this.searchBlock(this.else,$)}};xU=class xU extends i1{constructor($){super(),this.value=$}get astNodeType(){return"return"}search($){var Q;(Q=this.value)===null||Q===void 0||Q.search($)}};Nh=class Nh extends i1{constructor($){super(),this.name=$}get astNodeType(){return"enable"}};Dh=class Dh extends i1{constructor($){super(),this.extensions=$}get astNodeType(){return"requires"}};gU=class gU extends i1{constructor($,Q){super(),this.severity=$,this.rule=Q}get astNodeType(){return"diagnostic"}};IZ=class IZ extends i1{constructor($,Q){super(),this.name=$,this.type=Q}get astNodeType(){return"alias"}};Ch=class Ch extends i1{constructor(){super()}get astNodeType(){return"discard"}};yU=class yU extends i1{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}};fU=class fU extends i1{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}};y=class y extends i1{constructor($){super(),this.attributes=null,this.name=$}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType($){let Q=$[0];if(Q.name==="f32")return Q;for(let J=1;J<$.length;++J){let Z=y._priority.get(Q.name);y._priority.get($[J].name)<Z&&(Q=$[J])}return Q.name==="x32"?y.i32:Q}getTypeName(){return this.name}};y.x32=new y("x32"),y.f32=new y("f32"),y.i32=new y("i32"),y.u32=new y("u32"),y.f16=new y("f16"),y.bool=new y("bool"),y.void=new y("void"),y._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);MU=class MU extends y{constructor($){super($)}};L6=class L6 extends y{constructor($,Q,J,Z){super($),this.members=Q,this.startLine=J,this.endLine=Z}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex($){for(let Q=0;Q<this.members.length;Q++)if(this.members[Q].name==$)return Q;return-1}search($){for(let Q of this.members)$(Q)}};E=class E extends y{constructor($,Q,J){super($),this.format=Q,this.access=J}get astNodeType(){return"template"}getTypeName(){let $=this.name;if(this.format!==null){if($==="vec2"||$==="vec3"||$==="vec4"||$==="mat2x2"||$==="mat2x3"||$==="mat2x4"||$==="mat3x2"||$==="mat3x3"||$==="mat3x4"||$==="mat4x2"||$==="mat4x3"||$==="mat4x4"){if(this.format.name==="f32")return $+="f",$;if(this.format.name==="i32")return $+="i",$;if(this.format.name==="u32")return $+="u",$;if(this.format.name==="bool")return $+="b",$;if(this.format.name==="f16")return $+="h",$}$+=`<${this.format.name}>`}else if($==="vec2"||$==="vec3"||$==="vec4")return $;return $}};E.vec2f=new E("vec2",y.f32,null),E.vec3f=new E("vec3",y.f32,null),E.vec4f=new E("vec4",y.f32,null),E.vec2i=new E("vec2",y.i32,null),E.vec3i=new E("vec3",y.i32,null),E.vec4i=new E("vec4",y.i32,null),E.vec2u=new E("vec2",y.u32,null),E.vec3u=new E("vec3",y.u32,null),E.vec4u=new E("vec4",y.u32,null),E.vec2h=new E("vec2",y.f16,null),E.vec3h=new E("vec3",y.f16,null),E.vec4h=new E("vec4",y.f16,null),E.vec2b=new E("vec2",y.bool,null),E.vec3b=new E("vec3",y.bool,null),E.vec4b=new E("vec4",y.bool,null),E.mat2x2f=new E("mat2x2",y.f32,null),E.mat2x3f=new E("mat2x3",y.f32,null),E.mat2x4f=new E("mat2x4",y.f32,null),E.mat3x2f=new E("mat3x2",y.f32,null),E.mat3x3f=new E("mat3x3",y.f32,null),E.mat3x4f=new E("mat3x4",y.f32,null),E.mat4x2f=new E("mat4x2",y.f32,null),E.mat4x3f=new E("mat4x3",y.f32,null),E.mat4x4f=new E("mat4x4",y.f32,null),E.mat2x2h=new E("mat2x2",y.f16,null),E.mat2x3h=new E("mat2x3",y.f16,null),E.mat2x4h=new E("mat2x4",y.f16,null),E.mat3x2h=new E("mat3x2",y.f16,null),E.mat3x3h=new E("mat3x3",y.f16,null),E.mat3x4h=new E("mat3x4",y.f16,null),E.mat4x2h=new E("mat4x2",y.f16,null),E.mat4x3h=new E("mat4x3",y.f16,null),E.mat4x4h=new E("mat4x4",y.f16,null),E.mat2x2i=new E("mat2x2",y.i32,null),E.mat2x3i=new E("mat2x3",y.i32,null),E.mat2x4i=new E("mat2x4",y.i32,null),E.mat3x2i=new E("mat3x2",y.i32,null),E.mat3x3i=new E("mat3x3",y.i32,null),E.mat3x4i=new E("mat3x4",y.i32,null),E.mat4x2i=new E("mat4x2",y.i32,null),E.mat4x3i=new E("mat4x3",y.i32,null),E.mat4x4i=new E("mat4x4",y.i32,null),E.mat2x2u=new E("mat2x2",y.u32,null),E.mat2x3u=new E("mat2x3",y.u32,null),E.mat2x4u=new E("mat2x4",y.u32,null),E.mat3x2u=new E("mat3x2",y.u32,null),E.mat3x3u=new E("mat3x3",y.u32,null),E.mat3x4u=new E("mat3x4",y.u32,null),E.mat4x2u=new E("mat4x2",y.u32,null),E.mat4x3u=new E("mat4x3",y.u32,null),E.mat4x4u=new E("mat4x4",y.u32,null);i2=class i2 extends y{constructor($,Q,J,Z){super($),this.storage=Q,this.type=J,this.access=Z}get astNodeType(){return"pointer"}};m9=class m9 extends y{constructor($,Q,J,Z){super($),this.attributes=Q,this.format=J,this.count=Z}get astNodeType(){return"array"}get isArray(){return!0}};f9=class f9 extends y{constructor($,Q,J){super($),this.format=Q,this.access=J}get astNodeType(){return"sampler"}};x5=class x5 extends _5{constructor(){super(),this.postfix=null}};D7=class D7 extends x5{constructor($){super(),this.value=$}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}};$6=class $6 extends x5{constructor($,Q){super(),this.type=$,this.args=Q}get astNodeType(){return"createExpr"}search($){if($(this),this.args)for(let Q of this.args)Q.search($)}constEvaluate($,Q){return Q&&(Q[0]=this.type),$.evalExpression(this,$.context)}};GZ=class GZ extends x5{constructor($,Q){super(),this.cachedReturnValue=null,this.name=$,this.args=Q}get astNodeType(){return"callExpr"}setCachedReturnValue($){this.cachedReturnValue=$}get isBuiltin(){return Uh.has(this.name)}constEvaluate($,Q){return $.evalExpression(this,$.context)}search($){for(let Q of this.args)Q.search($);$(this)}};$5=class $5 extends x5{constructor($){super(),this.name=$}get astNodeType(){return"varExpr"}search($){$(this),this.postfix&&this.postfix.search($)}constEvaluate($,Q){return $.evalExpression(this,$.context)}};bU=class bU extends x5{constructor($,Q){super(),this.name=$,this.initializer=Q}get astNodeType(){return"constExpr"}constEvaluate($,Q){if(this.initializer){let J=$.evalExpression(this.initializer,$.context);return J!==null&&this.postfix?J.getSubData($,this.postfix,$.context):J}return null}search($){this.initializer.search($)}};N0=class N0 extends x5{constructor($,Q){super(),this.value=$,this.type=Q}get astNodeType(){return"literalExpr"}constEvaluate($,Q){return Q!==void 0&&(Q[0]=this.type),this.value}get isScalar(){return this.value instanceof w}get isVector(){return this.value instanceof R||this.value instanceof F1}get scalarValue(){return this.value instanceof w?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof R||this.value instanceof F1?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}};mU=class mU extends x5{constructor($,Q){super(),this.type=$,this.value=Q}get astNodeType(){return"bitcastExpr"}search($){this.value.search($)}};k8=class k8 extends x5{constructor($){super(),this.index=$}search($){this.index.search($)}};cU=class cU extends x5{constructor(){super()}};H0=class H0 extends cU{constructor($,Q){super(),this.operator=$,this.right=Q}get astNodeType(){return"unaryOp"}constEvaluate($,Q){return $.evalExpression(this,$.context)}search($){this.right.search($)}};L5=class L5 extends cU{constructor($,Q,J){super(),this.operator=$,this.left=Q,this.right=J}get astNodeType(){return"binaryOp"}_getPromotedType($,Q){return $.name===Q.name?$:$.name==="f32"||Q.name==="f32"?y.f32:$.name==="u32"||Q.name==="u32"?y.u32:y.i32}constEvaluate($,Q){return $.evalExpression(this,$.context)}search($){this.left.search($),this.right.search($)}};dU=class dU extends _5{constructor($){super(),this.body=$}search($){$(this),this.searchBlock(this.body,$)}};n2=class n2 extends x5{constructor(){super()}get astNodeType(){return"default"}};lU=class lU extends dU{constructor($,Q){super(Q),this.selectors=$}get astNodeType(){return"case"}search($){this.searchBlock(this.body,$)}};pU=class pU extends dU{constructor($){super($)}get astNodeType(){return"default"}search($){this.searchBlock(this.body,$)}};wU=class wU extends _5{constructor($,Q,J){super(),this.name=$,this.type=Q,this.attributes=J}get astNodeType(){return"argument"}};Ah=class Ah extends _5{constructor($,Q){super(),this.condition=$,this.body=Q}get astNodeType(){return"elseif"}search($){this.condition.search($),this.searchBlock(this.body,$)}};SU=class SU extends _5{constructor($,Q,J){super(),this.name=$,this.type=Q,this.attributes=J}get astNodeType(){return"member"}};uU=class uU extends _5{constructor($,Q){super(),this.name=$,this.value=Q}get astNodeType(){return"attribute"}};v5._id=0;OZ=class OZ extends v5{constructor(){super(new q5("void",null),null)}toString(){return"void"}};OZ.void=new OZ;z8=class z8 extends v5{constructor($){super(new BZ("pointer",$.typeInfo,null),null),this.reference=$}clone(){return this}setDataValue($,Q,J,Z){this.reference.setDataValue($,Q,J,Z)}getSubData($,Q,J){return Q?this.reference.getSubData($,Q,J):this}toString(){return`&${this.reference.toString()}`}};w=class w extends v5{constructor($,Q,J=null){super(Q,J),$ instanceof Int32Array||$ instanceof Uint32Array||$ instanceof Float32Array?this.data=$:this.typeInfo.name==="x32"?$-Math.floor($)!==0?this.data=new Float32Array([$]):this.data=$>=0?new Uint32Array([$]):new Int32Array([$]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([$]):this.typeInfo.name==="u32"?this.data=new Uint32Array([$]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([$]):console.error("ScalarData2: Invalid type",Q)}clone(){if(this.data instanceof Float32Array)return new w(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new w(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new w(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value($){this.data[0]=$}setDataValue($,Q,J,Z){if(J)return void console.error("SetDataValue: Scalar data does not support postfix",J);if(!(Q instanceof w))return void console.error("SetDataValue: Invalid value",Q);let K=Q.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?K=Math.floor(K):this.typeInfo.name==="bool"&&(K=K?1:0),this.data[0]=K}getSubData($,Q,J){return Q?(console.error("getSubData: Scalar data does not support postfix",Q),null):this}toString(){return`${this.value}`}};R=class R extends v5{constructor($,Q,J=null){if(super(Q,J),$ instanceof Float32Array||$ instanceof Uint32Array||$ instanceof Int32Array)this.data=$;else{let Z=this.typeInfo.name;Z==="vec2f"||Z==="vec3f"||Z==="vec4f"?this.data=new Float32Array($):Z==="vec2i"||Z==="vec3i"||Z==="vec4i"?this.data=new Int32Array($):Z==="vec2u"||Z==="vec3u"||Z==="vec4u"?this.data=new Uint32Array($):Z==="vec2h"||Z==="vec3h"||Z==="vec4h"?this.data=new Float32Array($):Z==="vec2b"||Z==="vec3b"||Z==="vec4b"?this.data=new Int32Array($):Z==="vec2"||Z==="vec3"||Z==="vec4"?this.data=new Float32Array($):console.error(`VectorData: Invalid type ${Z}`)}}clone(){if(this.data instanceof Float32Array)return new R(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new R(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new R(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue($,Q,J,Z){J instanceof D7?console.error("TODO: Set vector postfix"):Q instanceof R?this.data=Q.data:console.error("SetDataValue: Invalid value",Q)}getSubData($,Q,J){if(Q===null)return this;let Z=$.getTypeInfo("f32");if(this.typeInfo instanceof N7)Z=this.typeInfo.format||Z;else{let X=this.typeInfo.name;X==="vec2f"||X==="vec3f"||X==="vec4f"?Z=$.getTypeInfo("f32"):X==="vec2i"||X==="vec3i"||X==="vec4i"?Z=$.getTypeInfo("i32"):X==="vec2b"||X==="vec3b"||X==="vec4b"?Z=$.getTypeInfo("bool"):X==="vec2u"||X==="vec3u"||X==="vec4u"?Z=$.getTypeInfo("u32"):X==="vec2h"||X==="vec3h"||X==="vec4h"?Z=$.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${X}`)}let K=this;for(;Q!==null&&K!==null;){if(Q instanceof k8){let X=Q.index,Y=-1;if(X instanceof N0){if(!(X.value instanceof w))return console.error(`GetSubData: Invalid array index ${X.value}`),null;Y=X.value.value}else{let W=$.evalExpression(X,J);if(!(W instanceof w))return console.error("GetSubData: Unknown index type",X),null;Y=W.value}if(Y<0||Y>=K.data.length)return console.error("GetSubData: Index out of range",Y),null;if(K.data instanceof Float32Array){let W=new Float32Array(K.data.buffer,K.data.byteOffset+4*Y,1);return new w(W,Z)}if(K.data instanceof Int32Array){let W=new Int32Array(K.data.buffer,K.data.byteOffset+4*Y,1);return new w(W,Z)}if(K.data instanceof Uint32Array){let W=new Uint32Array(K.data.buffer,K.data.byteOffset+4*Y,1);return new w(W,Z)}throw"GetSubData: Invalid data type"}if(!(Q instanceof D7))return console.error("GetSubData: Unknown postfix",Q),null;{let X=Q.value.toLowerCase();if(X.length===1){let W=0;if(X==="x"||X==="r")W=0;else if(X==="y"||X==="g")W=1;else if(X==="z"||X==="b")W=2;else{if(X!=="w"&&X!=="a")return console.error(`GetSubData: Unknown member ${X}`),null;W=3}if(this.data instanceof Float32Array){let q=new Float32Array(this.data.buffer,this.data.byteOffset+4*W,1);return new w(q,Z,this)}if(this.data instanceof Int32Array){let q=new Int32Array(this.data.buffer,this.data.byteOffset+4*W,1);return new w(q,Z,this)}if(this.data instanceof Uint32Array){let q=new Uint32Array(this.data.buffer,this.data.byteOffset+4*W,1);return new w(q,Z,this)}}let Y=[];for(let W of X)W==="x"||W==="r"?Y.push(this.data[0]):W==="y"||W==="g"?Y.push(this.data[1]):W==="z"||W==="b"?Y.push(this.data[2]):W==="w"||W==="a"?Y.push(this.data[3]):console.error(`GetDataValue: Unknown member ${W}`);K=g51($,Y,Z.name)}Q=Q.postfix}return K}toString(){let $=`${this.data[0]}`;for(let Q=1;Q<this.data.length;++Q)$+=`, ${this.data[Q]}`;return $}};F1=class F1 extends v5{constructor($,Q,J=null){super(Q,J),$ instanceof Float32Array?this.data=$:this.data=new Float32Array($)}clone(){return new F1(new Float32Array(this.data),this.typeInfo,null)}setDataValue($,Q,J,Z){J instanceof D7?console.error("TODO: Set matrix postfix"):Q instanceof F1?this.data=Q.data:console.error("SetDataValue: Invalid value",Q)}getSubData($,Q,J){if(Q===null)return this;let Z=this.typeInfo.name;if($.getTypeInfo("f32"),this.typeInfo instanceof N7)this.typeInfo.format;else if(Z.endsWith("f"))$.getTypeInfo("f32");else if(Z.endsWith("i"))$.getTypeInfo("i32");else if(Z.endsWith("u"))$.getTypeInfo("u32");else{if(!Z.endsWith("h"))return console.error(`GetDataValue: Unknown type ${Z}`),null;$.getTypeInfo("f16")}if(Q instanceof k8){let K=Q.index,X=-1;if(K instanceof N0){if(!(K.value instanceof w))return console.error(`GetDataValue: Invalid array index ${K.value}`),null;X=K.value.value}else{let q=$.evalExpression(K,J);if(!(q instanceof w))return console.error("GetDataValue: Unknown index type",K),null;X=q.value}if(X<0||X>=this.data.length)return console.error("GetDataValue: Index out of range",X),null;let Y=Z.endsWith("h")?"h":"f",W;if(Z==="mat2x2"||Z==="mat2x2f"||Z==="mat2x2h"||Z==="mat3x2"||Z==="mat3x2f"||Z==="mat3x2h"||Z==="mat4x2"||Z==="mat4x2f"||Z==="mat4x2h")W=new R(new Float32Array(this.data.buffer,this.data.byteOffset+2*X*4,2),$.getTypeInfo(`vec2${Y}`));else if(Z==="mat2x3"||Z==="mat2x3f"||Z==="mat2x3h"||Z==="mat3x3"||Z==="mat3x3f"||Z==="mat3x3h"||Z==="mat4x3"||Z==="mat4x3f"||Z==="mat4x3h")W=new R(new Float32Array(this.data.buffer,this.data.byteOffset+3*X*4,3),$.getTypeInfo(`vec3${Y}`));else{if(Z!=="mat2x4"&&Z!=="mat2x4f"&&Z!=="mat2x4h"&&Z!=="mat3x4"&&Z!=="mat3x4f"&&Z!=="mat3x4h"&&Z!=="mat4x4"&&Z!=="mat4x4f"&&Z!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${Z}`),null;W=new R(new Float32Array(this.data.buffer,this.data.byteOffset+4*X*4,4),$.getTypeInfo(`vec4${Y}`))}return Q.postfix?W.getSubData($,Q.postfix,J):W}return console.error("GetDataValue: Invalid postfix",Q),null}toString(){let $=`${this.data[0]}`;for(let Q=1;Q<this.data.length;++Q)$+=`, ${this.data[Q]}`;return $}};Y0=class Y0 extends v5{constructor($,Q,J=0,Z=null){super(Q,Z),this.buffer=$ instanceof ArrayBuffer?$:$.buffer,this.offset=J}clone(){let $=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Y0($.buffer,this.typeInfo,0,null)}setDataValue($,Q,J,Z){if(Q===null)return void console.log("setDataValue: NULL data.");let K=this.offset,X=this.typeInfo;for(;J;){if(J instanceof k8)if(X instanceof H4){let Y=J.index;if(Y instanceof N0){if(!(Y.value instanceof w))return void console.error(`SetDataValue: Invalid index type ${Y.value}`);K+=Y.value.value*X.stride}else{let W=$.evalExpression(Y,Z);if(!(W instanceof w))return void console.error("SetDataValue: Unknown index type",Y);K+=W.value*X.stride}X=X.format}else console.error(`SetDataValue: Type ${X.getTypeName()} is not an array`);else{if(!(J instanceof D7))return void console.error("SetDataValue: Unknown postfix type",J);{let Y=J.value;if(X instanceof q4){let W=!1;for(let q of X.members)if(q.name===Y){K+=q.offset,X=q.type,W=!0;break}if(!W)return void console.error(`SetDataValue: Member ${Y} not found`)}else if(X instanceof q5){let W=X.getTypeName(),q=0;if(Y==="x"||Y==="r")q=0;else if(Y==="y"||Y==="g")q=1;else if(Y==="z"||Y==="b")q=2;else{if(Y!=="w"&&Y!=="a")return void console.error(`SetDataValue: Unknown member ${Y}`);q=3}if(!(Q instanceof w))return void console.error("SetDataValue: Invalid value",Q);let H=Q.value;return W==="vec2f"?void(new Float32Array(this.buffer,K,2)[q]=H):W==="vec3f"?void(new Float32Array(this.buffer,K,3)[q]=H):W==="vec4f"?void(new Float32Array(this.buffer,K,4)[q]=H):W==="vec2i"?void(new Int32Array(this.buffer,K,2)[q]=H):W==="vec3i"?void(new Int32Array(this.buffer,K,3)[q]=H):W==="vec4i"?void(new Int32Array(this.buffer,K,4)[q]=H):W==="vec2u"?void(new Uint32Array(this.buffer,K,2)[q]=H):W==="vec3u"?void(new Uint32Array(this.buffer,K,3)[q]=H):W==="vec4u"?void(new Uint32Array(this.buffer,K,4)[q]=H):void console.error(`SetDataValue: Type ${W} is not a struct`)}}}J=J.postfix}this.setData($,Q,X,K,Z)}setData($,Q,J,Z,K){let X=J.getTypeName();if(X!=="f32"&&X!=="f16")if(X!=="i32"&&X!=="atomic<i32>"&&X!=="x32")if(X!=="u32"&&X!=="atomic<u32>")if(X!=="bool"){if(X==="vec2f"||X==="vec2h"){let Y=new Float32Array(this.buffer,Z,2);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1]):(Y[0]=Q[0],Y[1]=Q[1]))}if(X==="vec3f"||X==="vec3h"){let Y=new Float32Array(this.buffer,Z,3);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2]))}if(X==="vec4f"||X==="vec4h"){let Y=new Float32Array(this.buffer,Z,4);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3]))}if(X==="vec2i"){let Y=new Int32Array(this.buffer,Z,2);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1]):(Y[0]=Q[0],Y[1]=Q[1]))}if(X==="vec3i"){let Y=new Int32Array(this.buffer,Z,3);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2]))}if(X==="vec4i"){let Y=new Int32Array(this.buffer,Z,4);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3]))}if(X==="vec2u"){let Y=new Uint32Array(this.buffer,Z,2);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1]):(Y[0]=Q[0],Y[1]=Q[1]))}if(X==="vec3u"){let Y=new Uint32Array(this.buffer,Z,3);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2]))}if(X==="vec4u"){let Y=new Uint32Array(this.buffer,Z,4);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3]))}if(X==="vec2b"){let Y=new Uint32Array(this.buffer,Z,2);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1]):(Y[0]=Q[0],Y[1]=Q[1]))}if(X==="vec3b"){let Y=new Uint32Array(this.buffer,Z,3);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2]))}if(X==="vec4b"){let Y=new Uint32Array(this.buffer,Z,4);return void(Q instanceof R?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3]))}if(X==="mat2x2f"||X==="mat2x2h"){let Y=new Float32Array(this.buffer,Z,4);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3]))}if(X==="mat2x3f"||X==="mat2x3h"){let Y=new Float32Array(this.buffer,Z,6);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5]))}if(X==="mat2x4f"||X==="mat2x4h"){let Y=new Float32Array(this.buffer,Z,8);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7]))}if(X==="mat3x2f"||X==="mat3x2h"){let Y=new Float32Array(this.buffer,Z,6);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5]))}if(X==="mat3x3f"||X==="mat3x3h"){let Y=new Float32Array(this.buffer,Z,9);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7],Y[8]=Q.data[8]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7],Y[8]=Q[8]))}if(X==="mat3x4f"||X==="mat3x4h"){let Y=new Float32Array(this.buffer,Z,12);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7],Y[8]=Q.data[8],Y[9]=Q.data[9],Y[10]=Q.data[10],Y[11]=Q.data[11]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7],Y[8]=Q[8],Y[9]=Q[9],Y[10]=Q[10],Y[11]=Q[11]))}if(X==="mat4x2f"||X==="mat4x2h"){let Y=new Float32Array(this.buffer,Z,8);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7]))}if(X==="mat4x3f"||X==="mat4x3h"){let Y=new Float32Array(this.buffer,Z,12);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7],Y[8]=Q.data[8],Y[9]=Q.data[9],Y[10]=Q.data[10],Y[11]=Q.data[11]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7],Y[8]=Q[8],Y[9]=Q[9],Y[10]=Q[10],Y[11]=Q[11]))}if(X==="mat4x4f"||X==="mat4x4h"){let Y=new Float32Array(this.buffer,Z,16);return void(Q instanceof F1?(Y[0]=Q.data[0],Y[1]=Q.data[1],Y[2]=Q.data[2],Y[3]=Q.data[3],Y[4]=Q.data[4],Y[5]=Q.data[5],Y[6]=Q.data[6],Y[7]=Q.data[7],Y[8]=Q.data[8],Y[9]=Q.data[9],Y[10]=Q.data[10],Y[11]=Q.data[11],Y[12]=Q.data[12],Y[13]=Q.data[13],Y[14]=Q.data[14],Y[15]=Q.data[15]):(Y[0]=Q[0],Y[1]=Q[1],Y[2]=Q[2],Y[3]=Q[3],Y[4]=Q[4],Y[5]=Q[5],Y[6]=Q[6],Y[7]=Q[7],Y[8]=Q[8],Y[9]=Q[9],Y[10]=Q[10],Y[11]=Q[11],Y[12]=Q[12],Y[13]=Q[13],Y[14]=Q[14],Y[15]=Q[15]))}if(Q instanceof Y0){if(J===Q.typeInfo)return void new Uint8Array(this.buffer,Z,Q.buffer.byteLength).set(new Uint8Array(Q.buffer));console.error("SetDataValue: Type mismatch",X,Q.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${X}`)}else Q instanceof w&&(new Int32Array(this.buffer,Z,1)[0]=Q.value);else Q instanceof w&&(new Uint32Array(this.buffer,Z,1)[0]=Q.value);else Q instanceof w&&(new Int32Array(this.buffer,Z,1)[0]=Q.value);else Q instanceof w&&(new Float32Array(this.buffer,Z,1)[0]=Q.value)}getSubData($,Q,J){var Z,K,X;if(Q===null)return this;let Y=this.offset,W=this.typeInfo;for(;Q;){if(Q instanceof k8){let H=Q.index,F=H instanceof x5?$.evalExpression(H,J):H,U=0;if(F instanceof w?U=F.value:typeof F=="number"?U=F:console.error("GetDataValue: Invalid index type",H),W instanceof H4)Y+=U*W.stride,W=W.format;else{let V=W.getTypeName();V==="mat4x4"||V==="mat4x4f"||V==="mat4x4h"?(Y+=16*U,W=$.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${W.getTypeName()} is not an array`)}}else{if(!(Q instanceof D7))return console.error("GetDataValue: Unknown postfix type",Q),null;{let H=Q.value;if(W instanceof q4){let F=!1;for(let U of W.members)if(U.name===H){Y+=U.offset,W=U.type,F=!0;break}if(!F)return console.error(`GetDataValue: Member ${H} not found`),null}else if(W instanceof q5){let F=W.getTypeName();if(F==="vec2f"||F==="vec3f"||F==="vec4f"||F==="vec2i"||F==="vec3i"||F==="vec4i"||F==="vec2u"||F==="vec3u"||F==="vec4u"||F==="vec2b"||F==="vec3b"||F==="vec4b"||F==="vec2h"||F==="vec3h"||F==="vec4h"||F==="vec2"||F==="vec3"||F==="vec4"){if(H.length>0&&H.length<5){let U="f",V=[];for(let N=0;N<H.length;++N){let D=H[N].toLowerCase(),z=0;if(D==="x"||D==="r")z=0;else if(D==="y"||D==="g")z=1;else if(D==="z"||D==="b")z=2;else{if(D!=="w"&&D!=="a")return console.error(`Unknown member ${H}`),null;z=3}if(H.length===1){if(F.endsWith("f"))return this.buffer.byteLength<Y+4*z+4?(console.log("Insufficient buffer data"),null):new w(new Float32Array(this.buffer,Y+4*z,1),$.getTypeInfo("f32"),this);if(F.endsWith("h"))return new w(new Float32Array(this.buffer,Y+4*z,1),$.getTypeInfo("f16"),this);if(F.endsWith("i"))return new w(new Int32Array(this.buffer,Y+4*z,1),$.getTypeInfo("i32"),this);if(F.endsWith("b"))return new w(new Int32Array(this.buffer,Y+4*z,1),$.getTypeInfo("bool"),this);if(F.endsWith("u"))return new w(new Uint32Array(this.buffer,Y+4*z,1),$.getTypeInfo("i32"),this)}if(F==="vec2f")V.push(new Float32Array(this.buffer,Y,2)[z]);else if(F==="vec3f"){if(Y+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;let B=new Float32Array(this.buffer,Y,3);V.push(B[z])}else if(F==="vec4f")V.push(new Float32Array(this.buffer,Y,4)[z]);else if(F==="vec2i")U="i",V.push(new Int32Array(this.buffer,Y,2)[z]);else if(F==="vec3i")U="i",V.push(new Int32Array(this.buffer,Y,3)[z]);else if(F==="vec4i")U="i",V.push(new Int32Array(this.buffer,Y,4)[z]);else if(F==="vec2u"){U="u";let B=new Uint32Array(this.buffer,Y,2);V.push(B[z])}else F==="vec3u"?(U="u",V.push(new Uint32Array(this.buffer,Y,3)[z])):F==="vec4u"&&(U="u",V.push(new Uint32Array(this.buffer,Y,4)[z]))}return V.length===2?W=$.getTypeInfo(`vec2${U}`):V.length===3?W=$.getTypeInfo(`vec3${U}`):V.length===4?W=$.getTypeInfo(`vec4${U}`):console.error(`GetDataValue: Invalid vector length ${V.length}`),new R(V,W,null)}return console.error(`GetDataValue: Unknown member ${H}`),null}return console.error(`GetDataValue: Type ${F} is not a struct`),null}}}Q=Q.postfix}let q=W.getTypeName();return q==="f32"?new w(new Float32Array(this.buffer,Y,1),W,this):q==="i32"?new w(new Int32Array(this.buffer,Y,1),W,this):q==="u32"?new w(new Uint32Array(this.buffer,Y,1),W,this):q==="vec2f"?new R(new Float32Array(this.buffer,Y,2),W,this):q==="vec3f"?new R(new Float32Array(this.buffer,Y,3),W,this):q==="vec4f"?new R(new Float32Array(this.buffer,Y,4),W,this):q==="vec2i"?new R(new Int32Array(this.buffer,Y,2),W,this):q==="vec3i"?new R(new Int32Array(this.buffer,Y,3),W,this):q==="vec4i"?new R(new Int32Array(this.buffer,Y,4),W,this):q==="vec2u"?new R(new Uint32Array(this.buffer,Y,2),W,this):q==="vec3u"?new R(new Uint32Array(this.buffer,Y,3),W,this):q==="vec4u"?new R(new Uint32Array(this.buffer,Y,4),W,this):W instanceof N7&&W.name==="atomic"?((Z=W.format)===null||Z===void 0?void 0:Z.name)==="u32"?new w(new Uint32Array(this.buffer,Y,1)[0],W.format,this):((K=W.format)===null||K===void 0?void 0:K.name)==="i32"?new w(new Int32Array(this.buffer,Y,1)[0],W.format,this):(console.error(`GetDataValue: Invalid atomic format ${(X=W.format)===null||X===void 0?void 0:X.name}`),null):new Y0(this.buffer,W,Y,this)}toString(){let $="";if(this.typeInfo instanceof H4)if(this.typeInfo.format.name==="f32"){let Q=new Float32Array(this.buffer,this.offset);$=`[${Q[0]}`;for(let J=1;J<Q.length;++J)$+=`, ${Q[J]}`}else if(this.typeInfo.format.name==="i32"){let Q=new Int32Array(this.buffer,this.offset);$=`[${Q[0]}`;for(let J=1;J<Q.length;++J)$+=`, ${Q[J]}`}else if(this.typeInfo.format.name==="u32"){let Q=new Uint32Array(this.buffer,this.offset);$=`[${Q[0]}`;for(let J=1;J<Q.length;++J)$+=`, ${Q[J]}`}else if(this.typeInfo.format.name==="vec2f"){let Q=new Float32Array(this.buffer,this.offset);$=`[${Q[0]}, ${Q[1]}]`;for(let J=1;J<Q.length/2;++J)$+=`, [${Q[2*J]}, ${Q[2*J+1]}]`}else if(this.typeInfo.format.name==="vec3f"){let Q=new Float32Array(this.buffer,this.offset);$=`[${Q[0]}, ${Q[1]}, ${Q[2]}]`;for(let J=4;J<Q.length;J+=4)$+=`, [${Q[J]}, ${Q[J+1]}, ${Q[J+2]}]`}else if(this.typeInfo.format.name==="vec4f"){let Q=new Float32Array(this.buffer,this.offset);$=`[${Q[0]}, ${Q[1]}, ${Q[2]}, ${Q[3]}]`;for(let J=4;J<Q.length;J+=4)$+=`, [${Q[J]}, ${Q[J+1]}, ${Q[J+2]}, ${Q[J+3]}]`}else $="[...]";else this.typeInfo instanceof q4?$+="{...}":$="[...]";return $}};W4=class W4 extends v5{constructor($,Q,J,Z){super(Q,null),this.data=$,this.descriptor=J,this.view=Z}clone(){return new W4(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var $,Q;let J=this.descriptor.size;return J instanceof Array&&J.length>0?($=J[0])!==null&&$!==void 0?$:0:J instanceof Object&&(Q=J.width)!==null&&Q!==void 0?Q:0}get height(){var $,Q;let J=this.descriptor.size;return J instanceof Array&&J.length>1?($=J[1])!==null&&$!==void 0?$:0:J instanceof Object&&(Q=J.height)!==null&&Q!==void 0?Q:0}get depthOrArrayLayers(){var $,Q;let J=this.descriptor.size;return J instanceof Array&&J.length>2?($=J[2])!==null&&$!==void 0?$:0:J instanceof Object&&(Q=J.depthOrArrayLayers)!==null&&Q!==void 0?Q:0}get format(){var $;return this.descriptor&&($=this.descriptor.format)!==null&&$!==void 0?$:"rgba8unorm"}get sampleCount(){var $;return this.descriptor&&($=this.descriptor.sampleCount)!==null&&$!==void 0?$:1}get mipLevelCount(){var $;return this.descriptor&&($=this.descriptor.mipLevelCount)!==null&&$!==void 0?$:1}get dimension(){var $;return this.descriptor&&($=this.descriptor.dimension)!==null&&$!==void 0?$:"2d"}getMipLevelSize($){if($>=this.mipLevelCount)return[0,0,0];let Q=[this.width,this.height,this.depthOrArrayLayers];for(let J=0;J<Q.length;++J)Q[J]=Math.max(1,Q[J]>>$);return Q}get texelByteSize(){let $=this.format,Q=BU[$];return Q?Q.isDepthStencil?4:Q.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){let $=this.format,Q=BU[$];return!!Q&&Q.isDepthStencil}getGpuSize(){let $=this.format,Q=BU[$],J=this.width;if(!$||J<=0||!Q)return-1;let Z=this.height,K=this.depthOrArrayLayers,X=this.dimension;return J/Q.blockWidth*(X==="1d"?1:Z/Q.blockHeight)*Q.bytesPerBlock*K}getPixel($,Q,J=0,Z=0){let K=this.texelByteSize,X=this.bytesPerRow,Y=this.height,W=this.data[Z];return x51(new Uint8Array(W),$,Q,J,Z,Y,X,K,this.format)}setPixel($,Q,J,Z,K){let X=this.texelByteSize,Y=this.bytesPerRow,W=this.height,q=this.data[Z];(function(H,F,U,V,N,D,z,B,M,P){let O=V*(z>>=N)*(D>>=N)+U*z+F*B;switch(M){case"r8unorm":return void v1(H,O,"8unorm",1,P);case"r8snorm":return void v1(H,O,"8snorm",1,P);case"r8uint":return void v1(H,O,"8uint",1,P);case"r8sint":return void v1(H,O,"8sint",1,P);case"rg8unorm":return void v1(H,O,"8unorm",2,P);case"rg8snorm":return void v1(H,O,"8snorm",2,P);case"rg8uint":return void v1(H,O,"8uint",2,P);case"rg8sint":return void v1(H,O,"8sint",2,P);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void v1(H,O,"8unorm",4,P);case"rgba8snorm":return void v1(H,O,"8snorm",4,P);case"rgba8uint":return void v1(H,O,"8uint",4,P);case"rgba8sint":return void v1(H,O,"8sint",4,P);case"r16uint":return void v1(H,O,"16uint",1,P);case"r16sint":return void v1(H,O,"16sint",1,P);case"r16float":return void v1(H,O,"16float",1,P);case"rg16uint":return void v1(H,O,"16uint",2,P);case"rg16sint":return void v1(H,O,"16sint",2,P);case"rg16float":return void v1(H,O,"16float",2,P);case"rgba16uint":return void v1(H,O,"16uint",4,P);case"rgba16sint":return void v1(H,O,"16sint",4,P);case"rgba16float":return void v1(H,O,"16float",4,P);case"r32uint":return void v1(H,O,"32uint",1,P);case"r32sint":return void v1(H,O,"32sint",1,P);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void v1(H,O,"32float",1,P);case"rg32uint":return void v1(H,O,"32uint",2,P);case"rg32sint":return void v1(H,O,"32sint",2,P);case"rg32float":return void v1(H,O,"32float",2,P);case"rgba32uint":return void v1(H,O,"32uint",4,P);case"rgba32sint":return void v1(H,O,"32sint",4,P);case"rgba32float":return void v1(H,O,"32float",4,P);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(q),$,Q,J,Z,W,Y,X,this.format,K)}};(($)=>{$[$.token=0]="token",$[$.keyword=1]="keyword",$[$.reserved=2]="reserved"})(T||(T={}));j=k,k.none=new I("",T.reserved,""),k.eof=new I("EOF",T.token,""),k.reserved={asm:new I("asm",T.reserved,"asm"),bf16:new I("bf16",T.reserved,"bf16"),do:new I("do",T.reserved,"do"),enum:new I("enum",T.reserved,"enum"),f16:new I("f16",T.reserved,"f16"),f64:new I("f64",T.reserved,"f64"),handle:new I("handle",T.reserved,"handle"),i8:new I("i8",T.reserved,"i8"),i16:new I("i16",T.reserved,"i16"),i64:new I("i64",T.reserved,"i64"),mat:new I("mat",T.reserved,"mat"),premerge:new I("premerge",T.reserved,"premerge"),regardless:new I("regardless",T.reserved,"regardless"),typedef:new I("typedef",T.reserved,"typedef"),u8:new I("u8",T.reserved,"u8"),u16:new I("u16",T.reserved,"u16"),u64:new I("u64",T.reserved,"u64"),unless:new I("unless",T.reserved,"unless"),using:new I("using",T.reserved,"using"),vec:new I("vec",T.reserved,"vec"),void:new I("void",T.reserved,"void")},k.keywords={array:new I("array",T.keyword,"array"),atomic:new I("atomic",T.keyword,"atomic"),bool:new I("bool",T.keyword,"bool"),f32:new I("f32",T.keyword,"f32"),i32:new I("i32",T.keyword,"i32"),mat2x2:new I("mat2x2",T.keyword,"mat2x2"),mat2x3:new I("mat2x3",T.keyword,"mat2x3"),mat2x4:new I("mat2x4",T.keyword,"mat2x4"),mat3x2:new I("mat3x2",T.keyword,"mat3x2"),mat3x3:new I("mat3x3",T.keyword,"mat3x3"),mat3x4:new I("mat3x4",T.keyword,"mat3x4"),mat4x2:new I("mat4x2",T.keyword,"mat4x2"),mat4x3:new I("mat4x3",T.keyword,"mat4x3"),mat4x4:new I("mat4x4",T.keyword,"mat4x4"),ptr:new I("ptr",T.keyword,"ptr"),sampler:new I("sampler",T.keyword,"sampler"),sampler_comparison:new I("sampler_comparison",T.keyword,"sampler_comparison"),struct:new I("struct",T.keyword,"struct"),texture_1d:new I("texture_1d",T.keyword,"texture_1d"),texture_2d:new I("texture_2d",T.keyword,"texture_2d"),texture_2d_array:new I("texture_2d_array",T.keyword,"texture_2d_array"),texture_3d:new I("texture_3d",T.keyword,"texture_3d"),texture_cube:new I("texture_cube",T.keyword,"texture_cube"),texture_cube_array:new I("texture_cube_array",T.keyword,"texture_cube_array"),texture_multisampled_2d:new I("texture_multisampled_2d",T.keyword,"texture_multisampled_2d"),texture_storage_1d:new I("texture_storage_1d",T.keyword,"texture_storage_1d"),texture_storage_2d:new I("texture_storage_2d",T.keyword,"texture_storage_2d"),texture_storage_2d_array:new I("texture_storage_2d_array",T.keyword,"texture_storage_2d_array"),texture_storage_3d:new I("texture_storage_3d",T.keyword,"texture_storage_3d"),texture_depth_2d:new I("texture_depth_2d",T.keyword,"texture_depth_2d"),texture_depth_2d_array:new I("texture_depth_2d_array",T.keyword,"texture_depth_2d_array"),texture_depth_cube:new I("texture_depth_cube",T.keyword,"texture_depth_cube"),texture_depth_cube_array:new I("texture_depth_cube_array",T.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new I("texture_depth_multisampled_2d",T.keyword,"texture_depth_multisampled_2d"),texture_external:new I("texture_external",T.keyword,"texture_external"),u32:new I("u32",T.keyword,"u32"),vec2:new I("vec2",T.keyword,"vec2"),vec3:new I("vec3",T.keyword,"vec3"),vec4:new I("vec4",T.keyword,"vec4"),bitcast:new I("bitcast",T.keyword,"bitcast"),block:new I("block",T.keyword,"block"),break:new I("break",T.keyword,"break"),case:new I("case",T.keyword,"case"),continue:new I("continue",T.keyword,"continue"),continuing:new I("continuing",T.keyword,"continuing"),default:new I("default",T.keyword,"default"),diagnostic:new I("diagnostic",T.keyword,"diagnostic"),discard:new I("discard",T.keyword,"discard"),else:new I("else",T.keyword,"else"),enable:new I("enable",T.keyword,"enable"),fallthrough:new I("fallthrough",T.keyword,"fallthrough"),false:new I("false",T.keyword,"false"),fn:new I("fn",T.keyword,"fn"),for:new I("for",T.keyword,"for"),function:new I("function",T.keyword,"function"),if:new I("if",T.keyword,"if"),let:new I("let",T.keyword,"let"),const:new I("const",T.keyword,"const"),loop:new I("loop",T.keyword,"loop"),while:new I("while",T.keyword,"while"),private:new I("private",T.keyword,"private"),read:new I("read",T.keyword,"read"),read_write:new I("read_write",T.keyword,"read_write"),return:new I("return",T.keyword,"return"),requires:new I("requires",T.keyword,"requires"),storage:new I("storage",T.keyword,"storage"),switch:new I("switch",T.keyword,"switch"),true:new I("true",T.keyword,"true"),alias:new I("alias",T.keyword,"alias"),type:new I("type",T.keyword,"type"),uniform:new I("uniform",T.keyword,"uniform"),var:new I("var",T.keyword,"var"),override:new I("override",T.keyword,"override"),workgroup:new I("workgroup",T.keyword,"workgroup"),write:new I("write",T.keyword,"write"),r8unorm:new I("r8unorm",T.keyword,"r8unorm"),r8snorm:new I("r8snorm",T.keyword,"r8snorm"),r8uint:new I("r8uint",T.keyword,"r8uint"),r8sint:new I("r8sint",T.keyword,"r8sint"),r16uint:new I("r16uint",T.keyword,"r16uint"),r16sint:new I("r16sint",T.keyword,"r16sint"),r16float:new I("r16float",T.keyword,"r16float"),rg8unorm:new I("rg8unorm",T.keyword,"rg8unorm"),rg8snorm:new I("rg8snorm",T.keyword,"rg8snorm"),rg8uint:new I("rg8uint",T.keyword,"rg8uint"),rg8sint:new I("rg8sint",T.keyword,"rg8sint"),r32uint:new I("r32uint",T.keyword,"r32uint"),r32sint:new I("r32sint",T.keyword,"r32sint"),r32float:new I("r32float",T.keyword,"r32float"),rg16uint:new I("rg16uint",T.keyword,"rg16uint"),rg16sint:new I("rg16sint",T.keyword,"rg16sint"),rg16float:new I("rg16float",T.keyword,"rg16float"),rgba8unorm:new I("rgba8unorm",T.keyword,"rgba8unorm"),rgba8unorm_srgb:new I("rgba8unorm_srgb",T.keyword,"rgba8unorm_srgb"),rgba8snorm:new I("rgba8snorm",T.keyword,"rgba8snorm"),rgba8uint:new I("rgba8uint",T.keyword,"rgba8uint"),rgba8sint:new I("rgba8sint",T.keyword,"rgba8sint"),bgra8unorm:new I("bgra8unorm",T.keyword,"bgra8unorm"),bgra8unorm_srgb:new I("bgra8unorm_srgb",T.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new I("rgb10a2unorm",T.keyword,"rgb10a2unorm"),rg11b10float:new I("rg11b10float",T.keyword,"rg11b10float"),rg32uint:new I("rg32uint",T.keyword,"rg32uint"),rg32sint:new I("rg32sint",T.keyword,"rg32sint"),rg32float:new I("rg32float",T.keyword,"rg32float"),rgba16uint:new I("rgba16uint",T.keyword,"rgba16uint"),rgba16sint:new I("rgba16sint",T.keyword,"rgba16sint"),rgba16float:new I("rgba16float",T.keyword,"rgba16float"),rgba32uint:new I("rgba32uint",T.keyword,"rgba32uint"),rgba32sint:new I("rgba32sint",T.keyword,"rgba32sint"),rgba32float:new I("rgba32float",T.keyword,"rgba32float"),static_assert:new I("static_assert",T.keyword,"static_assert")},k.tokens={decimal_float_literal:new I("decimal_float_literal",T.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new I("hex_float_literal",T.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new I("int_literal",T.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new I("uint_literal",T.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new I("name",T.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new I("ident",T.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new I("and",T.token,"&"),and_and:new I("and_and",T.token,"&&"),arrow:new I("arrow ",T.token,"->"),attr:new I("attr",T.token,"@"),forward_slash:new I("forward_slash",T.token,"/"),bang:new I("bang",T.token,"!"),bracket_left:new I("bracket_left",T.token,"["),bracket_right:new I("bracket_right",T.token,"]"),brace_left:new I("brace_left",T.token,"{"),brace_right:new I("brace_right",T.token,"}"),colon:new I("colon",T.token,":"),comma:new I("comma",T.token,","),equal:new I("equal",T.token,"="),equal_equal:new I("equal_equal",T.token,"=="),not_equal:new I("not_equal",T.token,"!="),greater_than:new I("greater_than",T.token,">"),greater_than_equal:new I("greater_than_equal",T.token,">="),shift_right:new I("shift_right",T.token,">>"),less_than:new I("less_than",T.token,"<"),less_than_equal:new I("less_than_equal",T.token,"<="),shift_left:new I("shift_left",T.token,"<<"),modulo:new I("modulo",T.token,"%"),minus:new I("minus",T.token,"-"),minus_minus:new I("minus_minus",T.token,"--"),period:new I("period",T.token,"."),plus:new I("plus",T.token,"+"),plus_plus:new I("plus_plus",T.token,"++"),or:new I("or",T.token,"|"),or_or:new I("or_or",T.token,"||"),paren_left:new I("paren_left",T.token,"("),paren_right:new I("paren_right",T.token,")"),semicolon:new I("semicolon",T.token,";"),star:new I("star",T.token,"*"),tilde:new I("tilde",T.token,"~"),underscore:new I("underscore",T.token,"_"),xor:new I("xor",T.token,"^"),plus_equal:new I("plus_equal",T.token,"+="),minus_equal:new I("minus_equal",T.token,"-="),times_equal:new I("times_equal",T.token,"*="),division_equal:new I("division_equal",T.token,"/="),modulo_equal:new I("modulo_equal",T.token,"%="),and_equal:new I("and_equal",T.token,"&="),or_equal:new I("or_equal",T.token,"|="),xor_equal:new I("xor_equal",T.token,"^="),shift_right_equal:new I("shift_right_equal",T.token,">>="),shift_left_equal:new I("shift_left_equal",T.token,"<<=")},k.simpleTokens={"@":j.tokens.attr,"{":j.tokens.brace_left,"}":j.tokens.brace_right,":":j.tokens.colon,",":j.tokens.comma,"(":j.tokens.paren_left,")":j.tokens.paren_right,";":j.tokens.semicolon},k.literalTokens={"&":j.tokens.and,"&&":j.tokens.and_and,"->":j.tokens.arrow,"/":j.tokens.forward_slash,"!":j.tokens.bang,"[":j.tokens.bracket_left,"]":j.tokens.bracket_right,"=":j.tokens.equal,"==":j.tokens.equal_equal,"!=":j.tokens.not_equal,">":j.tokens.greater_than,">=":j.tokens.greater_than_equal,">>":j.tokens.shift_right,"<":j.tokens.less_than,"<=":j.tokens.less_than_equal,"<<":j.tokens.shift_left,"%":j.tokens.modulo,"-":j.tokens.minus,"--":j.tokens.minus_minus,".":j.tokens.period,"+":j.tokens.plus,"++":j.tokens.plus_plus,"|":j.tokens.or,"||":j.tokens.or_or,"*":j.tokens.star,"~":j.tokens.tilde,_:j.tokens.underscore,"^":j.tokens.xor,"+=":j.tokens.plus_equal,"-=":j.tokens.minus_equal,"*=":j.tokens.times_equal,"/=":j.tokens.division_equal,"%=":j.tokens.modulo_equal,"&=":j.tokens.and_equal,"|=":j.tokens.or_equal,"^=":j.tokens.xor_equal,">>=":j.tokens.shift_right_equal,"<<=":j.tokens.shift_left_equal},k.regexTokens={decimal_float_literal:j.tokens.decimal_float_literal,hex_float_literal:j.tokens.hex_float_literal,int_literal:j.tokens.int_literal,uint_literal:j.tokens.uint_literal,ident:j.tokens.ident},k.storage_class=[j.keywords.function,j.keywords.private,j.keywords.workgroup,j.keywords.uniform,j.keywords.storage],k.access_mode=[j.keywords.read,j.keywords.write,j.keywords.read_write],k.sampler_type=[j.keywords.sampler,j.keywords.sampler_comparison],k.sampled_texture_type=[j.keywords.texture_1d,j.keywords.texture_2d,j.keywords.texture_2d_array,j.keywords.texture_3d,j.keywords.texture_cube,j.keywords.texture_cube_array],k.multisampled_texture_type=[j.keywords.texture_multisampled_2d],k.storage_texture_type=[j.keywords.texture_storage_1d,j.keywords.texture_storage_2d,j.keywords.texture_storage_2d_array,j.keywords.texture_storage_3d],k.depth_texture_type=[j.keywords.texture_depth_2d,j.keywords.texture_depth_2d_array,j.keywords.texture_depth_cube,j.keywords.texture_depth_cube_array,j.keywords.texture_depth_multisampled_2d],k.texture_external_type=[j.keywords.texture_external],k.any_texture_type=[...j.sampled_texture_type,...j.multisampled_texture_type,...j.storage_texture_type,...j.depth_texture_type,...j.texture_external_type],k.texel_format=[j.keywords.r8unorm,j.keywords.r8snorm,j.keywords.r8uint,j.keywords.r8sint,j.keywords.r16uint,j.keywords.r16sint,j.keywords.r16float,j.keywords.rg8unorm,j.keywords.rg8snorm,j.keywords.rg8uint,j.keywords.rg8sint,j.keywords.r32uint,j.keywords.r32sint,j.keywords.r32float,j.keywords.rg16uint,j.keywords.rg16sint,j.keywords.rg16float,j.keywords.rgba8unorm,j.keywords.rgba8unorm_srgb,j.keywords.rgba8snorm,j.keywords.rgba8uint,j.keywords.rgba8sint,j.keywords.bgra8unorm,j.keywords.bgra8unorm_srgb,j.keywords.rgb10a2unorm,j.keywords.rg11b10float,j.keywords.rg32uint,j.keywords.rg32sint,j.keywords.rg32float,j.keywords.rgba16uint,j.keywords.rgba16sint,j.keywords.rgba16float,j.keywords.rgba32uint,j.keywords.rgba32sint,j.keywords.rgba32float],k.const_literal=[j.tokens.int_literal,j.tokens.uint_literal,j.tokens.decimal_float_literal,j.tokens.hex_float_literal,j.keywords.true,j.keywords.false],k.literal_or_ident=[j.tokens.ident,j.tokens.int_literal,j.tokens.uint_literal,j.tokens.decimal_float_literal,j.tokens.hex_float_literal,j.tokens.name],k.element_count_expression=[j.tokens.int_literal,j.tokens.uint_literal,j.tokens.ident],k.template_types=[j.keywords.vec2,j.keywords.vec3,j.keywords.vec4,j.keywords.mat2x2,j.keywords.mat2x3,j.keywords.mat2x4,j.keywords.mat3x2,j.keywords.mat3x3,j.keywords.mat3x4,j.keywords.mat4x2,j.keywords.mat4x3,j.keywords.mat4x4,j.keywords.atomic,j.keywords.bitcast,...j.any_texture_type],k.attribute_name=[j.tokens.ident,j.keywords.block,j.keywords.diagnostic],k.assignment_operators=[j.tokens.equal,j.tokens.plus_equal,j.tokens.minus_equal,j.tokens.times_equal,j.tokens.division_equal,j.tokens.modulo_equal,j.tokens.and_equal,j.tokens.or_equal,j.tokens.xor_equal,j.tokens.shift_right_equal,j.tokens.shift_left_equal],k.increment_operators=[j.tokens.plus_plus,j.tokens.minus_minus];PZ=new Float32Array(1),y51=new Uint32Array(PZ.buffer),f51=new Uint32Array(PZ.buffer),MZ=new Int32Array(1),b51=new Float32Array(MZ.buffer),m51=new Uint32Array(MZ.buffer),wZ=new Uint32Array(1),c51=new Float32Array(wZ.buffer),d51=new Int32Array(wZ.buffer);_6._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},_6._textureTypes=k.any_texture_type.map(($)=>$.name),_6._samplerTypes=k.sampler_type.map(($)=>$.name);RU={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},u0={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};L0=class L0 extends Bh{constructor($,Q){var J;super(),this.ast=$!=null?$:[],this.reflection=new _6,this.reflection.updateAST(this.ast),this.context=(J=Q==null?void 0:Q.clone())!==null&&J!==void 0?J:new oU,this.builtins=new Rh(this),this.typeInfo={bool:this.getTypeInfo(y.bool),i32:this.getTypeInfo(y.i32),u32:this.getTypeInfo(y.u32),f32:this.getTypeInfo(y.f32),f16:this.getTypeInfo(y.f16),vec2f:this.getTypeInfo(E.vec2f),vec2u:this.getTypeInfo(E.vec2u),vec2i:this.getTypeInfo(E.vec2i),vec2h:this.getTypeInfo(E.vec2h),vec3f:this.getTypeInfo(E.vec3f),vec3u:this.getTypeInfo(E.vec3u),vec3i:this.getTypeInfo(E.vec3i),vec3h:this.getTypeInfo(E.vec3h),vec4f:this.getTypeInfo(E.vec4f),vec4u:this.getTypeInfo(E.vec4u),vec4i:this.getTypeInfo(E.vec4i),vec4h:this.getTypeInfo(E.vec4h),mat2x2f:this.getTypeInfo(E.mat2x2f),mat2x3f:this.getTypeInfo(E.mat2x3f),mat2x4f:this.getTypeInfo(E.mat2x4f),mat3x2f:this.getTypeInfo(E.mat3x2f),mat3x3f:this.getTypeInfo(E.mat3x3f),mat3x4f:this.getTypeInfo(E.mat3x4f),mat4x2f:this.getTypeInfo(E.mat4x2f),mat4x3f:this.getTypeInfo(E.mat4x3f),mat4x4f:this.getTypeInfo(E.mat4x4f)}}getVariableValue($){var Q,J;let Z=(J=(Q=this.context.getVariable($))===null||Q===void 0?void 0:Q.value)!==null&&J!==void 0?J:null;if(Z===null)return null;if(Z instanceof w)return Z.value;if(Z instanceof R)return Array.from(Z.data);if(Z instanceof F1)return Array.from(Z.data);if(Z instanceof Y0&&Z.typeInfo instanceof H4){if(Z.typeInfo.format.name==="u32")return Array.from(new Uint32Array(Z.buffer,Z.offset,Z.typeInfo.count));if(Z.typeInfo.format.name==="i32")return Array.from(new Int32Array(Z.buffer,Z.offset,Z.typeInfo.count));if(Z.typeInfo.format.name==="f32")return Array.from(new Float32Array(Z.buffer,Z.offset,Z.typeInfo.count))}return console.error(`Unsupported return variable type ${Z.typeInfo.name}`),null}execute($){($=$!=null?$:{}).constants&&this._setOverrides($.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups($,Q,J,Z){let K=this.context.clone();(Z=Z!=null?Z:{}).constants&&this._setOverrides(Z.constants,K),this._execStatements(this.ast,K);let X=K.getFunction($);if(!X)return void console.error(`Function ${$} not found`);if(typeof Q=="number")Q=[Q,1,1];else{if(Q.length===0)return void console.error("Invalid dispatch count");Q.length===1?Q=[Q[0],1,1]:Q.length===2?Q=[Q[0],Q[1],1]:Q.length>3&&(Q=[Q[0],Q[1],Q[2]])}let Y=Q[0],W=Q[1],q=Q[2],H=this.getTypeInfo("vec3u");K.setVariable("@num_workgroups",new R(Q,H));let F=this.reflection.getFunctionInfo($);F===null&&console.error(`Function ${$} not found in reflection data`);for(let U in J)for(let V in J[U]){let N=J[U][V];K.variables.forEach((D)=>{var z;let B=D.node;if(B==null?void 0:B.attributes){let M=null,P=null;for(let O of B.attributes)O.name==="binding"?M=O.value:O.name==="group"&&(P=O.value);if(V==M&&U==P){let O=!1;for(let G of F.resources)if(G.name===D.name&&G.group===parseInt(U)&&G.binding===parseInt(V)){O=!0;break}if(O)if(N.texture!==void 0&&N.descriptor!==void 0){let G=new W4(N.texture,this.getTypeInfo(B.type),N.descriptor,(z=N.texture.view)!==null&&z!==void 0?z:null);D.value=G}else N.uniform!==void 0?D.value=new Y0(N.uniform,this.getTypeInfo(B.type)):D.value=new Y0(N,this.getTypeInfo(B.type))}}})}for(let U=0;U<q;++U)for(let V=0;V<W;++V)for(let N=0;N<Y;++N)K.setVariable("@workgroup_id",new R([N,V,U],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(X,[N,V,U],K)}execStatement($,Q){if($ instanceof xU)return this.evalExpression($.value,Q);if($ instanceof yU){if($.condition){let J=this.evalExpression($.condition,Q);if(!(J instanceof w))throw Error("Invalid break-if condition");if(!J.value)return null}return L0._breakObj}if($ instanceof fU)return L0._continueObj;if($ instanceof b9)this._let($,Q);else if($ instanceof v6)this._var($,Q);else if($ instanceof u2)this._const($,Q);else if($ instanceof c9)this._function($,Q);else{if($ instanceof _U)return this._if($,Q);if($ instanceof vU)return this._switch($,Q);if($ instanceof EU)return this._for($,Q);if($ instanceof GU)return this._while($,Q);if($ instanceof LU)return this._loop($,Q);if($ instanceof RZ){let J=Q.clone();return J.currentFunctionName=Q.currentFunctionName,this._execStatements($.body,J)}if($ instanceof hU)this._assign($,Q);else if($ instanceof jU)this._increment($,Q);else{if($ instanceof L6)return null;if($ instanceof SZ){let J=$.name;Q.getVariable(J)===null&&Q.setVariable(J,new w(0,this.getTypeInfo("u32")))}else if($ instanceof TZ)this._call($,Q);else{if($ instanceof gU)return null;if($ instanceof IZ)return null;console.error("Invalid statement type.",$,`Line ${$.line}`)}}}return null}evalExpression($,Q){return $ instanceof L5?this._evalBinaryOp($,Q):$ instanceof N0?this._evalLiteral($,Q):$ instanceof $5?this._evalVariable($,Q):$ instanceof GZ?this._evalCall($,Q):$ instanceof $6?this._evalCreate($,Q):$ instanceof bU?this._evalConst($,Q):$ instanceof mU?this._evalBitcast($,Q):$ instanceof H0?this._evalUnaryOp($,Q):(console.error("Invalid expression type",$,`Line ${$.line}`),null)}getTypeInfo($){var Q;if($ instanceof y){let Z=this.reflection.getTypeInfo($);if(Z!==null)return Z}let J=(Q=this.typeInfo[$])!==null&&Q!==void 0?Q:null;return J!==null||(J=this.reflection.getTypeInfoByName($)),J}_setOverrides($,Q){for(let J in $){let Z=$[J],K=this.reflection.getOverrideInfo(J);K!==null?(K.type===null&&(K.type=this.getTypeInfo("u32")),K.type.name==="u32"||K.type.name==="i32"||K.type.name==="f32"||K.type.name==="f16"?Q.setVariable(J,new w(Z,K.type)):K.type.name==="bool"?Q.setVariable(J,new w(Z?1:0,K.type)):K.type.name==="vec2"||K.type.name==="vec3"||K.type.name==="vec4"||K.type.name==="vec2f"||K.type.name==="vec3f"||K.type.name==="vec4f"||K.type.name==="vec2i"||K.type.name==="vec3i"||K.type.name==="vec4i"||K.type.name==="vec2u"||K.type.name==="vec3u"||K.type.name==="vec4u"||K.type.name==="vec2h"||K.type.name==="vec3h"||K.type.name==="vec4h"?Q.setVariable(J,new R(Z,K.type)):console.error(`Invalid constant type for ${J}`)):console.error(`Override ${J} does not exist in the shader.`)}}_dispatchWorkgroup($,Q,J){let Z=[1,1,1];for(let H of $.node.attributes)if(H.name==="workgroup_size"){if(H.value.length>0){let F=J.getVariableValue(H.value[0]);Z[0]=F instanceof w?F.value:parseInt(H.value[0])}if(H.value.length>1){let F=J.getVariableValue(H.value[1]);Z[1]=F instanceof w?F.value:parseInt(H.value[1])}if(H.value.length>2){let F=J.getVariableValue(H.value[2]);Z[2]=F instanceof w?F.value:parseInt(H.value[2])}}let K=this.getTypeInfo("vec3u"),X=this.getTypeInfo("u32");J.setVariable("@workgroup_size",new R(Z,K));let Y=Z[0],W=Z[1],q=Z[2];for(let H=0,F=0;H<q;++H)for(let U=0;U<W;++U)for(let V=0;V<Y;++V,++F){let N=[V,U,H],D=[V+Q[0]*Z[0],U+Q[1]*Z[1],H+Q[2]*Z[2]];J.setVariable("@local_invocation_id",new R(N,K)),J.setVariable("@global_invocation_id",new R(D,K)),J.setVariable("@local_invocation_index",new w(F,X)),this._dispatchExec($,J)}}_dispatchExec($,Q){for(let J of $.node.args)for(let Z of J.attributes)if(Z.name==="builtin"){let K=`@${Z.value}`,X=Q.getVariable(K);X!==void 0&&Q.variables.set(J.name,X)}this._execStatements($.node.body,Q)}getVariableName($,Q){for(;$ instanceof H0;)$=$.right;return $ instanceof $5?$.name:(console.error("Unknown variable type",$,"Line",$.line),null)}_execStatements($,Q){for(let J of $){if(J instanceof Array){let K=Q.clone(),X=this._execStatements(J,K);if(X)return X;continue}let Z=this.execStatement(J,Q);if(Z)return Z}return null}_call($,Q){let J=Q.clone();J.currentFunctionName=$.name;let Z=Q.getFunction($.name);if(Z){for(let K=0;K<Z.node.args.length;++K){let X=Z.node.args[K],Y=this.evalExpression($.args[K],J);J.setVariable(X.name,Y,X)}this._execStatements(Z.node.body,J)}else if($.isBuiltin)this._callBuiltinFunction($,J);else this.getTypeInfo($.name)&&this._evalCreate($,Q)}_increment($,Q){let J=this.getVariableName($.variable,Q),Z=Q.getVariable(J);Z?$.operator==="++"?Z.value instanceof w?Z.value.value++:console.error(`Variable ${J} is not a scalar. Line ${$.line}`):$.operator==="--"?Z.value instanceof w?Z.value.value--:console.error(`Variable ${J} is not a scalar. Line ${$.line}`):console.error(`Unknown increment operator ${$.operator}. Line ${$.line}`):console.error(`Variable ${J} not found. Line ${$.line}`)}_getVariableData($,Q){if($ instanceof $5){let J=this.getVariableName($,Q),Z=Q.getVariable(J);return Z===null?(console.error(`Variable ${J} not found. Line ${$.line}`),null):Z.value.getSubData(this,$.postfix,Q)}if($ instanceof H0){if($.operator==="*"){let J=this._getVariableData($.right,Q);return J instanceof z8?J.reference.getSubData(this,$.postfix,Q):(console.error(`Variable ${$.right} is not a pointer. Line ${$.line}`),null)}if($.operator==="&"){let J=this._getVariableData($.right,Q);return new z8(J)}}return null}_assign($,Q){let J=null,Z="<var>",K=null;if($.variable instanceof H0){let W=this._getVariableData($.variable,Q),q=this.evalExpression($.value,Q),H=$.operator;if(H==="="){if(W instanceof w||W instanceof R||W instanceof F1){if(q instanceof w||q instanceof R||q instanceof F1&&W.data.length===q.data.length)return void W.data.set(q.data);console.error(`Invalid assignment. Line ${$.line}`)}else if(W instanceof Y0&&q instanceof Y0&&W.buffer.byteLength-W.offset>=q.buffer.byteLength-q.offset)return void(W.buffer.byteLength%4==0?new Uint32Array(W.buffer,W.offset,W.typeInfo.size/4).set(new Uint32Array(q.buffer,q.offset,q.typeInfo.size/4)):new Uint8Array(W.buffer,W.offset,W.typeInfo.size).set(new Uint8Array(q.buffer,q.offset,q.typeInfo.size)));return console.error(`Invalid assignment. Line ${$.line}`),null}if(H==="+=")return W instanceof w||W instanceof R||W instanceof F1?q instanceof w||q instanceof R||q instanceof F1?void W.data.set(q.data.map((F,U)=>W.data[U]+F)):void console.error(`Invalid assignment . Line ${$.line}`):void console.error(`Invalid assignment. Line ${$.line}`);if(H==="-=")return(W instanceof w||W instanceof R||W instanceof F1)&&(q instanceof w||q instanceof R||q instanceof F1)?void W.data.set(q.data.map((F,U)=>W.data[U]-F)):void console.error(`Invalid assignment. Line ${$.line}`)}if($.variable instanceof H0){if($.variable.operator==="*"){Z=this.getVariableName($.variable.right,Q);let W=Q.getVariable(Z);if(!(W&&W.value instanceof z8))return void console.error(`Variable ${Z} is not a pointer. Line ${$.line}`);J=W.value.reference;let q=$.variable.postfix;if(!q){let H=$.variable.right;for(;H instanceof H0;){if(H.postfix){q=H.postfix;break}H=H.right}}q&&(J=J.getSubData(this,q,Q))}}else{K=$.variable.postfix,Z=this.getVariableName($.variable,Q);let W=Q.getVariable(Z);if(W===null)return void console.error(`Variable ${Z} not found. Line ${$.line}`);J=W.value}if(J instanceof z8&&(J=J.reference),J===null)return void console.error(`Variable ${Z} not found. Line ${$.line}`);let X=this.evalExpression($.value,Q),Y=$.operator;if(Y!=="="){let W=J.getSubData(this,K,Q);if(W instanceof R&&X instanceof w){let q=W.data,H=X.value;if(Y==="+=")for(let F=0;F<q.length;++F)q[F]+=H;else if(Y==="-=")for(let F=0;F<q.length;++F)q[F]-=H;else if(Y==="*=")for(let F=0;F<q.length;++F)q[F]*=H;else if(Y==="/=")for(let F=0;F<q.length;++F)q[F]/=H;else if(Y==="%=")for(let F=0;F<q.length;++F)q[F]%=H;else if(Y==="&=")for(let F=0;F<q.length;++F)q[F]&=H;else if(Y==="|=")for(let F=0;F<q.length;++F)q[F]|=H;else if(Y==="^=")for(let F=0;F<q.length;++F)q[F]^=H;else if(Y==="<<=")for(let F=0;F<q.length;++F)q[F]<<=H;else if(Y===">>=")for(let F=0;F<q.length;++F)q[F]>>=H;else console.error(`Invalid operator ${Y}. Line ${$.line}`)}else if(W instanceof R&&X instanceof R){let q=W.data,H=X.data;if(q.length!==H.length)return void console.error(`Vector length mismatch. Line ${$.line}`);if(Y==="+=")for(let F=0;F<q.length;++F)q[F]+=H[F];else if(Y==="-=")for(let F=0;F<q.length;++F)q[F]-=H[F];else if(Y==="*=")for(let F=0;F<q.length;++F)q[F]*=H[F];else if(Y==="/=")for(let F=0;F<q.length;++F)q[F]/=H[F];else if(Y==="%=")for(let F=0;F<q.length;++F)q[F]%=H[F];else if(Y==="&=")for(let F=0;F<q.length;++F)q[F]&=H[F];else if(Y==="|=")for(let F=0;F<q.length;++F)q[F]|=H[F];else if(Y==="^=")for(let F=0;F<q.length;++F)q[F]^=H[F];else if(Y==="<<=")for(let F=0;F<q.length;++F)q[F]<<=H[F];else if(Y===">>=")for(let F=0;F<q.length;++F)q[F]>>=H[F];else console.error(`Invalid operator ${Y}. Line ${$.line}`)}else{if(!(W instanceof w&&X instanceof w))return void console.error(`Invalid type for ${$.operator} operator. Line ${$.line}`);Y==="+="?W.value+=X.value:Y==="-="?W.value-=X.value:Y==="*="?W.value*=X.value:Y==="/="?W.value/=X.value:Y==="%="?W.value%=X.value:Y==="&="?W.value&=X.value:Y==="|="?W.value|=X.value:Y==="^="?W.value^=X.value:Y==="<<="?W.value<<=X.value:Y===">>="?W.value>>=X.value:console.error(`Invalid operator ${Y}. Line ${$.line}`)}return void(J instanceof Y0&&J.setDataValue(this,W,K,Q))}if(J instanceof Y0)J.setDataValue(this,X,K,Q);else if(K){if(!(J instanceof R||J instanceof F1))return void console.error(`Variable ${Z} is not a vector or matrix. Line ${$.line}`);if(K instanceof k8){let W=this.evalExpression(K.index,Q).value;if(J instanceof R){if(!(X instanceof w))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[W]=X.value}else{if(!(J instanceof F1))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);{let q=this.evalExpression(K.index,Q).value;if(q<0)return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);if(!(X instanceof R))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);{let H=J.typeInfo.getTypeName();if(H==="mat2x2"||H==="mat2x2f"||H==="mat2x2h"){if(!(q<2&&X.data.length===2))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[2*q]=X.data[0],J.data[2*q+1]=X.data[1]}else if(H==="mat2x3"||H==="mat2x3f"||H==="mat2x3h"){if(!(q<2&&X.data.length===3))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[3*q]=X.data[0],J.data[3*q+1]=X.data[1],J.data[3*q+2]=X.data[2]}else if(H==="mat2x4"||H==="mat2x4f"||H==="mat2x4h"){if(!(q<2&&X.data.length===4))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[4*q]=X.data[0],J.data[4*q+1]=X.data[1],J.data[4*q+2]=X.data[2],J.data[4*q+3]=X.data[3]}else if(H==="mat3x2"||H==="mat3x2f"||H==="mat3x2h"){if(!(q<3&&X.data.length===2))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[2*q]=X.data[0],J.data[2*q+1]=X.data[1]}else if(H==="mat3x3"||H==="mat3x3f"||H==="mat3x3h"){if(!(q<3&&X.data.length===3))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[3*q]=X.data[0],J.data[3*q+1]=X.data[1],J.data[3*q+2]=X.data[2]}else if(H==="mat3x4"||H==="mat3x4f"||H==="mat3x4h"){if(!(q<3&&X.data.length===4))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[4*q]=X.data[0],J.data[4*q+1]=X.data[1],J.data[4*q+2]=X.data[2],J.data[4*q+3]=X.data[3]}else if(H==="mat4x2"||H==="mat4x2f"||H==="mat4x2h"){if(!(q<4&&X.data.length===2))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[2*q]=X.data[0],J.data[2*q+1]=X.data[1]}else if(H==="mat4x3"||H==="mat4x3f"||H==="mat4x3h"){if(!(q<4&&X.data.length===3))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[3*q]=X.data[0],J.data[3*q+1]=X.data[1],J.data[3*q+2]=X.data[2]}else{if(H!=="mat4x4"&&H!=="mat4x4f"&&H!=="mat4x4h")return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);if(!(q<4&&X.data.length===4))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);J.data[4*q]=X.data[0],J.data[4*q+1]=X.data[1],J.data[4*q+2]=X.data[2],J.data[4*q+3]=X.data[3]}}}}}else if(K instanceof D7){let W=K.value;if(!(J instanceof R))return void console.error(`Invalid assignment to ${W}. Variable ${Z} is not a vector. Line ${$.line}`);if(X instanceof w){if(W.length>1)return void console.error(`Invalid assignment to ${W} for variable ${Z}. Line ${$.line}`);if(W==="x")J.data[0]=X.value;else if(W==="y"){if(J.data.length<2)return void console.error(`Invalid assignment to ${W} for variable ${Z}. Line ${$.line}`);J.data[1]=X.value}else if(W==="z"){if(J.data.length<3)return void console.error(`Invalid assignment to ${W} for variable ${Z}. Line ${$.line}`);J.data[2]=X.value}else if(W==="w"){if(J.data.length<4)return void console.error(`Invalid assignment to ${W} for variable ${Z}. Line ${$.line}`);J.data[3]=X.value}}else{if(!(X instanceof R))return void console.error(`Invalid assignment to ${Z}. Line ${$.line}`);if(W.length!==X.data.length)return void console.error(`Invalid assignment to ${W} for variable ${Z}. Line ${$.line}`);for(let q=0;q<W.length;++q){let H=W[q];if(H==="x"||H==="r")J.data[0]=X.data[q];else if(H==="y"||H==="g"){if(X.data.length<2)return void console.error(`Invalid assignment to ${H} for variable ${Z}. Line ${$.line}`);J.data[1]=X.data[q]}else if(H==="z"||H==="b"){if(X.data.length<3)return void console.error(`Invalid assignment to ${H} for variable ${Z}. Line ${$.line}`);J.data[2]=X.data[q]}else{if(H!=="w"&&H!=="a")return void console.error(`Invalid assignment to ${H} for variable ${Z}. Line ${$.line}`);if(X.data.length<4)return void console.error(`Invalid assignment to ${H} for variable ${Z}. Line ${$.line}`);J.data[3]=X.data[q]}}}}}else J instanceof w&&X instanceof w?J.value=X.value:J instanceof R&&X instanceof R||J instanceof F1&&X instanceof F1?J.data.set(X.data):console.error(`Invalid assignment to ${Z}. Line ${$.line}`)}_function($,Q){let J=new sU($);Q.functions.set($.name,J)}_const($,Q){let J=null;$.value!==null&&(J=this.evalExpression($.value,Q)),Q.createVariable($.name,J,$)}_let($,Q){let J=null;if($.value!==null){if(J=this.evalExpression($.value,Q),J===null)return void console.error(`Invalid value for variable ${$.name}. Line ${$.line}`);$.value instanceof H0||(J=J.clone())}else{let Z=$.type.name;if(Z==="f32"||Z==="i32"||Z==="u32"||Z==="bool"||Z==="f16"||Z==="vec2"||Z==="vec3"||Z==="vec4"||Z==="vec2f"||Z==="vec3f"||Z==="vec4f"||Z==="vec2i"||Z==="vec3i"||Z==="vec4i"||Z==="vec2u"||Z==="vec3u"||Z==="vec4u"||Z==="vec2h"||Z==="vec3h"||Z==="vec4h"||Z==="vec2b"||Z==="vec3b"||Z==="vec4b"||Z==="mat2x2"||Z==="mat2x3"||Z==="mat2x4"||Z==="mat3x2"||Z==="mat3x3"||Z==="mat3x4"||Z==="mat4x2"||Z==="mat4x3"||Z==="mat4x4"||Z==="mat2x2f"||Z==="mat2x3f"||Z==="mat2x4f"||Z==="mat3x2f"||Z==="mat3x3f"||Z==="mat3x4f"||Z==="mat4x2f"||Z==="mat4x3f"||Z==="mat4x4f"||Z==="mat2x2h"||Z==="mat2x3h"||Z==="mat2x4h"||Z==="mat3x2h"||Z==="mat3x3h"||Z==="mat3x4h"||Z==="mat4x2h"||Z==="mat4x3h"||Z==="mat4x4h"||Z==="array"){let K=new $6($.type,[]);J=this._evalCreate(K,Q)}}Q.createVariable($.name,J,$)}_var($,Q){let J=null;if($.value!==null){if(J=this.evalExpression($.value,Q),J===null)return void console.error(`Invalid value for variable ${$.name}. Line ${$.line}`);$.value instanceof H0||(J=J.clone())}else{if($.type===null)return void console.error(`Variable ${$.name} has no type. Line ${$.line}`);let Z=$.type.name;if(Z==="f32"||Z==="i32"||Z==="u32"||Z==="bool"||Z==="f16"||Z==="vec2"||Z==="vec3"||Z==="vec4"||Z==="vec2f"||Z==="vec3f"||Z==="vec4f"||Z==="vec2i"||Z==="vec3i"||Z==="vec4i"||Z==="vec2u"||Z==="vec3u"||Z==="vec4u"||Z==="vec2h"||Z==="vec3h"||Z==="vec4h"||Z==="vec2b"||Z==="vec3b"||Z==="vec4b"||Z==="mat2x2"||Z==="mat2x3"||Z==="mat2x4"||Z==="mat3x2"||Z==="mat3x3"||Z==="mat3x4"||Z==="mat4x2"||Z==="mat4x3"||Z==="mat4x4"||Z==="mat2x2f"||Z==="mat2x3f"||Z==="mat2x4f"||Z==="mat3x2f"||Z==="mat3x3f"||Z==="mat3x4f"||Z==="mat4x2f"||Z==="mat4x3f"||Z==="mat4x4f"||Z==="mat2x2h"||Z==="mat2x3h"||Z==="mat2x4h"||Z==="mat3x2h"||Z==="mat3x3h"||Z==="mat3x4h"||Z==="mat4x2h"||Z==="mat4x3h"||Z==="mat4x4h"||$.type instanceof m9||$.type instanceof L6||$.type instanceof E){let K=new $6($.type,[]);J=this._evalCreate(K,Q)}}Q.createVariable($.name,J,$)}_switch($,Q){Q=Q.clone();let J=this.evalExpression($.condition,Q);if(!(J instanceof w))return console.error(`Invalid if condition. Line ${$.line}`),null;let Z=null;for(let K of $.cases)if(K instanceof lU)for(let X of K.selectors){if(X instanceof n2){Z=K;continue}let Y=this.evalExpression(X,Q);if(!(Y instanceof w))return console.error(`Invalid case selector. Line ${$.line}`),null;if(Y.value===J.value)return this._execStatements(K.body,Q)}else K instanceof pU&&(Z=K);return Z?this._execStatements(Z.body,Q):null}_if($,Q){Q=Q.clone();let J=this.evalExpression($.condition,Q);if(!(J instanceof w))return console.error(`Invalid if condition. Line ${$.line}`),null;if(J.value)return this._execStatements($.body,Q);for(let Z of $.elseif){let K=this.evalExpression(Z.condition,Q);if(!(K instanceof w))return console.error(`Invalid if condition. Line ${$.line}`),null;if(K.value)return this._execStatements(Z.body,Q)}return $.else?this._execStatements($.else,Q):null}_getScalarValue($){return $ instanceof w?$.value:(console.error("Expected scalar value.",$),0)}_for($,Q){for(Q=Q.clone(),this.execStatement($.init,Q);this._getScalarValue(this.evalExpression($.condition,Q));){let J=this._execStatements($.body,Q);if(J===L0._breakObj)break;if(J!==null&&J!==L0._continueObj)return J;this.execStatement($.increment,Q)}return null}_loop($,Q){for(Q=Q.clone();;){let J=this._execStatements($.body,Q);if(J===L0._breakObj)break;if(J===L0._continueObj){if($.continuing){if(this._execStatements($.continuing.body,Q)===L0._breakObj)break}}else if(J!==null)return J}return null}_while($,Q){for(Q=Q.clone();this._getScalarValue(this.evalExpression($.condition,Q));){let J=this._execStatements($.body,Q);if(J===L0._breakObj)break;if(J!==L0._continueObj&&J!==null)return J}return null}_evalBitcast($,Q){let J=this.evalExpression($.value,Q),Z=$.type;if(J instanceof w){let K=Jh(J.value,J.typeInfo.name,Z.name);return new w(K,this.getTypeInfo(Z))}if(J instanceof R){let K=J.typeInfo.getTypeName(),X="";if(K.endsWith("f"))X="f32";else if(K.endsWith("i"))X="i32";else if(K.endsWith("u"))X="u32";else if(K.endsWith("b"))X="bool";else{if(!K.endsWith("h"))return console.error(`Unknown vector type ${K}. Line ${$.line}`),null;X="f16"}let Y=Z.getTypeName(),W="";if(Y.endsWith("f"))W="f32";else if(Y.endsWith("i"))W="i32";else if(Y.endsWith("u"))W="u32";else if(Y.endsWith("b"))W="bool";else{if(!Y.endsWith("h"))return console.error(`Unknown vector type ${W}. Line ${$.line}`),null;W="f16"}let q=function(H,F,U){if(F===U)return H;let V=Array(H.length);for(let N=0;N<H.length;N++)V[N]=Jh(H[N],F,U);return V}(Array.from(J.data),X,W);return new R(q,this.getTypeInfo(Z))}return console.error(`TODO: bitcast for ${J.typeInfo.name}. Line ${$.line}`),null}_evalConst($,Q){return Q.getVariableValue($.name).clone().getSubData(this,$.postfix,Q)}_evalCreate($,Q){var J;if($ instanceof $6){if($.type===null)return OZ.void;switch($.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue($,Q);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec($,Q);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix($,Q)}}let Z=$ instanceof $6?$.type.name:$.name,K=$ instanceof $6?this.getTypeInfo($.type):this.getTypeInfo($.name);if(K===null)return console.error(`Unknown type ${Z}. Line ${$.line}`),null;if(K.size===0)return null;let X=new Y0(new ArrayBuffer(K.size),K,0);if(K instanceof q4){if($.args)for(let Y=0;Y<$.args.length;++Y){let W=K.members[Y],q=$.args[Y],H=this.evalExpression(q,Q);X.setData(this,H,W.type,W.offset,Q)}}else if(K instanceof H4){let Y=0;if($.args)for(let W=0;W<$.args.length;++W){let q=$.args[W],H=this.evalExpression(q,Q);K.format===null&&(((J=H.typeInfo)===null||J===void 0?void 0:J.name)==="x32"?K.format=this.getTypeInfo("i32"):K.format=H.typeInfo),X.setData(this,H,K.format,Y,Q),Y+=K.stride}}else console.error(`Unknown type "${Z}". Line ${$.line}`);return $ instanceof $6?X.getSubData(this,$.postfix,Q):X}_evalLiteral($,Q){let J=this.getTypeInfo($.type),Z=J.name;if(Z==="x32"||Z==="u32"||Z==="f32"||Z==="f16"||Z==="i32"||Z==="bool")return new w($.scalarValue,J);return Z==="vec2"||Z==="vec3"||Z==="vec4"||Z==="vec2f"||Z==="vec3f"||Z==="vec4f"||Z==="vec2h"||Z==="vec3h"||Z==="vec4h"||Z==="vec2i"||Z==="vec3i"||Z==="vec4i"||Z==="vec2u"||Z==="vec3u"||Z==="vec4u"?this._callConstructorVec($,Q):Z==="mat2x2"||Z==="mat2x3"||Z==="mat2x4"||Z==="mat3x2"||Z==="mat3x3"||Z==="mat3x4"||Z==="mat4x2"||Z==="mat4x3"||Z==="mat4x4"||Z==="mat2x2f"||Z==="mat2x3f"||Z==="mat2x4f"||Z==="mat3x2f"||Z==="mat3x3f"||Z==="mat3x4f"||Z==="mat4x2f"||Z==="mat4x3f"||Z==="mat4x4f"||Z==="mat2x2h"||Z==="mat2x3h"||Z==="mat2x4h"||Z==="mat3x2h"||Z==="mat3x3h"||Z==="mat3x4h"||Z==="mat4x2h"||Z==="mat4x3h"||Z==="mat4x4h"?this._callConstructorMatrix($,Q):$.value}_evalVariable($,Q){let J=Q.getVariableValue($.name);return J===null?J:J.getSubData(this,$.postfix,Q)}_maxFormatTypeInfo($){let Q=$[0];if(Q.name==="f32")return Q;for(let J=1;J<$.length;++J){let Z=L0._priority.get(Q.name);L0._priority.get($[J].name)<Z&&(Q=$[J])}return Q.name==="x32"?this.getTypeInfo("i32"):Q}_evalUnaryOp($,Q){let J=this.evalExpression($.right,Q);if($.operator==="&")return new z8(J);if($.operator==="*")return J instanceof z8?J.reference.getSubData(this,$.postfix,Q):(console.error(`Invalid dereference. Line ${$.line}`),null);let Z=J instanceof w?J.value:J instanceof R?Array.from(J.data):null;switch($.operator){case"+":{if(s(Z)){let Y=Z.map((W,q)=>+W);return new R(Y,J.typeInfo)}let K=Z,X=this._maxFormatTypeInfo([J.typeInfo,J.typeInfo]);return new w(+K,X)}case"-":{if(s(Z)){let Y=Z.map((W,q)=>-W);return new R(Y,J.typeInfo)}let K=Z,X=this._maxFormatTypeInfo([J.typeInfo,J.typeInfo]);return new w(-K,X)}case"!":{if(s(Z)){let Y=Z.map((W,q)=>W?0:1);return new R(Y,J.typeInfo)}let K=Z,X=this._maxFormatTypeInfo([J.typeInfo,J.typeInfo]);return new w(K?0:1,X)}case"~":{if(s(Z)){let Y=Z.map((W,q)=>~W);return new R(Y,J.typeInfo)}let K=Z,X=this._maxFormatTypeInfo([J.typeInfo,J.typeInfo]);return new w(~K,X)}}return console.error(`Invalid unary operator ${$.operator}. Line ${$.line}`),null}_evalBinaryOp($,Q){let J=this.evalExpression($.left,Q),Z=this.evalExpression($.right,Q),K=J instanceof w?J.value:J instanceof R||J instanceof F1?Array.from(J.data):null,X=Z instanceof w?Z.value:Z instanceof R||Z instanceof F1?Array.from(Z.data):null;switch($.operator){case"+":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V+F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U+H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H+U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y+W,q)}case"-":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V-F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U-H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H-U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y-W,q)}case"*":{if(s(K)&&s(X)){let H=K,F=X;if(J instanceof F1&&Z instanceof F1){let U=function(z,B,M,P){if(u0[B.name]===void 0||u0[P.name]===void 0)return null;let O=u0[B.name][0],G=u0[B.name][1],L=u0[P.name][0];if(O!==u0[P.name][1])return null;let b=Array(L*G);for(let d=0;d<G;d++)for(let p=0;p<L;p++){let i=0;for(let l=0;l<O;l++)i+=z[l*G+d]*M[p*O+l];b[d*L+p]=i}return b}(H,J.typeInfo,F,Z.typeInfo);if(U===null)return console.error(`Matrix multiplication failed. Line ${$.line}.`),null;let V=u0[Z.typeInfo.name][0],N=u0[J.typeInfo.name][1],D=this.getTypeInfo(`mat${V}x${N}f`);return new F1(U,D)}if(J instanceof F1&&Z instanceof R){let U=function(V,N,D,z){if(u0[N.name]===void 0||RU[z.name]===void 0)return null;let B=u0[N.name][0],M=u0[N.name][1];if(B!==D.length)return null;let P=Array(M);for(let O=0;O<M;O++){let G=0;for(let L=0;L<B;L++)G+=V[L*M+O]*D[L];P[O]=G}return P}(H,J.typeInfo,F,Z.typeInfo);return U===null?(console.error(`Matrix vector multiplication failed. Line ${$.line}.`),null):new R(U,Z.typeInfo)}if(J instanceof R&&Z instanceof F1){let U=function(V,N,D,z){if(RU[N.name]===void 0||u0[z.name]===void 0)return null;let B=u0[z.name][0],M=u0[z.name][1];if(M!==V.length)return null;let P=[];for(let O=0;O<B;O++){let G=0;for(let L=0;L<M;L++)G+=V[L]*D[L*B+O];P[O]=G}return P}(H,J.typeInfo,F,Z.typeInfo);return U===null?(console.error(`Matrix vector multiplication failed. Line ${$.line}.`),null):new R(U,J.typeInfo)}{if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V*F[N]);return new R(U,J.typeInfo)}}if(s(K)){let H=X,F=K.map((U,V)=>U*H);return J instanceof F1?new F1(F,J.typeInfo):new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H*U);return Z instanceof F1?new F1(F,Z.typeInfo):new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y*W,q)}case"%":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V%F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U%H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H%U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y%W,q)}case"/":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V/F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U/H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H/U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y/W,q)}case"&":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V&F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U&H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H&U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y&W,q)}case"|":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V|F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U|H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H|U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y|W,q)}case"^":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V^F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U^H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H^U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y^W,q)}case"<<":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V<<F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U<<H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H<<U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y<<W,q)}case">>":{if(s(K)&&s(X)){let H=K,F=X;if(H.length!==F.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let U=H.map((V,N)=>V>>F[N]);return new R(U,J.typeInfo)}if(s(K)){let H=X,F=K.map((U,V)=>U>>H);return new R(F,J.typeInfo)}if(s(X)){let H=K,F=X.map((U,V)=>H>>U);return new R(F,Z.typeInfo)}let Y=K,W=X,q=this._maxFormatTypeInfo([J.typeInfo,Z.typeInfo]);return new w(Y>>W,q)}case">":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H>W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q>Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y>q?1:0);return new R(W,Z.typeInfo)}return new w(K>X?1:0,this.getTypeInfo("bool"));case"<":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H<W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q<Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y<q?1:0);return new R(W,Z.typeInfo)}return new w(K<X?1:0,this.getTypeInfo("bool"));case"==":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H===W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q==Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y==q?1:0);return new R(W,Z.typeInfo)}return new w(K===X?1:0,this.getTypeInfo("bool"));case"!=":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H!==W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q!==Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y!==q?1:0);return new R(W,Z.typeInfo)}return new w(K!==X?1:0,this.getTypeInfo("bool"));case">=":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H>=W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q>=Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y>=q?1:0);return new R(W,Z.typeInfo)}return new w(K>=X?1:0,this.getTypeInfo("bool"));case"<=":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H<=W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q<=Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y<=q?1:0);return new R(W,Z.typeInfo)}return new w(K<=X?1:0,this.getTypeInfo("bool"));case"&&":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H&&W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q&&Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y&&q?1:0);return new R(W,Z.typeInfo)}return new w(K&&X?1:0,this.getTypeInfo("bool"));case"||":if(s(K)&&s(X)){let Y=K,W=X;if(Y.length!==W.length)return console.error(`Vector length mismatch. Line ${$.line}.`),null;let q=Y.map((H,F)=>H||W[F]?1:0);return new R(q,J.typeInfo)}if(s(K)){let Y=X,W=K.map((q,H)=>q||Y?1:0);return new R(W,J.typeInfo)}if(s(X)){let Y=K,W=X.map((q,H)=>Y||q?1:0);return new R(W,Z.typeInfo)}return new w(K||X?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${$.operator}. Line ${$.line}`),null}_evalCall($,Q){if($.cachedReturnValue!==null)return $.cachedReturnValue;let J=Q.clone();J.currentFunctionName=$.name;let Z=Q.getFunction($.name);if(!Z){if($.isBuiltin)return this._callBuiltinFunction($,J);return this.getTypeInfo($.name)?this._evalCreate($,Q):(console.error(`Unknown function "${$.name}". Line ${$.line}`),null)}for(let K=0;K<Z.node.args.length;++K){let X=Z.node.args[K],Y=this.evalExpression($.args[K],J);J.createVariable(X.name,Y,X)}return this._execStatements(Z.node.body,J)}_callBuiltinFunction($,Q){switch($.name){case"all":return this.builtins.All($,Q);case"any":return this.builtins.Any($,Q);case"select":return this.builtins.Select($,Q);case"arrayLength":return this.builtins.ArrayLength($,Q);case"abs":return this.builtins.Abs($,Q);case"acos":return this.builtins.Acos($,Q);case"acosh":return this.builtins.Acosh($,Q);case"asin":return this.builtins.Asin($,Q);case"asinh":return this.builtins.Asinh($,Q);case"atan":return this.builtins.Atan($,Q);case"atanh":return this.builtins.Atanh($,Q);case"atan2":return this.builtins.Atan2($,Q);case"ceil":return this.builtins.Ceil($,Q);case"clamp":return this.builtins.Clamp($,Q);case"cos":return this.builtins.Cos($,Q);case"cosh":return this.builtins.Cosh($,Q);case"countLeadingZeros":return this.builtins.CountLeadingZeros($,Q);case"countOneBits":return this.builtins.CountOneBits($,Q);case"countTrailingZeros":return this.builtins.CountTrailingZeros($,Q);case"cross":return this.builtins.Cross($,Q);case"degrees":return this.builtins.Degrees($,Q);case"determinant":return this.builtins.Determinant($,Q);case"distance":return this.builtins.Distance($,Q);case"dot":return this.builtins.Dot($,Q);case"dot4U8Packed":return this.builtins.Dot4U8Packed($,Q);case"dot4I8Packed":return this.builtins.Dot4I8Packed($,Q);case"exp":return this.builtins.Exp($,Q);case"exp2":return this.builtins.Exp2($,Q);case"extractBits":return this.builtins.ExtractBits($,Q);case"faceForward":return this.builtins.FaceForward($,Q);case"firstLeadingBit":return this.builtins.FirstLeadingBit($,Q);case"firstTrailingBit":return this.builtins.FirstTrailingBit($,Q);case"floor":return this.builtins.Floor($,Q);case"fma":return this.builtins.Fma($,Q);case"fract":return this.builtins.Fract($,Q);case"frexp":return this.builtins.Frexp($,Q);case"insertBits":return this.builtins.InsertBits($,Q);case"inverseSqrt":return this.builtins.InverseSqrt($,Q);case"ldexp":return this.builtins.Ldexp($,Q);case"length":return this.builtins.Length($,Q);case"log":return this.builtins.Log($,Q);case"log2":return this.builtins.Log2($,Q);case"max":return this.builtins.Max($,Q);case"min":return this.builtins.Min($,Q);case"mix":return this.builtins.Mix($,Q);case"modf":return this.builtins.Modf($,Q);case"normalize":return this.builtins.Normalize($,Q);case"pow":return this.builtins.Pow($,Q);case"quantizeToF16":return this.builtins.QuantizeToF16($,Q);case"radians":return this.builtins.Radians($,Q);case"reflect":return this.builtins.Reflect($,Q);case"refract":return this.builtins.Refract($,Q);case"reverseBits":return this.builtins.ReverseBits($,Q);case"round":return this.builtins.Round($,Q);case"saturate":return this.builtins.Saturate($,Q);case"sign":return this.builtins.Sign($,Q);case"sin":return this.builtins.Sin($,Q);case"sinh":return this.builtins.Sinh($,Q);case"smoothstep":return this.builtins.SmoothStep($,Q);case"sqrt":return this.builtins.Sqrt($,Q);case"step":return this.builtins.Step($,Q);case"tan":return this.builtins.Tan($,Q);case"tanh":return this.builtins.Tanh($,Q);case"transpose":return this.builtins.Transpose($,Q);case"trunc":return this.builtins.Trunc($,Q);case"dpdx":return this.builtins.Dpdx($,Q);case"dpdxCoarse":return this.builtins.DpdxCoarse($,Q);case"dpdxFine":return this.builtins.DpdxFine($,Q);case"dpdy":return this.builtins.Dpdy($,Q);case"dpdyCoarse":return this.builtins.DpdyCoarse($,Q);case"dpdyFine":return this.builtins.DpdyFine($,Q);case"fwidth":return this.builtins.Fwidth($,Q);case"fwidthCoarse":return this.builtins.FwidthCoarse($,Q);case"fwidthFine":return this.builtins.FwidthFine($,Q);case"textureDimensions":return this.builtins.TextureDimensions($,Q);case"textureGather":return this.builtins.TextureGather($,Q);case"textureGatherCompare":return this.builtins.TextureGatherCompare($,Q);case"textureLoad":return this.builtins.TextureLoad($,Q);case"textureNumLayers":return this.builtins.TextureNumLayers($,Q);case"textureNumLevels":return this.builtins.TextureNumLevels($,Q);case"textureNumSamples":return this.builtins.TextureNumSamples($,Q);case"textureSample":return this.builtins.TextureSample($,Q);case"textureSampleBias":return this.builtins.TextureSampleBias($,Q);case"textureSampleCompare":return this.builtins.TextureSampleCompare($,Q);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel($,Q);case"textureSampleGrad":return this.builtins.TextureSampleGrad($,Q);case"textureSampleLevel":return this.builtins.TextureSampleLevel($,Q);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge($,Q);case"textureStore":return this.builtins.TextureStore($,Q);case"atomicLoad":return this.builtins.AtomicLoad($,Q);case"atomicStore":return this.builtins.AtomicStore($,Q);case"atomicAdd":return this.builtins.AtomicAdd($,Q);case"atomicSub":return this.builtins.AtomicSub($,Q);case"atomicMax":return this.builtins.AtomicMax($,Q);case"atomicMin":return this.builtins.AtomicMin($,Q);case"atomicAnd":return this.builtins.AtomicAnd($,Q);case"atomicOr":return this.builtins.AtomicOr($,Q);case"atomicXor":return this.builtins.AtomicXor($,Q);case"atomicExchange":return this.builtins.AtomicExchange($,Q);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak($,Q);case"pack4x8snorm":return this.builtins.Pack4x8snorm($,Q);case"pack4x8unorm":return this.builtins.Pack4x8unorm($,Q);case"pack4xI8":return this.builtins.Pack4xI8($,Q);case"pack4xU8":return this.builtins.Pack4xU8($,Q);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp($,Q);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp($,Q);case"pack2x16snorm":return this.builtins.Pack2x16snorm($,Q);case"pack2x16unorm":return this.builtins.Pack2x16unorm($,Q);case"pack2x16float":return this.builtins.Pack2x16float($,Q);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm($,Q);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm($,Q);case"unpack4xI8":return this.builtins.Unpack4xI8($,Q);case"unpack4xU8":return this.builtins.Unpack4xU8($,Q);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm($,Q);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm($,Q);case"unpack2x16float":return this.builtins.Unpack2x16float($,Q);case"storageBarrier":return this.builtins.StorageBarrier($,Q);case"textureBarrier":return this.builtins.TextureBarrier($,Q);case"workgroupBarrier":return this.builtins.WorkgroupBarrier($,Q);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad($,Q);case"subgroupAdd":return this.builtins.SubgroupAdd($,Q);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd($,Q);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd($,Q);case"subgroupAll":return this.builtins.SubgroupAll($,Q);case"subgroupAnd":return this.builtins.SubgroupAnd($,Q);case"subgroupAny":return this.builtins.SubgroupAny($,Q);case"subgroupBallot":return this.builtins.SubgroupBallot($,Q);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast($,Q);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst($,Q);case"subgroupElect":return this.builtins.SubgroupElect($,Q);case"subgroupMax":return this.builtins.SubgroupMax($,Q);case"subgroupMin":return this.builtins.SubgroupMin($,Q);case"subgroupMul":return this.builtins.SubgroupMul($,Q);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul($,Q);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul($,Q);case"subgroupOr":return this.builtins.SubgroupOr($,Q);case"subgroupShuffle":return this.builtins.SubgroupShuffle($,Q);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown($,Q);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp($,Q);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor($,Q);case"subgroupXor":return this.builtins.SubgroupXor($,Q);case"quadBroadcast":return this.builtins.QuadBroadcast($,Q);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal($,Q);case"quadSwapX":return this.builtins.QuadSwapX($,Q);case"quadSwapY":return this.builtins.QuadSwapY($,Q)}let J=Q.getFunction($.name);if(J){let Z=Q.clone();for(let K=0;K<J.node.args.length;++K){let X=J.node.args[K],Y=this.evalExpression($.args[K],Z);Z.setVariable(X.name,Y,X)}return this._execStatements(J.node.body,Z)}return null}_callConstructorValue($,Q){if(!$.args||$.args.length===0)return new w(0,this.getTypeInfo($.type));let J=this.evalExpression($.args[0],Q);return J.typeInfo=this.getTypeInfo($.type),J.getSubData(this,$.postfix,Q).clone()}_callConstructorVec($,Q){let J=this.getTypeInfo($.type),Z=$.type.getTypeName(),K=RU[Z];if(K===void 0)return console.error(`Invalid vec constructor ${Z}. Line ${$.line}`),null;let X=[];if($ instanceof N0)if($.isVector){let Y=$.vectorValue;for(let W of Y)X.push(W)}else X.push($.scalarValue);else if($.args)for(let Y of $.args){let W=this.evalExpression(Y,Q);if(W instanceof R){let q=W.data;for(let H=0;H<q.length;++H){let F=q[H];X.push(F)}}else if(W instanceof w){let q=W.value;X.push(q)}}if($.type instanceof E&&$.type.format===null&&($.type.format=E.f32),X.length===0){let Y=Array(K).fill(0);return new R(Y,J).getSubData(this,$.postfix,Q)}if(X.length===1)for(;X.length<K;)X.push(X[0]);if(X.length<K)return console.error(`Invalid vec constructor. Line ${$.line}`),null;return new R(X.length>K?X.slice(0,K):X,J).getSubData(this,$.postfix,Q)}_callConstructorMatrix($,Q){let J=this.getTypeInfo($.type),Z=$.type.getTypeName(),K=u0[Z];if(K===void 0)return console.error(`Invalid matrix constructor ${Z}. Line ${$.line}`),null;let X=[];if($ instanceof N0)if($.isVector){let Y=$.vectorValue;for(let W of Y)X.push(W)}else X.push($.scalarValue);else if($.args)for(let Y of $.args){let W=this.evalExpression(Y,Q);W instanceof R?X.push(...W.data):W instanceof w?X.push(W.value):W instanceof F1&&X.push(...W.data)}if(J instanceof N7&&J.format===null&&(J.format=this.getTypeInfo("f32")),X.length===0){let Y=Array(K[2]).fill(0);return new F1(Y,J).getSubData(this,$.postfix,Q)}return X.length!==K[2]?(console.error(`Invalid matrix constructor. Line ${$.line}`),null):new F1(X,J).getSubData(this,$.postfix,Q)}};L0._breakObj=new v5(new q5("BREAK",null),null),L0._continueObj=new v5(new q5("CONTINUE",null),null),L0._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);rU=class rU extends _6{constructor($){super(),$&&this.update($)}update($){let Q=new Ph().parse($);this.updateAST(Q)}}});function aU($){let Q={attributes:[],bindings:[]},J;try{J=l51($)}catch(X){return f.error(X.message)(),Q}for(let X of J.uniforms){let Y=[];for(let W of X.type?.members||[])Y.push({name:W.name,type:wh(W.type)});Q.bindings.push({type:"uniform",name:X.name,group:X.group,location:X.binding,members:Y})}for(let X of J.textures)Q.bindings.push({type:"texture",name:X.name,group:X.group,location:X.binding});for(let X of J.samplers)Q.bindings.push({type:"sampler",name:X.name,group:X.group,location:X.binding});let Z=J.entry.vertex[0],K=Z?.inputs.length||0;for(let X=0;X<K;X++){let Y=Z.inputs[X];if(Y.locationType==="location"){let W=wh(Y.type);Q.attributes.push({name:Y.name,location:Number(Y.location),type:W})}}return Q}function wh($){return $.format?`${$.name}<${$.format.name}>`:$.name}function l51($){try{return new rU($)}catch(Q){if(Q instanceof Error)throw Q;let J="WGSL parse error";if(typeof Q==="object"&&Q?.message)J+=`: ${Q.message} `;if(typeof Q==="object"&&Q?.token)J+=Q.token.line||"";throw Error(J,{cause:Q})}}var Sh=C(()=>{O1();Mh()});function tU($,{precision:Q=R0.precision}={}){return $=u51($),`${parseFloat($.toPrecision(Q))}`}function F4($){return Array.isArray($)||ArrayBuffer.isView($)&&!($ instanceof DataView)}function g5($,Q,J){return n51($,(Z)=>Math.max(Q,Math.min(J,Z)))}function B8($,Q,J){if(F4($))return $.map((Z,K)=>B8(Z,Q[K],J));return J*Q+(1-J)*$}function U4($,Q,J){let Z=R0.EPSILON;if(J)R0.EPSILON=J;try{if($===Q)return!0;if(F4($)&&F4(Q)){if($.length!==Q.length)return!1;for(let K=0;K<$.length;++K)if(!U4($[K],Q[K]))return!1;return!0}if($&&$.equals)return $.equals(Q);if(Q&&Q.equals)return Q.equals($);if(typeof $==="number"&&typeof Q==="number")return Math.abs($-Q)<=R0.EPSILON*Math.max(1,Math.abs($),Math.abs(Q));return!1}finally{R0.EPSILON=Z}}function u51($){return Math.round($/R0.EPSILON)*R0.EPSILON}function i51($){return $.clone?$.clone():Array($.length)}function n51($,Q,J){if(F4($)){let Z=$;J=J||i51(Z);for(let K=0;K<J.length&&K<Z.length;++K){let X=typeof $==="number"?$:$[K];J[K]=Q(X,K,J)}return J}return Q($)}var Oz1,Pz1,p51,R0;var d9=C(()=>{Oz1=1/Math.PI*180,Pz1=0.005555555555555556*Math.PI,p51={EPSILON:0.000000000001,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...p51}};R0=globalThis.mathgl.config});var r2;var eU=C(()=>{d9();r2=class r2 extends Array{clone(){return new this.constructor().copy(this)}fromArray($,Q=0){for(let J=0;J<this.ELEMENTS;++J)this[J]=$[J+Q];return this.check()}toArray($=[],Q=0){for(let J=0;J<this.ELEMENTS;++J)$[Q+J]=this[J];return $}toObject($){return $}from($){return Array.isArray($)?this.copy($):this.fromObject($)}to($){if($===this)return this;return F4($)?this.toArray($):this.toObject($)}toTarget($){return $?this.to($):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(R0)}formatString($){let Q="";for(let J=0;J<this.ELEMENTS;++J)Q+=(J>0?", ":"")+tU(this[J],$);return`${$.printTypes?this.constructor.name:""}[${Q}]`}equals($){if(!$||this.length!==$.length)return!1;for(let Q=0;Q<this.ELEMENTS;++Q)if(!U4(this[Q],$[Q]))return!1;return!0}exactEquals($){if(!$||this.length!==$.length)return!1;for(let Q=0;Q<this.ELEMENTS;++Q)if(this[Q]!==$[Q])return!1;return!0}negate(){for(let $=0;$<this.ELEMENTS;++$)this[$]=-this[$];return this.check()}lerp($,Q,J){if(J===void 0)return this.lerp(this,$,Q);for(let Z=0;Z<this.ELEMENTS;++Z){let K=$[Z],X=typeof Q==="number"?Q:Q[Z];this[Z]=K+J*(X-K)}return this.check()}min($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]=Math.min($[Q],this[Q]);return this.check()}max($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]=Math.max($[Q],this[Q]);return this.check()}clamp($,Q){for(let J=0;J<this.ELEMENTS;++J)this[J]=Math.min(Math.max(this[J],$[J]),Q[J]);return this.check()}add(...$){for(let Q of $)for(let J=0;J<this.ELEMENTS;++J)this[J]+=Q[J];return this.check()}subtract(...$){for(let Q of $)for(let J=0;J<this.ELEMENTS;++J)this[J]-=Q[J];return this.check()}scale($){if(typeof $==="number")for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]*=$;else for(let Q=0;Q<this.ELEMENTS&&Q<$.length;++Q)this[Q]*=$[Q];return this.check()}multiplyByScalar($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]*=$;return this.check()}check(){if(R0.debug&&!this.validate())throw Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let $=this.length===this.ELEMENTS;for(let Q=0;Q<this.ELEMENTS;++Q)$=$&&Number.isFinite(this[Q]);return $}sub($){return this.subtract($)}setScalar($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]=$;return this.check()}addScalar($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]+=$;return this.check()}subScalar($){return this.addScalar(-$)}multiplyScalar($){for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]*=$;return this.check()}divideScalar($){return this.multiplyByScalar(1/$)}clampScalar($,Q){for(let J=0;J<this.ELEMENTS;++J)this[J]=Math.min(Math.max(this[J],$),Q);return this.check()}get elements(){return this}}});function s51($,Q){if($.length!==Q)return!1;for(let J=0;J<$.length;++J)if(!Number.isFinite($[J]))return!1;return!0}function v0($){if(!Number.isFinite($))throw Error(`Invalid number ${JSON.stringify($)}`);return $}function EZ($,Q,J=""){if(R0.debug&&!s51($,Q))throw Error(`math.gl: ${J} some fields set to invalid numbers'`);return $}var a2=C(()=>{d9()});function $V($,Q){if(!$)throw Error(`math.gl assertion ${Q}`)}var QV;var Th=C(()=>{eU();a2();QV=class QV extends r2{get x(){return this[0]}set x($){this[0]=v0($)}get y(){return this[1]}set y($){this[1]=v0($)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let $=0;for(let Q=0;Q<this.ELEMENTS;++Q)$+=this[Q]*this[Q];return $}magnitudeSquared(){return this.lengthSquared()}distance($){return Math.sqrt(this.distanceSquared($))}distanceSquared($){let Q=0;for(let J=0;J<this.ELEMENTS;++J){let Z=this[J]-$[J];Q+=Z*Z}return v0(Q)}dot($){let Q=0;for(let J=0;J<this.ELEMENTS;++J)Q+=this[J]*$[J];return v0(Q)}normalize(){let $=this.magnitude();if($!==0)for(let Q=0;Q<this.ELEMENTS;++Q)this[Q]/=$;return this.check()}multiply(...$){for(let Q of $)for(let J=0;J<this.ELEMENTS;++J)this[J]*=Q[J];return this.check()}divide(...$){for(let Q of $)for(let J=0;J<this.ELEMENTS;++J)this[J]/=Q[J];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo($){return this.distance($)}distanceToSquared($){return this.distanceSquared($)}getComponent($){return $V($>=0&&$<this.ELEMENTS,"index is out of range"),v0(this[$])}setComponent($,Q){return $V($>=0&&$<this.ELEMENTS,"index is out of range"),this[$]=Q,this.check()}addVectors($,Q){return this.copy($).add(Q)}subVectors($,Q){return this.copy($).subtract(Q)}multiplyVectors($,Q){return this.copy($).multiply(Q)}addScaledVector($,Q){return this.add(new this.constructor($).multiplyScalar(Q))}}});function y5($){if($>=0)return Math.round($);return $%0.5===0?Math.floor($):Math.round($)}var w1=0.000001,y1,x6,vz1;var R8=C(()=>{y1=typeof Float32Array<"u"?Float32Array:Array,x6=Math.random;vz1=Math.PI/180});var g6={};E7(g6,{zero:()=>B61,transformMat4:()=>JV,transformMat3:()=>A61,transformMat2d:()=>C61,transformMat2:()=>D61,subtract:()=>Gh,sub:()=>w61,str:()=>R61,squaredLength:()=>_h,squaredDistance:()=>Lh,sqrLen:()=>E61,sqrDist:()=>G61,set:()=>t51,scaleAndAdd:()=>Y61,scale:()=>X61,round:()=>K61,rotate:()=>z61,random:()=>N61,normalize:()=>H61,negate:()=>W61,multiply:()=>Eh,mul:()=>S61,min:()=>J61,max:()=>Z61,lerp:()=>V61,length:()=>vh,len:()=>M61,inverse:()=>q61,fromValues:()=>r51,forEach:()=>j61,floor:()=>Q61,exactEquals:()=>O61,equals:()=>P61,dot:()=>F61,divide:()=>jh,div:()=>T61,distance:()=>hh,dist:()=>I61,cross:()=>U61,create:()=>Ih,copy:()=>a51,clone:()=>o51,ceil:()=>$61,angle:()=>k61,add:()=>e51});function Ih(){let $=new y1(2);if(y1!=Float32Array)$[0]=0,$[1]=0;return $}function o51($){let Q=new y1(2);return Q[0]=$[0],Q[1]=$[1],Q}function r51($,Q){let J=new y1(2);return J[0]=$,J[1]=Q,J}function a51($,Q){return $[0]=Q[0],$[1]=Q[1],$}function t51($,Q,J){return $[0]=Q,$[1]=J,$}function e51($,Q,J){return $[0]=Q[0]+J[0],$[1]=Q[1]+J[1],$}function Gh($,Q,J){return $[0]=Q[0]-J[0],$[1]=Q[1]-J[1],$}function Eh($,Q,J){return $[0]=Q[0]*J[0],$[1]=Q[1]*J[1],$}function jh($,Q,J){return $[0]=Q[0]/J[0],$[1]=Q[1]/J[1],$}function $61($,Q){return $[0]=Math.ceil(Q[0]),$[1]=Math.ceil(Q[1]),$}function Q61($,Q){return $[0]=Math.floor(Q[0]),$[1]=Math.floor(Q[1]),$}function J61($,Q,J){return $[0]=Math.min(Q[0],J[0]),$[1]=Math.min(Q[1],J[1]),$}function Z61($,Q,J){return $[0]=Math.max(Q[0],J[0]),$[1]=Math.max(Q[1],J[1]),$}function K61($,Q){return $[0]=y5(Q[0]),$[1]=y5(Q[1]),$}function X61($,Q,J){return $[0]=Q[0]*J,$[1]=Q[1]*J,$}function Y61($,Q,J,Z){return $[0]=Q[0]+J[0]*Z,$[1]=Q[1]+J[1]*Z,$}function hh($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1];return Math.sqrt(J*J+Z*Z)}function Lh($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1];return J*J+Z*Z}function vh($){let Q=$[0],J=$[1];return Math.sqrt(Q*Q+J*J)}function _h($){let Q=$[0],J=$[1];return Q*Q+J*J}function W61($,Q){return $[0]=-Q[0],$[1]=-Q[1],$}function q61($,Q){return $[0]=1/Q[0],$[1]=1/Q[1],$}function H61($,Q){let J=Q[0],Z=Q[1],K=J*J+Z*Z;if(K>0)K=1/Math.sqrt(K);return $[0]=Q[0]*K,$[1]=Q[1]*K,$}function F61($,Q){return $[0]*Q[0]+$[1]*Q[1]}function U61($,Q,J){let Z=Q[0]*J[1]-Q[1]*J[0];return $[0]=$[1]=0,$[2]=Z,$}function V61($,Q,J,Z){let K=Q[0],X=Q[1];return $[0]=K+Z*(J[0]-K),$[1]=X+Z*(J[1]-X),$}function N61($,Q){Q=Q===void 0?1:Q;let J=x6()*2*Math.PI;return $[0]=Math.cos(J)*Q,$[1]=Math.sin(J)*Q,$}function D61($,Q,J){let Z=Q[0],K=Q[1];return $[0]=J[0]*Z+J[2]*K,$[1]=J[1]*Z+J[3]*K,$}function C61($,Q,J){let Z=Q[0],K=Q[1];return $[0]=J[0]*Z+J[2]*K+J[4],$[1]=J[1]*Z+J[3]*K+J[5],$}function A61($,Q,J){let Z=Q[0],K=Q[1];return $[0]=J[0]*Z+J[3]*K+J[6],$[1]=J[1]*Z+J[4]*K+J[7],$}function JV($,Q,J){let Z=Q[0],K=Q[1];return $[0]=J[0]*Z+J[4]*K+J[12],$[1]=J[1]*Z+J[5]*K+J[13],$}function z61($,Q,J,Z){let K=Q[0]-J[0],X=Q[1]-J[1],Y=Math.sin(Z),W=Math.cos(Z);return $[0]=K*W-X*Y+J[0],$[1]=K*Y+X*W+J[1],$}function k61($,Q){let J=$[0],Z=$[1],K=Q[0],X=Q[1],Y=Math.sqrt((J*J+Z*Z)*(K*K+X*X)),W=Y&&(J*K+Z*X)/Y;return Math.acos(Math.min(Math.max(W,-1),1))}function B61($){return $[0]=0,$[1]=0,$}function R61($){return`vec2(${$[0]}, ${$[1]})`}function O61($,Q){return $[0]===Q[0]&&$[1]===Q[1]}function P61($,Q){let J=$[0],Z=$[1],K=Q[0],X=Q[1];return Math.abs(J-K)<=w1*Math.max(1,Math.abs(J),Math.abs(K))&&Math.abs(Z-X)<=w1*Math.max(1,Math.abs(Z),Math.abs(X))}var M61,w61,S61,T61,I61,G61,E61,j61;var ZV=C(()=>{R8();M61=vh,w61=Gh,S61=Eh,T61=jh,I61=hh,G61=Lh,E61=_h,j61=function(){let $=Ih();return function(Q,J,Z,K,X,Y){let W,q;if(!J)J=2;if(!Z)Z=0;if(K)q=Math.min(K*J+Z,Q.length);else q=Q.length;for(W=Z;W<q;W+=J)$[0]=Q[W],$[1]=Q[W+1],X($,$,Y),Q[W]=$[0],Q[W+1]=$[1];return Q}}()});function xh($,Q,J){let Z=Q[0],K=Q[1],X=J[3]*Z+J[7]*K||1;return $[0]=(J[0]*Z+J[4]*K)/X,$[1]=(J[1]*Z+J[5]*K)/X,$}function jZ($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=J[3]*Z+J[7]*K+J[11]*X||1;return $[0]=(J[0]*Z+J[4]*K+J[8]*X)/Y,$[1]=(J[1]*Z+J[5]*K+J[9]*X)/Y,$[2]=(J[2]*Z+J[6]*K+J[10]*X)/Y,$}function gh($,Q,J){let Z=Q[0],K=Q[1];return $[0]=J[0]*Z+J[2]*K,$[1]=J[1]*Z+J[3]*K,$[2]=Q[2],$}var P8={};E7(P8,{zero:()=>o61,transformQuat:()=>YV,transformMat4:()=>e2,transformMat3:()=>XV,subtract:()=>fh,sub:()=>e61,str:()=>r61,squaredLength:()=>lh,squaredDistance:()=>dh,sqrLen:()=>K41,sqrDist:()=>Z41,slerp:()=>u61,set:()=>v61,scaleAndAdd:()=>c61,scale:()=>m61,round:()=>b61,rotateZ:()=>HV,rotateY:()=>qV,rotateX:()=>WV,random:()=>s61,normalize:()=>KV,negate:()=>d61,multiply:()=>bh,mul:()=>$41,min:()=>y61,max:()=>f61,lerp:()=>p61,length:()=>yh,len:()=>UV,inverse:()=>l61,hermite:()=>i61,fromValues:()=>LZ,forEach:()=>X41,floor:()=>g61,exactEquals:()=>a61,equals:()=>t61,dot:()=>t2,divide:()=>mh,div:()=>Q41,distance:()=>ch,dist:()=>J41,cross:()=>O8,create:()=>hZ,copy:()=>L61,clone:()=>h61,ceil:()=>x61,bezier:()=>n61,angle:()=>FV,add:()=>_61});function hZ(){let $=new y1(3);if(y1!=Float32Array)$[0]=0,$[1]=0,$[2]=0;return $}function h61($){let Q=new y1(3);return Q[0]=$[0],Q[1]=$[1],Q[2]=$[2],Q}function yh($){let Q=$[0],J=$[1],Z=$[2];return Math.sqrt(Q*Q+J*J+Z*Z)}function LZ($,Q,J){let Z=new y1(3);return Z[0]=$,Z[1]=Q,Z[2]=J,Z}function L61($,Q){return $[0]=Q[0],$[1]=Q[1],$[2]=Q[2],$}function v61($,Q,J,Z){return $[0]=Q,$[1]=J,$[2]=Z,$}function _61($,Q,J){return $[0]=Q[0]+J[0],$[1]=Q[1]+J[1],$[2]=Q[2]+J[2],$}function fh($,Q,J){return $[0]=Q[0]-J[0],$[1]=Q[1]-J[1],$[2]=Q[2]-J[2],$}function bh($,Q,J){return $[0]=Q[0]*J[0],$[1]=Q[1]*J[1],$[2]=Q[2]*J[2],$}function mh($,Q,J){return $[0]=Q[0]/J[0],$[1]=Q[1]/J[1],$[2]=Q[2]/J[2],$}function x61($,Q){return $[0]=Math.ceil(Q[0]),$[1]=Math.ceil(Q[1]),$[2]=Math.ceil(Q[2]),$}function g61($,Q){return $[0]=Math.floor(Q[0]),$[1]=Math.floor(Q[1]),$[2]=Math.floor(Q[2]),$}function y61($,Q,J){return $[0]=Math.min(Q[0],J[0]),$[1]=Math.min(Q[1],J[1]),$[2]=Math.min(Q[2],J[2]),$}function f61($,Q,J){return $[0]=Math.max(Q[0],J[0]),$[1]=Math.max(Q[1],J[1]),$[2]=Math.max(Q[2],J[2]),$}function b61($,Q){return $[0]=y5(Q[0]),$[1]=y5(Q[1]),$[2]=y5(Q[2]),$}function m61($,Q,J){return $[0]=Q[0]*J,$[1]=Q[1]*J,$[2]=Q[2]*J,$}function c61($,Q,J,Z){return $[0]=Q[0]+J[0]*Z,$[1]=Q[1]+J[1]*Z,$[2]=Q[2]+J[2]*Z,$}function ch($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1],K=Q[2]-$[2];return Math.sqrt(J*J+Z*Z+K*K)}function dh($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1],K=Q[2]-$[2];return J*J+Z*Z+K*K}function lh($){let Q=$[0],J=$[1],Z=$[2];return Q*Q+J*J+Z*Z}function d61($,Q){return $[0]=-Q[0],$[1]=-Q[1],$[2]=-Q[2],$}function l61($,Q){return $[0]=1/Q[0],$[1]=1/Q[1],$[2]=1/Q[2],$}function KV($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=J*J+Z*Z+K*K;if(X>0)X=1/Math.sqrt(X);return $[0]=Q[0]*X,$[1]=Q[1]*X,$[2]=Q[2]*X,$}function t2($,Q){return $[0]*Q[0]+$[1]*Q[1]+$[2]*Q[2]}function O8($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=J[0],W=J[1],q=J[2];return $[0]=K*q-X*W,$[1]=X*Y-Z*q,$[2]=Z*W-K*Y,$}function p61($,Q,J,Z){let K=Q[0],X=Q[1],Y=Q[2];return $[0]=K+Z*(J[0]-K),$[1]=X+Z*(J[1]-X),$[2]=Y+Z*(J[2]-Y),$}function u61($,Q,J,Z){let K=Math.acos(Math.min(Math.max(t2(Q,J),-1),1)),X=Math.sin(K),Y=Math.sin((1-Z)*K)/X,W=Math.sin(Z*K)/X;return $[0]=Y*Q[0]+W*J[0],$[1]=Y*Q[1]+W*J[1],$[2]=Y*Q[2]+W*J[2],$}function i61($,Q,J,Z,K,X){let Y=X*X,W=Y*(2*X-3)+1,q=Y*(X-2)+X,H=Y*(X-1),F=Y*(3-2*X);return $[0]=Q[0]*W+J[0]*q+Z[0]*H+K[0]*F,$[1]=Q[1]*W+J[1]*q+Z[1]*H+K[1]*F,$[2]=Q[2]*W+J[2]*q+Z[2]*H+K[2]*F,$}function n61($,Q,J,Z,K,X){let Y=1-X,W=Y*Y,q=X*X,H=W*Y,F=3*X*W,U=3*q*Y,V=q*X;return $[0]=Q[0]*H+J[0]*F+Z[0]*U+K[0]*V,$[1]=Q[1]*H+J[1]*F+Z[1]*U+K[1]*V,$[2]=Q[2]*H+J[2]*F+Z[2]*U+K[2]*V,$}function s61($,Q){Q=Q===void 0?1:Q;let J=x6()*2*Math.PI,Z=x6()*2-1,K=Math.sqrt(1-Z*Z)*Q;return $[0]=Math.cos(J)*K,$[1]=Math.sin(J)*K,$[2]=Z*Q,$}function e2($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=J[3]*Z+J[7]*K+J[11]*X+J[15];return Y=Y||1,$[0]=(J[0]*Z+J[4]*K+J[8]*X+J[12])/Y,$[1]=(J[1]*Z+J[5]*K+J[9]*X+J[13])/Y,$[2]=(J[2]*Z+J[6]*K+J[10]*X+J[14])/Y,$}function XV($,Q,J){let Z=Q[0],K=Q[1],X=Q[2];return $[0]=Z*J[0]+K*J[3]+X*J[6],$[1]=Z*J[1]+K*J[4]+X*J[7],$[2]=Z*J[2]+K*J[5]+X*J[8],$}function YV($,Q,J){let Z=J[0],K=J[1],X=J[2],Y=J[3],W=Q[0],q=Q[1],H=Q[2],F=K*H-X*q,U=X*W-Z*H,V=Z*q-K*W,N=K*V-X*U,D=X*F-Z*V,z=Z*U-K*F,B=Y*2;return F*=B,U*=B,V*=B,N*=2,D*=2,z*=2,$[0]=W+F+N,$[1]=q+U+D,$[2]=H+V+z,$}function WV($,Q,J,Z){let K=[],X=[];return K[0]=Q[0]-J[0],K[1]=Q[1]-J[1],K[2]=Q[2]-J[2],X[0]=K[0],X[1]=K[1]*Math.cos(Z)-K[2]*Math.sin(Z),X[2]=K[1]*Math.sin(Z)+K[2]*Math.cos(Z),$[0]=X[0]+J[0],$[1]=X[1]+J[1],$[2]=X[2]+J[2],$}function qV($,Q,J,Z){let K=[],X=[];return K[0]=Q[0]-J[0],K[1]=Q[1]-J[1],K[2]=Q[2]-J[2],X[0]=K[2]*Math.sin(Z)+K[0]*Math.cos(Z),X[1]=K[1],X[2]=K[2]*Math.cos(Z)-K[0]*Math.sin(Z),$[0]=X[0]+J[0],$[1]=X[1]+J[1],$[2]=X[2]+J[2],$}function HV($,Q,J,Z){let K=[],X=[];return K[0]=Q[0]-J[0],K[1]=Q[1]-J[1],K[2]=Q[2]-J[2],X[0]=K[0]*Math.cos(Z)-K[1]*Math.sin(Z),X[1]=K[0]*Math.sin(Z)+K[1]*Math.cos(Z),X[2]=K[2],$[0]=X[0]+J[0],$[1]=X[1]+J[1],$[2]=X[2]+J[2],$}function FV($,Q){let J=$[0],Z=$[1],K=$[2],X=Q[0],Y=Q[1],W=Q[2],q=Math.sqrt((J*J+Z*Z+K*K)*(X*X+Y*Y+W*W)),H=q&&t2($,Q)/q;return Math.acos(Math.min(Math.max(H,-1),1))}function o61($){return $[0]=0,$[1]=0,$[2]=0,$}function r61($){return`vec3(${$[0]}, ${$[1]}, ${$[2]})`}function a61($,Q){return $[0]===Q[0]&&$[1]===Q[1]&&$[2]===Q[2]}function t61($,Q){let J=$[0],Z=$[1],K=$[2],X=Q[0],Y=Q[1],W=Q[2];return Math.abs(J-X)<=w1*Math.max(1,Math.abs(J),Math.abs(X))&&Math.abs(Z-Y)<=w1*Math.max(1,Math.abs(Z),Math.abs(Y))&&Math.abs(K-W)<=w1*Math.max(1,Math.abs(K),Math.abs(W))}var e61,$41,Q41,J41,Z41,UV,K41,X41;var $$=C(()=>{R8();e61=fh,$41=bh,Q41=mh,J41=ch,Z41=dh,UV=yh,K41=lh,X41=function(){let $=hZ();return function(Q,J,Z,K,X,Y){let W,q;if(!J)J=3;if(!Z)Z=0;if(K)q=Math.min(K*J+Z,Q.length);else q=Q.length;for(W=Z;W<q;W+=J)$[0]=Q[W],$[1]=Q[W+1],$[2]=Q[W+2],X($,$,Y),Q[W]=$[0],Q[W+1]=$[1],Q[W+2]=$[2];return Q}}()});var VV,vZ,_0;var ph=C(()=>{Th();d9();a2();$$();VV=[0,0,0];_0=class _0 extends QV{static get ZERO(){if(!vZ)vZ=new _0(0,0,0),Object.freeze(vZ);return vZ}constructor($=0,Q=0,J=0){super(-0,-0,-0);if(arguments.length===1&&F4($))this.copy($);else{if(R0.debug)v0($),v0(Q),v0(J);this[0]=$,this[1]=Q,this[2]=J}}set($,Q,J){return this[0]=$,this[1]=Q,this[2]=J,this.check()}copy($){return this[0]=$[0],this[1]=$[1],this[2]=$[2],this.check()}fromObject($){if(R0.debug)v0($.x),v0($.y),v0($.z);return this[0]=$.x,this[1]=$.y,this[2]=$.z,this.check()}toObject($){return $.x=this[0],$.y=this[1],$.z=this[2],$}get ELEMENTS(){return 3}get z(){return this[2]}set z($){this[2]=v0($)}angle($){return FV(this,$)}cross($){return O8(this,this,$),this.check()}rotateX({radians:$,origin:Q=VV}){return WV(this,this,Q,$),this.check()}rotateY({radians:$,origin:Q=VV}){return qV(this,this,Q,$),this.check()}rotateZ({radians:$,origin:Q=VV}){return HV(this,this,Q,$),this.check()}transform($){return this.transformAsPoint($)}transformAsPoint($){return e2(this,this,$),this.check()}transformAsVector($){return jZ(this,this,$),this.check()}transformByMatrix3($){return XV(this,this,$),this.check()}transformByMatrix2($){return gh(this,this,$),this.check()}transformByQuaternion($){return YV(this,this,$),this.check()}}});var NV;var uh=C(()=>{eU();a2();d9();NV=class NV extends r2{toString(){let $="[";if(R0.printRowMajor){$+="row-major:";for(let Q=0;Q<this.RANK;++Q)for(let J=0;J<this.RANK;++J)$+=` ${this[J*this.RANK+Q]}`}else{$+="column-major:";for(let Q=0;Q<this.ELEMENTS;++Q)$+=` ${this[Q]}`}return $+="]",$}getElementIndex($,Q){return Q*this.RANK+$}getElement($,Q){return this[Q*this.RANK+$]}setElement($,Q,J){return this[Q*this.RANK+$]=v0(J),this}getColumn($,Q=Array(this.RANK).fill(-0)){let J=$*this.RANK;for(let Z=0;Z<this.RANK;++Z)Q[Z]=this[J+Z];return Q}setColumn($,Q){let J=$*this.RANK;for(let Z=0;Z<this.RANK;++Z)this[J+Z]=Q[Z];return this}}});function ih(){let $=new y1(9);if(y1!=Float32Array)$[1]=0,$[2]=0,$[3]=0,$[5]=0,$[6]=0,$[7]=0;return $[0]=1,$[4]=1,$[8]=1,$}var DV=C(()=>{R8()});var C0={};E7(C0,{transpose:()=>CV,translate:()=>kV,targetTo:()=>I41,subtract:()=>eh,sub:()=>g41,str:()=>G41,set:()=>F41,scale:()=>BV,rotateZ:()=>MV,rotateY:()=>PV,rotateX:()=>OV,rotate:()=>RV,perspectiveZO:()=>w41,perspectiveNO:()=>ah,perspectiveFromFieldOfView:()=>S41,perspective:()=>TV,orthoZO:()=>T41,orthoNO:()=>th,ortho:()=>IV,multiplyScalarAndAdd:()=>L41,multiplyScalar:()=>h41,multiply:()=>Q$,mul:()=>x41,lookAt:()=>GV,invert:()=>AV,identity:()=>sh,getTranslation:()=>B41,getScaling:()=>rh,getRotation:()=>R41,frustum:()=>SV,fromZRotation:()=>z41,fromYRotation:()=>A41,fromXRotation:()=>C41,fromValues:()=>H41,fromTranslation:()=>V41,fromScaling:()=>N41,fromRotationTranslationScaleOrigin:()=>M41,fromRotationTranslationScale:()=>P41,fromRotationTranslation:()=>oh,fromRotation:()=>D41,fromQuat2:()=>k41,fromQuat:()=>wV,frob:()=>E41,exactEquals:()=>v41,equals:()=>_41,determinant:()=>zV,decompose:()=>O41,create:()=>Y41,copy:()=>q41,clone:()=>W41,adjoint:()=>U41,add:()=>j41});function Y41(){let $=new y1(16);if(y1!=Float32Array)$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[11]=0,$[12]=0,$[13]=0,$[14]=0;return $[0]=1,$[5]=1,$[10]=1,$[15]=1,$}function W41($){let Q=new y1(16);return Q[0]=$[0],Q[1]=$[1],Q[2]=$[2],Q[3]=$[3],Q[4]=$[4],Q[5]=$[5],Q[6]=$[6],Q[7]=$[7],Q[8]=$[8],Q[9]=$[9],Q[10]=$[10],Q[11]=$[11],Q[12]=$[12],Q[13]=$[13],Q[14]=$[14],Q[15]=$[15],Q}function q41($,Q){return $[0]=Q[0],$[1]=Q[1],$[2]=Q[2],$[3]=Q[3],$[4]=Q[4],$[5]=Q[5],$[6]=Q[6],$[7]=Q[7],$[8]=Q[8],$[9]=Q[9],$[10]=Q[10],$[11]=Q[11],$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15],$}function H41($,Q,J,Z,K,X,Y,W,q,H,F,U,V,N,D,z){let B=new y1(16);return B[0]=$,B[1]=Q,B[2]=J,B[3]=Z,B[4]=K,B[5]=X,B[6]=Y,B[7]=W,B[8]=q,B[9]=H,B[10]=F,B[11]=U,B[12]=V,B[13]=N,B[14]=D,B[15]=z,B}function F41($,Q,J,Z,K,X,Y,W,q,H,F,U,V,N,D,z,B){return $[0]=Q,$[1]=J,$[2]=Z,$[3]=K,$[4]=X,$[5]=Y,$[6]=W,$[7]=q,$[8]=H,$[9]=F,$[10]=U,$[11]=V,$[12]=N,$[13]=D,$[14]=z,$[15]=B,$}function sh($){return $[0]=1,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=1,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=1,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function CV($,Q){if($===Q){let J=Q[1],Z=Q[2],K=Q[3],X=Q[6],Y=Q[7],W=Q[11];$[1]=Q[4],$[2]=Q[8],$[3]=Q[12],$[4]=J,$[6]=Q[9],$[7]=Q[13],$[8]=Z,$[9]=X,$[11]=Q[14],$[12]=K,$[13]=Y,$[14]=W}else $[0]=Q[0],$[1]=Q[4],$[2]=Q[8],$[3]=Q[12],$[4]=Q[1],$[5]=Q[5],$[6]=Q[9],$[7]=Q[13],$[8]=Q[2],$[9]=Q[6],$[10]=Q[10],$[11]=Q[14],$[12]=Q[3],$[13]=Q[7],$[14]=Q[11],$[15]=Q[15];return $}function AV($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=Q[3],Y=Q[4],W=Q[5],q=Q[6],H=Q[7],F=Q[8],U=Q[9],V=Q[10],N=Q[11],D=Q[12],z=Q[13],B=Q[14],M=Q[15],P=J*W-Z*Y,O=J*q-K*Y,G=J*H-X*Y,L=Z*q-K*W,b=Z*H-X*W,d=K*H-X*q,p=F*z-U*D,i=F*B-V*D,l=F*M-N*D,N1=U*B-V*z,Y1=U*M-N*z,a=V*M-N*B,D1=P*a-O*Y1+G*N1+L*l-b*i+d*p;if(!D1)return null;return D1=1/D1,$[0]=(W*a-q*Y1+H*N1)*D1,$[1]=(K*Y1-Z*a-X*N1)*D1,$[2]=(z*d-B*b+M*L)*D1,$[3]=(V*b-U*d-N*L)*D1,$[4]=(q*l-Y*a-H*i)*D1,$[5]=(J*a-K*l+X*i)*D1,$[6]=(B*G-D*d-M*O)*D1,$[7]=(F*d-V*G+N*O)*D1,$[8]=(Y*Y1-W*l+H*p)*D1,$[9]=(Z*l-J*Y1-X*p)*D1,$[10]=(D*b-z*G+M*P)*D1,$[11]=(U*G-F*b-N*P)*D1,$[12]=(W*i-Y*N1-q*p)*D1,$[13]=(J*N1-Z*i+K*p)*D1,$[14]=(z*O-D*L-B*P)*D1,$[15]=(F*L-U*O+V*P)*D1,$}function U41($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=Q[3],Y=Q[4],W=Q[5],q=Q[6],H=Q[7],F=Q[8],U=Q[9],V=Q[10],N=Q[11],D=Q[12],z=Q[13],B=Q[14],M=Q[15],P=J*W-Z*Y,O=J*q-K*Y,G=J*H-X*Y,L=Z*q-K*W,b=Z*H-X*W,d=K*H-X*q,p=F*z-U*D,i=F*B-V*D,l=F*M-N*D,N1=U*B-V*z,Y1=U*M-N*z,a=V*M-N*B;return $[0]=W*a-q*Y1+H*N1,$[1]=K*Y1-Z*a-X*N1,$[2]=z*d-B*b+M*L,$[3]=V*b-U*d-N*L,$[4]=q*l-Y*a-H*i,$[5]=J*a-K*l+X*i,$[6]=B*G-D*d-M*O,$[7]=F*d-V*G+N*O,$[8]=Y*Y1-W*l+H*p,$[9]=Z*l-J*Y1-X*p,$[10]=D*b-z*G+M*P,$[11]=U*G-F*b-N*P,$[12]=W*i-Y*N1-q*p,$[13]=J*N1-Z*i+K*p,$[14]=z*O-D*L-B*P,$[15]=F*L-U*O+V*P,$}function zV($){let Q=$[0],J=$[1],Z=$[2],K=$[3],X=$[4],Y=$[5],W=$[6],q=$[7],H=$[8],F=$[9],U=$[10],V=$[11],N=$[12],D=$[13],z=$[14],B=$[15],M=Q*Y-J*X,P=Q*W-Z*X,O=J*W-Z*Y,G=H*D-F*N,L=H*z-U*N,b=F*z-U*D,d=Q*b-J*L+Z*G,p=X*b-Y*L+W*G,i=H*O-F*P+U*M,l=N*O-D*P+z*M;return q*d-K*p+B*i-V*l}function Q$($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=Q[3],W=Q[4],q=Q[5],H=Q[6],F=Q[7],U=Q[8],V=Q[9],N=Q[10],D=Q[11],z=Q[12],B=Q[13],M=Q[14],P=Q[15],O=J[0],G=J[1],L=J[2],b=J[3];return $[0]=O*Z+G*W+L*U+b*z,$[1]=O*K+G*q+L*V+b*B,$[2]=O*X+G*H+L*N+b*M,$[3]=O*Y+G*F+L*D+b*P,O=J[4],G=J[5],L=J[6],b=J[7],$[4]=O*Z+G*W+L*U+b*z,$[5]=O*K+G*q+L*V+b*B,$[6]=O*X+G*H+L*N+b*M,$[7]=O*Y+G*F+L*D+b*P,O=J[8],G=J[9],L=J[10],b=J[11],$[8]=O*Z+G*W+L*U+b*z,$[9]=O*K+G*q+L*V+b*B,$[10]=O*X+G*H+L*N+b*M,$[11]=O*Y+G*F+L*D+b*P,O=J[12],G=J[13],L=J[14],b=J[15],$[12]=O*Z+G*W+L*U+b*z,$[13]=O*K+G*q+L*V+b*B,$[14]=O*X+G*H+L*N+b*M,$[15]=O*Y+G*F+L*D+b*P,$}function kV($,Q,J){let Z=J[0],K=J[1],X=J[2],Y,W,q,H,F,U,V,N,D,z,B,M;if(Q===$)$[12]=Q[0]*Z+Q[4]*K+Q[8]*X+Q[12],$[13]=Q[1]*Z+Q[5]*K+Q[9]*X+Q[13],$[14]=Q[2]*Z+Q[6]*K+Q[10]*X+Q[14],$[15]=Q[3]*Z+Q[7]*K+Q[11]*X+Q[15];else Y=Q[0],W=Q[1],q=Q[2],H=Q[3],F=Q[4],U=Q[5],V=Q[6],N=Q[7],D=Q[8],z=Q[9],B=Q[10],M=Q[11],$[0]=Y,$[1]=W,$[2]=q,$[3]=H,$[4]=F,$[5]=U,$[6]=V,$[7]=N,$[8]=D,$[9]=z,$[10]=B,$[11]=M,$[12]=Y*Z+F*K+D*X+Q[12],$[13]=W*Z+U*K+z*X+Q[13],$[14]=q*Z+V*K+B*X+Q[14],$[15]=H*Z+N*K+M*X+Q[15];return $}function BV($,Q,J){let Z=J[0],K=J[1],X=J[2];return $[0]=Q[0]*Z,$[1]=Q[1]*Z,$[2]=Q[2]*Z,$[3]=Q[3]*Z,$[4]=Q[4]*K,$[5]=Q[5]*K,$[6]=Q[6]*K,$[7]=Q[7]*K,$[8]=Q[8]*X,$[9]=Q[9]*X,$[10]=Q[10]*X,$[11]=Q[11]*X,$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15],$}function RV($,Q,J,Z){let K=Z[0],X=Z[1],Y=Z[2],W=Math.sqrt(K*K+X*X+Y*Y),q,H,F,U,V,N,D,z,B,M,P,O,G,L,b,d,p,i,l,N1,Y1,a,D1,F0;if(W<w1)return null;if(W=1/W,K*=W,X*=W,Y*=W,H=Math.sin(J),q=Math.cos(J),F=1-q,U=Q[0],V=Q[1],N=Q[2],D=Q[3],z=Q[4],B=Q[5],M=Q[6],P=Q[7],O=Q[8],G=Q[9],L=Q[10],b=Q[11],d=K*K*F+q,p=X*K*F+Y*H,i=Y*K*F-X*H,l=K*X*F-Y*H,N1=X*X*F+q,Y1=Y*X*F+K*H,a=K*Y*F+X*H,D1=X*Y*F-K*H,F0=Y*Y*F+q,$[0]=U*d+z*p+O*i,$[1]=V*d+B*p+G*i,$[2]=N*d+M*p+L*i,$[3]=D*d+P*p+b*i,$[4]=U*l+z*N1+O*Y1,$[5]=V*l+B*N1+G*Y1,$[6]=N*l+M*N1+L*Y1,$[7]=D*l+P*N1+b*Y1,$[8]=U*a+z*D1+O*F0,$[9]=V*a+B*D1+G*F0,$[10]=N*a+M*D1+L*F0,$[11]=D*a+P*D1+b*F0,Q!==$)$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15];return $}function OV($,Q,J){let Z=Math.sin(J),K=Math.cos(J),X=Q[4],Y=Q[5],W=Q[6],q=Q[7],H=Q[8],F=Q[9],U=Q[10],V=Q[11];if(Q!==$)$[0]=Q[0],$[1]=Q[1],$[2]=Q[2],$[3]=Q[3],$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15];return $[4]=X*K+H*Z,$[5]=Y*K+F*Z,$[6]=W*K+U*Z,$[7]=q*K+V*Z,$[8]=H*K-X*Z,$[9]=F*K-Y*Z,$[10]=U*K-W*Z,$[11]=V*K-q*Z,$}function PV($,Q,J){let Z=Math.sin(J),K=Math.cos(J),X=Q[0],Y=Q[1],W=Q[2],q=Q[3],H=Q[8],F=Q[9],U=Q[10],V=Q[11];if(Q!==$)$[4]=Q[4],$[5]=Q[5],$[6]=Q[6],$[7]=Q[7],$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15];return $[0]=X*K-H*Z,$[1]=Y*K-F*Z,$[2]=W*K-U*Z,$[3]=q*K-V*Z,$[8]=X*Z+H*K,$[9]=Y*Z+F*K,$[10]=W*Z+U*K,$[11]=q*Z+V*K,$}function MV($,Q,J){let Z=Math.sin(J),K=Math.cos(J),X=Q[0],Y=Q[1],W=Q[2],q=Q[3],H=Q[4],F=Q[5],U=Q[6],V=Q[7];if(Q!==$)$[8]=Q[8],$[9]=Q[9],$[10]=Q[10],$[11]=Q[11],$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15];return $[0]=X*K+H*Z,$[1]=Y*K+F*Z,$[2]=W*K+U*Z,$[3]=q*K+V*Z,$[4]=H*K-X*Z,$[5]=F*K-Y*Z,$[6]=U*K-W*Z,$[7]=V*K-q*Z,$}function V41($,Q){return $[0]=1,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=1,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=1,$[11]=0,$[12]=Q[0],$[13]=Q[1],$[14]=Q[2],$[15]=1,$}function N41($,Q){return $[0]=Q[0],$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=Q[1],$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=Q[2],$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function D41($,Q,J){let Z=J[0],K=J[1],X=J[2],Y=Math.sqrt(Z*Z+K*K+X*X),W,q,H;if(Y<w1)return null;return Y=1/Y,Z*=Y,K*=Y,X*=Y,q=Math.sin(Q),W=Math.cos(Q),H=1-W,$[0]=Z*Z*H+W,$[1]=K*Z*H+X*q,$[2]=X*Z*H-K*q,$[3]=0,$[4]=Z*K*H-X*q,$[5]=K*K*H+W,$[6]=X*K*H+Z*q,$[7]=0,$[8]=Z*X*H+K*q,$[9]=K*X*H-Z*q,$[10]=X*X*H+W,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function C41($,Q){let J=Math.sin(Q),Z=Math.cos(Q);return $[0]=1,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=Z,$[6]=J,$[7]=0,$[8]=0,$[9]=-J,$[10]=Z,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function A41($,Q){let J=Math.sin(Q),Z=Math.cos(Q);return $[0]=Z,$[1]=0,$[2]=-J,$[3]=0,$[4]=0,$[5]=1,$[6]=0,$[7]=0,$[8]=J,$[9]=0,$[10]=Z,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function z41($,Q){let J=Math.sin(Q),Z=Math.cos(Q);return $[0]=Z,$[1]=J,$[2]=0,$[3]=0,$[4]=-J,$[5]=Z,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=1,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function oh($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=Q[3],W=Z+Z,q=K+K,H=X+X,F=Z*W,U=Z*q,V=Z*H,N=K*q,D=K*H,z=X*H,B=Y*W,M=Y*q,P=Y*H;return $[0]=1-(N+z),$[1]=U+P,$[2]=V-M,$[3]=0,$[4]=U-P,$[5]=1-(F+z),$[6]=D+B,$[7]=0,$[8]=V+M,$[9]=D-B,$[10]=1-(F+N),$[11]=0,$[12]=J[0],$[13]=J[1],$[14]=J[2],$[15]=1,$}function k41($,Q){let J=new y1(3),Z=-Q[0],K=-Q[1],X=-Q[2],Y=Q[3],W=Q[4],q=Q[5],H=Q[6],F=Q[7],U=Z*Z+K*K+X*X+Y*Y;if(U>0)J[0]=(W*Y+F*Z+q*X-H*K)*2/U,J[1]=(q*Y+F*K+H*Z-W*X)*2/U,J[2]=(H*Y+F*X+W*K-q*Z)*2/U;else J[0]=(W*Y+F*Z+q*X-H*K)*2,J[1]=(q*Y+F*K+H*Z-W*X)*2,J[2]=(H*Y+F*X+W*K-q*Z)*2;return oh($,Q,J),$}function B41($,Q){return $[0]=Q[12],$[1]=Q[13],$[2]=Q[14],$}function rh($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=Q[4],Y=Q[5],W=Q[6],q=Q[8],H=Q[9],F=Q[10];return $[0]=Math.sqrt(J*J+Z*Z+K*K),$[1]=Math.sqrt(X*X+Y*Y+W*W),$[2]=Math.sqrt(q*q+H*H+F*F),$}function R41($,Q){let J=new y1(3);rh(J,Q);let Z=1/J[0],K=1/J[1],X=1/J[2],Y=Q[0]*Z,W=Q[1]*K,q=Q[2]*X,H=Q[4]*Z,F=Q[5]*K,U=Q[6]*X,V=Q[8]*Z,N=Q[9]*K,D=Q[10]*X,z=Y+F+D,B=0;if(z>0)B=Math.sqrt(z+1)*2,$[3]=0.25*B,$[0]=(U-N)/B,$[1]=(V-q)/B,$[2]=(W-H)/B;else if(Y>F&&Y>D)B=Math.sqrt(1+Y-F-D)*2,$[3]=(U-N)/B,$[0]=0.25*B,$[1]=(W+H)/B,$[2]=(V+q)/B;else if(F>D)B=Math.sqrt(1+F-Y-D)*2,$[3]=(V-q)/B,$[0]=(W+H)/B,$[1]=0.25*B,$[2]=(U+N)/B;else B=Math.sqrt(1+D-Y-F)*2,$[3]=(W-H)/B,$[0]=(V+q)/B,$[1]=(U+N)/B,$[2]=0.25*B;return $}function O41($,Q,J,Z){Q[0]=Z[12],Q[1]=Z[13],Q[2]=Z[14];let K=Z[0],X=Z[1],Y=Z[2],W=Z[4],q=Z[5],H=Z[6],F=Z[8],U=Z[9],V=Z[10];J[0]=Math.sqrt(K*K+X*X+Y*Y),J[1]=Math.sqrt(W*W+q*q+H*H),J[2]=Math.sqrt(F*F+U*U+V*V);let N=1/J[0],D=1/J[1],z=1/J[2],B=K*N,M=X*D,P=Y*z,O=W*N,G=q*D,L=H*z,b=F*N,d=U*D,p=V*z,i=B+G+p,l=0;if(i>0)l=Math.sqrt(i+1)*2,$[3]=0.25*l,$[0]=(L-d)/l,$[1]=(b-P)/l,$[2]=(M-O)/l;else if(B>G&&B>p)l=Math.sqrt(1+B-G-p)*2,$[3]=(L-d)/l,$[0]=0.25*l,$[1]=(M+O)/l,$[2]=(b+P)/l;else if(G>p)l=Math.sqrt(1+G-B-p)*2,$[3]=(b-P)/l,$[0]=(M+O)/l,$[1]=0.25*l,$[2]=(L+d)/l;else l=Math.sqrt(1+p-B-G)*2,$[3]=(M-O)/l,$[0]=(b+P)/l,$[1]=(L+d)/l,$[2]=0.25*l;return $}function P41($,Q,J,Z){let K=Q[0],X=Q[1],Y=Q[2],W=Q[3],q=K+K,H=X+X,F=Y+Y,U=K*q,V=K*H,N=K*F,D=X*H,z=X*F,B=Y*F,M=W*q,P=W*H,O=W*F,G=Z[0],L=Z[1],b=Z[2];return $[0]=(1-(D+B))*G,$[1]=(V+O)*G,$[2]=(N-P)*G,$[3]=0,$[4]=(V-O)*L,$[5]=(1-(U+B))*L,$[6]=(z+M)*L,$[7]=0,$[8]=(N+P)*b,$[9]=(z-M)*b,$[10]=(1-(U+D))*b,$[11]=0,$[12]=J[0],$[13]=J[1],$[14]=J[2],$[15]=1,$}function M41($,Q,J,Z,K){let X=Q[0],Y=Q[1],W=Q[2],q=Q[3],H=X+X,F=Y+Y,U=W+W,V=X*H,N=X*F,D=X*U,z=Y*F,B=Y*U,M=W*U,P=q*H,O=q*F,G=q*U,L=Z[0],b=Z[1],d=Z[2],p=K[0],i=K[1],l=K[2],N1=(1-(z+M))*L,Y1=(N+G)*L,a=(D-O)*L,D1=(N-G)*b,F0=(1-(V+M))*b,d5=(B+P)*b,F6=(D+O)*d,u6=(B-P)*d,c=(1-(V+z))*d;return $[0]=N1,$[1]=Y1,$[2]=a,$[3]=0,$[4]=D1,$[5]=F0,$[6]=d5,$[7]=0,$[8]=F6,$[9]=u6,$[10]=c,$[11]=0,$[12]=J[0]+p-(N1*p+D1*i+F6*l),$[13]=J[1]+i-(Y1*p+F0*i+u6*l),$[14]=J[2]+l-(a*p+d5*i+c*l),$[15]=1,$}function wV($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=Q[3],Y=J+J,W=Z+Z,q=K+K,H=J*Y,F=Z*Y,U=Z*W,V=K*Y,N=K*W,D=K*q,z=X*Y,B=X*W,M=X*q;return $[0]=1-U-D,$[1]=F+M,$[2]=V-B,$[3]=0,$[4]=F-M,$[5]=1-H-D,$[6]=N+z,$[7]=0,$[8]=V+B,$[9]=N-z,$[10]=1-H-U,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function SV($,Q,J,Z,K,X,Y){let W=1/(J-Q),q=1/(K-Z),H=1/(X-Y);return $[0]=X*2*W,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=X*2*q,$[6]=0,$[7]=0,$[8]=(J+Q)*W,$[9]=(K+Z)*q,$[10]=(Y+X)*H,$[11]=-1,$[12]=0,$[13]=0,$[14]=Y*X*2*H,$[15]=0,$}function ah($,Q,J,Z,K){let X=1/Math.tan(Q/2);if($[0]=X/J,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=X,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[11]=-1,$[12]=0,$[13]=0,$[15]=0,K!=null&&K!==1/0){let Y=1/(Z-K);$[10]=(K+Z)*Y,$[14]=2*K*Z*Y}else $[10]=-1,$[14]=-2*Z;return $}function w41($,Q,J,Z,K){let X=1/Math.tan(Q/2);if($[0]=X/J,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=X,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[11]=-1,$[12]=0,$[13]=0,$[15]=0,K!=null&&K!==1/0){let Y=1/(Z-K);$[10]=K*Y,$[14]=K*Z*Y}else $[10]=-1,$[14]=-Z;return $}function S41($,Q,J,Z){let K=Math.tan(Q.upDegrees*Math.PI/180),X=Math.tan(Q.downDegrees*Math.PI/180),Y=Math.tan(Q.leftDegrees*Math.PI/180),W=Math.tan(Q.rightDegrees*Math.PI/180),q=2/(Y+W),H=2/(K+X);return $[0]=q,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=H,$[6]=0,$[7]=0,$[8]=-((Y-W)*q*0.5),$[9]=(K-X)*H*0.5,$[10]=Z/(J-Z),$[11]=-1,$[12]=0,$[13]=0,$[14]=Z*J/(J-Z),$[15]=0,$}function th($,Q,J,Z,K,X,Y){let W=1/(Q-J),q=1/(Z-K),H=1/(X-Y);return $[0]=-2*W,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=-2*q,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=2*H,$[11]=0,$[12]=(Q+J)*W,$[13]=(K+Z)*q,$[14]=(Y+X)*H,$[15]=1,$}function T41($,Q,J,Z,K,X,Y){let W=1/(Q-J),q=1/(Z-K),H=1/(X-Y);return $[0]=-2*W,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=-2*q,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=H,$[11]=0,$[12]=(Q+J)*W,$[13]=(K+Z)*q,$[14]=X*H,$[15]=1,$}function GV($,Q,J,Z){let K,X,Y,W,q,H,F,U,V,N,D=Q[0],z=Q[1],B=Q[2],M=Z[0],P=Z[1],O=Z[2],G=J[0],L=J[1],b=J[2];if(Math.abs(D-G)<w1&&Math.abs(z-L)<w1&&Math.abs(B-b)<w1)return sh($);if(U=D-G,V=z-L,N=B-b,K=1/Math.sqrt(U*U+V*V+N*N),U*=K,V*=K,N*=K,X=P*N-O*V,Y=O*U-M*N,W=M*V-P*U,K=Math.sqrt(X*X+Y*Y+W*W),!K)X=0,Y=0,W=0;else K=1/K,X*=K,Y*=K,W*=K;if(q=V*W-N*Y,H=N*X-U*W,F=U*Y-V*X,K=Math.sqrt(q*q+H*H+F*F),!K)q=0,H=0,F=0;else K=1/K,q*=K,H*=K,F*=K;return $[0]=X,$[1]=q,$[2]=U,$[3]=0,$[4]=Y,$[5]=H,$[6]=V,$[7]=0,$[8]=W,$[9]=F,$[10]=N,$[11]=0,$[12]=-(X*D+Y*z+W*B),$[13]=-(q*D+H*z+F*B),$[14]=-(U*D+V*z+N*B),$[15]=1,$}function I41($,Q,J,Z){let K=Q[0],X=Q[1],Y=Q[2],W=Z[0],q=Z[1],H=Z[2],F=K-J[0],U=X-J[1],V=Y-J[2],N=F*F+U*U+V*V;if(N>0)N=1/Math.sqrt(N),F*=N,U*=N,V*=N;let D=q*V-H*U,z=H*F-W*V,B=W*U-q*F;if(N=D*D+z*z+B*B,N>0)N=1/Math.sqrt(N),D*=N,z*=N,B*=N;return $[0]=D,$[1]=z,$[2]=B,$[3]=0,$[4]=U*B-V*z,$[5]=V*D-F*B,$[6]=F*z-U*D,$[7]=0,$[8]=F,$[9]=U,$[10]=V,$[11]=0,$[12]=K,$[13]=X,$[14]=Y,$[15]=1,$}function G41($){return`mat4(${$[0]}, ${$[1]}, ${$[2]}, ${$[3]}, ${$[4]}, ${$[5]}, ${$[6]}, ${$[7]}, ${$[8]}, ${$[9]}, ${$[10]}, ${$[11]}, ${$[12]}, ${$[13]}, ${$[14]}, ${$[15]})`}function E41($){return Math.sqrt($[0]*$[0]+$[1]*$[1]+$[2]*$[2]+$[3]*$[3]+$[4]*$[4]+$[5]*$[5]+$[6]*$[6]+$[7]*$[7]+$[8]*$[8]+$[9]*$[9]+$[10]*$[10]+$[11]*$[11]+$[12]*$[12]+$[13]*$[13]+$[14]*$[14]+$[15]*$[15])}function j41($,Q,J){return $[0]=Q[0]+J[0],$[1]=Q[1]+J[1],$[2]=Q[2]+J[2],$[3]=Q[3]+J[3],$[4]=Q[4]+J[4],$[5]=Q[5]+J[5],$[6]=Q[6]+J[6],$[7]=Q[7]+J[7],$[8]=Q[8]+J[8],$[9]=Q[9]+J[9],$[10]=Q[10]+J[10],$[11]=Q[11]+J[11],$[12]=Q[12]+J[12],$[13]=Q[13]+J[13],$[14]=Q[14]+J[14],$[15]=Q[15]+J[15],$}function eh($,Q,J){return $[0]=Q[0]-J[0],$[1]=Q[1]-J[1],$[2]=Q[2]-J[2],$[3]=Q[3]-J[3],$[4]=Q[4]-J[4],$[5]=Q[5]-J[5],$[6]=Q[6]-J[6],$[7]=Q[7]-J[7],$[8]=Q[8]-J[8],$[9]=Q[9]-J[9],$[10]=Q[10]-J[10],$[11]=Q[11]-J[11],$[12]=Q[12]-J[12],$[13]=Q[13]-J[13],$[14]=Q[14]-J[14],$[15]=Q[15]-J[15],$}function h41($,Q,J){return $[0]=Q[0]*J,$[1]=Q[1]*J,$[2]=Q[2]*J,$[3]=Q[3]*J,$[4]=Q[4]*J,$[5]=Q[5]*J,$[6]=Q[6]*J,$[7]=Q[7]*J,$[8]=Q[8]*J,$[9]=Q[9]*J,$[10]=Q[10]*J,$[11]=Q[11]*J,$[12]=Q[12]*J,$[13]=Q[13]*J,$[14]=Q[14]*J,$[15]=Q[15]*J,$}function L41($,Q,J,Z){return $[0]=Q[0]+J[0]*Z,$[1]=Q[1]+J[1]*Z,$[2]=Q[2]+J[2]*Z,$[3]=Q[3]+J[3]*Z,$[4]=Q[4]+J[4]*Z,$[5]=Q[5]+J[5]*Z,$[6]=Q[6]+J[6]*Z,$[7]=Q[7]+J[7]*Z,$[8]=Q[8]+J[8]*Z,$[9]=Q[9]+J[9]*Z,$[10]=Q[10]+J[10]*Z,$[11]=Q[11]+J[11]*Z,$[12]=Q[12]+J[12]*Z,$[13]=Q[13]+J[13]*Z,$[14]=Q[14]+J[14]*Z,$[15]=Q[15]+J[15]*Z,$}function v41($,Q){return $[0]===Q[0]&&$[1]===Q[1]&&$[2]===Q[2]&&$[3]===Q[3]&&$[4]===Q[4]&&$[5]===Q[5]&&$[6]===Q[6]&&$[7]===Q[7]&&$[8]===Q[8]&&$[9]===Q[9]&&$[10]===Q[10]&&$[11]===Q[11]&&$[12]===Q[12]&&$[13]===Q[13]&&$[14]===Q[14]&&$[15]===Q[15]}function _41($,Q){let J=$[0],Z=$[1],K=$[2],X=$[3],Y=$[4],W=$[5],q=$[6],H=$[7],F=$[8],U=$[9],V=$[10],N=$[11],D=$[12],z=$[13],B=$[14],M=$[15],P=Q[0],O=Q[1],G=Q[2],L=Q[3],b=Q[4],d=Q[5],p=Q[6],i=Q[7],l=Q[8],N1=Q[9],Y1=Q[10],a=Q[11],D1=Q[12],F0=Q[13],d5=Q[14],F6=Q[15];return Math.abs(J-P)<=w1*Math.max(1,Math.abs(J),Math.abs(P))&&Math.abs(Z-O)<=w1*Math.max(1,Math.abs(Z),Math.abs(O))&&Math.abs(K-G)<=w1*Math.max(1,Math.abs(K),Math.abs(G))&&Math.abs(X-L)<=w1*Math.max(1,Math.abs(X),Math.abs(L))&&Math.abs(Y-b)<=w1*Math.max(1,Math.abs(Y),Math.abs(b))&&Math.abs(W-d)<=w1*Math.max(1,Math.abs(W),Math.abs(d))&&Math.abs(q-p)<=w1*Math.max(1,Math.abs(q),Math.abs(p))&&Math.abs(H-i)<=w1*Math.max(1,Math.abs(H),Math.abs(i))&&Math.abs(F-l)<=w1*Math.max(1,Math.abs(F),Math.abs(l))&&Math.abs(U-N1)<=w1*Math.max(1,Math.abs(U),Math.abs(N1))&&Math.abs(V-Y1)<=w1*Math.max(1,Math.abs(V),Math.abs(Y1))&&Math.abs(N-a)<=w1*Math.max(1,Math.abs(N),Math.abs(a))&&Math.abs(D-D1)<=w1*Math.max(1,Math.abs(D),Math.abs(D1))&&Math.abs(z-F0)<=w1*Math.max(1,Math.abs(z),Math.abs(F0))&&Math.abs(B-d5)<=w1*Math.max(1,Math.abs(B),Math.abs(d5))&&Math.abs(M-F6)<=w1*Math.max(1,Math.abs(M),Math.abs(F6))}var TV,IV,x41,g41;var EV=C(()=>{R8();TV=ah;IV=th;x41=Q$,g41=eh});var Q6={};E7(Q6,{zero:()=>s41,transformQuat:()=>n41,transformMat4:()=>vV,subtract:()=>YL,sub:()=>a41,str:()=>o41,squaredLength:()=>hV,squaredDistance:()=>UL,sqrLen:()=>Z71,sqrDist:()=>Q71,set:()=>KL,scaleAndAdd:()=>d41,scale:()=>HL,round:()=>c41,random:()=>i41,normalize:()=>LV,negate:()=>l41,multiply:()=>WL,mul:()=>t41,min:()=>b41,max:()=>m41,lerp:()=>NL,length:()=>jV,len:()=>J71,inverse:()=>p41,fromValues:()=>JL,forEach:()=>K71,floor:()=>f41,exactEquals:()=>DL,equals:()=>r41,dot:()=>VL,divide:()=>qL,div:()=>e41,distance:()=>FL,dist:()=>$71,cross:()=>u41,create:()=>$L,copy:()=>ZL,clone:()=>QL,ceil:()=>y41,add:()=>XL});function $L(){let $=new y1(4);if(y1!=Float32Array)$[0]=0,$[1]=0,$[2]=0,$[3]=0;return $}function QL($){let Q=new y1(4);return Q[0]=$[0],Q[1]=$[1],Q[2]=$[2],Q[3]=$[3],Q}function JL($,Q,J,Z){let K=new y1(4);return K[0]=$,K[1]=Q,K[2]=J,K[3]=Z,K}function ZL($,Q){return $[0]=Q[0],$[1]=Q[1],$[2]=Q[2],$[3]=Q[3],$}function KL($,Q,J,Z,K){return $[0]=Q,$[1]=J,$[2]=Z,$[3]=K,$}function XL($,Q,J){return $[0]=Q[0]+J[0],$[1]=Q[1]+J[1],$[2]=Q[2]+J[2],$[3]=Q[3]+J[3],$}function YL($,Q,J){return $[0]=Q[0]-J[0],$[1]=Q[1]-J[1],$[2]=Q[2]-J[2],$[3]=Q[3]-J[3],$}function WL($,Q,J){return $[0]=Q[0]*J[0],$[1]=Q[1]*J[1],$[2]=Q[2]*J[2],$[3]=Q[3]*J[3],$}function qL($,Q,J){return $[0]=Q[0]/J[0],$[1]=Q[1]/J[1],$[2]=Q[2]/J[2],$[3]=Q[3]/J[3],$}function y41($,Q){return $[0]=Math.ceil(Q[0]),$[1]=Math.ceil(Q[1]),$[2]=Math.ceil(Q[2]),$[3]=Math.ceil(Q[3]),$}function f41($,Q){return $[0]=Math.floor(Q[0]),$[1]=Math.floor(Q[1]),$[2]=Math.floor(Q[2]),$[3]=Math.floor(Q[3]),$}function b41($,Q,J){return $[0]=Math.min(Q[0],J[0]),$[1]=Math.min(Q[1],J[1]),$[2]=Math.min(Q[2],J[2]),$[3]=Math.min(Q[3],J[3]),$}function m41($,Q,J){return $[0]=Math.max(Q[0],J[0]),$[1]=Math.max(Q[1],J[1]),$[2]=Math.max(Q[2],J[2]),$[3]=Math.max(Q[3],J[3]),$}function c41($,Q){return $[0]=y5(Q[0]),$[1]=y5(Q[1]),$[2]=y5(Q[2]),$[3]=y5(Q[3]),$}function HL($,Q,J){return $[0]=Q[0]*J,$[1]=Q[1]*J,$[2]=Q[2]*J,$[3]=Q[3]*J,$}function d41($,Q,J,Z){return $[0]=Q[0]+J[0]*Z,$[1]=Q[1]+J[1]*Z,$[2]=Q[2]+J[2]*Z,$[3]=Q[3]+J[3]*Z,$}function FL($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1],K=Q[2]-$[2],X=Q[3]-$[3];return Math.sqrt(J*J+Z*Z+K*K+X*X)}function UL($,Q){let J=Q[0]-$[0],Z=Q[1]-$[1],K=Q[2]-$[2],X=Q[3]-$[3];return J*J+Z*Z+K*K+X*X}function jV($){let Q=$[0],J=$[1],Z=$[2],K=$[3];return Math.sqrt(Q*Q+J*J+Z*Z+K*K)}function hV($){let Q=$[0],J=$[1],Z=$[2],K=$[3];return Q*Q+J*J+Z*Z+K*K}function l41($,Q){return $[0]=-Q[0],$[1]=-Q[1],$[2]=-Q[2],$[3]=-Q[3],$}function p41($,Q){return $[0]=1/Q[0],$[1]=1/Q[1],$[2]=1/Q[2],$[3]=1/Q[3],$}function LV($,Q){let J=Q[0],Z=Q[1],K=Q[2],X=Q[3],Y=J*J+Z*Z+K*K+X*X;if(Y>0)Y=1/Math.sqrt(Y);return $[0]=J*Y,$[1]=Z*Y,$[2]=K*Y,$[3]=X*Y,$}function VL($,Q){return $[0]*Q[0]+$[1]*Q[1]+$[2]*Q[2]+$[3]*Q[3]}function u41($,Q,J,Z){let K=J[0]*Z[1]-J[1]*Z[0],X=J[0]*Z[2]-J[2]*Z[0],Y=J[0]*Z[3]-J[3]*Z[0],W=J[1]*Z[2]-J[2]*Z[1],q=J[1]*Z[3]-J[3]*Z[1],H=J[2]*Z[3]-J[3]*Z[2],F=Q[0],U=Q[1],V=Q[2],N=Q[3];return $[0]=U*H-V*q+N*W,$[1]=-(F*H)+V*Y-N*X,$[2]=F*q-U*Y+N*K,$[3]=-(F*W)+U*X-V*K,$}function NL($,Q,J,Z){let K=Q[0],X=Q[1],Y=Q[2],W=Q[3];return $[0]=K+Z*(J[0]-K),$[1]=X+Z*(J[1]-X),$[2]=Y+Z*(J[2]-Y),$[3]=W+Z*(J[3]-W),$}function i41($,Q){Q=Q===void 0?1:Q;let J,Z,K,X,Y,W;do J=x6()*2-1,Z=x6()*2-1,Y=J*J+Z*Z;while(Y>=1);do K=x6()*2-1,X=x6()*2-1,W=K*K+X*X;while(W>=1);let q=Math.sqrt((1-Y)/W);return $[0]=Q*J,$[1]=Q*Z,$[2]=Q*K*q,$[3]=Q*X*q,$}function vV($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=Q[3];return $[0]=J[0]*Z+J[4]*K+J[8]*X+J[12]*Y,$[1]=J[1]*Z+J[5]*K+J[9]*X+J[13]*Y,$[2]=J[2]*Z+J[6]*K+J[10]*X+J[14]*Y,$[3]=J[3]*Z+J[7]*K+J[11]*X+J[15]*Y,$}function n41($,Q,J){let Z=Q[0],K=Q[1],X=Q[2],Y=J[0],W=J[1],q=J[2],H=J[3],F=H*Z+W*X-q*K,U=H*K+q*Z-Y*X,V=H*X+Y*K-W*Z,N=-Y*Z-W*K-q*X;return $[0]=F*H+N*-Y+U*-q-V*-W,$[1]=U*H+N*-W+V*-Y-F*-q,$[2]=V*H+N*-q+F*-W-U*-Y,$[3]=Q[3],$}function s41($){return $[0]=0,$[1]=0,$[2]=0,$[3]=0,$}function o41($){return`vec4(${$[0]}, ${$[1]}, ${$[2]}, ${$[3]})`}function DL($,Q){return $[0]===Q[0]&&$[1]===Q[1]&&$[2]===Q[2]&&$[3]===Q[3]}function r41($,Q){let J=$[0],Z=$[1],K=$[2],X=$[3],Y=Q[0],W=Q[1],q=Q[2],H=Q[3];return Math.abs(J-Y)<=w1*Math.max(1,Math.abs(J),Math.abs(Y))&&Math.abs(Z-W)<=w1*Math.max(1,Math.abs(Z),Math.abs(W))&&Math.abs(K-q)<=w1*Math.max(1,Math.abs(K),Math.abs(q))&&Math.abs(X-H)<=w1*Math.max(1,Math.abs(X),Math.abs(H))}var a41,t41,e41,$71,Q71,J71,Z71,K71;var _Z=C(()=>{R8();a41=YL,t41=WL,e41=qL,$71=FL,Q71=UL,J71=jV,Z71=hV,K71=function(){let $=$L();return function(Q,J,Z,K,X,Y){let W,q;if(!J)J=4;if(!Z)Z=0;if(K)q=Math.min(K*J+Z,Q.length);else q=Q.length;for(W=Z;W<q;W+=J)$[0]=Q[W],$[1]=Q[W+1],$[2]=Q[W+2],$[3]=Q[W+3],X($,$,Y),Q[W]=$[0],Q[W+1]=$[1],Q[W+2]=$[2],Q[W+3]=$[3];return Q}}()});function q71(){if(!xZ)xZ=new x0([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(xZ);return xZ}function H71(){if(!gZ)gZ=new x0,Object.freeze(gZ);return gZ}function CL($){if($>Math.PI*2)throw Error("expected radians")}function F71($,Q,J,Z,K,X){let Y=2*X/(J-Q),W=2*X/(K-Z),q=(J+Q)/(J-Q),H=(K+Z)/(K-Z),F=-1,U=-1,V=-2*X;return $[0]=Y,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=W,$[6]=0,$[7]=0,$[8]=q,$[9]=H,$[10]=-1,$[11]=-1,$[12]=0,$[13]=0,$[14]=V,$[15]=0,$}var gV,X71,Y71=1,_V=0.1,xV=500,W71,x0,xZ,gZ;var AL=C(()=>{uh();a2();EV();ZV();$$();_Z();(function($){$[$.COL0ROW0=0]="COL0ROW0",$[$.COL0ROW1=1]="COL0ROW1",$[$.COL0ROW2=2]="COL0ROW2",$[$.COL0ROW3=3]="COL0ROW3",$[$.COL1ROW0=4]="COL1ROW0",$[$.COL1ROW1=5]="COL1ROW1",$[$.COL1ROW2=6]="COL1ROW2",$[$.COL1ROW3=7]="COL1ROW3",$[$.COL2ROW0=8]="COL2ROW0",$[$.COL2ROW1=9]="COL2ROW1",$[$.COL2ROW2=10]="COL2ROW2",$[$.COL2ROW3=11]="COL2ROW3",$[$.COL3ROW0=12]="COL3ROW0",$[$.COL3ROW1=13]="COL3ROW1",$[$.COL3ROW2=14]="COL3ROW2",$[$.COL3ROW3=15]="COL3ROW3"})(gV||(gV={}));X71=45*Math.PI/180,W71=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);x0=class x0 extends NV{static get IDENTITY(){return H71()}static get ZERO(){return q71()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return gV}constructor($){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0);if(arguments.length===1&&Array.isArray($))this.copy($);else this.identity()}copy($){return this[0]=$[0],this[1]=$[1],this[2]=$[2],this[3]=$[3],this[4]=$[4],this[5]=$[5],this[6]=$[6],this[7]=$[7],this[8]=$[8],this[9]=$[9],this[10]=$[10],this[11]=$[11],this[12]=$[12],this[13]=$[13],this[14]=$[14],this[15]=$[15],this.check()}set($,Q,J,Z,K,X,Y,W,q,H,F,U,V,N,D,z){return this[0]=$,this[1]=Q,this[2]=J,this[3]=Z,this[4]=K,this[5]=X,this[6]=Y,this[7]=W,this[8]=q,this[9]=H,this[10]=F,this[11]=U,this[12]=V,this[13]=N,this[14]=D,this[15]=z,this.check()}setRowMajor($,Q,J,Z,K,X,Y,W,q,H,F,U,V,N,D,z){return this[0]=$,this[1]=K,this[2]=q,this[3]=V,this[4]=Q,this[5]=X,this[6]=H,this[7]=N,this[8]=J,this[9]=Y,this[10]=F,this[11]=D,this[12]=Z,this[13]=W,this[14]=U,this[15]=z,this.check()}toRowMajor($){return $[0]=this[0],$[1]=this[4],$[2]=this[8],$[3]=this[12],$[4]=this[1],$[5]=this[5],$[6]=this[9],$[7]=this[13],$[8]=this[2],$[9]=this[6],$[10]=this[10],$[11]=this[14],$[12]=this[3],$[13]=this[7],$[14]=this[11],$[15]=this[15],$}identity(){return this.copy(W71)}fromObject($){return this.check()}fromQuaternion($){return wV(this,$),this.check()}frustum($){let{left:Q,right:J,bottom:Z,top:K,near:X=_V,far:Y=xV}=$;if(Y===1/0)F71(this,Q,J,Z,K,X);else SV(this,Q,J,Z,K,X,Y);return this.check()}lookAt($){let{eye:Q,center:J=[0,0,0],up:Z=[0,1,0]}=$;return GV(this,Q,J,Z),this.check()}ortho($){let{left:Q,right:J,bottom:Z,top:K,near:X=_V,far:Y=xV}=$;return IV(this,Q,J,Z,K,X,Y),this.check()}orthographic($){let{fovy:Q=X71,aspect:J=Y71,focalDistance:Z=1,near:K=_V,far:X=xV}=$;CL(Q);let Y=Q/2,W=Z*Math.tan(Y),q=W*J;return this.ortho({left:-q,right:q,bottom:-W,top:W,near:K,far:X})}perspective($){let{fovy:Q=45*Math.PI/180,aspect:J=1,near:Z=0.1,far:K=500}=$;return CL(Q),TV(this,Q,J,Z,K),this.check()}determinant(){return zV(this)}getScale($=[-0,-0,-0]){return $[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),$[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),$[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),$}getTranslation($=[-0,-0,-0]){return $[0]=this[12],$[1]=this[13],$[2]=this[14],$}getRotation($,Q){$=$||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],Q=Q||[-0,-0,-0];let J=this.getScale(Q),Z=1/J[0],K=1/J[1],X=1/J[2];return $[0]=this[0]*Z,$[1]=this[1]*K,$[2]=this[2]*X,$[3]=0,$[4]=this[4]*Z,$[5]=this[5]*K,$[6]=this[6]*X,$[7]=0,$[8]=this[8]*Z,$[9]=this[9]*K,$[10]=this[10]*X,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}getRotationMatrix3($,Q){$=$||[-0,-0,-0,-0,-0,-0,-0,-0,-0],Q=Q||[-0,-0,-0];let J=this.getScale(Q),Z=1/J[0],K=1/J[1],X=1/J[2];return $[0]=this[0]*Z,$[1]=this[1]*K,$[2]=this[2]*X,$[3]=this[4]*Z,$[4]=this[5]*K,$[5]=this[6]*X,$[6]=this[8]*Z,$[7]=this[9]*K,$[8]=this[10]*X,$}transpose(){return CV(this,this),this.check()}invert(){return AV(this,this),this.check()}multiplyLeft($){return Q$(this,$,this),this.check()}multiplyRight($){return Q$(this,this,$),this.check()}rotateX($){return OV(this,this,$),this.check()}rotateY($){return PV(this,this,$),this.check()}rotateZ($){return MV(this,this,$),this.check()}rotateXYZ($){return this.rotateX($[0]).rotateY($[1]).rotateZ($[2])}rotateAxis($,Q){return RV(this,this,$,Q),this.check()}scale($){return BV(this,this,Array.isArray($)?$:[$,$,$]),this.check()}translate($){return kV(this,this,$),this.check()}transform($,Q){if($.length===4)return Q=vV(Q||[-0,-0,-0,-0],$,this),EZ(Q,4),Q;return this.transformAsPoint($,Q)}transformAsPoint($,Q){let{length:J}=$,Z;switch(J){case 2:Z=JV(Q||[-0,-0],$,this);break;case 3:Z=e2(Q||[-0,-0,-0],$,this);break;default:throw Error("Illegal vector")}return EZ(Z,$.length),Z}transformAsVector($,Q){let J;switch($.length){case 2:J=xh(Q||[-0,-0],$,this);break;case 3:J=jZ(Q||[-0,-0,-0],$,this);break;default:throw Error("Illegal vector")}return EZ(J,$.length),J}transformPoint($,Q){return this.transformAsPoint($,Q)}transformVector($,Q){return this.transformAsPoint($,Q)}transformDirection($,Q){return this.transformAsVector($,Q)}makeRotationX($){return this.identity().rotateX($)}makeTranslation($,Q,J){return this.identity().translate([$,Q,J])}}});function zL(){let $=new y1(4);if(y1!=Float32Array)$[0]=0,$[1]=0,$[2]=0;return $[3]=1,$}function U71($,Q,J){J=J*0.5;let Z=Math.sin(J);return $[0]=Z*Q[0],$[1]=Z*Q[1],$[2]=Z*Q[2],$[3]=Math.cos(J),$}function yV($,Q,J,Z){let K=Q[0],X=Q[1],Y=Q[2],W=Q[3],q=J[0],H=J[1],F=J[2],U=J[3],V,N,D,z,B;if(V=K*q+X*H+Y*F+W*U,V<0)V=-V,q=-q,H=-H,F=-F,U=-U;if(1-V>w1)N=Math.acos(V),B=Math.sin(N),D=Math.sin((1-Z)*N)/B,z=Math.sin(Z*N)/B;else D=1-Z,z=Z;return $[0]=D*K+z*q,$[1]=D*X+z*H,$[2]=D*Y+z*F,$[3]=D*W+z*U,$}function V71($,Q){let J=Q[0]+Q[4]+Q[8],Z;if(J>0)Z=Math.sqrt(J+1),$[3]=0.5*Z,Z=0.5/Z,$[0]=(Q[5]-Q[7])*Z,$[1]=(Q[6]-Q[2])*Z,$[2]=(Q[1]-Q[3])*Z;else{let K=0;if(Q[4]>Q[0])K=1;if(Q[8]>Q[K*3+K])K=2;let X=(K+1)%3,Y=(K+2)%3;Z=Math.sqrt(Q[K*3+K]-Q[X*3+X]-Q[Y*3+Y]+1),$[K]=0.5*Z,Z=0.5/Z,$[3]=(Q[X*3+Y]-Q[Y*3+X])*Z,$[X]=(Q[X*3+K]+Q[K*3+X])*Z,$[Y]=(Q[Y*3+K]+Q[K*3+Y])*Z}return $}var kL,ez1,$k1,Qk1;var BL=C(()=>{R8();DV();$$();_Z();kL=LV,ez1=function(){let $=hZ(),Q=LZ(1,0,0),J=LZ(0,1,0);return function(Z,K,X){let Y=t2(K,X);if(Y<-0.999999){if(O8($,Q,K),UV($)<0.000001)O8($,J,K);return KV($,$),U71(Z,$,Math.PI),Z}else if(Y>0.999999)return Z[0]=0,Z[1]=0,Z[2]=0,Z[3]=1,Z;return O8($,K,X),Z[0]=$[0],Z[1]=$[1],Z[2]=$[2],Z[3]=1+Y,kL(Z,Z)}}(),$k1=function(){let $=zL(),Q=zL();return function(J,Z,K,X,Y,W){return yV($,Z,Y,W),yV(Q,K,X,W),yV(J,$,Q,2*W*(1-W)),J}}(),Qk1=function(){let $=ih();return function(Q,J,Z,K){return $[0]=Z[0],$[3]=Z[1],$[6]=Z[2],$[1]=K[0],$[4]=K[1],$[7]=K[2],$[2]=-J[0],$[5]=-J[1],$[8]=-J[2],kL(Q,V71(Q,$))}}()});var Jk1,Zk1,Kk1,Xk1;var RL=C(()=>{Jk1=Math.PI/2,Zk1=Math.PI/4,Kk1=Math.PI/6,Xk1=Math.PI*2});var g0=C(()=>{ph();AL();RL();d9();DV();EV();BL();ZV();$$();_Z()});function fV($,Q=[],J=0){let Z=Math.fround($),K=$-Z;return Q[J]=Z,Q[J+1]=K,Q}function OL($){return $-Math.fround($)}function PL($){let Q=new Float32Array(32);for(let J=0;J<4;++J)for(let Z=0;Z<4;++Z){let K=J*4+Z;fV($[Z*4+J],Q,K*2)}return Q}var bV;var ML=C(()=>{bV={name:"fp32",vs:`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`}});var wL=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`;var C71,mV;var SL=C(()=>{C71={ONE:1},mV={name:"fp64arithmetic",vs:wL,defaultUniforms:C71,uniformTypes:{ONE:"f32"},fp64ify:fV,fp64LowPart:OL,fp64ifyMatrix4:PL}});function z71($={},Q){let J={};if($.highlightedObjectColor===void 0);else if($.highlightedObjectColor===null)J.isHighlightActive=!1;else{J.isHighlightActive=!0;let Z=$.highlightedObjectColor.slice(0,3);J.highlightedObjectColor=Z}if($.highlightColor){let Z=Array.from($.highlightColor,(K)=>K/255);if(!Number.isFinite(Z[3]))Z[3]=1;J.highlightColor=Z}if($.isActive!==void 0)J.isActive=Boolean($.isActive),J.isAttribute=Boolean($.isAttribute);if($.useFloatColors!==void 0)J.useFloatColors=Boolean($.useFloatColors);return J}var A71,yZ;var TL=C(()=>{A71=[0,1,1,1],yZ={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:A71},vs:`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,fs:`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,getUniforms:z71}});var cV=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`;var IL=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`;function B71($,Q={}){if($=$?{...$}:$,!$)return{...J$.defaultUniforms};if($.lights)$={...$,...O71($.lights),lights:void 0};let{ambientLight:J,pointLights:Z,directionalLights:K}=$||{};if(!(J||Z&&Z.length>0||K&&K.length>0))return{...J$.defaultUniforms,enabled:0};let Y={...J$.defaultUniforms,...Q,...R71({ambientLight:J,pointLights:Z,directionalLights:K})};if($.enabled!==void 0)Y.enabled=$.enabled?1:0;return Y}function R71({ambientLight:$,pointLights:Q=[],directionalLights:J=[]}){let Z={};Z.ambientLightColor=dV($);let K=0;for(let X of Q){Z.lightType=Z$.POINT;let Y=K;Z[`lightColor${Y}`]=dV(X),Z[`lightPosition${Y}`]=X.position,Z[`lightAttenuation${Y}`]=X.attenuation||[1,0,0],K++}for(let X of J){Z.lightType=Z$.DIRECTIONAL;let Y=K;Z[`lightColor${Y}`]=dV(X),Z[`lightDirection${Y}`]=X.direction,K++}if(K>GL)f.warn("MAX_LIGHTS exceeded")();return Z.directionalLightCount=J.length,Z.pointLightCount=Q.length,Z}function O71($){let Q={pointLights:[],directionalLights:[]};for(let J of $||[])switch(J.type){case"ambient":Q.ambientLight=J;break;case"directional":Q.directionalLights?.push(J);break;case"point":Q.pointLights?.push(J);break;default:}return Q}function dV($={}){let{color:Q=[0,0,0],intensity:J=1}=$;return Q.map((Z)=>Z*J/k71)}var GL=3,k71=255,Z$,J$;var EL=C(()=>{O1();(function($){$[$.POINT=0]="POINT",$[$.DIRECTIONAL=1]="DIRECTIONAL"})(Z$||(Z$={}));J$={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:GL},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:Z$.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[0.1,0.1,0.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:IL,vs:cV,fs:cV,getUniforms:B71}});var jL=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,hL=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`;var LL=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`;var fZ;var vL=C(()=>{EL();fZ={props:{},name:"gouraudMaterial",vs:hL.replace("phongMaterial","gouraudMaterial"),fs:jL.replace("phongMaterial","gouraudMaterial"),source:LL.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[J$],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:0.35,diffuse:0.6,shininess:32,specularColor:[0.15,0.15,0.15]},getUniforms($){let Q={...$};if(Q.specularColor)Q.specularColor=Q.specularColor.map((J)=>J/255);return{...fZ.defaultUniforms,...Q}}}});var V4=C(()=>{eF();Nj();Sh();ML();SL();TL();vL()});var lV;var _L=C(()=>{lV={name:"layer",vs:`uniform layerUniforms {
  uniform float opacity;
} layer;
`,fs:`uniform layerUniforms {
  uniform float opacity;
} layer;
`,getUniforms:($)=>{return{opacity:Math.pow($.opacity,0.45454545454545453)}},uniformTypes:{opacity:"f32"}}});var bZ;var pV=C(()=>{bZ={name:"geometry",source:`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,vs:`#define SMOOTH_EDGE_RADIUS 0.5

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,fs:`#define SMOOTH_EDGE_RADIUS 0.5

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`}});var xL=25,_1,n1;var H5=C(()=>{(function($){$[$.Start=1]="Start",$[$.Move=2]="Move",$[$.End=4]="End",$[$.Cancel=8]="Cancel"})(_1||(_1={}));(function($){$[$.None=0]="None",$[$.Left=1]="Left",$[$.Right=2]="Right",$[$.Up=4]="Up",$[$.Down=8]="Down",$[$.Horizontal=3]="Horizontal",$[$.Vertical=12]="Vertical",$[$.All=15]="All"})(n1||(n1={}))});var Z1;var J6=C(()=>{(function($){$[$.Possible=1]="Possible",$[$.Began=2]="Began",$[$.Changed=4]="Changed",$[$.Ended=8]="Ended",$[$.Recognized=8]="Recognized",$[$.Cancelled=16]="Cancelled",$[$.Failed=32]="Failed"})(Z1||(Z1={}))});var gL="compute",uV="auto",K$="manipulation",M8="none",X$="pan-x",Y$="pan-y";function iV($){if($.includes(M8))return M8;let Q=$.includes(X$),J=$.includes(Y$);if(Q&&J)return M8;if(Q||J)return Q?X$:Y$;if($.includes(K$))return K$;return uV}var yL=()=>{};class mZ{constructor($,Q){this.actions="",this.manager=$,this.set(Q)}set($){if($===gL)$=this.compute();if(this.manager.element)this.manager.element.style.touchAction=$,this.actions=$}update(){this.set(this.manager.options.touchAction)}compute(){let $=[];for(let Q of this.manager.recognizers)if(Q.options.enable)$=$.concat(Q.getTouchAction());return iV($.join(" "))}}var nV=C(()=>{yL()});function p9($){return $.trim().split(/\s+/g)}function cZ($,Q,J){if(!$)return;for(let Z of p9(Q))$.addEventListener(Z,J,!1)}function dZ($,Q,J){if(!$)return;for(let Z of p9(Q))$.removeEventListener(Z,J,!1)}var fL=()=>{};function sV($){return($.ownerDocument||$).defaultView}function oV($,Q){let J=$;while(J){if(J===Q)return!0;J=J.parentNode}return!1}function lZ($){let Q=$.length;if(Q===1)return{x:Math.round($[0].clientX),y:Math.round($[0].clientY)};let J=0,Z=0,K=0;while(K<Q)J+=$[K].clientX,Z+=$[K].clientY,K++;return{x:Math.round(J/Q),y:Math.round(Z/Q)}}function rV($){let Q=[],J=0;while(J<$.pointers.length)Q[J]={clientX:Math.round($.pointers[J].clientX),clientY:Math.round($.pointers[J].clientY)},J++;return{timeStamp:Date.now(),pointers:Q,center:lZ(Q),deltaX:$.deltaX,deltaY:$.deltaY}}var bL=()=>{};function pZ($,Q){let J=Q.x-$.x,Z=Q.y-$.y;return Math.sqrt(J*J+Z*Z)}function aV($,Q){let J=Q.clientX-$.clientX,Z=Q.clientY-$.clientY;return Math.sqrt(J*J+Z*Z)}function mL($,Q){let J=Q.x-$.x,Z=Q.y-$.y;return Math.atan2(Z,J)*180/Math.PI}function tV($,Q){let J=Q.clientX-$.clientX,Z=Q.clientY-$.clientY;return Math.atan2(Z,J)*180/Math.PI}function uZ($,Q){if($===Q)return n1.None;if(Math.abs($)>=Math.abs(Q))return $<0?n1.Left:n1.Right;return Q<0?n1.Up:n1.Down}var eV=C(()=>{H5()});function cL($,Q){let J=Q.center,Z=$.offsetDelta,K=$.prevDelta,X=$.prevInput;if(Q.eventType===_1.Start||X?.eventType===_1.End)K=$.prevDelta={x:X?.deltaX||0,y:X?.deltaY||0},Z=$.offsetDelta={x:J.x,y:J.y};return{deltaX:K.x+(J.x-Z.x),deltaY:K.y+(J.y-Z.y)}}var dL=C(()=>{H5()});function iZ($,Q,J){return{x:Q/$||0,y:J/$||0}}function lL($,Q){return aV(Q[0],Q[1])/aV($[0],$[1])}var pL=()=>{};function uL($,Q){return tV(Q[1],Q[0])-tV($[1],$[0])}var iL=()=>{};function nL($,Q){let J=$.lastInterval||Q,Z=Q.timeStamp-J.timeStamp,K,X,Y,W;if(Q.eventType!==_1.Cancel&&(Z>xL||J.velocity===void 0)){let q=Q.deltaX-J.deltaX,H=Q.deltaY-J.deltaY,F=iZ(Z,q,H);X=F.x,Y=F.y,K=Math.abs(F.x)>Math.abs(F.y)?F.x:F.y,W=uZ(q,H),$.lastInterval=Q}else K=J.velocity,X=J.velocityX,Y=J.velocityY,W=J.direction;Q.velocity=K,Q.velocityX=X,Q.velocityY=Y,Q.direction=W}var sL=C(()=>{H5();eV()});function oL($,Q){let{session:J}=$,{pointers:Z}=Q,{length:K}=Z;if(!J.firstInput)J.firstInput=rV(Q);if(K>1&&!J.firstMultiple)J.firstMultiple=rV(Q);else if(K===1)J.firstMultiple=!1;let{firstInput:X,firstMultiple:Y}=J,W=Y?Y.center:X.center,q=Q.center=lZ(Z);Q.timeStamp=Date.now(),Q.deltaTime=Q.timeStamp-X.timeStamp,Q.angle=mL(W,q),Q.distance=pZ(W,q);let{deltaX:H,deltaY:F}=cL(J,Q);Q.deltaX=H,Q.deltaY=F,Q.offsetDirection=uZ(Q.deltaX,Q.deltaY);let U=iZ(Q.deltaTime,Q.deltaX,Q.deltaY);Q.overallVelocityX=U.x,Q.overallVelocityY=U.y,Q.overallVelocity=Math.abs(U.x)>Math.abs(U.y)?U.x:U.y,Q.scale=Y?lL(Y.pointers,Z):1,Q.rotation=Y?uL(Y.pointers,Z):0,Q.maxPointers=!J.prevInput?Q.pointers.length:Q.pointers.length>J.prevInput.maxPointers?Q.pointers.length:J.prevInput.maxPointers;let V=$.element;if(oV(Q.srcEvent.target,V))V=Q.srcEvent.target;return Q.target=V,nL(J,Q),Q}var rL=C(()=>{bL();eV();dL();pL();iL();sL()});function aL($,Q,J){let Z=J.pointers.length,K=J.changedPointers.length,X=Q&_1.Start&&Z-K===0,Y=Q&(_1.End|_1.Cancel)&&Z-K===0;if(J.isFirst=Boolean(X),J.isFinal=Boolean(Y),X)$.session={};J.eventType=Q;let W=oL($,J);$.emit("hammer.input",W),$.recognize(W),$.session.prevInput=W}var tL=C(()=>{H5();rL()});class nZ{constructor($){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=(Q)=>{if(this.manager.options.enable)this.handler(Q)},this.manager=$,this.element=$.element,this.target=$.options.inputTarget||$.element}callback($,Q){aL(this.manager,$,Q)}init(){cZ(this.element,this.evEl,this.domHandler),cZ(this.target,this.evTarget,this.domHandler),cZ(sV(this.element),this.evWin,this.domHandler)}destroy(){dZ(this.element,this.evEl,this.domHandler),dZ(this.target,this.evTarget,this.domHandler),dZ(sV(this.element),this.evWin,this.domHandler)}}var $N=C(()=>{fL();tL()});var P71,M71="pointerdown",w71="pointermove pointerup pointercancel",sZ;var QN=C(()=>{H5();$N();P71={pointerdown:_1.Start,pointermove:_1.Move,pointerup:_1.End,pointercancel:_1.Cancel,pointerout:_1.Cancel};sZ=class sZ extends nZ{constructor($){super($);this.evEl=M71,this.evWin=w71,this.store=this.manager.session.pointerEvents=[],this.init()}handler($){let{store:Q}=this,J=!1,Z=P71[$.type],K=$.pointerType,X=K==="touch",Y=Q.findIndex((W)=>W.pointerId===$.pointerId);if(Z&_1.Start&&($.buttons||X)){if(Y<0)Q.push($),Y=Q.length-1}else if(Z&(_1.End|_1.Cancel))J=!0;if(Y<0)return;if(Q[Y]=$,this.callback(Z,{pointers:Q,changedPointers:[$],eventType:Z,pointerType:K,srcEvent:$}),J)Q.splice(Y,1)}}});function eL($,Q){let J=Q[0].toUpperCase()+Q.slice(1);for(let Z of S71){let K=Z?Z+J:Q;if(K in $)return K}return}var S71;var $v=C(()=>{S71=["","webkit","Moz","MS","ms","o"]});class oZ{constructor($,Q){this.options={...Jv,...Q,cssProps:{...Jv.cssProps,...Q.cssProps},inputTarget:Q.inputTarget||$},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=$,this.input=new sZ(this),this.touchAction=new mZ(this,this.options.touchAction),this.toggleCssProps(!0)}set($){if(Object.assign(this.options,$),$.touchAction)this.touchAction.update();if($.inputTarget)this.input.destroy(),this.input.target=$.inputTarget,this.input.init();return this}stop($){this.session.stopped=$?Qv:T71}recognize($){let{session:Q}=this;if(Q.stopped)return;if(this.session.prevented)$.srcEvent.preventDefault();let J,{recognizers:Z}=this,{curRecognizer:K}=Q;if(!K||K&&K.state&Z1.Recognized)K=Q.curRecognizer=null;let X=0;while(X<Z.length){if(J=Z[X],Q.stopped!==Qv&&(!K||J===K||J.canRecognizeWith(K)))J.recognize($);else J.reset();if(!K&&J.state&(Z1.Began|Z1.Changed|Z1.Ended))K=Q.curRecognizer=J;X++}}get($){let{recognizers:Q}=this;for(let J=0;J<Q.length;J++)if(Q[J].options.event===$)return Q[J];return null}add($){if(Array.isArray($)){for(let J of $)this.add(J);return this}let Q=this.get($.options.event);if(Q)this.remove(Q);return this.recognizers.push($),$.manager=this,this.touchAction.update(),$}remove($){if(Array.isArray($)){for(let J of $)this.remove(J);return this}let Q=typeof $==="string"?this.get($):$;if(Q){let{recognizers:J}=this,Z=J.indexOf(Q);if(Z!==-1)J.splice(Z,1),this.touchAction.update()}return this}on($,Q){if(!$||!Q)return;let{handlers:J}=this;for(let Z of p9($))J[Z]=J[Z]||[],J[Z].push(Q)}off($,Q){if(!$)return;let{handlers:J}=this;for(let Z of p9($))if(!Q)delete J[Z];else if(J[Z])J[Z].splice(J[Z].indexOf(Q),1)}emit($,Q){let J=this.handlers[$]&&this.handlers[$].slice();if(!J||!J.length)return;let Z=Q;Z.type=$,Z.preventDefault=function(){Q.srcEvent.preventDefault()};let K=0;while(K<J.length)J[K](Z),K++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps($){let{element:Q}=this;if(!Q)return;for(let[J,Z]of Object.entries(this.options.cssProps)){let K=eL(Q.style,J);if($)this.oldCssProps[K]=Q.style[K],Q.style[K]=Z;else Q.style[K]=this.oldCssProps[K]||""}if(!$)this.oldCssProps={}}}var T71=1,Qv=2,Jv;var Zv=C(()=>{nV();QN();$v();J6();Jv={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}}});function Kv(){return I71++}var I71=1;function JN($){if($&Z1.Cancelled)return"cancel";else if($&Z1.Ended)return"end";else if($&Z1.Changed)return"move";else if($&Z1.Began)return"start";return""}var Xv=C(()=>{J6()});class C7{constructor($){this.options=$,this.id=Kv(),this.state=Z1.Possible,this.simultaneous={},this.requireFail=[]}set($){return Object.assign(this.options,$),this.manager.touchAction.update(),this}recognizeWith($){if(Array.isArray($)){for(let Z of $)this.recognizeWith(Z);return this}let Q;if(typeof $==="string"){if(Q=this.manager.get($),!Q)throw Error(`Cannot find recognizer ${$}`)}else Q=$;let{simultaneous:J}=this;if(!J[Q.id])J[Q.id]=Q,Q.recognizeWith(this);return this}dropRecognizeWith($){if(Array.isArray($)){for(let J of $)this.dropRecognizeWith(J);return this}let Q;if(typeof $==="string")Q=this.manager.get($);else Q=$;if(Q)delete this.simultaneous[Q.id];return this}requireFailure($){if(Array.isArray($)){for(let Z of $)this.requireFailure(Z);return this}let Q;if(typeof $==="string"){if(Q=this.manager.get($),!Q)throw Error(`Cannot find recognizer ${$}`)}else Q=$;let{requireFail:J}=this;if(J.indexOf(Q)===-1)J.push(Q),Q.requireFailure(this);return this}dropRequireFailure($){if(Array.isArray($)){for(let J of $)this.dropRequireFailure(J);return this}let Q;if(typeof $==="string")Q=this.manager.get($);else Q=$;if(Q){let J=this.requireFail.indexOf(Q);if(J>-1)this.requireFail.splice(J,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find(($)=>$.options.enable))}canRecognizeWith($){return Boolean(this.simultaneous[$.id])}emit($){if(!$)return;let{state:Q}=this;if(Q<Z1.Ended)this.manager.emit(this.options.event+JN(Q),$);if(this.manager.emit(this.options.event,$),$.additionalEvent)this.manager.emit($.additionalEvent,$);if(Q>=Z1.Ended)this.manager.emit(this.options.event+JN(Q),$)}tryEmit($){if(this.canEmit())this.emit($);else this.state=Z1.Failed}canEmit(){let $=0;while($<this.requireFail.length){if(!(this.requireFail[$].state&(Z1.Failed|Z1.Possible)))return!1;$++}return!0}recognize($){let Q={...$};if(!this.options.enable){this.reset(),this.state=Z1.Failed;return}if(this.state&(Z1.Recognized|Z1.Cancelled|Z1.Failed))this.state=Z1.Possible;if(this.state=this.process(Q),this.state&(Z1.Began|Z1.Changed|Z1.Ended|Z1.Cancelled))this.tryEmit(Q)}getEventNames(){return[this.options.event]}reset(){}}var W$=C(()=>{J6();Xv()});var A7;var u9=C(()=>{W$();J6();H5();A7=class A7 extends C7{attrTest($){let Q=this.options.pointers;return Q===0||$.pointers.length===Q}process($){let{state:Q}=this,{eventType:J}=$,Z=Q&(Z1.Began|Z1.Changed),K=this.attrTest($);if(Z&&(J&_1.Cancel||!K))return Q|Z1.Cancelled;else if(Z||K){if(J&_1.End)return Q|Z1.Ended;else if(!(Q&Z1.Began))return Z1.Began;return Q|Z1.Changed}return Z1.Failed}}});var i9;var Yv=C(()=>{W$();H5();J6();i9=class i9 extends C7{constructor($={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...$});this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[K$]}process($){let{options:Q}=this,J=$.pointers.length===Q.pointers,Z=$.distance<Q.threshold,K=$.deltaTime<Q.time;if(this.reset(),$.eventType&_1.Start&&this.count===0)return this.failTimeout();if(Z&&K&&J){if($.eventType!==_1.End)return this.failTimeout();let X=this.pTime?$.timeStamp-this.pTime<Q.interval:!0,Y=!this.pCenter||pZ(this.pCenter,$.center)<Q.posThreshold;if(this.pTime=$.timeStamp,this.pCenter=$.center,!Y||!X)this.count=1;else this.count+=1;if(this._input=$,this.count%Q.taps===0){if(!this.hasRequireFailures())return Z1.Recognized;return this._timer=setTimeout(()=>{this.state=Z1.Recognized,this.tryEmit(this._input)},Q.interval),Z1.Began}}return Z1.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Z1.Failed},this.options.interval),Z1.Failed}reset(){clearTimeout(this._timer)}emit($){if(this.state===Z1.Recognized)$.tapCount=this.count,this.manager.emit(this.options.event,$)}}});var G71,w8;var ZN=C(()=>{u9();H5();J6();G71=["","start","move","end","cancel","up","down","left","right"];w8=class w8 extends A7{constructor($={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:n1.All,...$});this.pX=null,this.pY=null}getTouchAction(){let{options:{direction:$}}=this,Q=[];if($&n1.Horizontal)Q.push(Y$);if($&n1.Vertical)Q.push(X$);return Q}getEventNames(){return G71.map(($)=>this.options.event+$)}directionTest($){let{options:Q}=this,J=!0,{distance:Z}=$,{direction:K}=$,X=$.deltaX,Y=$.deltaY;if(!(K&Q.direction))if(Q.direction&n1.Horizontal)K=X===0?n1.None:X<0?n1.Left:n1.Right,J=X!==this.pX,Z=Math.abs($.deltaX);else K=Y===0?n1.None:Y<0?n1.Up:n1.Down,J=Y!==this.pY,Z=Math.abs($.deltaY);return $.direction=K,J&&Z>Q.threshold&&Boolean(K&Q.direction)}attrTest($){return super.attrTest($)&&(Boolean(this.state&Z1.Began)||!(this.state&Z1.Began)&&this.directionTest($))}emit($){this.pX=$.deltaX,this.pY=$.deltaY;let Q=n1[$.direction].toLowerCase();if(Q)$.additionalEvent=this.options.event+Q;super.emit($)}}});var Wv=C(()=>{u9();H5();ZN()});var E71,q$;var qv=C(()=>{u9();J6();E71=["","start","move","end","cancel","in","out"];q$=class q$ extends A7{constructor($={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...$})}getTouchAction(){return[M8]}getEventNames(){return E71.map(($)=>this.options.event+$)}attrTest($){return super.attrTest($)&&(Math.abs($.scale-1)>this.options.threshold||Boolean(this.state&Z1.Began))}emit($){if($.scale!==1){let Q=$.scale<1?"in":"out";$.additionalEvent=this.options.event+Q}super.emit($)}}});var Hv=C(()=>{u9();J6()});var Fv=C(()=>{W$();J6();H5()});var KN=C(()=>{H5();J6();H5();Zv();$N();nV();QN();W$();u9();Yv();ZN();Wv();qv();Hv();Fv()});class N4{constructor($,Q,J){this.element=$,this.callback=Q,this.options=J}}var Uv,VO1;var Vv=C(()=>{Uv=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",VO1=typeof window<"u"?window:global});var v71,Nv=4.000244140625,_71=40,x71=0.25,XN;var Dv=C(()=>{Vv();v71=Uv.indexOf("firefox")!==-1;XN=class XN extends N4{constructor($,Q,J){super($,Q,{enable:!0,...J});this.handleEvent=(Z)=>{if(!this.options.enable)return;let K=Z.deltaY;if(globalThis.WheelEvent){if(v71&&Z.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL)K/=globalThis.devicePixelRatio;if(Z.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE)K*=_71}if(K!==0&&K%Nv===0)K=Math.floor(K/Nv);if(Z.shiftKey&&K)K=K*x71;this.callback({type:"wheel",center:{x:Z.clientX,y:Z.clientY},delta:-K,srcEvent:Z,pointerType:"mouse",target:Z.target})},$.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType($,Q){if($==="wheel")this.options.enable=Q}}});var Cv,YN;var Av=C(()=>{Cv=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];YN=class YN extends N4{constructor($,Q,J){super($,Q,{enable:!0,...J});this.handleEvent=(K)=>{this.handleOverEvent(K),this.handleOutEvent(K),this.handleEnterEvent(K),this.handleLeaveEvent(K),this.handleMoveEvent(K)},this.pressed=!1;let{enable:Z}=this.options;this.enableMoveEvent=Z,this.enableLeaveEvent=Z,this.enableEnterEvent=Z,this.enableOutEvent=Z,this.enableOverEvent=Z,Cv.forEach((K)=>$.addEventListener(K,this.handleEvent))}destroy(){Cv.forEach(($)=>this.element.removeEventListener($,this.handleEvent))}enableEventType($,Q){switch($){case"pointermove":this.enableMoveEvent=Q;break;case"pointerover":this.enableOverEvent=Q;break;case"pointerout":this.enableOutEvent=Q;break;case"pointerenter":this.enableEnterEvent=Q;break;case"pointerleave":this.enableLeaveEvent=Q;break;default:}}handleOverEvent($){if(this.enableOverEvent&&$.type==="mouseover")this._emit("pointerover",$)}handleOutEvent($){if(this.enableOutEvent&&$.type==="mouseout")this._emit("pointerout",$)}handleEnterEvent($){if(this.enableEnterEvent&&$.type==="mouseenter")this._emit("pointerenter",$)}handleLeaveEvent($){if(this.enableLeaveEvent&&$.type==="mouseleave")this._emit("pointerleave",$)}handleMoveEvent($){if(this.enableMoveEvent)switch($.type){case"mousedown":if($.button>=0)this.pressed=!0;break;case"mousemove":if($.buttons===0)this.pressed=!1;if(!this.pressed)this._emit("pointermove",$);break;case"mouseup":this.pressed=!1;break;default:}}_emit($,Q){this.callback({type:$,center:{x:Q.clientX,y:Q.clientY},srcEvent:Q,pointerType:"mouse",target:Q.target})}}});var zv,WN;var kv=C(()=>{zv=["keydown","keyup"];WN=class WN extends N4{constructor($,Q,J){super($,Q,{enable:!0,tabIndex:0,...J});this.handleEvent=(Z)=>{let K=Z.target||Z.srcElement;if(K.tagName==="INPUT"&&K.type==="text"||K.tagName==="TEXTAREA")return;if(this.enableDownEvent&&Z.type==="keydown")this.callback({type:"keydown",srcEvent:Z,key:Z.key,target:Z.target});if(this.enableUpEvent&&Z.type==="keyup")this.callback({type:"keyup",srcEvent:Z,key:Z.key,target:Z.target})},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,$.tabIndex=this.options.tabIndex,$.style.outline="none",zv.forEach((Z)=>$.addEventListener(Z,this.handleEvent))}destroy(){zv.forEach(($)=>this.element.removeEventListener($,this.handleEvent))}enableEventType($,Q){if($==="keydown")this.enableDownEvent=Q;if($==="keyup")this.enableUpEvent=Q}}});var qN;var Bv=C(()=>{qN=class qN extends N4{constructor($,Q,J){super($,Q,J);this.handleEvent=(Z)=>{if(!this.options.enable)return;this.callback({type:"contextmenu",center:{x:Z.clientX,y:Z.clientY},srcEvent:Z,pointerType:"mouse",target:Z.target})},$.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType($,Q){if($==="contextmenu")this.options.enable=Q}}});function Rv($){let Q=g71[$.srcEvent.type];if(!Q)return null;let{buttons:J,button:Z}=$.srcEvent,K=!1,X=!1,Y=!1;if(Q===2)K=Boolean(J&1),X=Boolean(J&4),Y=Boolean(J&2);else K=Z===0,X=Z===1,Y=Z===2;return{leftButton:K,middleButton:X,rightButton:Y}}function Ov($,Q){let J=$.center;if(!J)return null;let Z=Q.getBoundingClientRect(),K=Z.width/Q.offsetWidth||1,X=Z.height/Q.offsetHeight||1,Y={x:(J.x-Z.left-Q.clientLeft)/K,y:(J.y-Z.top-Q.clientTop)/X};return{center:J,offsetCenter:Y}}var g71;var Pv=C(()=>{g71={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4}});class HN{constructor($,Q){this.handleEvent=(J)=>{if(this.isEmpty())return;let Z=this._normalizeEvent(J),K=J.srcEvent.target;while(K&&K!==Z.rootElement){if(this._emit(Z,K),Z.handled)return;K=K.parentNode}this._emit(Z,"root")},this.eventManager=$,this.recognizerName=Q,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add($,Q,J,Z=!1,K=!1){let{handlers:X,handlersByElement:Y}=this,W={...y71,...J},q=Y.get(W.srcElement);if(!q)q=[],Y.set(W.srcElement,q);let H={type:$,handler:Q,srcElement:W.srcElement,priority:W.priority};if(Z)H.once=!0;if(K)H.passive=!0;X.push(H),this._active=this._active||!H.passive;let F=q.length-1;while(F>=0){if(q[F].priority>=H.priority)break;F--}q.splice(F+1,0,H)}remove($,Q){let{handlers:J,handlersByElement:Z}=this;for(let K=J.length-1;K>=0;K--){let X=J[K];if(X.type===$&&X.handler===Q){J.splice(K,1);let Y=Z.get(X.srcElement);if(Y.splice(Y.indexOf(X),1),Y.length===0)Z.delete(X.srcElement)}}this._active=J.some((K)=>!K.passive)}_emit($,Q){let J=this.handlersByElement.get(Q);if(J){let Z=!1,K=()=>{$.handled=!0},X=()=>{$.handled=!0,Z=!0},Y=[];for(let W=0;W<J.length;W++){let{type:q,handler:H,once:F}=J[W];if(H({...$,type:q,stopPropagation:K,stopImmediatePropagation:X}),F)Y.push(J[W]);if(Z)break}for(let W=0;W<Y.length;W++){let{type:q,handler:H}=Y[W];this.remove(q,H)}}}_normalizeEvent($){let Q=this.eventManager.getElement();return{...$,...Rv($),...Ov($,Q),preventDefault:()=>{$.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:Q}}}var y71;var Mv=C(()=>{Pv();y71={srcElement:"root",priority:0}});function f71($){if("recognizer"in $)return $;let Q,J=Array.isArray($)?[...$]:[$];if(typeof J[0]==="function"){let Z=J.shift(),K=J.shift()||{};Q=new Z(K)}else Q=J.shift();return{recognizer:Q,recognizeWith:typeof J[0]==="string"?[J[0]]:J[0],requireFailure:typeof J[1]==="string"?[J[1]]:J[1]}}class rZ{constructor($=null,Q={}){if(this._onBasicInput=(J)=>{this.manager.emit(J.srcEvent.type,J)},this._onOtherEvent=(J)=>{this.manager.emit(J.type,J)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...Q},this.events=new Map,this.element=$,!$)return;this.manager=new oZ($,this.options);for(let J of this.options.recognizers){let{recognizer:Z,recognizeWith:K,requireFailure:X}=f71(J);if(this.manager.add(Z),K)Z.recognizeWith(K);if(X)Z.requireFailure(X)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new XN($,this._onOtherEvent,{enable:!1}),this.moveInput=new YN($,this._onOtherEvent,{enable:!1}),this.keyInput=new WN($,this._onOtherEvent,{enable:!1,tabIndex:Q.tabIndex}),this.contextmenuInput=new qN($,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}getElement(){return this.element}destroy(){if(!this.element)return;this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy()}on($,Q,J){this._addEventHandler($,Q,J,!1)}once($,Q,J){this._addEventHandler($,Q,J,!0)}watch($,Q,J){this._addEventHandler($,Q,J,!1,!0)}off($,Q){this._removeEventHandler($,Q)}_toggleRecognizer($,Q){let{manager:J}=this;if(!J)return;let Z=J.get($);if(Z)Z.set({enable:Q}),J.touchAction.update();this.wheelInput?.enableEventType($,Q),this.moveInput?.enableEventType($,Q),this.keyInput?.enableEventType($,Q),this.contextmenuInput?.enableEventType($,Q)}_addEventHandler($,Q,J,Z,K){if(typeof $!=="string"){J=Q;for(let[q,H]of Object.entries($))this._addEventHandler(q,H,J,Z,K);return}let{manager:X,events:Y}=this;if(!X)return;let W=Y.get($);if(!W){let q=this._getRecognizerName($)||$;if(W=new HN(this,q),Y.set($,W),X)X.on($,W.handleEvent)}if(W.add($,Q,J,Z,K),!W.isEmpty())this._toggleRecognizer(W.recognizerName,!0)}_removeEventHandler($,Q){if(typeof $!=="string"){for(let[K,X]of Object.entries($))this._removeEventHandler(K,X);return}let{events:J}=this,Z=J.get($);if(!Z)return;if(Z.remove($,Q),Z.isEmpty()){let{recognizerName:K}=Z,X=!1;for(let Y of J.values())if(Y.recognizerName===K&&!Y.isEmpty()){X=!0;break}if(!X)this._toggleRecognizer(K,!1)}}_getRecognizerName($){return this.manager.recognizers.find((Q)=>{return Q.getEventNames().includes($)})?.options.event}}var wv=C(()=>{KN();Dv();Av();kv();Bv();Mv()});var FN=C(()=>{wv();KN()});var z1,I0,y0,H$,UN;var Z6=C(()=>{T0();FN();z1={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(z1,"IDENTITY",{get:()=>{return r.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0}});I0={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},y0={common:0,meters:1,pixels:2},H$={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},UN={multipan:[w8,{threshold:10,direction:n1.Vertical,pointers:2}],pinch:[q$,{},null,["multipan"]],pan:[w8,{threshold:1},["pinch"],["multipan"]],dblclick:[i9,{event:"dblclick",taps:2}],click:[i9,{event:"click"},null,["dblclick"]]}});function b71($,Q){if($===Q)return!0;if(Array.isArray($)){let J=$.length;if(!Q||Q.length!==J)return!1;for(let Z=0;Z<J;Z++)if($[Z]!==Q[Z])return!1;return!0}return!1}function y6($){let Q={},J;return(Z)=>{for(let K in Z)if(!b71(Z[K],Q[K])){J=$(Z),Q=Z;break}return J}}function VN($,Q,J=Iv){if(J.length<3)J=[J[0],J[1],0];let Z=J,K,X=!0;if(Q===z1.LNGLAT_OFFSETS||Q===z1.METER_OFFSETS)K=J;else K=$.isGeospatial?[Math.fround($.longitude),Math.fround($.latitude),0]:null;switch($.projectionMode){case I0.WEB_MERCATOR:if(Q===z1.LNGLAT||Q===z1.CARTESIAN)K=[0,0,0],X=!1;break;case I0.WEB_MERCATOR_AUTO_OFFSET:if(Q===z1.LNGLAT)Z=K;else if(Q===z1.CARTESIAN)Z=[Math.fround($.center[0]),Math.fround($.center[1]),0],K=$.unprojectPosition(Z),Z[0]-=J[0],Z[1]-=J[1],Z[2]-=J[2];break;case I0.IDENTITY:Z=$.position.map(Math.fround),Z[2]=Z[2]||0;break;case I0.GLOBE:X=!1,K=null;break;default:X=!1}return{geospatialOrigin:K,shaderCoordinateOrigin:Z,offsetMode:X}}function l71($,Q,J){let{viewMatrixUncentered:Z,projectionMatrix:K}=$,{viewMatrix:X,viewProjectionMatrix:Y}=$,W=Sv,q=Sv,H=$.cameraPosition,{geospatialOrigin:F,shaderCoordinateOrigin:U,offsetMode:V}=VN($,Q,J);if(V)q=$.projectPosition(F||U),H=[H[0]-q[0],H[1]-q[1],H[2]-q[2]],q[3]=1,W=Q6.transformMat4([],q,Y),X=Z||X,Y=C0.multiply([],K,X),Y=C0.multiply([],Y,m71);return{viewMatrix:X,viewProjectionMatrix:Y,projectionCenter:W,originCommon:q,cameraPosCommon:H,shaderCoordinateOrigin:U,geospatialOrigin:F}}function Gv({viewport:$,devicePixelRatio:Q=1,modelMatrix:J=null,coordinateSystem:Z=z1.DEFAULT,coordinateOrigin:K=Iv,autoWrapLongitude:X=!1}){if(Z===z1.DEFAULT)Z=$.isGeospatial?z1.LNGLAT:z1.CARTESIAN;let Y=d71({viewport:$,devicePixelRatio:Q,coordinateSystem:Z,coordinateOrigin:K});return Y.wrapLongitude=X,Y.modelMatrix=J||Tv,Y}function p71({viewport:$,devicePixelRatio:Q,coordinateSystem:J,coordinateOrigin:Z}){let{projectionCenter:K,viewProjectionMatrix:X,originCommon:Y,cameraPosCommon:W,shaderCoordinateOrigin:q,geospatialOrigin:H}=l71($,J,Z),F=$.getDistanceScales(),U=[$.width*Q,$.height*Q],V=Q6.transformMat4([],[0,0,-$.focalDistance,1],$.projectionMatrix)[3]||1,N={coordinateSystem:J,projectionMode:$.projectionMode,coordinateOrigin:q,commonOrigin:Y.slice(0,3),center:K,pseudoMeters:Boolean($._pseudoMeters),viewportSize:U,devicePixelRatio:Q,focalDistance:V,commonUnitsPerMeter:F.unitsPerMeter,commonUnitsPerWorldUnit:F.unitsPerMeter,commonUnitsPerWorldUnit2:c71,scale:$.scale,wrapLongitude:!1,viewProjectionMatrix:X,modelMatrix:Tv,cameraPosition:W};if(H){let D=$.getDistanceScales(H);switch(J){case z1.METER_OFFSETS:N.commonUnitsPerWorldUnit=D.unitsPerMeter,N.commonUnitsPerWorldUnit2=D.unitsPerMeter2;break;case z1.LNGLAT:case z1.LNGLAT_OFFSETS:if(!$._pseudoMeters)N.commonUnitsPerMeter=D.unitsPerMeter;N.commonUnitsPerWorldUnit=D.unitsPerDegree,N.commonUnitsPerWorldUnit2=D.unitsPerDegree2;break;case z1.CARTESIAN:N.commonUnitsPerWorldUnit=[1,1,D.unitsPerMeter[2]],N.commonUnitsPerWorldUnit2=[0,0,D.unitsPerMeter2[2]];break;default:break}}return N}var Sv,m71,Tv,c71,Iv,d71;var NN=C(()=>{g0();Z6();Sv=[0,0,0,0],m71=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Tv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c71=[0,0,0],Iv=[0,0,0],d71=y6(p71)});var u71,i71,n71,s71,Ev;var jv=C(()=>{Z6();u71=Object.keys(z1).map(($)=>`const COORDINATE_SYSTEM_${$}: i32 = ${z1[$]};`).join(""),i71=Object.keys(I0).map(($)=>`const PROJECTION_MODE_${$}: i32 = ${I0[$]};`).join(""),n71=Object.keys(y0).map(($)=>`const UNIT_${$.toUpperCase()}: i32 = ${y0[$]};`).join(""),s71=`${u71}
${i71}
${n71}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,Ev=`${s71}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the z‑axis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`});var o71,r71,a71,hv;var Lv=C(()=>{Z6();o71=Object.keys(z1).map(($)=>`const int COORDINATE_SYSTEM_${$} = ${z1[$]};`).join(""),r71=Object.keys(I0).map(($)=>`const int PROJECTION_MODE_${$} = ${I0[$]};`).join(""),a71=Object.keys(y0).map(($)=>`const int UNIT_${$.toUpperCase()} = ${y0[$]};`).join(""),hv=`${o71}
${r71}
${a71}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`});function e71($=t71){if("viewport"in $)return Gv($);return{}}var t71,n9;var DN=C(()=>{V4();pV();NN();jv();Lv();t71={};n9={name:"project",dependencies:[bV,bZ],source:Ev,vs:hv,getUniforms:e71,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}}});var $81=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,Q81=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,f5;var vv=C(()=>{DN();f5={name:"project32",dependencies:[n9],source:$81,vs:Q81}});function CN(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function z7($,Q){let J=Q6.transformMat4([],Q,$);return Q6.scale(J,J,1/J[3]),J}function AN($,Q){let J=$%Q;return J<0?Q+J:J}function F$($,Q,J){return $<Q?Q:$>J?J:$}function J81($){return Math.log($)*Math.LOG2E}var s9;var S8=C(()=>{g0();s9=Math.log2||J81});function K6($,Q){if(!$)throw Error(Q||"@math.gl/web-mercator: assertion failed.")}function kN($){return s9($)}function D4($){let[Q,J]=$;K6(Number.isFinite(Q)),K6(Number.isFinite(J)&&J>=-90&&J<=90,"invalid latitude");let Z=Q*b5,K=J*b5,X=o9*(Z+X6)/(2*X6),Y=o9*(X6+Math.log(Math.tan(_v+K*0.5)))/(2*X6);return[X,Y]}function F5($){let[Q,J]=$,Z=Q/o9*(2*X6)-X6,K=2*(Math.atan(Math.exp(J/o9*(2*X6)-X6))-_v);return[Z*zN,K*zN]}function BN($){let{latitude:Q}=$;K6(Number.isFinite(Q));let J=Math.cos(Q*b5);return kN(aZ*J)-9}function U$($){let Q=Math.cos($*b5);return o9/aZ/Q}function a9($){let{latitude:Q,longitude:J,highPrecision:Z=!1}=$;K6(Number.isFinite(Q)&&Number.isFinite(J));let K=o9,X=Math.cos(Q*b5),Y=K/360,W=Y/X,q=K/aZ/X,H={unitsPerMeter:[q,q,q],metersPerUnit:[1/q,1/q,1/q],unitsPerDegree:[Y,W,q],degreesPerUnit:[1/Y,1/W,1/q]};if(Z){let F=b5*Math.tan(Q*b5)/X,U=Y*F/2,V=K/aZ*F,N=V/W*q;H.unitsPerDegree2=[0,U,V],H.unitsPerMeter2=[N,0,N]}return H}function V$($,Q){let[J,Z,K]=$,[X,Y,W]=Q,{unitsPerMeter:q,unitsPerMeter2:H}=a9({longitude:J,latitude:Z,highPrecision:!0}),F=D4($);F[0]+=X*(q[0]+H[0]*Y),F[1]+=Y*(q[1]+H[1]*Y);let U=F5(F),V=(K||0)+(W||0);return Number.isFinite(K)||Number.isFinite(W)?[U[0],U[1],V]:U}function tZ($){let{height:Q,pitch:J,bearing:Z,altitude:K,scale:X,center:Y}=$,W=CN();C0.translate(W,W,[0,0,-K]),C0.rotateX(W,W,-J*b5),C0.rotateZ(W,W,Z*b5);let q=X/Q;if(C0.scale(W,W,[q,q,q]),Y)C0.translate(W,W,P8.negate([],Y));return W}function RN($){let{width:Q,height:J,altitude:Z,pitch:K=0,offset:X,center:Y,scale:W,nearZMultiplier:q=1,farZMultiplier:H=1}=$,{fovy:F=T8(xv)}=$;if(Z!==void 0)F=T8(Z);let U=F*b5,V=K*b5,N=N$(F),D=N;if(Y)D+=Y[2]*W/Math.cos(V)/J;let z=U*(0.5+(X?X[1]:0)/J),B=Math.sin(z)*D/Math.sin(F$(Math.PI/2-V-z,0.01,Math.PI-0.01)),M=Math.sin(V)*B+D,P=D*10,O=Math.min(M*H,P);return{fov:U,aspect:Q/J,focalDistance:N,near:q,far:O}}function T8($){return 2*Math.atan(0.5/$)*zN}function N$($){return 0.5/Math.tan(0.5*$*b5)}function t9($,Q){let[J,Z,K=0]=$;return K6(Number.isFinite(J)&&Number.isFinite(Z)&&Number.isFinite(K)),z7(Q,[J,Z,K,1])}function k7($,Q,J=0){let[Z,K,X]=$;if(K6(Number.isFinite(Z)&&Number.isFinite(K),"invalid pixel coordinate"),Number.isFinite(X))return z7(Q,[Z,K,X,1]);let Y=z7(Q,[Z,K,0,1]),W=z7(Q,[Z,K,1,1]),q=Y[2],H=W[2],F=q===H?0:((J||0)-q)/(H-q);return g6.lerp([],Y,W,F)}var X6,_v,b5,zN,o9=512,aZ=40030000,r9=85.051129,xv=1.5;var I8=C(()=>{S8();g0();X6=Math.PI,_v=X6/4,b5=X6/180,zN=180/X6});function eZ($){let{width:Q,height:J,bounds:Z,minExtent:K=0,maxZoom:X=24,offset:Y=[0,0]}=$,[[W,q],[H,F]]=Z,U=Z81($.padding),V=D4([W,F$(F,-r9,r9)]),N=D4([H,F$(q,-r9,r9)]),D=[Math.max(Math.abs(N[0]-V[0]),K),Math.max(Math.abs(N[1]-V[1]),K)],z=[Q-U.left-U.right-Math.abs(Y[0])*2,J-U.top-U.bottom-Math.abs(Y[1])*2];K6(z[0]>0&&z[1]>0);let B=z[0]/D[0],M=z[1]/D[1],P=(U.right-U.left)/2/B,O=(U.top-U.bottom)/2/M,G=[(N[0]+V[0])/2+P,(N[1]+V[1])/2+O],L=F5(G),b=Math.min(X,s9(Math.abs(Math.min(B,M))));return K6(Number.isFinite(b)),{longitude:L[0],latitude:L[1],zoom:b}}function Z81($=0){if(typeof $==="number")return{top:$,bottom:$,left:$,right:$};return K6(Number.isFinite($.top)&&Number.isFinite($.bottom)&&Number.isFinite($.left)&&Number.isFinite($.right)),$}var ON=C(()=>{S8();I8()});function $K($,Q=0){let{width:J,height:Z,unproject:K}=$,X={targetZ:Q},Y=K([0,Z],X),W=K([J,Z],X),q,H,F=$.fovy?0.5*$.fovy*gv:Math.atan(0.5/$.altitude),U=(90-$.pitch)*gv;if(F>U-0.01)q=yv($,0,Q),H=yv($,J,Q);else q=K([0,0],X),H=K([J,0],X);return[Y,W,H,q]}function yv($,Q,J){let{pixelUnprojectionMatrix:Z}=$,K=z7(Z,[Q,0,1,1]),X=z7(Z,[Q,$.height,1,1]),W=(J*$.distanceScales.unitsPerMeter[2]-K[2])/(X[2]-K[2]),q=g6.lerp([],K,X,W),H=F5(q);return H.push(J),H}var gv;var PN=C(()=>{g0();I8();S8();gv=Math.PI/180});var MN=C(()=>{S8();I8();ON();PN()});function wN($){let{width:Q,height:J,pitch:Z=0}=$,{longitude:K,latitude:X,zoom:Y,bearing:W=0}=$;if(K<-180||K>180)K=AN(K+180,360)-180;if(W<-180||W>180)W=AN(W+180,360)-180;let q=s9(J/bv);if(Y<=q)Y=q,X=0;else{let H=J/2/Math.pow(2,Y),F=F5([0,H])[1];if(X<F)X=F;else{let U=F5([0,bv-H])[1];if(X>U)X=U}}return{width:Q,height:J,longitude:K,latitude:X,zoom:Y,pitch:Z,bearing:W}}var bv=512;var mv=C(()=>{I8();S8()});var cv=C(()=>{S8();I8()});var G8=C(()=>{MN();PN();ON();mv();cv();I8();MN()});function D81($,Q){let[J,Z,K]=$,X=k7([J,Z,K],Q);if(Number.isFinite(K))return X;return[X[0],X[1],0]}function C81({viewport:$,center:Q}){return new x0($.viewProjectionMatrix).invert().transform(Q)}function A81({viewport:$,shadowMatrices:Q}){let J=[],Z=$.pixelUnprojectionMatrix,K=$.isGeospatial?void 0:1,X=[[0,0,K],[$.width,0,K],[0,$.height,K],[$.width,$.height,K],[0,0,-1],[$.width,0,-1],[0,$.height,-1],[$.width,$.height,-1]].map((Y)=>D81(Y,Z));for(let Y of Q){let W=Y.clone().translate(new _0($.center).negate()),q=X.map((F)=>W.transform(F)),H=new x0().ortho({left:Math.min(...q.map((F)=>F[0])),right:Math.max(...q.map((F)=>F[0])),bottom:Math.min(...q.map((F)=>F[1])),top:Math.max(...q.map((F)=>F[1])),near:Math.min(...q.map((F)=>-F[2])),far:Math.max(...q.map((F)=>-F[2]))});J.push(H.multiplyRight(Y))}return J}function z81($){let{shadowEnabled:Q=!0,project:J}=$;if(!Q||!J||!$.shadowMatrices||!$.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:$.dummyShadowMap,shadow_uShadowMap1:$.dummyShadowMap};let Z=n9.getUniforms(J),K=F81({viewport:J.viewport,center:Z.center}),X=[],Y=U81({shadowMatrices:$.shadowMatrices,viewport:J.viewport}).slice();for(let q=0;q<$.shadowMatrices.length;q++){let H=Y[q],F=H.clone().translate(new _0(J.viewport.center).negate());if(Z.coordinateSystem===z1.LNGLAT&&Z.projectionMode===I0.WEB_MERCATOR)Y[q]=F,X[q]=K;else Y[q]=H.clone().multiplyRight(N81),X[q]=F.transform(K)}let W={drawShadowMap:Boolean($.drawToShadowMap),useShadowMap:$.shadowMaps?$.shadowMaps.length>0:!1,color:$.shadowColor||V81,lightId:$.shadowLightId||0,lightCount:$.shadowMatrices.length,shadow_uShadowMap0:$.dummyShadowMap,shadow_uShadowMap1:$.dummyShadowMap};for(let q=0;q<Y.length;q++)W[`viewProjectionMatrix${q}`]=Y[q],W[`projectCenter${q}`]=X[q];for(let q=0;q<2;q++)W[`shadow_uShadowMap${q}`]=$.shadowMaps&&$.shadowMaps[q]||$.dummyShadowMap;return W}var dv=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,Y81=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,W81,q81=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,H81,F81,U81,V81,N81,QK;var lv=C(()=>{Z6();DN();g0();G8();W81=`
${dv}
${Y81}
`,H81=`
${dv}
${q81}
`,F81=y6(C81),U81=y6(A81),V81=[0,0,0,1],N81=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];QK={name:"shadow",dependencies:[n9],vs:W81,fs:H81,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:z81,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}}});var m5;var pv=C(()=>{V4();m5={...yZ,defaultUniforms:{...yZ.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}}});function uv($){let Q=E6.getDefaultShaderAssembler();for(let Z of k81)Q.addDefaultModule(Z);let J=$==="glsl"?B81:R81;for(let Z of J)Q.addShaderHook(Z);return Q}var k81,B81,R81;var SN=C(()=>{V4();_L();pV();vv();pv();k81=[bZ],B81=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],R81=[]});class TN{constructor($={}){this.type="ambient";let{color:Q=O81}=$,{intensity:J=1}=$;this.id=$.id||`ambient-${P81++}`,this.color=Q,this.intensity=J}}var O81,P81=0;var iv=C(()=>{O81=[255,255,255]});class JK{constructor($={}){this.type="directional";let{color:Q=M81}=$,{intensity:J=w81}=$,{direction:Z=S81}=$,{_shadow:K=!1}=$;this.id=$.id||`directional-${T81++}`,this.color=Q,this.intensity=J,this.type="directional",this.direction=new _0(Z).normalize().toArray(),this.shadow=K}getProjectedLight($){return this}}var M81,w81=1,S81,T81=0;var nv=C(()=>{g0();M81=[255,255,255],S81=[0,0,-1]});class ZK{constructor($,Q={id:"pass"}){let{id:J}=Q;this.id=J,this.device=$,this.props={...Q}}setProps($){Object.assign(this.props,$)}render($){}cleanup(){}}function ov($=0,Q={}){let J={},Z=(K,X)=>{let Y=K.props._offset,W=K.id,q=K.parent&&K.parent.id,H;if(q&&!(q in Q))Z(K.parent,!1);if(q in J){let F=J[q]=J[q]||ov(Q[q],Q);H=F(K,X),J[W]=F}else if(Number.isFinite(Y))H=Y+(Q[q]||0),J[W]=null;else H=$;if(X&&H>=$)$=H+1;return Q[W]=H,H};return Z}function I81($,{shaderModuleProps:Q,target:J,viewport:Z}){let K=Q?.project?.devicePixelRatio??$.canvasContext.cssToDeviceRatio(),[,X]=$.canvasContext.getDrawingBufferSize(),Y=J?J.height:X,W=Z;return[W.x*K,Y-(W.y+W.height)*K,W.width*K,W.height*K]}function sv($,...Q){for(let J of Q)if(J)for(let Z in J)if($[Z])Object.assign($[Z],J[Z]);else $[Z]=J[Z];return $}var B7;var KK=C(()=>{B7=class B7 extends ZK{constructor(){super(...arguments);this._lastRenderIndex=-1}render($){let[Q,J]=this.device.canvasContext.getDrawingBufferSize(),Z=$.clearCanvas??!0,K=$.clearColor??(Z?[0,0,0,0]:!1),X=Z?1:!1,Y=Z?0:!1,W=$.colorMask??15,q={viewport:[0,0,Q,J]};if($.colorMask)q.colorMask=W;if($.scissorRect)q.scissorRect=$.scissorRect;let H=this.device.beginRenderPass({framebuffer:$.target,parameters:q,clearColor:K,clearDepth:X,clearStencil:Y});try{return this._drawLayers(H,$)}finally{H.end(),this.device.submit()}}_drawLayers($,Q){let{target:J,shaderModuleProps:Z,viewports:K,views:X,onViewportActive:Y,clearStack:W=!0}=Q;if(Q.pass=Q.pass||"unknown",W)this._lastRenderIndex=-1;let q=[];for(let H of K){let F=X&&X[H.id];Y?.(H);let U=this._getDrawLayerParams(H,Q),V=H.subViewports||[H];for(let N of V){let D=this._drawLayersInViewport($,{target:J,shaderModuleProps:Z,viewport:N,view:F,pass:Q.pass,layers:Q.layers},U);q.push(D)}}return q}_getDrawLayerParams($,{layers:Q,pass:J,isPicking:Z=!1,layerFilter:K,cullRect:X,effects:Y,shaderModuleProps:W},q=!1){let H=[],F=ov(this._lastRenderIndex+1),U={layer:Q[0],viewport:$,isPicking:Z,renderPass:J,cullRect:X},V={};for(let N=0;N<Q.length;N++){let D=Q[N],z=this._shouldDrawLayer(D,U,K,V),B={shouldDrawLayer:z};if(z&&!q)B.shouldDrawLayer=!0,B.layerRenderIndex=F(D,z),B.shaderModuleProps=this._getShaderModuleProps(D,Y,J,W),B.layerParameters={...D.context.deck?.props.parameters,...this.getLayerParameters(D,N,$)};H[N]=B}return H}_drawLayersInViewport($,{layers:Q,shaderModuleProps:J,pass:Z,target:K,viewport:X,view:Y},W){let q=I81(this.device,{shaderModuleProps:J,target:K,viewport:X});if(Y&&Y.props.clear){let F=Y.props.clear===!0?{color:!0,depth:!0}:Y.props.clear;this.device.beginRenderPass({framebuffer:K,parameters:{viewport:q,scissorRect:q},clearColor:F.color?[0,0,0,0]:!1,clearDepth:F.depth?1:!1}).end()}let H={totalCount:Q.length,visibleCount:0,compositeCount:0,pickableCount:0};$.setParameters({viewport:q});for(let F=0;F<Q.length;F++){let U=Q[F],V=W[F],{shouldDrawLayer:N}=V;if(N&&U.props.pickable)H.pickableCount++;if(U.isComposite)H.compositeCount++;if(U.isDrawable&&V.shouldDrawLayer){let{layerRenderIndex:D,shaderModuleProps:z,layerParameters:B}=V;if(H.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,D),z.project)z.project.viewport=X;U.context.renderPass=$;try{U._drawLayer({renderPass:$,shaderModuleProps:z,uniforms:{layerIndex:D},parameters:B})}catch(M){U.raiseError(M,`drawing ${U} to ${Z}`)}}}return H}shouldDrawLayer($){return!0}getShaderModuleProps($,Q,J){return null}getLayerParameters($,Q,J){return $.props.parameters}_shouldDrawLayer($,Q,J,Z){if(!($.props.visible&&this.shouldDrawLayer($)))return!1;Q.layer=$;let X=$.parent;while(X){if(!X.props.visible||!X.filterSubLayer(Q))return!1;Q.layer=X,X=X.parent}if(J){let Y=Q.layer.id;if(!(Y in Z))Z[Y]=J(Q);if(!Z[Y])return!1}return $.activateViewport(Q.viewport),!0}_getShaderModuleProps($,Q,J,Z){let K=this.device.canvasContext.cssToDeviceRatio(),X=$.internalState?.propsInTransition||$.props,Y={layer:X,picking:{isActive:!1},project:{viewport:$.context.viewport,devicePixelRatio:K,modelMatrix:X.modelMatrix,coordinateSystem:X.coordinateSystem,coordinateOrigin:X.coordinateOrigin,autoWrapLongitude:$.wrapLongitude}};if(Q)for(let W of Q)sv(Y,W.getShaderModuleProps?.($,Y));return sv(Y,this.getShaderModuleProps($,Q,Y),Z)}}});var XK;var rv=C(()=>{KK();XK=class XK extends B7{constructor($,Q){super($,Q);let J=$.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),Z=$.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=$.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[J],depthStencilAttachment:Z})}delete(){if(this.fbo)this.fbo.destroy(),this.fbo=null}getShadowMap(){return this.fbo.colorAttachments[0].texture}render($){let Q=this.fbo,J=this.device.canvasContext.cssToDeviceRatio(),Z=$.viewports[0],K=Z.width*J,X=Z.height*J,Y=[1,1,1,1];if(K!==Q.width||X!==Q.height)Q.resize({width:K,height:X});super.render({...$,clearColor:Y,target:Q,pass:"shadow"})}getLayerParameters($,Q,J){return{...$.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer($){return $.props.shadowEnabled!==!1}getShaderModuleProps($,Q,J){return{shadow:{project:J.project,drawToShadowMap:!0}}}}});class D${constructor($={}){this.id="lighting-effect",this.shadowColor=E81,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps($)}setup($){this.context=$;let{device:Q,deck:J}=$;if(this.shadow&&!this.dummyShadowMap)this._createShadowPasses(Q),J._addDefaultShaderModule(QK),this.dummyShadowMap=Q.createTexture({width:1,height:1})}setProps($){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(let Q in $){let J=$[Q];switch(J.type){case"ambient":this.ambientLight=J;break;case"directional":this.directionalLights.push(J);break;case"point":this.pointLights.push(J);break;default:}}if(this._applyDefaultLights(),this.shadow=this.directionalLights.some((Q)=>Q.shadow),this.context)this.setup(this.context);this.props=$}preRender({layers:$,layerFilter:Q,viewports:J,onViewportActive:Z,views:K}){if(!this.shadow)return;this.shadowMatrices=this._calculateMatrices();for(let X=0;X<this.shadowPasses.length;X++)this.shadowPasses[X].render({layers:$,layerFilter:Q,viewports:J,onViewportActive:Z,views:K,shaderModuleProps:{shadow:{shadowLightId:X,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}getShaderModuleProps($,Q){let J=this.shadow?{project:Q.project,shadowMaps:this.shadowPasses.map((X)=>X.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},Z={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((X)=>X.getProjectedLight({layer:$})),pointLights:this.pointLights.map((X)=>X.getProjectedLight({layer:$}))},K=$.props.material;return{shadow:J,lighting:Z,phongMaterial:K,gouraudMaterial:K}}cleanup($){for(let Q of this.shadowPasses)Q.delete();if(this.shadowPasses.length=0,this.dummyShadowMap)this.dummyShadowMap.destroy(),this.dummyShadowMap=null,$.deck._removeDefaultShaderModule(QK)}_calculateMatrices(){let $=[];for(let Q of this.directionalLights){let J=new x0().lookAt({eye:new _0(Q.direction).negate()});$.push(J)}return $}_createShadowPasses($){for(let Q=0;Q<this.directionalLights.length;Q++){let J=new XK($);this.shadowPasses[Q]=J}}_applyDefaultLights(){let{ambientLight:$,pointLights:Q,directionalLights:J}=this;if(!$&&Q.length===0&&J.length===0)this.ambientLight=new TN(G81),this.directionalLights.push(new JK(av[0]),new JK(av[1]))}}var G81,av,E81;var tv=C(()=>{iv();nv();g0();rv();lv();G81={color:[255,255,255],intensity:1},av=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:0.9,direction:[1,-8,-2.5]}],E81=[0,0,0,0.7843137254901961]});class ev{constructor($={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions($)}setOptions($){Object.assign(this.opts,$)}allocate($,Q,{size:J=1,type:Z,padding:K=0,copy:X=!1,initialize:Y=!1,maxCount:W}){let q=Z||$&&$.constructor||Float32Array,H=Q*J+K;if(ArrayBuffer.isView($)){if(H<=$.length)return $;if(H*$.BYTES_PER_ELEMENT<=$.buffer.byteLength)return new q($.buffer,0,H)}let F=1/0;if(W)F=W*J+K;let U=this._allocate(q,H,Y,F);if($&&X)U.set($);else if(!Y)U.fill(0,0,4);return this._release($),U}release($){this._release($)}_allocate($,Q,J,Z){let K=Math.max(Math.ceil(Q*this.opts.overAlloc),1);if(K>Z)K=Z;let X=this._pool,Y=$.BYTES_PER_ELEMENT*K,W=X.findIndex((q)=>q.byteLength>=Y);if(W>=0){let q=new $(X.splice(W,1)[0],0,K);if(J)q.fill(0);return q}return new $(K)}_release($){if(!ArrayBuffer.isView($))return;let Q=this._pool,{buffer:J}=$,{byteLength:Z}=J,K=Q.findIndex((X)=>X.byteLength>=Z);if(K<0)Q.push(J);else if(K>0||Q.length<this.opts.poolSize)Q.splice(K,0,J);if(Q.length>this.opts.poolSize)Q.shift()}}var Y6;var e9=C(()=>{Y6=new ev});function Q3(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Q_($){return[$[12],$[13],$[14]]}function J_($){return{left:$3($[3]+$[0],$[7]+$[4],$[11]+$[8],$[15]+$[12]),right:$3($[3]-$[0],$[7]-$[4],$[11]-$[8],$[15]-$[12]),bottom:$3($[3]+$[1],$[7]+$[5],$[11]+$[9],$[15]+$[13]),top:$3($[3]-$[1],$[7]-$[5],$[11]-$[9],$[15]-$[13]),near:$3($[3]+$[2],$[7]+$[6],$[11]+$[10],$[15]+$[14]),far:$3($[3]-$[2],$[7]-$[6],$[11]-$[10],$[15]-$[14])}}function $3($,Q,J,Z){$_.set($,Q,J);let K=$_.len();return{distance:Z/K,normal:new _0(-$/K,-Q/K,-J/K)}}function j81($){return $-Math.fround($)}function YK($,Q){let{size:J=1,startIndex:Z=0}=Q,K=Q.endIndex!==void 0?Q.endIndex:$.length,X=(K-Z)/J;C$=Y6.allocate(C$,X,{type:Float32Array,size:J*2});let Y=Z,W=0;while(Y<K){for(let q=0;q<J;q++){let H=$[Y++];C$[W+q]=H,C$[W+q+J]=j81(H)}W+=J*2}return C$.subarray(0,X*J*2)}function Z_($){let Q=null,J=!1;for(let Z of $){if(!Z)continue;if(!Q)Q=Z;else{if(!J)Q=[[Q[0][0],Q[0][1]],[Q[1][0],Q[1][1]]],J=!0;Q[0][0]=Math.min(Q[0][0],Z[0][0]),Q[0][1]=Math.min(Q[0][1],Z[0][1]),Q[1][0]=Math.max(Q[1][0],Z[1][0]),Q[1][1]=Math.max(Q[1][1],Z[1][1])}}return Q}var $_,C$;var WK=C(()=>{e9();g0();$_=new _0});function _81({width:$,height:Q,orthographic:J,fovyRadians:Z,focalDistance:K,padding:X,near:Y,far:W}){let q=$/Q,H=J?new x0().orthographic({fovy:Z,aspect:q,focalDistance:K,near:Y,far:W}):new x0().perspective({fovy:Z,aspect:q,near:Y,far:W});if(X){let{left:F=0,right:U=0,top:V=0,bottom:N=0}=X,D=g5((F+$-U)/2,0,$)-$/2,z=g5((V+Q-N)/2,0,Q)-Q/2;H[8]-=D*2/$,H[9]+=z*2/Q}return H}class qK{constructor($={}){this._frustumPlanes={},this.id=$.id||this.constructor.displayName||"viewport",this.x=$.x||0,this.y=$.y||0,this.width=$.width||1,this.height=$.height||1,this.zoom=$.zoom||0,this.padding=$.padding,this.distanceScales=$.distanceScales||v81,this.focalDistance=$.focalDistance||1,this.position=$.position||K_,this.modelMatrix=$.modelMatrix||null;let{longitude:Q,latitude:J}=$;this.isGeospatial=Number.isFinite(J)&&Number.isFinite(Q),this._initProps($),this._initMatrices($),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){if(this.isGeospatial)return this.zoom<12?I0.WEB_MERCATOR:I0.WEB_MERCATOR_AUTO_OFFSET;return I0.IDENTITY}equals($){if(!($ instanceof qK))return!1;if(this===$)return!0;return $.width===this.width&&$.height===this.height&&$.scale===this.scale&&U4($.projectionMatrix,this.projectionMatrix)&&U4($.viewMatrix,this.viewMatrix)}project($,{topLeft:Q=!0}={}){let J=this.projectPosition($),Z=t9(J,this.pixelProjectionMatrix),[K,X]=Z,Y=Q?X:this.height-X;return $.length===2?[K,Y]:[K,Y,Z[2]]}unproject($,{topLeft:Q=!0,targetZ:J}={}){let[Z,K,X]=$,Y=Q?K:this.height-K,W=J&&J*this.distanceScales.unitsPerMeter[2],q=k7([Z,Y,X],this.pixelUnprojectionMatrix,W),[H,F,U]=this.unprojectPosition(q);if(Number.isFinite(X))return[H,F,U];return Number.isFinite(J)?[H,F,J]:[H,F]}projectPosition($){let[Q,J]=this.projectFlat($),Z=($[2]||0)*this.distanceScales.unitsPerMeter[2];return[Q,J,Z]}unprojectPosition($){let[Q,J]=this.unprojectFlat($),Z=($[2]||0)*this.distanceScales.metersPerUnit[2];return[Q,J,Z]}projectFlat($){if(this.isGeospatial){let Q=D4($);return Q[1]=g5(Q[1],-318,830),Q}return $}unprojectFlat($){if(this.isGeospatial)return F5($);return $}getBounds($={}){let Q={targetZ:$.z||0},J=this.unproject([0,0],Q),Z=this.unproject([this.width,0],Q),K=this.unproject([0,this.height],Q),X=this.unproject([this.width,this.height],Q);return[Math.min(J[0],Z[0],K[0],X[0]),Math.min(J[1],Z[1],K[1],X[1]),Math.max(J[0],Z[0],K[0],X[0]),Math.max(J[1],Z[1],K[1],X[1])]}getDistanceScales($){if($&&this.isGeospatial)return a9({longitude:$[0],latitude:$[1],highPrecision:!0});return this.distanceScales}containsPixel({x:$,y:Q,width:J=1,height:Z=1}){return $<this.x+this.width&&this.x<$+J&&Q<this.y+this.height&&this.y<Q+Z}getFrustumPlanes(){if(this._frustumPlanes.near)return this._frustumPlanes;return Object.assign(this._frustumPlanes,J_(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition($,Q){return null}_initProps($){let{longitude:Q,latitude:J}=$;if(this.isGeospatial){if(!Number.isFinite($.zoom))this.zoom=BN({latitude:J})+Math.log2(this.focalDistance);this.distanceScales=$.distanceScales||a9({latitude:J,longitude:Q})}let Z=Math.pow(2,this.zoom);this.scale=Z;let{position:K,modelMatrix:X}=$,Y=K_;if(K)Y=X?new x0(X).transformAsVector(K,[]):K;if(this.isGeospatial){let W=this.projectPosition([Q,J,0]);this.center=new _0(Y).scale(this.distanceScales.unitsPerMeter).add(W)}else this.center=this.projectPosition(Y)}_initMatrices($){let{viewMatrix:Q=L81,projectionMatrix:J=null,orthographic:Z=!1,fovyRadians:K,fovy:X=75,near:Y=0.1,far:W=1000,padding:q=null,focalDistance:H=1}=$;this.viewMatrixUncentered=Q,this.viewMatrix=new x0().multiplyRight(Q).translate(new _0(this.center).negate()),this.projectionMatrix=J||_81({width:this.width,height:this.height,orthographic:Z,fovyRadians:K||X*h81,focalDistance:H,padding:q,near:Y,far:W});let F=Q3();C0.multiply(F,F,this.projectionMatrix),C0.multiply(F,F,this.viewMatrix),this.viewProjectionMatrix=F,this.viewMatrixInverse=C0.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Q_(this.viewMatrixInverse);let U=Q3(),V=Q3();if(C0.scale(U,U,[this.width/2,-this.height/2,1]),C0.translate(U,U,[1,-1,0]),C0.multiply(V,U,this.viewProjectionMatrix),this.pixelProjectionMatrix=V,this.pixelUnprojectionMatrix=C0.invert(Q3(),this.pixelProjectionMatrix),!this.pixelUnprojectionMatrix)r.warn("Pixel project matrix not invertible")()}}var h81,L81,K_,v81,HK;var IN=C(()=>{T0();WK();g0();G8();Z6();h81=Math.PI/180,L81=Q3(),K_=[0,0,0],v81={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};qK.displayName="Viewport";HK=qK});var A$,FK;var GN=C(()=>{IN();G8();g0();A$=class A$ extends HK{constructor($={}){let{latitude:Q=0,longitude:J=0,zoom:Z=0,pitch:K=0,bearing:X=0,nearZMultiplier:Y=0.1,farZMultiplier:W=1.01,nearZ:q,farZ:H,orthographic:F=!1,projectionMatrix:U,repeat:V=!1,worldOffset:N=0,position:D,padding:z,legacyMeterSizes:B=!1}=$,{width:M,height:P,altitude:O=1.5}=$,G=Math.pow(2,Z);M=M||1,P=P||1;let L,b=null;if(U)O=U[5]/2,L=T8(O);else{if($.fovy)L=$.fovy,O=N$(L);else L=T8(O);let p;if(z){let{top:i=0,bottom:l=0}=z;p=[0,g5((i+P-l)/2,0,P)-P/2]}if(b=RN({width:M,height:P,scale:G,center:D&&[0,0,D[2]*U$(Q)],offset:p,pitch:K,fovy:L,nearZMultiplier:Y,farZMultiplier:W}),Number.isFinite(q))b.near=q;if(Number.isFinite(H))b.far=H}let d=tZ({height:P,pitch:K,bearing:X,scale:G,altitude:O});if(N)d=new x0().translate([512*N,0,0]).multiplyLeft(d);super({...$,width:M,height:P,viewMatrix:d,longitude:J,latitude:Q,zoom:Z,...b,fovy:L,focalDistance:O});this.latitude=Q,this.longitude=J,this.zoom=Z,this.pitch=K,this.bearing=X,this.altitude=O,this.fovy=L,this.orthographic=F,this._subViewports=V?[]:null,this._pseudoMeters=B,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let $=this.getBounds(),Q=Math.floor(($[0]+180)/360),J=Math.ceil(($[2]-180)/360);for(let Z=Q;Z<=J;Z++){let K=Z?new A$({...this,worldOffset:Z}):this;this._subViewports.push(K)}}return this._subViewports}projectPosition($){if(this._pseudoMeters)return super.projectPosition($);let[Q,J]=this.projectFlat($),Z=($[2]||0)*U$($[1]);return[Q,J,Z]}unprojectPosition($){if(this._pseudoMeters)return super.unprojectPosition($);let[Q,J]=this.unprojectFlat($),Z=($[2]||0)/U$(J);return[Q,J,Z]}addMetersToLngLat($,Q){return V$($,Q)}panByPosition($,Q){let J=k7(Q,this.pixelUnprojectionMatrix),Z=this.projectFlat($),K=g6.add([],Z,g6.negate([],J)),X=g6.add([],this.center,K),[Y,W]=this.unprojectFlat(X);return{longitude:Y,latitude:W}}getBounds($={}){let Q=$K(this,$.z||0);return[Math.min(Q[0][0],Q[1][0],Q[2][0],Q[3][0]),Math.min(Q[0][1],Q[1][1],Q[2][1],Q[3][1]),Math.max(Q[0][0],Q[1][0],Q[2][0],Q[3][0]),Math.max(Q[0][1],Q[1][1],Q[2][1],Q[3][1])]}fitBounds($,Q={}){let{width:J,height:Z}=this,{longitude:K,latitude:X,zoom:Y}=eZ({width:J,height:Z,bounds:$,...Q});return new A$({width:J,height:Z,longitude:K,latitude:X,zoom:Y})}};A$.displayName="WebMercatorViewport";FK=A$});function EN($,Q,J=!1){let Z=Q.projectPosition($);if(J&&Q instanceof FK){let[K,X,Y=0]=$,W=Q.getDistanceScales([K,X]);Z[2]=Y*W.unitsPerMeter[2]}return Z}function x81($){let{viewport:Q,modelMatrix:J,coordinateOrigin:Z}=$,{coordinateSystem:K,fromCoordinateSystem:X,fromCoordinateOrigin:Y}=$;if(K===z1.DEFAULT)K=Q.isGeospatial?z1.LNGLAT:z1.CARTESIAN;if(X===void 0)X=K;if(Y===void 0)Y=Z;return{viewport:Q,coordinateSystem:K,coordinateOrigin:Z,modelMatrix:J,fromCoordinateSystem:X,fromCoordinateOrigin:Y}}function jN($,{viewport:Q,modelMatrix:J,coordinateSystem:Z,coordinateOrigin:K,offsetMode:X}){let[Y,W,q=0]=$;if(J)[Y,W,q]=Q6.transformMat4([],[Y,W,q,1],J);switch(Z){case z1.LNGLAT:return EN([Y,W,q],Q,X);case z1.LNGLAT_OFFSETS:return EN([Y+K[0],W+K[1],q+(K[2]||0)],Q,X);case z1.METER_OFFSETS:return EN(V$(K,[Y,W,q]),Q,X);case z1.CARTESIAN:default:return Q.isGeospatial?[Y+K[0],W+K[1],q+K[2]]:Q.projectPosition([Y,W,q])}}function Y_($,Q){let{viewport:J,coordinateSystem:Z,coordinateOrigin:K,modelMatrix:X,fromCoordinateSystem:Y,fromCoordinateOrigin:W}=x81(Q),{autoOffset:q=!0}=Q,{geospatialOrigin:H=X_,shaderCoordinateOrigin:F=X_,offsetMode:U=!1}=q?VN(J,Z,K):{},V=jN($,{viewport:J,modelMatrix:X,coordinateSystem:Y,coordinateOrigin:W,offsetMode:U});if(U){let N=J.projectPosition(H||F);P8.sub(V,V,N)}return V}var X_;var W_=C(()=>{Z6();NN();GN();g0();G8();X_=[0,0,0]});class J3{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel($){let{delay:Q=0,duration:J=Number.POSITIVE_INFINITY,rate:Z=1,repeat:K=1}=$,X=g81++,Y={time:0,delay:Q,duration:J,rate:Z,repeat:K};return this._setChannelTime(Y,this.time),this.channels.set(X,Y),X}removeChannel($){this.channels.delete($);for(let[Q,J]of this.animations)if(J.channel===$)this.detachAnimation(Q)}isFinished($){let Q=this.channels.get($);if(Q===void 0)return!1;return this.time>=Q.delay+Q.duration*Q.repeat}getTime($){if($===void 0)return this.time;let Q=this.channels.get($);if(Q===void 0)return-1;return Q.time}setTime($){this.time=Math.max(0,$);let Q=this.channels.values();for(let Z of Q)this._setChannelTime(Z,this.time);let J=this.animations.values();for(let Z of J){let{animation:K,channel:X}=Z;K.setTime(this.getTime(X))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation($,Q){let J=y81++;return this.animations.set(J,{animation:$,channel:Q}),$.setTime(this.getTime(Q)),J}detachAnimation($){this.animations.delete($)}update($){if(this.playing){if(this.lastEngineTime===-1)this.lastEngineTime=$;this.setTime(this.time+($-this.lastEngineTime)),this.lastEngineTime=$}}_setChannelTime($,Q){let J=Q-$.delay,Z=$.duration*$.repeat;if(J>=Z)$.time=$.duration*$.rate;else $.time=Math.max(0,J)%$.duration,$.time*=$.rate}}var g81=1,y81=1;function q_($){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame($):setTimeout($,16.666666666666668)}function H_($){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame($):clearTimeout($)}class UK{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor($){if(this.props={...b81,...$},$=this.props,!$.device)throw Error("No device provided");let{useDevicePixels:Q=!0}=this.props;this.stats=$.stats||new e5({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:$.autoResizeViewport,autoResizeDrawingBuffer:$.autoResizeDrawingBuffer,useDevicePixels:Q}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError($){if(this.props.onError($),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){let J=document.createElement("h1");J.innerHTML=$.message,J.style.position="absolute",J.style.top="20%",J.style.left="10px",J.style.color="black",J.style.backgroundColor="red",document.body.appendChild(J)}}setNeedsRedraw($){return this.needsRedraw=this.needsRedraw||$,this}setProps($){if("autoResizeViewport"in $)this.props.autoResizeViewport=$.autoResizeViewport||!1;if("autoResizeDrawingBuffer"in $)this.props.autoResizeDrawingBuffer=$.autoResizeDrawingBuffer||!1;if("useDevicePixels"in $)this.props.useDevicePixels=$.useDevicePixels||!1;return this}async start(){if(this._running)return this;this._running=!0;try{let $;if(!this._initialized)this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps());if(!this._running)return null;if($!==!1)this._cancelAnimationFrame(),this._requestAnimationFrame();return this}catch($){let Q=$ instanceof Error?$:Error("Unknown error");throw this.props.onError(Q),Q}}stop(){if(this._running){if(this.animationProps&&!this._error)this.props.onFinalize(this.animationProps);this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1}return this}redraw(){if(this.device?.isLost||this._error)return this;if(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame)this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null;return this._endFrameTimers(),this}attachTimeline($){return this.timeline=$,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){if(this.setNeedsRedraw("waitForRender"),!this._nextFramePromise)this._nextFramePromise=new Promise(($)=>{this._resolveNextFrame=$});return this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay($){if(this.display)this.display.destroy(),this.display.animationLoop=null;if($)$.animationLoop=this;this.display=$}_requestAnimationFrame(){if(!this._running)return;this._animationFrameId=q_(this._animationFrame.bind(this))}_cancelAnimationFrame(){if(this._animationFrameId===null)return;H_(this._animationFrameId),this._animationFrameId=null}_animationFrame(){if(!this._running)return;this.redraw(),this._requestAnimationFrame()}_renderFrame($){if(this.display){this.display._renderFrame($);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){let $=this.device?.canvasContext?.canvas;if(!this.device||!$)throw Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:$,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:$,height:Q,aspect:J}=this._getSizeAndAspect();if($!==this.animationProps.width||Q!==this.animationProps.height)this.setNeedsRedraw("drawing buffer resized");if(J!==this.animationProps.aspect)this.setNeedsRedraw("drawing buffer aspect changed");if(this.animationProps.width=$,this.animationProps.height=Q,this.animationProps.aspect=J,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline)this.timeline.update(this.animationProps.engineTime);this.animationProps.tick=Math.floor(this.animationProps.time/1000*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let $=document.createElement("div");document.body.appendChild($),$.style.position="relative";let Q=document.createElement("div");if(Q.style.position="absolute",Q.style.left="10px",Q.style.bottom="10px",Q.style.width="300px",Q.style.background="white",this.canvas instanceof HTMLCanvasElement)$.appendChild(this.canvas);$.appendChild(Q);let J=this.props.onAddHTML(Q);if(J)Q.innerHTML=J}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[$,Q]=this.device?.canvasContext?.getPixelSize()||[1,1],J=1,Z=this.device?.canvasContext?.canvas;if(Z&&Z.clientHeight)J=Z.clientWidth/Z.clientHeight;else if($>0&&Q>0)J=$/Q;return{width:$,height:Q,aspect:J}}_resizeViewport(){if(this.props.autoResizeViewport&&this.device.gl)this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){if(this.props.autoResizeDrawingBuffer)this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){if(this.canvas)this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this))}_onMousemove($){if($ instanceof MouseEvent)this._getAnimationProps()._mousePosition=[$.offsetX,$.offsetY]}_onMouseleave($){this._getAnimationProps()._mousePosition=null}}var f81=0,b81;var F_=C(()=>{O1();R2();b81={device:null,onAddHTML:()=>"",onInitialize:async()=>{return null},onRender:()=>{},onFinalize:()=>{},onError:($)=>console.error($),stats:v9.stats.get(`animation-loop-${f81++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1}});function R7($="id"){hN[$]=hN[$]||1;let Q=hN[$]++;return`${$}-${Q}`}var hN;var z$=C(()=>{hN={}});class LN{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor($){if(this.id=$.id||R7("geometry"),this.topology=$.topology,this.indices=$.indices||null,this.attributes=$.attributes,this.vertexCount=$.vertexCount,this.bufferLayout=$.bufferLayout||[],this.indices){if(!(this.indices.usage&M1.INDEX))throw Error("Index buffer must have INDEX usage")}}destroy(){this.indices?.destroy();for(let $ of Object.values(this.attributes))$.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount($){return $.byteLength/12}}function U_($,Q){if(Q instanceof LN)return Q;let J=m81($,Q),{attributes:Z,bufferLayout:K}=c81($,Q);return new LN({topology:Q.topology||"triangle-list",bufferLayout:K,vertexCount:Q.vertexCount,indices:J,attributes:Z})}function m81($,Q){if(!Q.indices)return;let J=Q.indices.value;return $.createBuffer({usage:M1.INDEX,data:J})}function c81($,Q){let J=[],Z={};for(let[X,Y]of Object.entries(Q.attributes)){let W=X;switch(X){case"POSITION":W="positions";break;case"NORMAL":W="normals";break;case"TEXCOORD_0":W="texCoords";break;case"COLOR_0":W="colors";break}if(Y){Z[W]=$.createBuffer({data:Y.value,id:`${X}-buffer`});let{value:q,size:H,normalized:F}=Y;J.push({name:W,format:zU(q,H,F)})}}let K=Q._calculateVertexCount(Q.attributes,Q.indices);return{attributes:Z,bufferLayout:J,vertexCount:K}}var V_=C(()=>{O1();z$()});var VK;var N_=C(()=>{O1();VK=class VK{static defaultProps={...h6.defaultProps};static getDefaultPipelineFactory($){return $._lumaData.defaultPipelineFactory=$._lumaData.defaultPipelineFactory||new VK($),$._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor($){this.device=$,this.destroyPolicy=$.props._factoryDestroyPolicy}createRenderPipeline($){let Q={...h6.defaultProps,...$},J=this._hashRenderPipeline(Q);if(!this._renderPipelineCache[J]){let Z=this.device.createRenderPipeline({...Q,id:Q.id?`${Q.id}-cached`:void 0});Z.hash=J,this._renderPipelineCache[J]={pipeline:Z,useCount:0}}return this._renderPipelineCache[J].useCount++,this._renderPipelineCache[J].pipeline}createComputePipeline($){let Q={..._9.defaultProps,...$},J=this._hashComputePipeline(Q);if(!this._computePipelineCache[J]){let Z=this.device.createComputePipeline({...Q,id:Q.id?`${Q.id}-cached`:void 0});Z.hash=J,this._computePipelineCache[J]={pipeline:Z,useCount:0}}return this._computePipelineCache[J].useCount++,this._computePipelineCache[J].pipeline}release($){let Q=$.hash,J=$ instanceof _9?this._computePipelineCache:this._renderPipelineCache;if(J[Q].useCount--,J[Q].useCount===0){if(this.destroyPolicy==="unused")J[Q].pipeline.destroy(),delete J[Q]}}_hashComputePipeline($){return`${this._getHash($.shader.source)}`}_hashRenderPipeline($){let Q=$.vs?this._getHash($.vs.source):0,J=$.fs?this._getHash($.fs.source):0,Z="-",K=this._getHash(JSON.stringify($.bufferLayout));switch(this.device.type){case"webgl":return`${Q}/${J}V-BL${K}`;default:let X=this._getHash(JSON.stringify($.parameters));return`${Q}/${J}V-T${$.topology}P${X}BL${K}`}}_getHash($){if(this._hashes[$]===void 0)this._hashes[$]=this._hashCounter++;return this._hashes[$]}}});var NK;var D_=C(()=>{O1();NK=class NK{static defaultProps={...C8.defaultProps};static getDefaultShaderFactory($){return $._lumaData.defaultShaderFactory||=new NK($),$._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor($){this.device=$,this.destroyPolicy=$.props._factoryDestroyPolicy}createShader($){let Q=this._hashShader($),J=this._cache[Q];if(!J){let Z=this.device.createShader({...$,id:$.id?`${$.id}-cached`:void 0});this._cache[Q]=J={shader:Z,useCount:0}}return J.useCount++,J.shader}release($){let Q=this._hashShader($),J=this._cache[Q];if(J){if(J.useCount--,J.useCount===0){if(this.destroyPolicy==="unused")delete this._cache[Q],J.shader.destroy()}}}_hashShader($){return`${$.stage}:${$.source}`}}});function C_($,Q){let J={},Z="Values";if($.attributes.length===0&&!$.varyings?.length)return{"No attributes or varyings":{["Values"]:"N/A"}};for(let K of $.attributes)if(K){let X=`${K.location} ${K.name}: ${K.type}`;J[`in ${X}`]={["Values"]:K.stepMode||"vertex"}}for(let K of $.varyings||[]){let X=`${K.location} ${K.name}`;J[`out ${X}`]={["Values"]:JSON.stringify(K)}}return J}function A_($,{id:Q,minimap:J,opaque:Z,top:K="0",left:X="0",rgbaScale:Y=1}){if(!O0)O0=document.createElement("canvas"),O0.id=Q,O0.title=Q,O0.style.zIndex="100",O0.style.position="absolute",O0.style.top=K,O0.style.left=X,O0.style.border="blue 5px solid",O0.style.transform="scaleY(-1)",document.body.appendChild(O0),vN=O0.getContext("2d");if(O0.width!==$.width||O0.height!==$.height)O0.width=$.width/2,O0.height=$.height/2,O0.style.width="400px",O0.style.height="400px";let W=$.device.readPixelsToArrayWebGL($),q=vN?.createImageData($.width,$.height);if(q){for(let F=0;F<W.length;F+=4)q.data[0+F+0]=W[F+0]*Y,q.data[0+F+1]=W[F+1]*Y,q.data[0+F+2]=W[F+2]*Y,q.data[0+F+3]=Z?255:W[F+3]*Y;vN?.putImageData(q,0,0)}}var O0=null,vN=null;function DK($,Q,J){if($===Q)return!0;if(!J||!$||!Q)return!1;if(Array.isArray($)){if(!Array.isArray(Q)||$.length!==Q.length)return!1;for(let Z=0;Z<$.length;Z++)if(!DK($[Z],Q[Z],J-1))return!1;return!0}if(Array.isArray(Q))return!1;if(typeof $==="object"&&typeof Q==="object"){let Z=Object.keys($),K=Object.keys(Q);if(Z.length!==K.length)return!1;for(let X of Z){if(!Q.hasOwnProperty(X))return!1;if(!DK($[X],Q[X],J-1))return!1}return!0}return!1}function z_($){return ArrayBuffer.isView($)&&!($ instanceof DataView)}function k_($){if(Array.isArray($))return $.length===0||typeof $[0]==="number";return!1}function k$($){return z_($)||k_($)}var _N=()=>{};function d81($){return k$($)||typeof $==="number"||typeof $==="boolean"}function CK($){let Q={bindings:{},uniforms:{}};return Object.keys($).forEach((J)=>{let Z=$[J];if(d81(Z))Q.uniforms[J]=Z;else Q.bindings[J]=Z}),Q}var xN=C(()=>{_N()});class gN{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor($,Q){Object.assign(this.options,Q);let J=j9(Object.values($).filter((Z)=>Z.dependencies));for(let Z of J)$[Z.name]=Z;f.log(1,"Creating ShaderInputs with modules",Object.keys($))(),this.modules=$,this.moduleUniforms={},this.moduleBindings={};for(let[Z,K]of Object.entries($))if(this._addModule(K),K.name&&Z!==K.name&&!this.options.disableWarnings)f.warn(`Module name: ${Z} vs ${K.name}`)()}destroy(){}setProps($){for(let Q of Object.keys($)){let J=Q,Z=$[J]||{},K=this.modules[J];if(!K){if(!this.options.disableWarnings)f.warn(`Module ${Q} not found`)();continue}let X=this.moduleUniforms[J],Y=this.moduleBindings[J],W=K.getUniforms?.(Z,X)||Z,{uniforms:q,bindings:H}=CK(W);this.moduleUniforms[J]={...X,...q},this.moduleBindings[J]={...Y,...H}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){let $={};for(let Q of Object.values(this.moduleBindings))Object.assign($,Q);return $}getDebugTable(){let $={};for(let[Q,J]of Object.entries(this.moduleUniforms))for(let[Z,K]of Object.entries(J))$[`${Q}.${Z}`]={type:this.modules[Q].uniformTypes?.[Z],value:String(K)};return $}_addModule($){let Q=$.name;this.moduleUniforms[Q]=$.defaultUniforms||{},this.moduleBindings[Q]={}}}var B_=C(()=>{O1();V4();xN()});async function R_($,Q){let J=new Image;return J.crossOrigin=Q?.crossOrigin||"anonymous",J.src=$.startsWith("http")?$:l81+$,await J.decode(),Q?await createImageBitmap(J,Q):await createImageBitmap(J)}var l81="";async function O_($){if($=await $,Array.isArray($))return await Promise.all($.map(O_));if($&&typeof $==="object"&&$.constructor===Object){let Q=$,J=await Promise.all(Object.values(Q)),Z=Object.keys(Q),K={};for(let X=0;X<Z.length;X++)K[Z[X]]=J[X];return K}return $}var B$;var P_=C(()=>{z$();B$=class B${device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor($,Q){if(this.device=$,this.id=Q.id||R7("async-texture"),typeof Q?.data==="string"&&Q.dimension==="2d")Q={...Q,data:R_(Q.data)};this.ready=new Promise((J,Z)=>{this.resolveReady=()=>{this.isReady=!0,J()},this.rejectReady=Z}),this.initAsync(Q)}async initAsync($){let Q=$.data,J;try{J=await O_(Q)}catch(K){this.rejectReady(K)}if(this.destroyed)return;let Z={...$,data:J};this.texture=this.device.createTexture(Z),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){if(this.texture)this.texture.destroy(),this.texture=null;this.destroyed=!0}resize($){if(!this.isReady)throw Error("Cannot resize texture before it is ready");if($.width===this.texture.width&&$.height===this.texture.height)return!1;if(this.texture){let Q=this.texture;this.texture=Q.clone($),Q.destroy()}return!0}}});function u81($){return Boolean($.uniformTypes&&!yN($.uniformTypes))}function i81($){return{type:$.type,shaderLanguage:$.info.shadingLanguage,shaderLanguageVersion:$.info.shadingLanguageVersion,gpu:$.info.gpu,features:$.features}}function yN($){for(let Q in $)return!1;return!0}var E8=2,p81=1e4,P0;var fN=C(()=>{O1();V4();V_();N_();D_();z$();B_();P_();xN();P0=class P0{static defaultProps={...h6.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:E6.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor($,Q){this.props={...P0.defaultProps,...Q},Q=this.props,this.id=Q.id||R7("model"),this.device=$,Object.assign(this.userData,Q.userData);let J=Object.fromEntries(this.props.modules?.map((W)=>[W.name,W])||[]),Z=Q.shaderInputs||new gN(J,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(Z);let K=i81($),X=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){let{source:W,getUniforms:q}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:K,...this.props,modules:X});this.source=W,this._getModuleUniforms=q,this.props.shaderLayout||=aU(this.source)}else{let{vs:W,fs:q,getUniforms:H}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:K,...this.props,modules:X});this.vs=W,this.fs=q,this._getModuleUniforms=H}if(this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,Q.geometry)this.setGeometry(Q.geometry);if(this.pipelineFactory=Q.pipelineFactory||VK.getDefaultPipelineFactory(this.device),this.shaderFactory=Q.shaderFactory||NK.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=$.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry)this._setGeometryAttributes(this._gpuGeometry);if("isInstanced"in Q)this.isInstanced=Q.isInstanced;if(Q.instanceCount)this.setInstanceCount(Q.instanceCount);if(Q.vertexCount)this.setVertexCount(Q.vertexCount);if(Q.indexBuffer)this.setIndexBuffer(Q.indexBuffer);if(Q.attributes)this.setAttributes(Q.attributes);if(Q.constantAttributes)this.setConstantAttributes(Q.constantAttributes);if(Q.bindings)this.setBindings(Q.bindings);if(Q.uniforms)this.setUniformsWebGL(Q.uniforms);if(Q.moduleSettings)this.updateModuleSettingsWebGL(Q.moduleSettings);if(Q.transformFeedback)this.transformFeedback=Q.transformFeedback;Object.seal(this)}destroy(){if(this._destroyed)return;if(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs)this.shaderFactory.release(this.pipeline.fs);this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0}needsRedraw(){if(this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp)this.setNeedsRedraw("contents of bound textures or buffers updated");let $=this._needsRedraw;return this._needsRedraw=!1,$}setNeedsRedraw($){this._needsRedraw||=$}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw($){let Q=this._areBindingsLoading();if(Q)return f.info(E8,`>>> DRAWING ABORTED ${this.id}: ${Q} not loaded`)(),!1;try{$.pushDebugGroup(`${this}.predraw(${$})`),this.predraw()}finally{$.popDebugGroup()}let J;try{$.pushDebugGroup(`${this}.draw(${$})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();let Z=this._getBindings();if(this.pipeline.setBindings(Z,{disableWarnings:this.props.disableWarnings}),!yN(this.uniforms))this.pipeline.setUniformsWebGL(this.uniforms);let{indexBuffer:K}=this.vertexArray,X=K?K.byteLength/(K.indexType==="uint32"?4:2):void 0;J=this.pipeline.draw({renderPass:$,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:X,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{$.popDebugGroup(),this._logDrawCallEnd()}if(this._logFramebuffer($),J)this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1;else this._needsRedraw="waiting for resource initialization";return J}setGeometry($){this._gpuGeometry?.destroy();let Q=$&&U_(this.device,$);if(Q){this.setTopology(Q.topology||"triangle-list");let J=new g9(this.bufferLayout);if(this.bufferLayout=J.mergeBufferLayouts(Q.bufferLayout,this.bufferLayout),this.vertexArray)this._setGeometryAttributes(Q)}this._gpuGeometry=Q}setTopology($){if($!==this.topology)this.topology=$,this._setPipelineNeedsUpdate("topology")}setBufferLayout($){let Q=new g9(this.bufferLayout);if(this.bufferLayout=this._gpuGeometry?Q.mergeBufferLayouts($,this._gpuGeometry.bufferLayout):$,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry)this._setGeometryAttributes(this._gpuGeometry)}setParameters($){if(!DK($,this.parameters,2))this.parameters=$,this._setPipelineNeedsUpdate("parameters")}setInstanceCount($){if(this.instanceCount=$,this.isInstanced===void 0&&$>0)this.isInstanced=!0;this.setNeedsRedraw("instanceCount")}setVertexCount($){this.vertexCount=$,this.setNeedsRedraw("vertexCount")}setShaderInputs($){this.shaderInputs=$,this._uniformStore=new zZ(this.shaderInputs.modules);for(let[Q,J]of Object.entries(this.shaderInputs.modules))if(u81(J)){let Z=this._uniformStore.getManagedUniformBuffer(this.device,Q);this.bindings[`${Q}Uniforms`]=Z}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings($){Object.assign(this.bindings,$),this.setNeedsRedraw("bindings")}setTransformFeedback($){this.transformFeedback=$,this.setNeedsRedraw("transformFeedback")}setIndexBuffer($){this.vertexArray.setIndexBuffer($),this.setNeedsRedraw("indexBuffer")}setAttributes($,Q){let J=Q?.disableWarnings??this.props.disableWarnings;if($.indices)f.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();this.bufferLayout=kU(this.pipeline.shaderLayout,this.bufferLayout);let Z=new g9(this.bufferLayout);for(let[K,X]of Object.entries($)){let Y=Z.getBufferLayout(K);if(!Y){if(!J)f.warn(`Model(${this.id}): Missing layout for buffer "${K}".`)();continue}let W=Z.getAttributeNamesForBuffer(Y),q=!1;for(let H of W){let F=this._attributeInfos[H];if(F){let U=this.device.type==="webgpu"?Z.getBufferIndex(F.bufferName):F.location;this.vertexArray.setBuffer(U,X),q=!0}}if(!q&&!J)f.warn(`Model(${this.id}): Ignoring buffer "${X.id}" for unknown attribute "${K}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes($,Q){for(let[J,Z]of Object.entries($)){let K=this._attributeInfos[J];if(K)this.vertexArray.setConstantWebGL(K.location,Z);else if(!(Q?.disableWarnings??this.props.disableWarnings))f.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${J}"`)()}this.setNeedsRedraw("constants")}setUniforms($){this.setUniformsWebGL($)}setUniformsWebGL($){if(!yN($))this.pipeline.setUniformsWebGL($),Object.assign(this.uniforms,$);this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL($){let{bindings:Q,uniforms:J}=CK(this._getModuleUniforms($));Object.assign(this.bindings,Q),Object.assign(this.uniforms,J),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(let $ of Object.values(this.bindings))if($ instanceof B$&&!$.isReady)return $.id;return!1}_getBindings(){let $={};for(let[Q,J]of Object.entries(this.bindings))if(J instanceof B$){if(J.isReady)$[Q]=J.texture}else $[Q]=J;return $}_getBindingsUpdateTimestamp(){let $=0;for(let Q of Object.values(this.bindings))if(Q instanceof D8)$=Math.max($,Q.texture.updateTimestamp);else if(Q instanceof M1||Q instanceof E1)$=Math.max($,Q.updateTimestamp);else if(Q instanceof B$)$=Q.texture?Math.max($,Q.texture.updateTimestamp):1/0;else if(!(Q instanceof U7))$=Math.max($,Q.buffer.updateTimestamp);return $}_setGeometryAttributes($){let Q={...$.attributes};for(let[J]of Object.entries(Q))if(!this.pipeline.shaderLayout.attributes.find((Z)=>Z.name===J)&&J!=="positions")delete Q[J];this.vertexCount=$.vertexCount,this.setIndexBuffer($.indices||null),this.setAttributes($.attributes,{disableWarnings:!0}),this.setAttributes(Q,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate($){this._pipelineNeedsUpdate||=$,this.setNeedsRedraw($)}_updatePipeline(){if(this._pipelineNeedsUpdate){let $=null,Q=null;if(this.pipeline)f.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),$=this.pipeline.vs,Q=this.pipeline.fs;this._pipelineNeedsUpdate=!1;let J=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders}),Z=null;if(this.source)Z=J;else if(this.fs)Z=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders});if(this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:J,fs:Z}),this._attributeInfos=CZ(this.pipeline.shaderLayout,this.bufferLayout),$)this.shaderFactory.release($);if(Q)this.shaderFactory.release(Q)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let $=f.level>3?0:p81;if(f.level<2||Date.now()-this._lastLogTime<$)return;this._lastLogTime=Date.now(),this._logOpen=!0,f.group(E8,`>>> DRAWING MODEL ${this.id}`,{collapsed:f.level<=2})()}_logDrawCallEnd(){if(this._logOpen){let $=C_(this.pipeline.shaderLayout,this.id);f.table(E8,$)();let Q=this.shaderInputs.getDebugTable();for(let[Z,K]of Object.entries(this.uniforms))Q[Z]={value:K};f.table(E8,Q)();let J=this._getAttributeDebugTable();f.table(E8,this._attributeInfos)(),f.table(E8,J)(),f.groupEnd(E8)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer($){let Q=this.device.props.debugFramebuffers;if(this._drawCount++,!Q)return;let J=$.props.framebuffer;if(J)A_(J,{id:J.id,minimap:!0})}_getAttributeDebugTable(){let $={};for(let[Q,J]of Object.entries(this._attributeInfos)){let Z=this.vertexArray.attributes[J.location];$[J.location]={name:Q,type:J.shaderType,values:Z?this._getBufferOrConstantValues(Z,J.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){let{indexBuffer:Q}=this.vertexArray,J=Q.indexType==="uint32"?new Uint32Array(Q.debugData):new Uint16Array(Q.debugData);$.indices={name:"indices",type:Q.indexType,values:J.toString()}}return $}_getBufferOrConstantValues($,Q){let J=c2(Q);return($ instanceof M1?new J($.debugData):$).toString()}}});var C4;var M_=C(()=>{O1();V4();fN();C4=class C4{device;model;transformFeedback;static defaultProps={...P0.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported($){return $?.info?.type==="webgl"}constructor($,Q=C4.defaultProps){if(!C4.isSupported($))throw Error("BufferTransform not yet implemented on WebGPU");this.device=$,this.model=new P0(this.device,{id:Q.id||"buffer-transform-model",fs:Q.fs||ZU(),topology:Q.topology||"point-list",varyings:Q.outputs||Q.varyings,...Q}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:Q.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){if(this.model)this.model.destroy()}delete(){this.destroy()}run($){if($?.inputBuffers)this.model.setAttributes($.inputBuffers);if($?.outputBuffers)this.transformFeedback.setBuffers($.outputBuffers);let Q=this.device.beginRenderPass($);this.model.draw(Q),Q.end()}getBuffer($){return this.transformFeedback.getBuffer($)}readAsync($){let Q=this.getBuffer($);if(!Q)throw Error("BufferTransform#getBuffer");if(Q instanceof M1)return Q.readAsync();let{buffer:J,byteOffset:Z=0,byteLength:K=J.byteLength}=Q;return J.readAsync(Z,K)}}});class U5{id;topology;vertexCount;indices;attributes;userData={};constructor($){let{attributes:Q={},indices:J=null,vertexCount:Z=null}=$;if(this.id=$.id||R7("geometry"),this.topology=$.topology,J)this.indices=ArrayBuffer.isView(J)?{value:J,size:1}:J;this.attributes={};for(let[K,X]of Object.entries(Q)){let Y=ArrayBuffer.isView(X)?{value:X}:X;if(!ArrayBuffer.isView(Y.value))throw Error(`${this._print(K)}: must be typed array or object with value as typed array`);if((K==="POSITION"||K==="positions")&&!Y.size)Y.size=3;if(K==="indices"){if(this.indices)throw Error("Multiple indices detected");this.indices=Y}else this.attributes[K]=Y}if(this.indices&&this.indices.isIndexed!==void 0)this.indices=Object.assign({},this.indices),delete this.indices.isIndexed;this.vertexCount=Z||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print($){return`Geometry ${this.id} attribute ${$}`}_setAttributes($,Q){return this}_calculateVertexCount($,Q){if(Q)return Q.value.length;let J=1/0;for(let Z of Object.values($)){let{value:K,size:X,constant:Y}=Z;if(!Y&&K&&X!==void 0&&X>=1)J=Math.min(J,K.length/X)}return J}}var w_=C(()=>{z$()});var V5=C(()=>{F_();fN();M_();w_()});function s81($,Q,J){let{byLayer:Z,byAlpha:K}=$,X,Y=Z.get(Q);if(Y)Y.viewports.push(J),X=Y.a;else if(X=Z.size+1,X<=255)Y={a:X,layer:Q,viewports:[J]},Z.set(Q,Y),K[X]=Y;else r.warn("Too many pickable layers, only picking the first 255")(),X=0;return[0,0,0,X/255]}function o81($,Q){let J=$.byAlpha[Q[3]];return J&&{pickedLayer:J.layer,pickedViewports:J.viewports,pickedObjectIndex:J.layer.decodePickingColor(Q)}}var n81,Z3;var bN=C(()=>{KK();T0();n81={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};Z3=class Z3 extends B7{constructor(){super(...arguments);this._colorEncoderState=null}render($){if("pickingFBO"in $)return this._drawPickingBuffer($);return super.render($)}_drawPickingBuffer({layers:$,layerFilter:Q,views:J,viewports:Z,onViewportActive:K,pickingFBO:X,deviceRect:{x:Y,y:W,width:q,height:H},cullRect:F,effects:U,pass:V="picking",pickZ:N,shaderModuleProps:D}){this.pickZ=N;let z=this._resetColorEncoder(N),B=[Y,W,q,H],M=super.render({target:X,layers:$,layerFilter:Q,views:J,viewports:Z,onViewportActive:K,cullRect:F,effects:U?.filter((O)=>O.useInPicking),pass:V,isPicking:!0,shaderModuleProps:D,clearColor:[0,0,0,0],colorMask:15,scissorRect:B});return this._colorEncoderState=null,{decodePickingColor:z&&o81.bind(null,z),stats:M}}shouldDrawLayer($){let{pickable:Q,operation:J}=$.props;return Q&&J.includes("draw")||J.includes("terrain")||J.includes("mask")}getShaderModuleProps($,Q,J){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters($,Q,J){let Z={...$.props.parameters},{pickable:K,operation:X}=$.props;if(!this._colorEncoderState||X.includes("terrain"))Z.blend=!1;else if(K&&X.includes("draw"))Object.assign(Z,n81),Z.blend=!0,Z.blendColor=s81(this._colorEncoderState,$,J);return Z}_resetColorEncoder($){return this._colorEncoderState=$?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}});var O7,j8,N5,AK,A4,f6,W6;var P7=C(()=>{O7={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},j8=Symbol.for("component"),N5=Symbol.for("propTypes"),AK=Symbol.for("deprecatedProps"),A4=Symbol.for("asyncPropDefaults"),f6=Symbol.for("asyncPropOriginal"),W6=Symbol.for("asyncPropResolved")});function K3($,Q=()=>!0){if(!Array.isArray($))return Q($)?[$]:[];return S_($,Q,[])}function S_($,Q,J){let Z=-1;while(++Z<$.length){let K=$[Z];if(Array.isArray(K))S_(K,Q,J);else if(Q(K))J.push(K)}return J}function T_({target:$,source:Q,start:J=0,count:Z=1}){let K=Q.length,X=Z*K,Y=0;for(let W=J;Y<K;Y++)$[W++]=Q[Y];while(Y<X)if(Y<X-Y)$.copyWithin(J+Y,J,J+Y),Y*=2;else $.copyWithin(J+Y,J,J+X-Y),Y=X;return $}class zK{constructor($,Q,J){this._loadCount=0,this._subscribers=new Set,this.id=$,this.context=J,this.setData(Q)}subscribe($){this._subscribers.add($)}unsubscribe($){this._subscribers.delete($)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData($,Q){if($===this._data&&!Q)return;this._data=$;let J=++this._loadCount,Z=$;if(typeof $==="string")Z=q7($);if(Z instanceof Promise)this.isLoaded=!1,this._loader=Z.then((K)=>{if(this._loadCount===J)this.isLoaded=!0,this._error=void 0,this._content=K}).catch((K)=>{if(this._loadCount===J)this.isLoaded=!0,this._error=K||!0});else this.isLoaded=!0,this._error=void 0,this._content=$;for(let K of this._subscribers)K.onChange(this.getData())}}var I_=C(()=>{E2()});class kK{constructor($){this.protocol=$.protocol||"resource://",this._context={device:$.device,gl:$.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains($){if($.startsWith(this.protocol))return!0;return $ in this._resources}add({resourceId:$,data:Q,forceUpdate:J=!1,persistent:Z=!0}){let K=this._resources[$];if(K)K.setData(Q,J);else K=new zK($,Q,this._context),this._resources[$]=K;K.persistent=Z}remove($){let Q=this._resources[$];if(Q)Q.delete(),delete this._resources[$]}unsubscribe({consumerId:$}){let Q=this._consumers[$];if(Q){for(let J in Q){let Z=Q[J],K=this._resources[Z.resourceId];if(K)K.unsubscribe(Z)}delete this._consumers[$],this.prune()}}subscribe({resourceId:$,onChange:Q,consumerId:J,requestId:Z="default"}){let{_resources:K,protocol:X}=this;if($.startsWith(X)){if($=$.replace(X,""),!K[$])this.add({resourceId:$,data:null,persistent:!1})}let Y=K[$];if(this._track(J,Z,Y,Q),Y)return Y.getData();return}prune(){if(!this._pruneRequest)this._pruneRequest=setTimeout(()=>this._prune(),0)}finalize(){for(let $ in this._resources)this._resources[$].delete()}_track($,Q,J,Z){let K=this._consumers,X=K[$]=K[$]||{},Y=X[Q],W=Y&&Y.resourceId&&this._resources[Y.resourceId];if(W)W.unsubscribe(Y),this.prune();if(J){if(Y)Y.onChange=Z,Y.resourceId=J.id;else Y={onChange:Z,resourceId:J.id};X[Q]=Y,J.subscribe(Y)}}_prune(){this._pruneRequest=null;for(let $ of Object.keys(this._resources)){let Q=this._resources[$];if(!Q.persistent&&!Q.inUse())Q.delete(),delete this._resources[$]}}}var G_=C(()=>{I_()});class BK{constructor($,Q){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=(Y)=>{if(X0(a81,this,Y),Y)this.context.viewport=Y};let{deck:J,stats:Z,viewport:K,timeline:X}=Q||{};this.layers=[],this.resourceManager=new kK({device:$,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:$,gl:$?.gl,deck:J,shaderAssembler:uv($?.info?.shadingLanguage||"glsl"),defaultShaderModules:[lV],renderPass:void 0,stats:Z||new e5({id:"deck.gl"}),viewport:K||new HK({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:X||new J3,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let $ of this.layers)this._finalizeLayer($)}needsRedraw($={clearRedrawFlags:!1}){let Q=this._needsRedraw;if($.clearRedrawFlags)this._needsRedraw=!1;for(let J of this.layers){let Z=J.getNeedsRedraw($);Q=Q||Z}return Q}needsUpdate(){if(this._nextLayers&&this._nextLayers!==this._lastRenderedLayers)return"layers changed";if(this._defaultShaderModulesChanged)return"shader modules changed";return this._needsUpdate}setNeedsRedraw($){this._needsRedraw=this._needsRedraw||$}setNeedsUpdate($){this._needsUpdate=this._needsUpdate||$}getLayers({layerIds:$}={}){return $?this.layers.filter((Q)=>$.find((J)=>Q.id.indexOf(J)===0)):this.layers}setProps($){if("debug"in $)this._debug=$.debug;if("userData"in $)this.context.userData=$.userData;if("layers"in $)this._nextLayers=$.layers;if("onError"in $)this.context.onError=$.onError}setLayers($,Q){X0(r81,this,Q,$),this._lastRenderedLayers=$;let J=K3($,Boolean);for(let Z of J)Z.context=this.context;this._updateLayers(this.layers,J)}updateLayers(){let $=this.needsUpdate();if($)this.setNeedsRedraw(`updating layers: ${$}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,$);this._nextLayers=null}addDefaultShaderModule($){let{defaultShaderModules:Q}=this.context;if(!Q.find((J)=>J.name===$.name))Q.push($),this._defaultShaderModulesChanged=!0}removeDefaultShaderModule($){let{defaultShaderModules:Q}=this.context,J=Q.findIndex((Z)=>Z.name===$.name);if(J>=0)Q.splice(J,1),this._defaultShaderModulesChanged=!0}_handleError($,Q,J){J.raiseError(Q,`${$} of ${J}`)}_updateLayers($,Q){let J={};for(let X of $)if(J[X.id])r.warn(`Multiple old layers with same id ${X.id}`)();else J[X.id]=X;if(this._defaultShaderModulesChanged){for(let X of $)X.setNeedsUpdate(),X.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let Z=[];this._updateSublayersRecursively(Q,J,Z),this._finalizeOldLayers(J);let K=!1;for(let X of Z)if(X.hasUniformTransition()){K=`Uniform transition in ${X}`;break}this._needsUpdate=K,this.layers=Z}_updateSublayersRecursively($,Q,J){for(let Z of $){Z.context=this.context;let K=Q[Z.id];if(K===null)r.warn(`Multiple new layers with same id ${Z.id}`)();Q[Z.id]=null;let X=null;try{if(this._debug&&K!==Z)Z.validateProps();if(!K)this._initializeLayer(Z);else this._transferLayerState(K,Z),this._updateLayer(Z);J.push(Z),X=Z.isComposite?Z.getSubLayers():null}catch(Y){this._handleError("matching",Y,Z)}if(X)this._updateSublayersRecursively(X,Q,J)}}_finalizeOldLayers($){for(let Q in $){let J=$[Q];if(J)this._finalizeLayer(J)}}_initializeLayer($){try{$._initialize(),$.lifecycle=O7.INITIALIZED}catch(Q){this._handleError("initialization",Q,$)}}_transferLayerState($,Q){if(Q._transferState($),Q.lifecycle=O7.MATCHED,Q!==$)$.lifecycle=O7.AWAITING_GC}_updateLayer($){try{$._update()}catch(Q){this._handleError("update",Q,$)}}_finalizeLayer($){this._needsRedraw=this._needsRedraw||`finalized ${$}`,$.lifecycle=O7.AWAITING_FINALIZATION;try{$._finalize(),$.lifecycle=O7.FINALIZED}catch(Q){this._handleError("finalization",Q,$)}}}var r81="layerManager.setLayers",a81="layerManager.activateViewport";var E_=C(()=>{V5();SN();P7();T0();N8();R2();G_();IN()});function G0($,Q,J){if($===Q)return!0;if(!J||!$||!Q)return!1;if(Array.isArray($)){if(!Array.isArray(Q)||$.length!==Q.length)return!1;for(let Z=0;Z<$.length;Z++)if(!G0($[Z],Q[Z],J-1))return!1;return!0}if(Array.isArray(Q))return!1;if(typeof $==="object"&&typeof Q==="object"){let Z=Object.keys($),K=Object.keys(Q);if(Z.length!==K.length)return!1;for(let X of Z){if(!Q.hasOwnProperty(X))return!1;if(!G0($[X],Q[X],J-1))return!1}return!0}return!1}class RK{constructor($){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=$.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=$.eventManager,this._eventCallbacks={onViewStateChange:$.onViewStateChange,onInteractionStateChange:$.onInteractionStateChange},Object.seal(this),this.setProps($)}finalize(){for(let $ in this.controllers){let Q=this.controllers[$];if(Q)Q.finalize()}this.controllers={}}needsRedraw($={clearRedrawFlags:!1}){let Q=this._needsRedraw;if($.clearRedrawFlags)this._needsRedraw=!1;return Q}setNeedsUpdate($){this._needsUpdate=this._needsUpdate||$,this._needsRedraw=this._needsRedraw||$}updateViewStates(){for(let $ in this.controllers){let Q=this.controllers[$];if(Q)Q.updateTransition()}}getViewports($){if($)return this._viewports.filter((Q)=>Q.containsPixel($));return this._viewports}getViews(){let $={};return this.views.forEach((Q)=>{$[Q.id]=Q}),$}getView($){return this.views.find((Q)=>Q.id===$)}getViewState($){let Q=typeof $==="string"?this.getView($):$,J=Q&&this.viewState[Q.getViewStateId()]||this.viewState;return Q?Q.filterViewState(J):J}getViewport($){return this._viewportMap[$]}unproject($,Q){let J=this.getViewports(),Z={x:$[0],y:$[1]};for(let K=J.length-1;K>=0;--K){let X=J[K];if(X.containsPixel(Z)){let Y=$.slice();return Y[0]-=X.x,Y[1]-=X.y,X.unproject(Y,Q)}}return null}setProps($){if($.views)this._setViews($.views);if($.viewState)this._setViewState($.viewState);if("width"in $||"height"in $)this._setSize($.width,$.height);if(!this._isUpdating)this._update()}_update(){if(this._isUpdating=!0,this._needsUpdate)this._needsUpdate=!1,this._rebuildViewports();if(this._needsUpdate)this._needsUpdate=!1,this._rebuildViewports();this._isUpdating=!1}_setSize($,Q){if($!==this.width||Q!==this.height)this.width=$,this.height=Q,this.setNeedsUpdate("Size changed")}_setViews($){if($=K3($,Boolean),this._diffViews($,this.views))this.setNeedsUpdate("views changed");this.views=$}_setViewState($){if($){if(!G0($,this.viewState,3))this.setNeedsUpdate("viewState changed");this.viewState=$}else r.warn("missing `viewState` or `initialViewState`")()}_createController($,Q){return new Q.type({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:(K)=>this.getView($.id)?.makeViewport({viewState:K,width:this.width,height:this.height})})}_updateController($,Q,J,Z){let K=$.controller;if(K&&J){let X={...Q,...K,id:$.id,x:J.x,y:J.y,width:J.width,height:J.height};if(!Z||Z.constructor!==K.type)Z=this._createController($,X);if(Z)Z.setProps(X);return Z}return null}_rebuildViewports(){let{views:$}=this,Q=this.controllers;this._viewports=[],this.controllers={};let J=!1;for(let Z=$.length;Z--;){let K=$[Z],X=this.getViewState(K),Y=K.makeViewport({viewState:X,width:this.width,height:this.height}),W=Q[K.id],q=Boolean(K.controller);if(q&&!W)J=!0;if((J||!q)&&W)W.finalize(),W=null;if(this.controllers[K.id]=this._updateController(K,X,Y,W),Y)this._viewports.unshift(Y)}for(let Z in Q){let K=Q[Z];if(K&&!this.controllers[Z])K.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(($)=>{if($.id)this._viewportMap[$.id]=this._viewportMap[$.id]||$})}_diffViews($,Q){if($.length!==Q.length)return!0;return $.some((J,Z)=>!$[Z].equals(Q[Z]))}}var j_=C(()=>{T0()});function z4($){switch(typeof $){case"number":return{position:$,relative:!1};case"string":let Q=t81.exec($);if(Q&&Q.length>=3){let J=Q[2]==="%",Z=parseFloat(Q[1]);return{position:J?Z/100:Z,relative:J}}default:throw Error(`Could not parse position string ${$}`)}}function k4($,Q){return $.relative?Math.round($.position*Q):$.position}var t81;var h_=C(()=>{t81=/([0-9]+\.?[0-9]*)(%|px)/});class c5{constructor($){let{id:Q,x:J=0,y:Z=0,width:K="100%",height:X="100%",padding:Y=null}=$;this.id=Q||this.constructor.displayName||"view",this.props={...$,id:this.id},this._x=z4(J),this._y=z4(Z),this._width=z4(K),this._height=z4(X),this._padding=Y&&{left:z4(Y.left||0),right:z4(Y.right||0),top:z4(Y.top||0),bottom:z4(Y.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals($){if(this===$)return!0;return this.constructor===$.constructor&&G0(this.props,$.props,2)}makeViewport({width:$,height:Q,viewState:J}){J=this.filterViewState(J);let Z=this.getDimensions({width:$,height:Q});if(!Z.height||!Z.width)return null;return new(this.getViewportType(J))({...J,...this.props,...Z})}getViewStateId(){let{viewState:$}=this.props;if(typeof $==="string")return $;return $?.id||this.id}filterViewState($){if(this.props.viewState&&typeof this.props.viewState==="object"){if(!this.props.viewState.id)return this.props.viewState;let Q={...$};for(let J in this.props.viewState)if(J!=="id")Q[J]=this.props.viewState[J];return Q}return $}getDimensions({width:$,height:Q}){let J={x:k4(this._x,$),y:k4(this._y,Q),width:k4(this._width,$),height:k4(this._height,Q)};if(this._padding)J.padding={left:k4(this._padding.left,$),top:k4(this._padding.top,Q),right:k4(this._padding.right,$),bottom:k4(this._padding.bottom,Q)};return J}get controller(){let $=this.props.controller;if(!$)return null;if($===!0)return{type:this.ControllerType};if(typeof $==="function")return{type:$};return{type:this.ControllerType,...$}}}var mN=C(()=>{h_()});class b6{constructor($){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=$}get inProgress(){return this._inProgress}start($){this.cancel(),this.settings=$,this._inProgress=!0,this.settings.onStart?.(this)}end(){if(this._inProgress)this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this)}cancel(){if(this._inProgress)this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:$,settings:Q}=this;this._handle=$.addChannel({delay:$.getTime(),duration:Q.duration})}if(this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle))this.end();return!0}_onUpdate(){}}class OK{constructor($){this._onTransitionUpdate=(Q)=>{let{time:J,settings:{interpolator:Z,startProps:K,endProps:X,duration:Y,easing:W}}=Q,q=W(J/Y),H=Z.interpolateProps(K,X,q);this.propsInTransition=this.getControllerState({...this.props,...H}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=$.getControllerState,this.propsInTransition=null,this.transition=new b6($.timeline),this.onViewStateChange=$.onViewStateChange||L_,this.onStateChange=$.onStateChange||L_}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange($){let Q=!1,J=this.props;if(this.props=$,!J||this._shouldIgnoreViewportChange(J,$))return!1;if(this._isTransitionEnabled($)){let Z=J;if(this.transition.inProgress){let{interruption:K,endProps:X}=this.transition.settings;Z={...J,...K===cN.SNAP_TO_END?X:this.propsInTransition||J}}this._triggerTransition(Z,$),Q=!0}else this.transition.cancel();return Q}updateTransition(){this.transition.update()}_isTransitionEnabled($){let{transitionDuration:Q,transitionInterpolator:J}=$;return(Q>0||Q==="auto")&&Boolean(J)}_isUpdateDueToCurrentTransition($){if(this.transition.inProgress&&this.propsInTransition)return this.transition.settings.interpolator.arePropsEqual($,this.propsInTransition);return!1}_shouldIgnoreViewportChange($,Q){if(this.transition.inProgress)return this.transition.settings.interruption===cN.IGNORE||this._isUpdateDueToCurrentTransition(Q);if(this._isTransitionEnabled(Q))return Q.transitionInterpolator.arePropsEqual($,Q);return!0}_triggerTransition($,Q){let J=this.getControllerState($),Z=this.getControllerState(Q).shortestPathFrom(J),K=Q.transitionInterpolator,X=K.getDuration?K.getDuration($,Q):Q.transitionDuration;if(X===0)return;let Y=K.initializeProps($,Z);this.propsInTransition={};let W={duration:X,easing:Q.transitionEasing||e81,interpolator:K,interruption:Q.transitionInterruption||$91,startProps:Y.start,endProps:Y.end,onStart:Q.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(Q.onTransitionInterrupt),onEnd:this._onTransitionEnd(Q.onTransitionEnd)};this.transition.start(W),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd($){return(Q)=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),$?.(Q)}}}var L_=()=>{},cN,e81=($)=>$,$91;var v_=C(()=>{cN={BREAK:1,SNAP_TO_END:2,IGNORE:3},$91=cN.BREAK});function r1($,Q){if(!$)throw Error(Q||"deck.gl: assertion failed.")}class PK{constructor($){let{compare:Q,extract:J,required:Z}=$;this._propsToCompare=Q,this._propsToExtract=J||Q,this._requiredProps=Z}arePropsEqual($,Q){for(let J of this._propsToCompare)if(!(J in $)||!(J in Q)||!U4($[J],Q[J]))return!1;return!0}initializeProps($,Q){let J={},Z={};for(let K of this._propsToExtract)if(K in $||K in Q)J[K]=$[K],Z[K]=Q[K];return this._checkRequiredProps(J),this._checkRequiredProps(Z),{start:J,end:Z}}getDuration($,Q){return Q.transitionDuration}_checkRequiredProps($){if(!this._requiredProps)return;this._requiredProps.forEach((Q)=>{let J=$[Q];r1(Number.isFinite(J)||Array.isArray(J),`${Q} is required for transition`)})}}var __=C(()=>{g0()});var Q91,J91,X3;var dN=C(()=>{__();g0();Q91=["longitude","latitude","zoom","bearing","pitch"],J91=["longitude","latitude","zoom"];X3=class X3 extends PK{constructor($={}){let Q=Array.isArray($)?$:$.transitionProps,J=Array.isArray($)?{}:$;J.transitionProps=Array.isArray(Q)?{compare:Q,required:Q}:Q||{compare:Q91,required:J91};super(J.transitionProps);this.opts=J}initializeProps($,Q){let J=super.initializeProps($,Q),{makeViewport:Z,around:K}=this.opts;if(Z&&K){let X=Z($),Y=Z(Q),W=X.unproject(K);J.start.around=K,Object.assign(J.end,{around:Y.project(W),aroundPosition:W,width:Q.width,height:Q.height})}return J}interpolateProps($,Q,J){let Z={};for(let K of this._propsToExtract)Z[K]=B8($[K]||0,Q[K]||0,J);if(Q.aroundPosition&&this.opts.makeViewport){let K=this.opts.makeViewport({...Q,...Z});Object.assign(Z,K.panByPosition(Q.aroundPosition,B8($.around,Q.around,J)))}return Z}}});class wK{constructor($){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new OK({...$,getControllerState:(Q)=>new this.ControllerState(Q),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=$.eventManager,this.onViewStateChange=$.onViewStateChange||(()=>{}),this.onStateChange=$.onStateChange||(()=>{}),this.makeViewport=$.makeViewport}set events($){if(this.toggleEvents(this._customEvents,!1),this.toggleEvents($,!0),this._customEvents=$,this.props)this.setProps(this.props)}finalize(){for(let $ in this._events)if(this._events[$])this.eventManager?.off($,this.handleEvent);this.transitionManager.finalize()}handleEvent($){this._controllerState=void 0;let Q=this._eventStartBlocked;switch($.type){case"panstart":return Q?!1:this._onPanStart($);case"panmove":return this._onPan($);case"panend":return this._onPanEnd($);case"pinchstart":return Q?!1:this._onPinchStart($);case"pinchmove":return this._onPinch($);case"pinchend":return this._onPinchEnd($);case"multipanstart":return Q?!1:this._onMultiPanStart($);case"multipanmove":return this._onMultiPan($);case"multipanend":return this._onMultiPanEnd($);case"dblclick":return this._onDoubleClick($);case"wheel":return this._onWheel($);case"keydown":return this._onKeyDown($);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter($){let{x:Q,y:J}=this.props,{offsetCenter:Z}=$;return[Z.x-Q,Z.y-J]}isPointInBounds($,Q){let{width:J,height:Z}=this.props;if(Q&&Q.handled)return!1;let K=$[0]>=0&&$[0]<=J&&$[1]>=0&&$[1]<=Z;if(K&&Q)Q.stopPropagation();return K}isFunctionKeyPressed($){let{srcEvent:Q}=$;return Boolean(Q.metaKey||Q.altKey||Q.ctrlKey||Q.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents($){let Q=setTimeout(()=>{if(this._eventStartBlocked===Q)this._eventStartBlocked=null},$);this._eventStartBlocked=Q}setProps($){if($.dragMode)this.dragMode=$.dragMode;if(this.props=$,!("transitionInterpolator"in $))$.transitionInterpolator=this._getTransitionProps().transitionInterpolator;this.transitionManager.processViewStateChange($);let{inertia:Q}=$;this.inertia=Number.isFinite(Q)?Q:Q===!0?Z91:0;let{scrollZoom:J=!0,dragPan:Z=!0,dragRotate:K=!0,doubleClickZoom:X=!0,touchZoom:Y=!0,touchRotate:W=!1,keyboard:q=!0}=$,H=Boolean(this.onViewStateChange);this.toggleEvents(Y3.WHEEL,H&&J),this.toggleEvents(Y3.PAN,H),this.toggleEvents(Y3.PINCH,H&&(Y||W)),this.toggleEvents(Y3.MULTI_PAN,H&&W),this.toggleEvents(Y3.DOUBLE_CLICK,H&&X),this.toggleEvents(Y3.KEYBOARD,H&&q),this.scrollZoom=J,this.dragPan=Z,this.dragRotate=K,this.doubleClickZoom=X,this.touchZoom=Y,this.touchRotate=W,this.keyboard=q}updateTransition(){this.transitionManager.updateTransition()}toggleEvents($,Q){if(this.eventManager)$.forEach((J)=>{if(this._events[J]!==Q)if(this._events[J]=Q,Q)this.eventManager.on(J,this.handleEvent);else this.eventManager.off(J,this.handleEvent)})}updateViewport($,Q=null,J={}){let Z={...$.getViewportProps(),...Q},K=this.controllerState!==$;if(this.state=$.getState(),this._setInteractionState(J),K){let X=this.controllerState&&this.controllerState.getViewportProps();if(this.onViewStateChange)this.onViewStateChange({viewState:Z,interactionState:this._interactionState,oldViewState:X,viewId:this.props.id})}}_onTransition($){this.onViewStateChange({...$,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState($){Object.assign(this._interactionState,$),this.onStateChange(this._interactionState)}_onPanStart($){let Q=this.getCenter($);if(!this.isPointInBounds(Q,$))return!1;let J=this.isFunctionKeyPressed($)||$.rightButton||!1;if(this.invertPan||this.dragMode==="pan")J=!J;let Z=this.controllerState[J?"panStart":"rotateStart"]({pos:Q});return this._panMove=J,this.updateViewport(Z,B4,{isDragging:!0}),!0}_onPan($){if(!this.isDragging())return!1;return this._panMove?this._onPanMove($):this._onPanRotate($)}_onPanEnd($){if(!this.isDragging())return!1;return this._panMove?this._onPanMoveEnd($):this._onPanRotateEnd($)}_onPanMove($){if(!this.dragPan)return!1;let Q=this.getCenter($),J=this.controllerState.pan({pos:Q});return this.updateViewport(J,B4,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd($){let{inertia:Q}=this;if(this.dragPan&&Q&&$.velocity){let J=this.getCenter($),Z=[J[0]+$.velocityX*Q/2,J[1]+$.velocityY*Q/2],K=this.controllerState.pan({pos:Z}).panEnd();this.updateViewport(K,{...this._getTransitionProps(),transitionDuration:Q,transitionEasing:MK},{isDragging:!1,isPanning:!0})}else{let J=this.controllerState.panEnd();this.updateViewport(J,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate($){if(!this.dragRotate)return!1;let Q=this.getCenter($),J=this.controllerState.rotate({pos:Q});return this.updateViewport(J,B4,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd($){let{inertia:Q}=this;if(this.dragRotate&&Q&&$.velocity){let J=this.getCenter($),Z=[J[0]+$.velocityX*Q/2,J[1]+$.velocityY*Q/2],K=this.controllerState.rotate({pos:Z}).rotateEnd();this.updateViewport(K,{...this._getTransitionProps(),transitionDuration:Q,transitionEasing:MK},{isDragging:!1,isRotating:!0})}else{let J=this.controllerState.rotateEnd();this.updateViewport(J,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel($){if(!this.scrollZoom)return!1;let Q=this.getCenter($);if(!this.isPointInBounds(Q,$))return!1;$.srcEvent.preventDefault();let{speed:J=0.01,smooth:Z=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:K}=$,X=2/(1+Math.exp(-Math.abs(K*J)));if(K<0&&X!==0)X=1/X;let Y=Z?{...this._getTransitionProps({around:Q}),transitionDuration:250}:B4,W=this.controllerState.zoom({pos:Q,scale:X});return this.updateViewport(W,Y,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart($){let Q=this.getCenter($);if(!this.isPointInBounds(Q,$))return!1;let J=this.controllerState.rotateStart({pos:Q});return this.updateViewport(J,B4,{isDragging:!0}),!0}_onMultiPan($){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;let Q=this.getCenter($);Q[0]-=$.deltaX;let J=this.controllerState.rotate({pos:Q});return this.updateViewport(J,B4,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd($){if(!this.isDragging())return!1;let{inertia:Q}=this;if(this.touchRotate&&Q&&$.velocityY){let J=this.getCenter($),Z=[J[0],J[1]+=$.velocityY*Q/2],K=this.controllerState.rotate({pos:Z});this.updateViewport(K,{...this._getTransitionProps(),transitionDuration:Q,transitionEasing:MK},{isDragging:!1,isRotating:!0}),this.blockEvents(Q)}else{let J=this.controllerState.rotateEnd();this.updateViewport(J,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart($){let Q=this.getCenter($);if(!this.isPointInBounds(Q,$))return!1;let J=this.controllerState.zoomStart({pos:Q}).rotateStart({pos:Q});return h8._startPinchRotation=$.rotation,h8._lastPinchEvent=$,this.updateViewport(J,B4,{isDragging:!0}),!0}_onPinch($){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let Q=this.controllerState;if(this.touchZoom){let{scale:J}=$,Z=this.getCenter($);Q=Q.zoom({pos:Z,scale:J})}if(this.touchRotate){let{rotation:J}=$;Q=Q.rotate({deltaAngleX:h8._startPinchRotation-J})}return this.updateViewport(Q,B4,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),h8._lastPinchEvent=$,!0}_onPinchEnd($){if(!this.isDragging())return!1;let{inertia:Q}=this,{_lastPinchEvent:J}=h8;if(this.touchZoom&&Q&&J&&$.scale!==J.scale){let Z=this.getCenter($),K=this.controllerState.rotateEnd(),X=Math.log2($.scale),Y=(X-Math.log2(J.scale))/($.deltaTime-J.deltaTime),W=Math.pow(2,X+Y*Q/2);K=K.zoom({pos:Z,scale:W}).zoomEnd(),this.updateViewport(K,{...this._getTransitionProps({around:Z}),transitionDuration:Q,transitionEasing:MK},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(Q)}else{let Z=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(Z,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return h8._startPinchRotation=null,h8._lastPinchEvent=null,!0}_onDoubleClick($){if(!this.doubleClickZoom)return!1;let Q=this.getCenter($);if(!this.isPointInBounds(Q,$))return!1;let J=this.isFunctionKeyPressed($),Z=this.controllerState.zoom({pos:Q,scale:J?0.5:2});return this.updateViewport(Z,this._getTransitionProps({around:Q}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown($){if(!this.keyboard)return!1;let Q=this.isFunctionKeyPressed($),{zoomSpeed:J,moveSpeed:Z,rotateSpeedX:K,rotateSpeedY:X}=this.keyboard===!0?{}:this.keyboard,{controllerState:Y}=this,W,q={};switch($.srcEvent.code){case"Minus":W=Q?Y.zoomOut(J).zoomOut(J):Y.zoomOut(J),q.isZooming=!0;break;case"Equal":W=Q?Y.zoomIn(J).zoomIn(J):Y.zoomIn(J),q.isZooming=!0;break;case"ArrowLeft":if(Q)W=Y.rotateLeft(K),q.isRotating=!0;else W=Y.moveLeft(Z),q.isPanning=!0;break;case"ArrowRight":if(Q)W=Y.rotateRight(K),q.isRotating=!0;else W=Y.moveRight(Z),q.isPanning=!0;break;case"ArrowUp":if(Q)W=Y.rotateUp(X),q.isRotating=!0;else W=Y.moveUp(Z),q.isPanning=!0;break;case"ArrowDown":if(Q)W=Y.rotateDown(X),q.isRotating=!0;else W=Y.moveDown(Z),q.isPanning=!0;break;default:return!1}return this.updateViewport(W,this._getTransitionProps(),q),!0}_getTransitionProps($){let{transition:Q}=this;if(!Q||!Q.transitionInterpolator)return B4;return $?{...Q,transitionInterpolator:new X3({...$,...Q.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:Q}}var B4,Z91=300,MK=($)=>1-(1-$)*(1-$),Y3,h8;var x_=C(()=>{v_();dN();B4={transitionDuration:0},Y3={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},h8={}});class SK{constructor($,Q){this._viewportProps=this.applyConstraints($),this._state=Q}getViewportProps(){return this._viewportProps}getState(){return this._state}}var g_=5,K91=1.2,y_,TK;var f_=C(()=>{g0();x_();G8();dN();y_=class y_ extends SK{constructor($){let{width:Q,height:J,latitude:Z,longitude:K,zoom:X,bearing:Y=0,pitch:W=0,altitude:q=1.5,position:H=[0,0,0],maxZoom:F=20,minZoom:U=0,maxPitch:V=60,minPitch:N=0,startPanLngLat:D,startZoomLngLat:z,startRotatePos:B,startBearing:M,startPitch:P,startZoom:O,normalize:G=!0}=$;r1(Number.isFinite(K)),r1(Number.isFinite(Z)),r1(Number.isFinite(X));super({width:Q,height:J,latitude:Z,longitude:K,zoom:X,bearing:Y,pitch:W,altitude:q,maxZoom:F,minZoom:U,maxPitch:V,minPitch:N,normalize:G,position:H},{startPanLngLat:D,startZoomLngLat:z,startRotatePos:B,startBearing:M,startPitch:P,startZoom:O});this.makeViewport=$.makeViewport}panStart({pos:$}){return this._getUpdatedState({startPanLngLat:this._unproject($)})}pan({pos:$,startPos:Q}){let J=this.getState().startPanLngLat||this._unproject(Q);if(!J)return this;let K=this.makeViewport(this.getViewportProps()).panByPosition(J,$);return this._getUpdatedState(K)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:$}){return this._getUpdatedState({startRotatePos:$,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:$,deltaAngleX:Q=0,deltaAngleY:J=0}){let{startRotatePos:Z,startBearing:K,startPitch:X}=this.getState();if(!Z||K===void 0||X===void 0)return this;let Y;if($)Y=this._getNewRotation($,Z,X,K);else Y={bearing:K+Q,pitch:X+J};return this._getUpdatedState(Y)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:$}){return this._getUpdatedState({startZoomLngLat:this._unproject($),startZoom:this.getViewportProps().zoom})}zoom({pos:$,startPos:Q,scale:J}){let{startZoom:Z,startZoomLngLat:K}=this.getState();if(!K)Z=this.getViewportProps().zoom,K=this._unproject(Q)||this._unproject($);if(!K)return this;let{maxZoom:X,minZoom:Y}=this.getViewportProps(),W=Z+Math.log2(J);W=g5(W,Y,X);let q=this.makeViewport({...this.getViewportProps(),zoom:W});return this._getUpdatedState({zoom:W,...q.panByPosition(K,$)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn($=2){return this._zoomFromCenter($)}zoomOut($=2){return this._zoomFromCenter(1/$)}moveLeft($=100){return this._panFromCenter([$,0])}moveRight($=100){return this._panFromCenter([-$,0])}moveUp($=100){return this._panFromCenter([0,$])}moveDown($=100){return this._panFromCenter([0,-$])}rotateLeft($=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-$})}rotateRight($=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+$})}rotateUp($=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+$})}rotateDown($=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-$})}shortestPathFrom($){let Q=$.getViewportProps(),J={...this.getViewportProps()},{bearing:Z,longitude:K}=J;if(Math.abs(Z-Q.bearing)>180)J.bearing=Z<0?Z+360:Z-360;if(Math.abs(K-Q.longitude)>180)J.longitude=K<0?K+360:K-360;return J}applyConstraints($){let{maxZoom:Q,minZoom:J,zoom:Z}=$;$.zoom=g5(Z,J,Q);let{maxPitch:K,minPitch:X,pitch:Y}=$;$.pitch=g5(Y,X,K);let{normalize:W=!0}=$;if(W)Object.assign($,wN($));return $}_zoomFromCenter($){let{width:Q,height:J}=this.getViewportProps();return this.zoom({pos:[Q/2,J/2],scale:$})}_panFromCenter($){let{width:Q,height:J}=this.getViewportProps();return this.pan({startPos:[Q/2,J/2],pos:[Q/2+$[0],J/2+$[1]]})}_getUpdatedState($){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...$})}_unproject($){let Q=this.makeViewport(this.getViewportProps());return $&&Q.unproject($)}_getNewRotation($,Q,J,Z){let K=$[0]-Q[0],X=$[1]-Q[1],Y=$[1],W=Q[1],{width:q,height:H}=this.getViewportProps(),F=K/q,U=0;if(X>0){if(Math.abs(H-W)>g_)U=X/(W-H)*K91}else if(X<0){if(W>g_)U=1-Y/W}U=g5(U,-1,1);let{minPitch:V,maxPitch:N}=this.getViewportProps(),D=Z+180*F,z=J;if(U>0)z=J+U*(N-J);else if(U<0)z=J-U*(V-J);return{pitch:z,bearing:D}}};TK=class TK extends wK{constructor(){super(...arguments);this.ControllerState=y_,this.transition={transitionDuration:300,transitionInterpolator:new X3({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps($){$.position=$.position||[0,0,0];let Q=this.props;if(super.setProps($),!Q||Q.height!==$.height)this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...$,...this.state}))}}});var lN,b_;var m_=C(()=>{mN();GN();f_();lN=class lN extends c5{constructor($={}){super($)}getViewportType(){return FK}get ControllerType(){return TK}};lN.displayName="MapView";b_=lN});function Y91($,Q){let J=$.order??1/0,Z=Q.order??1/0;return J-Z}class IK{constructor($){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=$,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect($){let Q=this._defaultEffects;if(!Q.find((J)=>J.id===$.id)){let J=Q.findIndex((Z)=>Y91(Z,$)>0);if(J<0)Q.push($);else Q.splice(J,0,$);$.setup(this._context),this._setEffects(this.effects)}}setProps($){if("effects"in $){if(!G0($.effects,this.effects,1))this._setEffects($.effects)}}needsRedraw($={clearRedrawFlags:!1}){let Q=this._needsRedraw;if($.clearRedrawFlags)this._needsRedraw=!1;return Q}getEffects(){return this._resolvedEffects}_setEffects($){let Q={};for(let Z of this.effects)Q[Z.id]=Z;let J=[];for(let Z of $){let K=Q[Z.id],X=Z;if(K&&K!==Z)if(K.setProps)K.setProps(Z.props),X=K;else K.cleanup(this._context);else if(!K)Z.setup(this._context);J.push(X),delete Q[Z.id]}for(let Z in Q)Q[Z].cleanup(this._context);if(this.effects=J,this._resolvedEffects=J.concat(this._defaultEffects),!$.some((Z)=>Z instanceof D$))this._resolvedEffects.push(X91);this._needsRedraw="effects changed"}finalize(){for(let $ of this._resolvedEffects)$.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}var X91;var c_=C(()=>{tv();X91=new D$});var GK;var d_=C(()=>{KK();GK=class GK extends B7{shouldDrawLayer($){let{operation:Q}=$.props;return Q.includes("draw")||Q.includes("terrain")}}});class EK{constructor($){this.device=$,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new GK($),this.pickLayersPass=new Z3($),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps($){if(this.layerFilter!==$.layerFilter)this.layerFilter=$.layerFilter,this._needsRedraw="layerFilter changed";if(this.drawPickingColors!==$.drawPickingColors)this.drawPickingColors=$.drawPickingColors,this._needsRedraw="drawPickingColors changed"}renderLayers($){if(!$.viewports.length)return;let Q=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,J={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...$};if(J.effects)this._preRender(J.effects,J);let Z=this.lastPostProcessEffect?this.renderBuffers[0]:J.target;if(this.lastPostProcessEffect)J.clearColor=[0,0,0,0],J.clearCanvas=!0;let K=Q.render({...J,target:Z});if(J.effects)this._postRender(J.effects,J);this.renderCount++,X0(W91,this,K,$)}needsRedraw($={clearRedrawFlags:!1}){let Q=this._needsRedraw;if($.clearRedrawFlags)this._needsRedraw=!1;return Q}finalize(){let{renderBuffers:$}=this;for(let Q of $)Q.delete();$.length=0}_preRender($,Q){this.lastPostProcessEffect=null,Q.preRenderStats=Q.preRenderStats||{};for(let J of $)if(Q.preRenderStats[J.id]=J.preRender(Q),J.postRender)this.lastPostProcessEffect=J.id;if(this.lastPostProcessEffect)this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:$}=this,Q=this.device.canvasContext.getDrawingBufferSize();if($.length===0)[0,1].map((J)=>{let Z=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});$.push(this.device.createFramebuffer({id:`deck-renderbuffer-${J}`,colorAttachments:[Z]}))});for(let J of $)J.resize(Q)}_postRender($,Q){let{renderBuffers:J}=this,Z={...Q,inputBuffer:J[0],swapBuffer:J[1]};for(let K of $)if(K.postRender){Z.target=K.id===this.lastPostProcessEffect?Q.target:void 0;let X=K.postRender(Z);Z.inputBuffer=X,Z.swapBuffer=X===J[0]?J[1]:J[0]}}}var W91="deckRenderer.renderLayers";var l_=C(()=>{N8();d_();bN()});function p_({pickedColors:$,decodePickingColor:Q,deviceX:J,deviceY:Z,deviceRadius:K,deviceRect:X}){let{x:Y,y:W,width:q,height:H}=X,F=K*K,U=-1,V=0;for(let N=0;N<H;N++){let D=N+W-Z,z=D*D;if(z>F)V+=4*q;else for(let B=0;B<q;B++){if($[V+3]-1>=0){let P=B+Y-J,O=P*P+z;if(O<=F)F=O,U=V}V+=4}}if(U>=0){let N=$.slice(U,U+4),D=Q(N);if(D){let z=Math.floor(U/4/q),B=U/4-z*q;return{...D,pickedColor:N,pickedX:Y+B,pickedY:W+z}}r.error("Picked non-existent layer. Is picking buffer corrupt?")()}return q91}function u_({pickedColors:$,decodePickingColor:Q}){let J=new Map;if($){for(let Z=0;Z<$.length;Z+=4)if($[Z+3]-1>=0){let X=$.slice(Z,Z+4),Y=X.join(",");if(!J.has(Y)){let W=Q(X);if(W)J.set(Y,{...W,color:X});else r.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(J.values())}var q91;var i_=C(()=>{T0();q91={pickedColor:null,pickedObjectIndex:-1}});function pN({pickInfo:$,viewports:Q,pixelRatio:J,x:Z,y:K,z:X}){let Y=Q[0];if(Q.length>1)Y=H91($?.pickedViewports||Q,{x:Z,y:K});let W;if(Y){let q=[Z-Y.x,K-Y.y];if(X!==void 0)q[2]=X;W=Y.unproject(q)}return{color:null,layer:null,viewport:Y,index:-1,picked:!1,x:Z,y:K,pixel:[Z,K],coordinate:W,devicePixel:$&&"pickedX"in $?[$.pickedX,$.pickedY]:void 0,pixelRatio:J}}function n_($){let{pickInfo:Q,lastPickedInfo:J,mode:Z,layers:K}=$,{pickedColor:X,pickedLayer:Y,pickedObjectIndex:W}=Q,q=Y?[Y]:[];if(Z==="hover"){let{index:U,layerId:V}=J,N=Y?Y.props.id:null;if(N!==V||W!==U){if(N!==V){let D=K.find((z)=>z.props.id===V);if(D)q.unshift(D)}J.layerId=N,J.index=W,J.info=null}}let H=pN($),F=new Map;return F.set(null,H),q.forEach((U)=>{let V={...H};if(U===Y)V.color=X,V.index=W,V.picked=!0;V=uN({layer:U,info:V,mode:Z});let N=V.layer;if(U===Y&&Z==="hover")J.info=V;if(F.set(N.id,V),Z==="hover")N.updateAutoHighlight(V)}),F}function uN({layer:$,info:Q,mode:J}){while($&&Q){let Z=Q.layer||null;Q.sourceLayer=Z,Q.layer=$,Q=$.getPickingInfo({info:Q,mode:J,sourceLayer:Z}),$=$.parent}return Q}function H91($,Q){for(let J=$.length-1;J>=0;J--){let Z=$[J];if(Z.containsPixel(Q))return Z}return $[0]}class jK{constructor($){this._pickable=!0,this.device=$,this.pickLayersPass=new Z3($),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps($){if("layerFilter"in $)this.layerFilter=$.layerFilter;if("_pickable"in $)this._pickable=$._pickable}finalize(){if(this.pickingFBO)this.pickingFBO.destroy();if(this.depthFBO)this.depthFBO.destroy()}pickObject($){return this._pickClosestObject($)}pickObjects($){return this._pickVisibleObjects($)}getLastPickedObject({x:$,y:Q,layers:J,viewports:Z},K=this.lastPickedInfo.info){let X=K&&K.layer&&K.layer.id,Y=K&&K.viewport&&K.viewport.id,W=X?J.find((U)=>U.id===X):null,q=Y&&Z.find((U)=>U.id===Y)||Z[0],H=q&&q.unproject([$-q.x,Q-q.y]);return{...K,...{x:$,y:Q,viewport:q,coordinate:H,layer:W}}}_resizeBuffer(){if(!this.pickingFBO){if(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float")){let Q=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=Q}}let{canvas:$}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:$.width,height:$.height}),this.depthFBO?.resize({width:$.width,height:$.height})}_getPickable($){if(this._pickable===!1)return null;let Q=$.filter((J)=>this.pickLayersPass.shouldDrawLayer(J)&&!J.isComposite);return Q.length?Q:null}_pickClosestObject({layers:$,views:Q,viewports:J,x:Z,y:K,radius:X=0,depth:Y=1,mode:W="query",unproject3D:q,onViewportActive:H,effects:F}){let U=this.device.canvasContext.cssToDeviceRatio(),V=this._getPickable($);if(!V||J.length===0)return{result:[],emptyInfo:pN({viewports:J,x:Z,y:K,pixelRatio:U})};this._resizeBuffer();let N=this.device.canvasContext.cssToDevicePixels([Z,K],!0),D=[N.x+Math.floor(N.width/2),N.y+Math.floor(N.height/2)],z=Math.round(X*U),{width:B,height:M}=this.pickingFBO,P=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:z,deviceWidth:B,deviceHeight:M}),O={x:Z-X,y:K-X,width:X*2+1,height:X*2+1},G,L=[],b=new Set;for(let d=0;d<Y;d++){let p;if(P){let l=this._drawAndSample({layers:V,views:Q,viewports:J,onViewportActive:H,deviceRect:P,cullRect:O,effects:F,pass:`picking:${W}`});p=p_({...l,deviceX:D[0],deviceY:D[1],deviceRadius:z,deviceRect:P})}else p={pickedColor:null,pickedObjectIndex:-1};let i;if(p.pickedLayer&&q&&this.depthFBO){let{pickedColors:l}=this._drawAndSample({layers:[p.pickedLayer],views:Q,viewports:J,onViewportActive:H,deviceRect:{x:p.pickedX,y:p.pickedY,width:1,height:1},cullRect:O,effects:F,pass:`picking:${W}:z`},!0);if(l[3])i=l[0]}if(p.pickedLayer&&d+1<Y)b.add(p.pickedLayer),p.pickedLayer.disablePickingIndex(p.pickedObjectIndex);G=n_({pickInfo:p,lastPickedInfo:this.lastPickedInfo,mode:W,layers:V,viewports:J,x:Z,y:K,z:i,pixelRatio:U});for(let l of G.values())if(l.layer)L.push(l);if(!p.pickedColor)break}for(let d of b)d.restorePickingColors();return{result:L,emptyInfo:G.get(null)}}_pickVisibleObjects({layers:$,views:Q,viewports:J,x:Z,y:K,width:X=1,height:Y=1,mode:W="query",maxObjects:q=null,onViewportActive:H,effects:F}){let U=this._getPickable($);if(!U||J.length===0)return[];this._resizeBuffer();let V=this.device.canvasContext.cssToDeviceRatio(),N=this.device.canvasContext.cssToDevicePixels([Z,K],!0),D=N.x,z=N.y+N.height,B=this.device.canvasContext.cssToDevicePixels([Z+X,K+Y],!0),M=B.x+B.width,P=B.y,O={x:D,y:P,width:M-D,height:z-P},G=this._drawAndSample({layers:U,views:Q,viewports:J,onViewportActive:H,deviceRect:O,cullRect:{x:Z,y:K,width:X,height:Y},effects:F,pass:`picking:${W}`}),L=u_(G),b=new Map,d=[],p=Number.isFinite(q);for(let i=0;i<L.length;i++){if(p&&d.length>=q)break;let l=L[i],N1={color:l.pickedColor,layer:null,index:l.pickedObjectIndex,picked:!0,x:Z,y:K,pixelRatio:V};N1=uN({layer:l.pickedLayer,info:N1,mode:W});let Y1=N1.layer.id;if(!b.has(Y1))b.set(Y1,new Set);let a=b.get(Y1),D1=N1.object??N1.index;if(!a.has(D1))a.add(D1),d.push(N1)}return d}_drawAndSample({layers:$,views:Q,viewports:J,onViewportActive:Z,deviceRect:K,cullRect:X,effects:Y,pass:W},q=!1){let H=q?this.depthFBO:this.pickingFBO,F={layers:$,layerFilter:this.layerFilter,views:Q,viewports:J,onViewportActive:Z,pickingFBO:H,deviceRect:K,cullRect:X,effects:Y,pass:W,pickZ:q,preRenderStats:{},isPicking:!0};for(let M of Y)if(M.useInPicking)F.preRenderStats[M.id]=M.preRender(F);let{decodePickingColor:U}=this.pickLayersPass.render(F),{x:V,y:N,width:D,height:z}=K,B=new(q?Float32Array:Uint8Array)(D*z*4);return this.device.readPixelsToArrayWebGL(H,{sourceX:V,sourceY:N,sourceWidth:D,sourceHeight:z,target:B}),{pickedColors:B,decodePickingColor:U}}_getPickingRect({deviceX:$,deviceY:Q,deviceRadius:J,deviceWidth:Z,deviceHeight:K}){let X=Math.max(0,$-J),Y=Math.max(0,Q-J),W=Math.min(Z,$+J+1)-X,q=Math.min(K,Q+J+1)-Y;if(W<=0||q<=0)return null;return{x:X,y:Y,width:W,height:q}}}var s_=C(()=>{bN();i_()});class iN{constructor({deck:$,parentElement:Q}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=$,this.parentElement=Q}getWidgets(){return this.resolvedWidgets}setProps($){if($.widgets&&!G0($.widgets,this.widgets,1))this._setWidgets($.widgets)}finalize(){for(let $ of this.getWidgets())this._remove($);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let $ in this.containers)this.containers[$].remove()}addDefault($){if(!this.defaultWidgets.find((Q)=>Q.id===$.id))this._add($),this.defaultWidgets.push($),this._setWidgets(this.widgets)}_setWidgets($){let Q={};for(let J of this.resolvedWidgets)Q[J.id]=J;this.resolvedWidgets.length=0;for(let J of this.defaultWidgets)Q[J.id]=null,this.resolvedWidgets.push(J);for(let J of $){let Z=Q[J.id];if(!Z)this._add(J);else if(Z.viewId!==J.viewId||Z.placement!==J.placement)this._remove(Z),this._add(J);else if(J!==Z)Z.setProps(J.props),J=Z;Q[J.id]=null,this.resolvedWidgets.push(J)}for(let J in Q){let Z=Q[J];if(Z)this._remove(Z)}this.widgets=$}_add($){let{viewId:Q=null,placement:J=U91}=$,Z=$.onAdd({deck:this.deck,viewId:Q});if(Z)this._getContainer(Q,J).append(Z);$._element=Z}_remove($){if($.onRemove?.(),$._element)$._element.remove();$._element=void 0}_getContainer($,Q){let J=$||o_,Z=this.containers[J];if(!Z)Z=document.createElement("div"),Z.style.pointerEvents="none",Z.style.position="absolute",Z.style.overflow="hidden",this.parentElement?.append(Z),this.containers[J]=Z;let K=Z.querySelector(`.${Q}`);if(!K)K=document.createElement("div"),K.className=Q,K.style.position="absolute",K.style.zIndex="2",Object.assign(K.style,F91[Q]),Z.append(K);return K}_updateContainers(){let $=this.deck.width,Q=this.deck.height;for(let J in this.containers){let Z=this.lastViewports[J]||null,K=J===o_||Z,X=this.containers[J];if(K)X.style.display="block",X.style.left=`${Z?Z.x:0}px`,X.style.top=`${Z?Z.y:0}px`,X.style.width=`${Z?Z.width:$}px`,X.style.height=`${Z?Z.height:Q}px`;else X.style.display="none"}}onRedraw({viewports:$,layers:Q}){let J=$.reduce((Z,K)=>{return Z[K.id]=K,Z},{});for(let Z of this.getWidgets()){let{viewId:K}=Z;if(K){let X=J[K];if(X){if(Z.onViewportChange)Z.onViewportChange(X);Z.onRedraw?.({viewports:[X],layers:Q})}}else{if(Z.onViewportChange)for(let X of $)Z.onViewportChange(X);Z.onRedraw?.({viewports:$,layers:Q})}}this.lastViewports=J,this._updateContainers()}onHover($,Q){for(let J of this.getWidgets()){let{viewId:Z}=J;if(!Z||Z===$.viewport?.id)J.onHover?.($,Q)}}onEvent($,Q){let J=H$[Q.type];if(!J)return;for(let Z of this.getWidgets()){let{viewId:K}=Z;if(!K||K===$.viewport?.id)Z[J]?.($,Q)}}}var F91,U91="top-left",o_="__root";var r_=C(()=>{Z6();F91={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}}});class hK{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:$}){let Q=document.createElement("div");return Q.className="deck-tooltip",Object.assign(Q.style,V91),this.deck=$,this.element=Q,Q}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange($){if(this.isVisible&&$.id===this.lastViewport?.id&&$!==this.lastViewport)this.setTooltip(null)}onHover($){let{deck:Q}=this,J=Q&&Q.props.getTooltip;if(!J)return;let Z=J($);this.lastViewport=$.viewport,this.setTooltip(Z,$.x,$.y)}setTooltip($,Q,J){let Z=this.element;if(!Z)return;if(typeof $==="string")Z.innerText=$;else if(!$){this.isVisible=!1,Z.style.display="none";return}else{if($.text)Z.innerText=$.text;if($.html)Z.innerHTML=$.html;if($.className)Z.className=$.className}if(this.isVisible=!0,Z.style.display="block",Z.style.transform=`translate(${Q}px, ${J}px)`,$&&typeof $==="object"&&"style"in $)Object.assign(Z.style,$.style)}}var V91;var a_=C(()=>{V91={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"}});var M7;var t_=C(()=>{(function($){$[$.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",$[$.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",$[$.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",$[$.POINTS=0]="POINTS",$[$.LINES=1]="LINES",$[$.LINE_LOOP=2]="LINE_LOOP",$[$.LINE_STRIP=3]="LINE_STRIP",$[$.TRIANGLES=4]="TRIANGLES",$[$.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",$[$.TRIANGLE_FAN=6]="TRIANGLE_FAN",$[$.ZERO=0]="ZERO",$[$.ONE=1]="ONE",$[$.SRC_COLOR=768]="SRC_COLOR",$[$.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",$[$.SRC_ALPHA=770]="SRC_ALPHA",$[$.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",$[$.DST_ALPHA=772]="DST_ALPHA",$[$.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",$[$.DST_COLOR=774]="DST_COLOR",$[$.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",$[$.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",$[$.CONSTANT_COLOR=32769]="CONSTANT_COLOR",$[$.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",$[$.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",$[$.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",$[$.FUNC_ADD=32774]="FUNC_ADD",$[$.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",$[$.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",$[$.BLEND_EQUATION=32777]="BLEND_EQUATION",$[$.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",$[$.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",$[$.BLEND_DST_RGB=32968]="BLEND_DST_RGB",$[$.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",$[$.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",$[$.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",$[$.BLEND_COLOR=32773]="BLEND_COLOR",$[$.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",$[$.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",$[$.LINE_WIDTH=2849]="LINE_WIDTH",$[$.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",$[$.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",$[$.CULL_FACE_MODE=2885]="CULL_FACE_MODE",$[$.FRONT_FACE=2886]="FRONT_FACE",$[$.DEPTH_RANGE=2928]="DEPTH_RANGE",$[$.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",$[$.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",$[$.DEPTH_FUNC=2932]="DEPTH_FUNC",$[$.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",$[$.STENCIL_FUNC=2962]="STENCIL_FUNC",$[$.STENCIL_FAIL=2964]="STENCIL_FAIL",$[$.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",$[$.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",$[$.STENCIL_REF=2967]="STENCIL_REF",$[$.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",$[$.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",$[$.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",$[$.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",$[$.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",$[$.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",$[$.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",$[$.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",$[$.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",$[$.VIEWPORT=2978]="VIEWPORT",$[$.SCISSOR_BOX=3088]="SCISSOR_BOX",$[$.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",$[$.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",$[$.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",$[$.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",$[$.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",$[$.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",$[$.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",$[$.RED_BITS=3410]="RED_BITS",$[$.GREEN_BITS=3411]="GREEN_BITS",$[$.BLUE_BITS=3412]="BLUE_BITS",$[$.ALPHA_BITS=3413]="ALPHA_BITS",$[$.DEPTH_BITS=3414]="DEPTH_BITS",$[$.STENCIL_BITS=3415]="STENCIL_BITS",$[$.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",$[$.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",$[$.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",$[$.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",$[$.SAMPLES=32937]="SAMPLES",$[$.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",$[$.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",$[$.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",$[$.VENDOR=7936]="VENDOR",$[$.RENDERER=7937]="RENDERER",$[$.VERSION=7938]="VERSION",$[$.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",$[$.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",$[$.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",$[$.STATIC_DRAW=35044]="STATIC_DRAW",$[$.STREAM_DRAW=35040]="STREAM_DRAW",$[$.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",$[$.ARRAY_BUFFER=34962]="ARRAY_BUFFER",$[$.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",$[$.BUFFER_SIZE=34660]="BUFFER_SIZE",$[$.BUFFER_USAGE=34661]="BUFFER_USAGE",$[$.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",$[$.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",$[$.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",$[$.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",$[$.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",$[$.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",$[$.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",$[$.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",$[$.CULL_FACE=2884]="CULL_FACE",$[$.FRONT=1028]="FRONT",$[$.BACK=1029]="BACK",$[$.FRONT_AND_BACK=1032]="FRONT_AND_BACK",$[$.BLEND=3042]="BLEND",$[$.DEPTH_TEST=2929]="DEPTH_TEST",$[$.DITHER=3024]="DITHER",$[$.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",$[$.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",$[$.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",$[$.SCISSOR_TEST=3089]="SCISSOR_TEST",$[$.STENCIL_TEST=2960]="STENCIL_TEST",$[$.NO_ERROR=0]="NO_ERROR",$[$.INVALID_ENUM=1280]="INVALID_ENUM",$[$.INVALID_VALUE=1281]="INVALID_VALUE",$[$.INVALID_OPERATION=1282]="INVALID_OPERATION",$[$.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",$[$.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",$[$.CW=2304]="CW",$[$.CCW=2305]="CCW",$[$.DONT_CARE=4352]="DONT_CARE",$[$.FASTEST=4353]="FASTEST",$[$.NICEST=4354]="NICEST",$[$.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",$[$.BYTE=5120]="BYTE",$[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.SHORT=5122]="SHORT",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.INT=5124]="INT",$[$.UNSIGNED_INT=5125]="UNSIGNED_INT",$[$.FLOAT=5126]="FLOAT",$[$.DOUBLE=5130]="DOUBLE",$[$.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",$[$.ALPHA=6406]="ALPHA",$[$.RGB=6407]="RGB",$[$.RGBA=6408]="RGBA",$[$.LUMINANCE=6409]="LUMINANCE",$[$.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",$[$.VERTEX_SHADER=35633]="VERTEX_SHADER",$[$.COMPILE_STATUS=35713]="COMPILE_STATUS",$[$.DELETE_STATUS=35712]="DELETE_STATUS",$[$.LINK_STATUS=35714]="LINK_STATUS",$[$.VALIDATE_STATUS=35715]="VALIDATE_STATUS",$[$.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",$[$.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",$[$.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",$[$.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",$[$.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",$[$.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",$[$.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",$[$.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",$[$.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",$[$.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",$[$.SHADER_TYPE=35663]="SHADER_TYPE",$[$.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",$[$.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",$[$.NEVER=512]="NEVER",$[$.LESS=513]="LESS",$[$.EQUAL=514]="EQUAL",$[$.LEQUAL=515]="LEQUAL",$[$.GREATER=516]="GREATER",$[$.NOTEQUAL=517]="NOTEQUAL",$[$.GEQUAL=518]="GEQUAL",$[$.ALWAYS=519]="ALWAYS",$[$.KEEP=7680]="KEEP",$[$.REPLACE=7681]="REPLACE",$[$.INCR=7682]="INCR",$[$.DECR=7683]="DECR",$[$.INVERT=5386]="INVERT",$[$.INCR_WRAP=34055]="INCR_WRAP",$[$.DECR_WRAP=34056]="DECR_WRAP",$[$.NEAREST=9728]="NEAREST",$[$.LINEAR=9729]="LINEAR",$[$.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",$[$.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",$[$.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",$[$.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",$[$.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",$[$.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",$[$.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",$[$.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",$[$.TEXTURE_2D=3553]="TEXTURE_2D",$[$.TEXTURE=5890]="TEXTURE",$[$.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",$[$.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",$[$.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",$[$.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",$[$.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",$[$.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",$[$.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",$[$.TEXTURE0=33984]="TEXTURE0",$[$.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",$[$.REPEAT=10497]="REPEAT",$[$.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",$[$.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",$[$.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",$[$.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",$[$.FLOAT_VEC2=35664]="FLOAT_VEC2",$[$.FLOAT_VEC3=35665]="FLOAT_VEC3",$[$.FLOAT_VEC4=35666]="FLOAT_VEC4",$[$.INT_VEC2=35667]="INT_VEC2",$[$.INT_VEC3=35668]="INT_VEC3",$[$.INT_VEC4=35669]="INT_VEC4",$[$.BOOL=35670]="BOOL",$[$.BOOL_VEC2=35671]="BOOL_VEC2",$[$.BOOL_VEC3=35672]="BOOL_VEC3",$[$.BOOL_VEC4=35673]="BOOL_VEC4",$[$.FLOAT_MAT2=35674]="FLOAT_MAT2",$[$.FLOAT_MAT3=35675]="FLOAT_MAT3",$[$.FLOAT_MAT4=35676]="FLOAT_MAT4",$[$.SAMPLER_2D=35678]="SAMPLER_2D",$[$.SAMPLER_CUBE=35680]="SAMPLER_CUBE",$[$.LOW_FLOAT=36336]="LOW_FLOAT",$[$.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",$[$.HIGH_FLOAT=36338]="HIGH_FLOAT",$[$.LOW_INT=36339]="LOW_INT",$[$.MEDIUM_INT=36340]="MEDIUM_INT",$[$.HIGH_INT=36341]="HIGH_INT",$[$.FRAMEBUFFER=36160]="FRAMEBUFFER",$[$.RENDERBUFFER=36161]="RENDERBUFFER",$[$.RGBA4=32854]="RGBA4",$[$.RGB5_A1=32855]="RGB5_A1",$[$.RGB565=36194]="RGB565",$[$.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",$[$.STENCIL_INDEX=6401]="STENCIL_INDEX",$[$.STENCIL_INDEX8=36168]="STENCIL_INDEX8",$[$.DEPTH_STENCIL=34041]="DEPTH_STENCIL",$[$.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",$[$.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",$[$.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",$[$.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",$[$.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",$[$.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",$[$.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",$[$.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",$[$.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",$[$.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",$[$.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",$[$.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",$[$.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",$[$.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",$[$.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",$[$.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",$[$.NONE=0]="NONE",$[$.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",$[$.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",$[$.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",$[$.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",$[$.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",$[$.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",$[$.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",$[$.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",$[$.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",$[$.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",$[$.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",$[$.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",$[$.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",$[$.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",$[$.READ_BUFFER=3074]="READ_BUFFER",$[$.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",$[$.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",$[$.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",$[$.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",$[$.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",$[$.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",$[$.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",$[$.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",$[$.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",$[$.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",$[$.MAX_ELEMENTS_VERTICES=33000]="MAX_ELEMENTS_VERTICES",$[$.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",$[$.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",$[$.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",$[$.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",$[$.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",$[$.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",$[$.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",$[$.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",$[$.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",$[$.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",$[$.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",$[$.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",$[$.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",$[$.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",$[$.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",$[$.RED=6403]="RED",$[$.RGB8=32849]="RGB8",$[$.RGBA8=32856]="RGBA8",$[$.RGB10_A2=32857]="RGB10_A2",$[$.TEXTURE_3D=32879]="TEXTURE_3D",$[$.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",$[$.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",$[$.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",$[$.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",$[$.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",$[$.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",$[$.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",$[$.SRGB=35904]="SRGB",$[$.SRGB8=35905]="SRGB8",$[$.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",$[$.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",$[$.RGBA32F=34836]="RGBA32F",$[$.RGB32F=34837]="RGB32F",$[$.RGBA16F=34842]="RGBA16F",$[$.RGB16F=34843]="RGB16F",$[$.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",$[$.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",$[$.R11F_G11F_B10F=35898]="R11F_G11F_B10F",$[$.RGB9_E5=35901]="RGB9_E5",$[$.RGBA32UI=36208]="RGBA32UI",$[$.RGB32UI=36209]="RGB32UI",$[$.RGBA16UI=36214]="RGBA16UI",$[$.RGB16UI=36215]="RGB16UI",$[$.RGBA8UI=36220]="RGBA8UI",$[$.RGB8UI=36221]="RGB8UI",$[$.RGBA32I=36226]="RGBA32I",$[$.RGB32I=36227]="RGB32I",$[$.RGBA16I=36232]="RGBA16I",$[$.RGB16I=36233]="RGB16I",$[$.RGBA8I=36238]="RGBA8I",$[$.RGB8I=36239]="RGB8I",$[$.RED_INTEGER=36244]="RED_INTEGER",$[$.RGB_INTEGER=36248]="RGB_INTEGER",$[$.RGBA_INTEGER=36249]="RGBA_INTEGER",$[$.R8=33321]="R8",$[$.RG8=33323]="RG8",$[$.R16F=33325]="R16F",$[$.R32F=33326]="R32F",$[$.RG16F=33327]="RG16F",$[$.RG32F=33328]="RG32F",$[$.R8I=33329]="R8I",$[$.R8UI=33330]="R8UI",$[$.R16I=33331]="R16I",$[$.R16UI=33332]="R16UI",$[$.R32I=33333]="R32I",$[$.R32UI=33334]="R32UI",$[$.RG8I=33335]="RG8I",$[$.RG8UI=33336]="RG8UI",$[$.RG16I=33337]="RG16I",$[$.RG16UI=33338]="RG16UI",$[$.RG32I=33339]="RG32I",$[$.RG32UI=33340]="RG32UI",$[$.R8_SNORM=36756]="R8_SNORM",$[$.RG8_SNORM=36757]="RG8_SNORM",$[$.RGB8_SNORM=36758]="RGB8_SNORM",$[$.RGBA8_SNORM=36759]="RGBA8_SNORM",$[$.RGB10_A2UI=36975]="RGB10_A2UI",$[$.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",$[$.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",$[$.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",$[$.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",$[$.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",$[$.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",$[$.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",$[$.HALF_FLOAT=5131]="HALF_FLOAT",$[$.RG=33319]="RG",$[$.RG_INTEGER=33320]="RG_INTEGER",$[$.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",$[$.CURRENT_QUERY=34917]="CURRENT_QUERY",$[$.QUERY_RESULT=34918]="QUERY_RESULT",$[$.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",$[$.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",$[$.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",$[$.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",$[$.DRAW_BUFFER0=34853]="DRAW_BUFFER0",$[$.DRAW_BUFFER1=34854]="DRAW_BUFFER1",$[$.DRAW_BUFFER2=34855]="DRAW_BUFFER2",$[$.DRAW_BUFFER3=34856]="DRAW_BUFFER3",$[$.DRAW_BUFFER4=34857]="DRAW_BUFFER4",$[$.DRAW_BUFFER5=34858]="DRAW_BUFFER5",$[$.DRAW_BUFFER6=34859]="DRAW_BUFFER6",$[$.DRAW_BUFFER7=34860]="DRAW_BUFFER7",$[$.DRAW_BUFFER8=34861]="DRAW_BUFFER8",$[$.DRAW_BUFFER9=34862]="DRAW_BUFFER9",$[$.DRAW_BUFFER10=34863]="DRAW_BUFFER10",$[$.DRAW_BUFFER11=34864]="DRAW_BUFFER11",$[$.DRAW_BUFFER12=34865]="DRAW_BUFFER12",$[$.DRAW_BUFFER13=34866]="DRAW_BUFFER13",$[$.DRAW_BUFFER14=34867]="DRAW_BUFFER14",$[$.DRAW_BUFFER15=34868]="DRAW_BUFFER15",$[$.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",$[$.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",$[$.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",$[$.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",$[$.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",$[$.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",$[$.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",$[$.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",$[$.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",$[$.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",$[$.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",$[$.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",$[$.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",$[$.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",$[$.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",$[$.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",$[$.SAMPLER_3D=35679]="SAMPLER_3D",$[$.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",$[$.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",$[$.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",$[$.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",$[$.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",$[$.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",$[$.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",$[$.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",$[$.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",$[$.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",$[$.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",$[$.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",$[$.MAX_SAMPLES=36183]="MAX_SAMPLES",$[$.SAMPLER_BINDING=35097]="SAMPLER_BINDING",$[$.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",$[$.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",$[$.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",$[$.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",$[$.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",$[$.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",$[$.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",$[$.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",$[$.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",$[$.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",$[$.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",$[$.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",$[$.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",$[$.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",$[$.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",$[$.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",$[$.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",$[$.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",$[$.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",$[$.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",$[$.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",$[$.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",$[$.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",$[$.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",$[$.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",$[$.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",$[$.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",$[$.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",$[$.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",$[$.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",$[$.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",$[$.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",$[$.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",$[$.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",$[$.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",$[$.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",$[$.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",$[$.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",$[$.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",$[$.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",$[$.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",$[$.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",$[$.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",$[$.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",$[$.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",$[$.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",$[$.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",$[$.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",$[$.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",$[$.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",$[$.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",$[$.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",$[$.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",$[$.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",$[$.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",$[$.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",$[$.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",$[$.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",$[$.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",$[$.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",$[$.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",$[$.UNIFORM_TYPE=35383]="UNIFORM_TYPE",$[$.UNIFORM_SIZE=35384]="UNIFORM_SIZE",$[$.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",$[$.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",$[$.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",$[$.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",$[$.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",$[$.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",$[$.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",$[$.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",$[$.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",$[$.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",$[$.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",$[$.OBJECT_TYPE=37138]="OBJECT_TYPE",$[$.SYNC_CONDITION=37139]="SYNC_CONDITION",$[$.SYNC_STATUS=37140]="SYNC_STATUS",$[$.SYNC_FLAGS=37141]="SYNC_FLAGS",$[$.SYNC_FENCE=37142]="SYNC_FENCE",$[$.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",$[$.UNSIGNALED=37144]="UNSIGNALED",$[$.SIGNALED=37145]="SIGNALED",$[$.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",$[$.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",$[$.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",$[$.WAIT_FAILED=37149]="WAIT_FAILED",$[$.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",$[$.COLOR=6144]="COLOR",$[$.DEPTH=6145]="DEPTH",$[$.STENCIL=6146]="STENCIL",$[$.MIN=32775]="MIN",$[$.MAX=32776]="MAX",$[$.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",$[$.STREAM_READ=35041]="STREAM_READ",$[$.STREAM_COPY=35042]="STREAM_COPY",$[$.STATIC_READ=35045]="STATIC_READ",$[$.STATIC_COPY=35046]="STATIC_COPY",$[$.DYNAMIC_READ=35049]="DYNAMIC_READ",$[$.DYNAMIC_COPY=35050]="DYNAMIC_COPY",$[$.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",$[$.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",$[$.INVALID_INDEX=4294967295]="INVALID_INDEX",$[$.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",$[$.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",$[$.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",$[$.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",$[$.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",$[$.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",$[$.R16_EXT=33322]="R16_EXT",$[$.RG16_EXT=33324]="RG16_EXT",$[$.RGB16_EXT=32852]="RGB16_EXT",$[$.RGBA16_EXT=32859]="RGBA16_EXT",$[$.R16_SNORM_EXT=36760]="R16_SNORM_EXT",$[$.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",$[$.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",$[$.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",$[$.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",$[$.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",$[$.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",$[$.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",$[$.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",$[$.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",$[$.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",$[$.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",$[$.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",$[$.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",$[$.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",$[$.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",$[$.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",$[$.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",$[$.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",$[$.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",$[$.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",$[$.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",$[$.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",$[$.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",$[$.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",$[$.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",$[$.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",$[$.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",$[$.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",$[$.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",$[$.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",$[$.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",$[$.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",$[$.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",$[$.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",$[$.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",$[$.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",$[$.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",$[$.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",$[$.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",$[$.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",$[$.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",$[$.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",$[$.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",$[$.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",$[$.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",$[$.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",$[$.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",$[$.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",$[$.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",$[$.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",$[$.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",$[$.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",$[$.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",$[$.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",$[$.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",$[$.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",$[$.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",$[$.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",$[$.LINE_WEBGL=6913]="LINE_WEBGL",$[$.FILL_WEBGL=6914]="FILL_WEBGL",$[$.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",$[$.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",$[$.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",$[$.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",$[$.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",$[$.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",$[$.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",$[$.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",$[$.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",$[$.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",$[$.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",$[$.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",$[$.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",$[$.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",$[$.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",$[$.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",$[$.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",$[$.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",$[$.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",$[$.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",$[$.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",$[$.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",$[$.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",$[$.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(M7||(M7={}))});var e_=C(()=>{t_()});function nN($){return Array.isArray($)||ArrayBuffer.isView($)&&!($ instanceof DataView)}function W0($,Q,J){return Q[$]!==void 0?Q[$]:J[$]}var O$,D0=($,Q,J)=>Q?$.enable(J):$.disable(J),$x=($,Q,J)=>$.hint(J,Q),D5=($,Q,J)=>$.pixelStorei(J,Q),Qx=($,Q,J)=>{let Z=J===36006?36009:36008;return $.bindFramebuffer(Z,Q)},R$=($,Q,J)=>{let K={[34964]:34962,[36662]:36662,[36663]:36663,[35053]:35051,[35055]:35052}[J];$.bindBuffer(K,Q)},Jx,Zx,sN,m6=($,Q)=>$.isEnabled(Q),oN,Kx;var rN=C(()=>{O$={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[35725]:null,[36006]:null,[36007]:null,[34229]:null,[34964]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32926]:!1,[32928]:!1,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[36389]:null,[36662]:null,[36663]:null,[35053]:null,[35055]:null,[35723]:4352,[36010]:null,[35977]:!1,[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0};Jx={[3042]:D0,[32773]:($,Q)=>$.blendColor(...Q),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:($,Q)=>$.clearColor(...Q),[3107]:($,Q)=>$.colorMask(...Q),[2884]:D0,[2885]:($,Q)=>$.cullFace(Q),[2929]:D0,[2931]:($,Q)=>$.clearDepth(Q),[2932]:($,Q)=>$.depthFunc(Q),[2928]:($,Q)=>$.depthRange(...Q),[2930]:($,Q)=>$.depthMask(Q),[3024]:D0,[35723]:$x,[35725]:($,Q)=>$.useProgram(Q),[36007]:($,Q)=>$.bindRenderbuffer(36161,Q),[36389]:($,Q)=>$.bindTransformFeedback?.(36386,Q),[34229]:($,Q)=>$.bindVertexArray(Q),[36006]:Qx,[36010]:Qx,[34964]:R$,[36662]:R$,[36663]:R$,[35053]:R$,[35055]:R$,[2886]:($,Q)=>$.frontFace(Q),[33170]:$x,[2849]:($,Q)=>$.lineWidth(Q),[32823]:D0,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:D0,[32926]:D0,[32928]:D0,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:D0,[3088]:($,Q)=>$.scissor(...Q),[2960]:D0,[2961]:($,Q)=>$.clearStencil(Q),[2968]:($,Q)=>$.stencilMaskSeparate(1028,Q),[36005]:($,Q)=>$.stencilMaskSeparate(1029,Q),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:($,Q)=>$.viewport(...Q),[34383]:D0,[10754]:D0,[12288]:D0,[12289]:D0,[12290]:D0,[12291]:D0,[12292]:D0,[12293]:D0,[12294]:D0,[12295]:D0,[3333]:D5,[3317]:D5,[37440]:D5,[37441]:D5,[37443]:D5,[3330]:D5,[3332]:D5,[3331]:D5,[3314]:D5,[32878]:D5,[3316]:D5,[3315]:D5,[32877]:D5,framebuffer:($,Q)=>{let J=Q&&"handle"in Q?Q.handle:Q;return $.bindFramebuffer(36160,J)},blend:($,Q)=>Q?$.enable(3042):$.disable(3042),blendColor:($,Q)=>$.blendColor(...Q),blendEquation:($,Q)=>{let J=typeof Q==="number"?[Q,Q]:Q;$.blendEquationSeparate(...J)},blendFunc:($,Q)=>{let J=Q?.length===2?[...Q,...Q]:Q;$.blendFuncSeparate(...J)},clearColor:($,Q)=>$.clearColor(...Q),clearDepth:($,Q)=>$.clearDepth(Q),clearStencil:($,Q)=>$.clearStencil(Q),colorMask:($,Q)=>$.colorMask(...Q),cull:($,Q)=>Q?$.enable(2884):$.disable(2884),cullFace:($,Q)=>$.cullFace(Q),depthTest:($,Q)=>Q?$.enable(2929):$.disable(2929),depthFunc:($,Q)=>$.depthFunc(Q),depthMask:($,Q)=>$.depthMask(Q),depthRange:($,Q)=>$.depthRange(...Q),dither:($,Q)=>Q?$.enable(3024):$.disable(3024),derivativeHint:($,Q)=>{$.hint(35723,Q)},frontFace:($,Q)=>$.frontFace(Q),mipmapHint:($,Q)=>$.hint(33170,Q),lineWidth:($,Q)=>$.lineWidth(Q),polygonOffsetFill:($,Q)=>Q?$.enable(32823):$.disable(32823),polygonOffset:($,Q)=>$.polygonOffset(...Q),sampleCoverage:($,Q)=>$.sampleCoverage(Q[0],Q[1]||!1),scissorTest:($,Q)=>Q?$.enable(3089):$.disable(3089),scissor:($,Q)=>$.scissor(...Q),stencilTest:($,Q)=>Q?$.enable(2960):$.disable(2960),stencilMask:($,Q)=>{Q=nN(Q)?Q:[Q,Q];let[J,Z]=Q;$.stencilMaskSeparate(1028,J),$.stencilMaskSeparate(1029,Z)},stencilFunc:($,Q)=>{Q=nN(Q)&&Q.length===3?[...Q,...Q]:Q;let[J,Z,K,X,Y,W]=Q;$.stencilFuncSeparate(1028,J,Z,K),$.stencilFuncSeparate(1029,X,Y,W)},stencilOp:($,Q)=>{Q=nN(Q)&&Q.length===3?[...Q,...Q]:Q;let[J,Z,K,X,Y,W]=Q;$.stencilOpSeparate(1028,J,Z,K),$.stencilOpSeparate(1029,X,Y,W)},viewport:($,Q)=>$.viewport(...Q)};Zx={blendEquation:($,Q,J)=>$.blendEquationSeparate(W0(32777,Q,J),W0(34877,Q,J)),blendFunc:($,Q,J)=>$.blendFuncSeparate(W0(32969,Q,J),W0(32968,Q,J),W0(32971,Q,J),W0(32970,Q,J)),polygonOffset:($,Q,J)=>$.polygonOffset(W0(32824,Q,J),W0(10752,Q,J)),sampleCoverage:($,Q,J)=>$.sampleCoverage(W0(32938,Q,J),W0(32939,Q,J)),stencilFuncFront:($,Q,J)=>$.stencilFuncSeparate(1028,W0(2962,Q,J),W0(2967,Q,J),W0(2963,Q,J)),stencilFuncBack:($,Q,J)=>$.stencilFuncSeparate(1029,W0(34816,Q,J),W0(36003,Q,J),W0(36004,Q,J)),stencilOpFront:($,Q,J)=>$.stencilOpSeparate(1028,W0(2964,Q,J),W0(2965,Q,J),W0(2966,Q,J)),stencilOpBack:($,Q,J)=>$.stencilOpSeparate(1029,W0(34817,Q,J),W0(34818,Q,J),W0(34819,Q,J))},sN={enable:($,Q)=>$({[Q]:!0}),disable:($,Q)=>$({[Q]:!1}),pixelStorei:($,Q,J)=>$({[Q]:J}),hint:($,Q,J)=>$({[Q]:J}),useProgram:($,Q)=>$({[35725]:Q}),bindRenderbuffer:($,Q,J)=>$({[36007]:J}),bindTransformFeedback:($,Q,J)=>$({[36389]:J}),bindVertexArray:($,Q)=>$({[34229]:Q}),bindFramebuffer:($,Q,J)=>{switch(Q){case 36160:return $({[36006]:J,[36010]:J});case 36009:return $({[36006]:J});case 36008:return $({[36010]:J});default:return null}},bindBuffer:($,Q,J)=>{let Z={[34962]:[34964],[36662]:[36662],[36663]:[36663],[35051]:[35053],[35052]:[35055]}[Q];if(Z)return $({[Z]:J});return{valueChanged:!0}},blendColor:($,Q,J,Z,K)=>$({[32773]:new Float32Array([Q,J,Z,K])}),blendEquation:($,Q)=>$({[32777]:Q,[34877]:Q}),blendEquationSeparate:($,Q,J)=>$({[32777]:Q,[34877]:J}),blendFunc:($,Q,J)=>$({[32969]:Q,[32968]:J,[32971]:Q,[32970]:J}),blendFuncSeparate:($,Q,J,Z,K)=>$({[32969]:Q,[32968]:J,[32971]:Z,[32970]:K}),clearColor:($,Q,J,Z,K)=>$({[3106]:new Float32Array([Q,J,Z,K])}),clearDepth:($,Q)=>$({[2931]:Q}),clearStencil:($,Q)=>$({[2961]:Q}),colorMask:($,Q,J,Z,K)=>$({[3107]:[Q,J,Z,K]}),cullFace:($,Q)=>$({[2885]:Q}),depthFunc:($,Q)=>$({[2932]:Q}),depthRange:($,Q,J)=>$({[2928]:new Float32Array([Q,J])}),depthMask:($,Q)=>$({[2930]:Q}),frontFace:($,Q)=>$({[2886]:Q}),lineWidth:($,Q)=>$({[2849]:Q}),polygonOffset:($,Q,J)=>$({[32824]:Q,[10752]:J}),sampleCoverage:($,Q,J)=>$({[32938]:Q,[32939]:J}),scissor:($,Q,J,Z,K)=>$({[3088]:new Int32Array([Q,J,Z,K])}),stencilMask:($,Q)=>$({[2968]:Q,[36005]:Q}),stencilMaskSeparate:($,Q,J)=>$({[Q===1028?2968:36005]:J}),stencilFunc:($,Q,J,Z)=>$({[2962]:Q,[2967]:J,[2963]:Z,[34816]:Q,[36003]:J,[36004]:Z}),stencilFuncSeparate:($,Q,J,Z,K)=>$({[Q===1028?2962:34816]:J,[Q===1028?2967:36003]:Z,[Q===1028?2963:36004]:K}),stencilOp:($,Q,J,Z)=>$({[2964]:Q,[2965]:J,[2966]:Z,[34817]:Q,[34818]:J,[34819]:Z}),stencilOpSeparate:($,Q,J,Z,K)=>$({[Q===1028?2964:34817]:J,[Q===1028?2965:34818]:Z,[Q===1028?2966:34819]:K}),viewport:($,Q,J,Z,K)=>$({[2978]:[Q,J,Z,K]})},oN={[3042]:m6,[2884]:m6,[2929]:m6,[3024]:m6,[32823]:m6,[32926]:m6,[32928]:m6,[3089]:m6,[2960]:m6,[35977]:m6},Kx=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068])});function q6($,Q){if(N91(Q))return;let J={};for(let K in Q){let X=Number(K),Y=Jx[K];if(Y)if(typeof Y==="string")J[Y]=!0;else Y($,Q[K],X)}let Z=$.state&&$.state.cache;if(Z)for(let K in J){let X=Zx[K];X($,Q,Z)}}function LK($,Q=O$){if(typeof Q==="number"){let K=Q,X=oN[K];return X?X($,K):$.getParameter(K)}let J=Array.isArray(Q)?Q:Object.keys(Q),Z={};for(let K of J){let X=oN[K];Z[K]=X?X($,Number(K)):$.getParameter(Number(K))}return Z}function Xx($){q6($,O$)}function N91($){for(let Q in $)return!1;return!0}var W3=C(()=>{rN()});function Yx($,Q){if($===Q)return!0;let J=Array.isArray($)||ArrayBuffer.isView($),Z=Array.isArray(Q)||ArrayBuffer.isView(Q);if(J&&Z&&$.length===Q.length){for(let K=0;K<$.length;++K)if($[K]!==Q[K])return!1;return!0}return!1}class c6{static get($){return $.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor($,Q){this.gl=$,this.log=Q?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push($={}){this.stateStack.push({})}pop(){let $=this.stateStack[this.stateStack.length-1];q6(this.gl,$),this.stateStack.pop()}trackState($,Q){if(this.cache=Q.copyState?LK($):Object.assign({},O$),this.initialized)throw Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,C91($);for(let J in sN){let Z=sN[J];D91($,J,Z)}Wx($,"getParameter"),Wx($,"isEnabled")}_updateCache($){let Q=!1,J,Z=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let K in $){let X=$[K],Y=this.cache[K];if(!Yx(X,Y)){if(Q=!0,J=Y,Z&&!(K in Z))Z[K]=Y;this.cache[K]=X}}return{valueChanged:Q,oldValue:J}}}function Wx($,Q){let J=$[Q].bind($);$[Q]=function(K){if(K===void 0||Kx.has(K))return J(K);let X=c6.get($);if(!(K in X.cache))X.cache[K]=J(K);return X.enable?X.cache[K]:J(K)},Object.defineProperty($[Q],"name",{value:`${Q}-from-cache`,configurable:!1})}function D91($,Q,J){if(!$[Q])return;let Z=$[Q].bind($);$[Q]=function(...X){let Y=c6.get($),{valueChanged:W,oldValue:q}=J(Y._updateCache,...X);if(W)Z(...X);return q},Object.defineProperty($[Q],"name",{value:`${Q}-to-cache`,configurable:!1})}function C91($){let Q=$.useProgram.bind($);$.useProgram=function(Z){let K=c6.get($);if(K.program!==Z)Q(Z),K.program=Z}}var aN=C(()=>{W3();rN()});function qx($,Q,J){let Z="",K={preserveDrawingBuffer:!0,...J},X=null;if(X||=$.getContext("webgl2",K),K.failIfMajorPerformanceCaveat)Z||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.";if(!X&&!J.failIfMajorPerformanceCaveat)K.failIfMajorPerformanceCaveat=!1,X=$.getContext("webgl2",K),X.luma||={},X.luma.softwareRenderer=!0;if(!X){if(X=$.getContext("webgl",{}),X)X=null,Z||="Your browser only supports WebGL1"}if(!X)throw Z||="Your browser does not support WebGL",Error(`Failed to create WebGL context: ${Z}`);let{onContextLost:Y,onContextRestored:W}=Q;return $.addEventListener("webglcontextlost",(q)=>Y(q),!1),$.addEventListener("webglcontextrestored",(q)=>W(q),!1),X.luma||={},X}function d6($,Q,J){if(J[Q]===void 0)J[Q]=$.getExtension(Q)||null;return J[Q]}function Hx($,Q){let J=$.getParameter(7936),Z=$.getParameter(7937);d6($,"WEBGL_debug_renderer_info",Q);let K=Q.WEBGL_debug_renderer_info,X=$.getParameter(K?K.UNMASKED_VENDOR_WEBGL:7936),Y=$.getParameter(K?K.UNMASKED_RENDERER_WEBGL:7937),W=X||J,q=Y||Z,H=$.getParameter(7938),F=Fx(W,q),U=A91(W,q),V=z91(W,q);return{type:"webgl",gpu:F,gpuType:V,gpuBackend:U,vendor:W,renderer:q,version:H,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Fx($,Q){if(/NVIDIA/i.exec($)||/NVIDIA/i.exec(Q))return"nvidia";if(/INTEL/i.exec($)||/INTEL/i.exec(Q))return"intel";if(/Apple/i.exec($)||/Apple/i.exec(Q))return"apple";if(/AMD/i.exec($)||/AMD/i.exec(Q)||/ATI/i.exec($)||/ATI/i.exec(Q))return"amd";if(/SwiftShader/i.exec($)||/SwiftShader/i.exec(Q))return"software";return"unknown"}function A91($,Q){if(/Metal/i.exec($)||/Metal/i.exec(Q))return"metal";if(/ANGLE/i.exec($)||/ANGLE/i.exec(Q))return"opengl";return"unknown"}function z91($,Q){if(/SwiftShader/i.exec($)||/SwiftShader/i.exec(Q))return"cpu";switch(Fx($,Q)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}var Ux=()=>{};function vK($){switch($){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw Error(String($))}var tN=()=>{};function Dx($){return $ in _K}function Cx($,Q,J){return(_K[Q]||[]).every((K)=>d6($,K,J))}function Ax($,Q,J){let Z=Q.create,K=eN[Q.format];if(K?.gl===void 0)Z=!1;if(K?.x)Z=Z&&Boolean(d6($,K.x,J));return{format:Q.format,create:Z&&Q.create,render:Z&&Q.render,filter:Z&&Q.filter,blend:Z&&Q.blend,store:Z&&Q.store}}function xK($){let Q=eN[$],J=S91($),Z=h9($);return{internalFormat:J,format:Q?.dataFormat||w91(Z.channels,Z.integer,Z.normalized,J),type:Z.dataType?vK(Z.dataType):Q?.types?.[0]||5121,compressed:Z.compressed||!1}}function zx($){switch(h9($).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw Error(`Not a depth stencil format: ${$}`)}}function w91($,Q,J,Z){if(Z===6408||Z===6407)return Z;switch($){case"r":return Q&&!J?36244:6403;case"rg":return Q&&!J?33320:33319;case"rgb":return Q&&!J?36248:6407;case"rgba":return Q&&!J?36249:6408;case"bgra":throw Error("bgra pixels not supported by WebGL");default:return 6408}}function S91($){let J=eN[$]?.gl;if(J===void 0)throw Error(`Unsupported texture format ${$}`);return J}var P$="WEBGL_compressed_texture_s3tc",M$="WEBGL_compressed_texture_s3tc_srgb",q3="EXT_texture_compression_rgtc",H3="EXT_texture_compression_bptc",k91="WEBGL_compressed_texture_etc",B91="WEBGL_compressed_texture_astc",R91="WEBGL_compressed_texture_etc1",O91="WEBGL_compressed_texture_pvrtc",P91="WEBGL_compressed_texture_atc",Vx="EXT_texture_norm16",Nx="EXT_render_snorm",M91="EXT_color_buffer_float",_K,eN;var F3=C(()=>{O1();tN();_K={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Nx],"norm16-renderable-webgl":[Vx],"snorm16-renderable-webgl":[Vx,Nx],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[P$,M$,q3,H3],"texture-compression-bc5-webgl":[q3],"texture-compression-bc7-webgl":[H3],"texture-compression-etc2":[k91],"texture-compression-astc":[B91],"texture-compression-etc1-webgl":[R91],"texture-compression-pvrtc-webgl":[O91],"texture-compression-atc-webgl":[P91]};eN={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:M91,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:P$},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:M$},"bc1-rgba-unorm":{gl:33777,x:P$},"bc1-rgba-unorm-srgb":{gl:35916,x:M$},"bc2-rgba-unorm":{gl:33778,x:P$},"bc2-rgba-unorm-srgb":{gl:35918,x:M$},"bc3-rgba-unorm":{gl:33779,x:P$},"bc3-rgba-unorm-srgb":{gl:35919,x:M$},"bc4-r-unorm":{gl:36283,x:q3},"bc4-r-snorm":{gl:36284,x:q3},"bc5-rg-unorm":{gl:36285,x:q3},"bc5-rg-snorm":{gl:36286,x:q3},"bc6h-rgb-ufloat":{gl:36495,x:H3},"bc6h-rgb-float":{gl:36494,x:H3},"bc7-rgba-unorm":{gl:36492,x:H3},"bc7-rgba-unorm-srgb":{gl:36493,x:H3},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}}});var kx,$D;var Bx=C(()=>{O1();F3();kx={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};$D=class $D extends NZ{gl;extensions;testedFeatures=new Set;constructor($,Q,J){super([],J);this.gl=$,this.extensions=Q,d6($,"EXT_color_buffer_float",Q)}*[Symbol.iterator](){let $=this.getFeatures();for(let Q of $)if(this.has(Q))yield Q;return[]}has($){if(this.disabledFeatures?.[$])return!1;if(!this.testedFeatures.has($)){if(this.testedFeatures.add($),Dx($)&&Cx(this.gl,$,this.extensions))this.features.add($);if(this.getWebGLFeature($))this.features.add($)}return this.features.has($)}initializeFeatures(){let $=this.getFeatures().filter((Q)=>Q!=="polygon-mode-webgl");for(let Q of $)this.has(Q)}getFeatures(){return[...Object.keys(kx),...Object.keys(_K)]}getWebGLFeature($){let Q=kx[$];return typeof Q==="string"?Boolean(d6(this.gl,Q,this.extensions)):Boolean(Q)}}});var QD;var Rx=C(()=>{O1();QD=class QD extends VZ{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor($){super();this.gl=$}getParameter($){if(this.limits[$]===void 0)this.limits[$]=this.gl.getParameter($);return this.limits[$]||0}}});function T91($){return $<34069?$+34069:$}function I91($){switch($){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${$}`}}var R4;var gK=C(()=>{O1();F3();R4=class R4 extends A8{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor($,Q){super($,Q);let J=Q.handle===null;if(this.device=$,this.gl=$.gl,this.handle=this.props.handle||J?this.props.handle:this.gl.createFramebuffer(),!J)$.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments()}destroy(){if(super.destroy(),!this.destroyed&&this.handle!==null)this.gl.deleteFramebuffer(this.handle)}updateAttachments(){let $=this.gl.bindFramebuffer(36160,this.handle);for(let Q=0;Q<this.colorAttachments.length;++Q){let J=this.colorAttachments[Q];if(J){let Z=36064+Q;this._attachTextureView(Z,J)}}if(this.depthStencilAttachment){let Q=zx(this.depthStencilAttachment.props.format);this._attachTextureView(Q,this.depthStencilAttachment)}if(this.device.props.debug){let Q=this.gl.checkFramebufferStatus(36160);if(Q!==36053)throw Error(`Framebuffer ${I91(Q)}`)}this.gl.bindFramebuffer(36160,$)}_attachTextureView($,Q){let{gl:J}=this.device,{texture:Z}=Q,K=Q.props.baseMipLevel,X=Q.props.baseArrayLayer;switch(J.bindTexture(Z.glTarget,Z.handle),Z.glTarget){case 35866:case 32879:J.framebufferTextureLayer(36160,$,Z.handle,K,X);break;case 34067:let Y=T91(X);J.framebufferTexture2D(36160,$,Y,Z.handle,K);break;case 3553:J.framebufferTexture2D(36160,$,3553,Z.handle,K);break;default:throw Error("Illegal texture type")}J.bindTexture(Z.glTarget,null)}}});var JD;var Ox=C(()=>{O1();gK();JD=class JD extends x2{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor($,Q){super(Q);this.device=$,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new R4(this.device,{handle:null}),this._framebuffer}update(){let $=this.getPixelSize();if($[0]!==this.presentationSize[0]||$[1]!==this.presentationSize[1])this.presentationSize=$,this.resize()}resize($){if(!this.device.gl)return;if(this.canvas){let Q=this.getDevicePixelRatio($?.useDevicePixels);this.setDevicePixelRatio(Q,$);return}}commit(){}}});async function yK($,Q){let J=document.getElementsByTagName("head")[0];if(!J)throw Error("loadScript");let Z=document.createElement("script");if(Z.setAttribute("type","text/javascript"),Z.setAttribute("src",$),Q)Z.id=Q;return new Promise((K,X)=>{Z.onload=K,Z.onerror=(Y)=>X(Error(`Unable to load script '${$}': ${Y}`)),J.appendChild(Z)})}async function Mx($){if(!globalThis.SPECTOR)try{await yK($.debugSpectorJSUrl||fK.debugSpectorJSUrl)}catch(Q){f.warn(String(Q))}}function wx($){if($={...fK,...$},!$.debugSpectorJS)return null;if(!C5&&globalThis.SPECTOR&&!globalThis.luma?.spector){f.probe(G91,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();let{Spector:Q}=globalThis.SPECTOR;if(C5=new Q,globalThis.luma)globalThis.luma.spector=C5}if(!C5)return null;if(!Px)Px=!0,C5.spyCanvases(),C5?.onCaptureStarted.add((Q)=>f.info("Spector capture started:",Q)()),C5?.onCapture.add((Q)=>{f.info("Spector capture complete:",Q)(),C5?.getResultUI(),C5?.resultView.display(),C5?.resultView.addCapture(Q)});if($.gl){let Q=$.gl,J=Q.device;C5?.startCapture($.gl,500),Q.device=J,new Promise((Z)=>setTimeout(Z,2000)).then((Z)=>{f.info("Spector capture stopped after 2 seconds")(),C5?.stopCapture()})}return C5}var G91=1,C5=null,Px=!1,fK;var ZD=C(()=>{O1();fK={debugSpectorJS:f.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0}});function Tx($){return $.luma=$.luma||{},$.luma}async function Ix(){if(d0()&&!globalThis.WebGLDebugUtils)globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await yK(E91)}function Gx($,Q={}){return Q.debugWebGL||Q.traceWebGL?h91($,Q):j91($)}function j91($){let Q=Tx($);return Q.realContext?Q.realContext:$}function h91($,Q){if(!globalThis.WebGLDebugUtils)return f.warn("webgl-debug not loaded")(),$;let J=Tx($);if(J.debugContext)return J.debugContext;globalThis.WebGLDebugUtils.init({...M7,...$});let Z=globalThis.WebGLDebugUtils.makeDebugContext($,L91.bind(null,Q),v91.bind(null,Q));for(let Y in M7)if(!(Y in Z)&&typeof M7[Y]==="number")Z[Y]=M7[Y];class K{}Object.setPrototypeOf(Z,Object.getPrototypeOf($)),Object.setPrototypeOf(K,Z);let X=Object.create(K);return J.realContext=$,J.debugContext=X,X.debug=!0,X}function Sx($,Q){Q=Array.from(Q).map((Z)=>Z===void 0?"undefined":Z);let J=globalThis.WebGLDebugUtils.glFunctionArgsToString($,Q);return J=`${J.slice(0,100)}${J.length>100?"...":""}`,`gl.${$}(${J})`}function L91($,Q,J,Z){Z=Array.from(Z).map((W)=>W===void 0?"undefined":W);let K=globalThis.WebGLDebugUtils.glEnumToString(Q),X=globalThis.WebGLDebugUtils.glFunctionArgsToString(J,Z),Y=`${K} in gl.${J}(${X})`;f.error(Y)();debugger}function v91($,Q,J){let Z="";if(f.level>=1){if(Z=Sx(Q,J),$.traceWebGL)f.log(1,Z)()}for(let K of J)if(K===void 0){Z=Z||Sx(Q,J);debugger}}var E91="https://unpkg.com/webgl-debug@2.0.1/index.js";var KD=C(()=>{O1();e_();W7()});function Ex($="id"){XD[$]=XD[$]||1;let Q=XD[$]++;return`${$}-${Q}`}var XD;var jx=C(()=>{XD={}});function _91($){if($&M1.INDEX)return 34963;if($&M1.VERTEX)return 34962;if($&M1.UNIFORM)return 35345;return 34962}function x91($){if($&M1.INDEX)return 35044;if($&M1.VERTEX)return 35044;if($&M1.UNIFORM)return 35048;return 35044}var l6;var bK=C(()=>{O1();l6=class l6 extends M1{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor($,Q={}){super($,Q);this.device=$,this.gl=this.device.gl;let J=typeof Q==="object"?Q.handle:void 0;if(this.handle=J||this.gl.createBuffer(),$.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=_91(this.props.usage),this.glUsage=x91(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,Q.data)this._initWithData(Q.data,Q.byteOffset,Q.byteLength);else this._initWithByteLength(Q.byteLength||0)}_initWithData($,Q=0,J=$.byteLength+Q){let Z=this.glTarget;this.gl.bindBuffer(Z,this.handle),this.gl.bufferData(Z,J,this.glUsage),this.gl.bufferSubData(Z,Q,$),this.gl.bindBuffer(Z,null),this.bytesUsed=J,this.byteLength=J,this._setDebugData($,Q,J),this.trackAllocatedMemory(J)}_initWithByteLength($){let Q=$;if($===0)Q=new Float32Array(0);let J=this.glTarget;return this.gl.bindBuffer(J,this.handle),this.gl.bufferData(J,Q,this.glUsage),this.gl.bindBuffer(J,null),this.bytesUsed=$,this.byteLength=$,this._setDebugData(null,0,$),this.trackAllocatedMemory($),this}destroy(){if(!this.destroyed&&this.handle)this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null}write($,Q=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,Q,$),this.gl.bindBuffer(36663,null),this._setDebugData($,Q,$.byteLength)}async readAsync($=0,Q){return this.readSyncWebGL($,Q)}readSyncWebGL($=0,Q){Q=Q??this.byteLength-$;let J=new Uint8Array(Q),Z=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,$,J,Z,Q),this.gl.bindBuffer(36662,null),this._setDebugData(J,$,Q),J}}});function Lx($){let Q=$.split(/\r?\n/),J=[];for(let Z of Q){if(Z.length<=1)continue;let K=Z.split(":");if(K.length===2){let[U,V]=K;J.push({message:V.trim(),type:hx(U),lineNum:0,linePos:0});continue}let[X,Y,W,...q]=K,H=parseInt(W,10);if(isNaN(H))H=0;let F=parseInt(Y,10);if(isNaN(F))F=0;J.push({message:q.join(":").trim(),type:hx(X),lineNum:H,linePos:F})}return J}function hx($){let Q=["warning","error","info"],J=$.toLowerCase();return Q.includes(J)?J:"info"}var YD;var vx=C(()=>{O1();YD=class YD extends C8{device;handle;constructor($,Q){super($,Q);switch(this.device=$,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw Error(this.props.stage)}this._compile(this.source)}destroy(){if(this.handle)this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let $=this.device.gl.getShaderInfoLog(this.handle);return $?Lx($):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile($){$=$.startsWith("#version ")?$:`#version 300 es
${$}`;let{gl:Q}=this.device;if(Q.shaderSource(this.handle,$),Q.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}f.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),f.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let $=async(Z)=>await new Promise((K)=>setTimeout(K,Z)),Q=10;if(!this.device.features.has("compilation-status-async-webgl")){await $(10);return}let{gl:J}=this.device;for(;;){if(J.getShaderParameter(this.handle,37297))return;await $(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}});function xx($,Q,J,Z){if(b91(Q))return Z($);let K=$;K.pushState();try{return g91($,Q),q6(K.gl,J),Z($)}finally{K.popState()}}function g91($,Q){let J=$,{gl:Z}=J;if(Q.cullMode)switch(Q.cullMode){case"none":Z.disable(2884);break;case"front":Z.enable(2884),Z.cullFace(1028);break;case"back":Z.enable(2884),Z.cullFace(1029);break}if(Q.frontFace)Z.frontFace(L8("frontFace",Q.frontFace,{ccw:2305,cw:2304}));if(Q.unclippedDepth){if($.features.has("depth-clip-control"))Z.enable(34383)}if(Q.depthBias!==void 0)Z.enable(32823),Z.polygonOffset(Q.depthBias,Q.depthBiasSlopeScale||0);if(Q.provokingVertex){if($.features.has("provoking-vertex-webgl")){let X=J.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,Y=L8("provokingVertex",Q.provokingVertex,{first:36429,last:36430});X?.provokingVertexWEBGL(Y)}}if(Q.polygonMode||Q.polygonOffsetLine){if($.features.has("polygon-mode-webgl")){if(Q.polygonMode){let X=J.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,Y=L8("polygonMode",Q.polygonMode,{fill:6914,line:6913});X?.polygonModeWEBGL(1028,Y),X?.polygonModeWEBGL(1029,Y)}if(Q.polygonOffsetLine)Z.enable(10754)}}if($.features.has("shader-clip-cull-distance-webgl")){if(Q.clipDistance0)Z.enable(12288);if(Q.clipDistance1)Z.enable(12289);if(Q.clipDistance2)Z.enable(12290);if(Q.clipDistance3)Z.enable(12291);if(Q.clipDistance4)Z.enable(12292);if(Q.clipDistance5)Z.enable(12293);if(Q.clipDistance6)Z.enable(12294);if(Q.clipDistance7)Z.enable(12295)}if(Q.depthWriteEnabled!==void 0)Z.depthMask(f91("depthWriteEnabled",Q.depthWriteEnabled));if(Q.depthCompare)Q.depthCompare!=="always"?Z.enable(2929):Z.disable(2929),Z.depthFunc(cK("depthCompare",Q.depthCompare));if(Q.stencilWriteMask){let K=Q.stencilWriteMask;Z.stencilMaskSeparate(1028,K),Z.stencilMaskSeparate(1029,K)}if(Q.stencilReadMask)f.warn("stencilReadMask not supported under WebGL");if(Q.stencilCompare){let K=Q.stencilReadMask||4294967295,X=cK("depthCompare",Q.stencilCompare);Q.stencilCompare!=="always"?Z.enable(2960):Z.disable(2960),Z.stencilFuncSeparate(1028,X,0,K),Z.stencilFuncSeparate(1029,X,0,K)}if(Q.stencilPassOperation&&Q.stencilFailOperation&&Q.stencilDepthFailOperation){let K=WD("stencilPassOperation",Q.stencilPassOperation),X=WD("stencilFailOperation",Q.stencilFailOperation),Y=WD("stencilDepthFailOperation",Q.stencilDepthFailOperation);Z.stencilOpSeparate(1028,X,Y,K),Z.stencilOpSeparate(1029,X,Y,K)}switch(Q.blend){case!0:Z.enable(3042);break;case!1:Z.disable(3042);break;default:}if(Q.blendColorOperation||Q.blendAlphaOperation){let K=_x("blendColorOperation",Q.blendColorOperation||"add"),X=_x("blendAlphaOperation",Q.blendAlphaOperation||"add");Z.blendEquationSeparate(K,X);let Y=mK("blendColorSrcFactor",Q.blendColorSrcFactor||"one"),W=mK("blendColorDstFactor",Q.blendColorDstFactor||"zero"),q=mK("blendAlphaSrcFactor",Q.blendAlphaSrcFactor||"one"),H=mK("blendAlphaDstFactor",Q.blendAlphaDstFactor||"zero");Z.blendFuncSeparate(Y,W,q,H)}}function cK($,Q){return L8($,Q,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function WD($,Q){return L8($,Q,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function _x($,Q){return L8($,Q,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function mK($,Q){return L8($,Q,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function y91($,Q){return`Illegal parameter ${Q} for ${$}`}function L8($,Q,J){if(!(Q in J))throw Error(y91($,Q));return J[Q]}function f91($,Q){return Q}function b91($){let Q=!0;for(let J in $){Q=!1;break}return Q}var qD=C(()=>{O1();W3()});function dK($){let Q={};if($.addressModeU)Q[10242]=HD($.addressModeU);if($.addressModeV)Q[10243]=HD($.addressModeV);if($.addressModeW)Q[32882]=HD($.addressModeW);if($.magFilter)Q[10240]=FD($.magFilter);if($.minFilter||$.mipmapFilter)Q[10241]=m91($.minFilter||"linear",$.mipmapFilter);if($.lodMinClamp!==void 0)Q[33082]=$.lodMinClamp;if($.lodMaxClamp!==void 0)Q[33083]=$.lodMaxClamp;if($.type==="comparison-sampler")Q[34892]=34894;if($.compare)Q[34893]=cK("compare",$.compare);if($.maxAnisotropy)Q[34046]=$.maxAnisotropy;return Q}function HD($){switch($){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function FD($){switch($){case"nearest":return 9728;case"linear":return 9729}}function m91($,Q="none"){if(!Q)return FD($);switch(Q){case"none":return FD($);case"nearest":return $==="nearest"?9984:9986;case"linear":return $==="nearest"?9985:9987}}var UD=C(()=>{qD()});var U3;var VD=C(()=>{O1();UD();U3=class U3 extends U7{device;handle;parameters;constructor($,Q){super($,Q);this.device=$,this.parameters=dK(Q),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){if(this.handle)this.device.gl.deleteSampler(this.handle),this.handle=void 0}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters($){for(let[Q,J]of Object.entries($)){let Z=Number(Q);switch(Z){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,Z,J);break;default:this.device.gl.samplerParameteri(this.handle,Z,J);break}}}}});var O4;var ND=C(()=>{O1();O4=class O4 extends D8{device;gl;handle;texture;constructor($,Q){super($,{...E1.defaultProps,...Q});this.device=$,this.gl=this.device.gl,this.handle=null,this.texture=Q.texture}}});function gx($){switch(ArrayBuffer.isView($)?$.constructor:$){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw Error(c91)}}function yx($,Q){let{clamped:J=!0}=Q||{};switch($){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return J?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw Error("Failed to deduce typed array type from GL constant")}}var c91="Failed to deduce GL constant from typed array";var fx=()=>{};function DD($){switch($){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function bx($){switch($){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}var mx=()=>{};function v8($,Q,J){if(d91(Q))return J($);let{nocatch:Z=!0}=Q,K=c6.get($);K.push(),q6($,Q);let X;if(Z)X=J($),K.pop();else try{X=J($)}finally{K.pop()}return X}function d91($){for(let Q in $)return!1;return!0}var lK=C(()=>{W3();aN()});function cx($,Q,J){let{dimension:Z,width:K,height:X,depth:Y=0}=J,{glInternalFormat:W}=J,q=J.glTarget;switch(Z){case"2d-array":case"3d":$.texStorage3D(q,Q,W,K,X,Y);break;default:$.texStorage2D(q,Q,W,K,X)}}function CD($,Q,J,Z){let{width:K,height:X}=Z,{dimension:Y,depth:W=0,mipLevel:q=0}=Z,{x:H=0,y:F=0,z:U=0}=Z,{glFormat:V,glType:N}=Z,D=lx(Z.glTarget,Y,W),z=Z.flipY?{[37440]:!0}:{};v8($,z,()=>{switch(Y){case"2d-array":case"3d":$.bindTexture(D,Q),$.texSubImage3D(D,q,H,F,U,K,X,W,V,N,J),$.bindTexture(D,null);break;case"2d":case"cube":$.bindTexture(D,Q),$.texSubImage2D(D,q,H,F,K,X,V,N,J),$.bindTexture(D,null);break;default:throw Error(Y)}})}function AD($,Q,J){let{dimension:Z,width:K,height:X,depth:Y=0,mipLevel:W=0,byteOffset:q=0}=J,{x:H=0,y:F=0,z:U=0}=J,{glFormat:V,glType:N,compressed:D}=J,z=lx(J.glTarget,Z,Y);switch(Z){case"2d-array":case"3d":if(D)$.compressedTexSubImage3D(z,W,H,F,U,K,X,Y,V,Q,q);else $.texSubImage3D(z,W,H,F,U,K,X,Y,V,N,Q,q);break;case"2d":case"cube":if(D)$.compressedTexSubImage2D(z,W,H,F,K,X,V,Q,q);else $.texSubImage2D(z,W,H,F,K,X,V,N,Q,q);break;default:throw Error(Z)}}function dx($){switch($){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866;case"cube-array":break}throw Error($)}function lx($,Q,J){return Q==="cube"?34069+J:$}function px($,Q){let{sourceX:J=0,sourceY:Z=0,sourceAttachment:K=0}=Q||{},{target:X=null,sourceWidth:Y,sourceHeight:W,sourceDepth:q,sourceFormat:H,sourceType:F}=Q||{},{framebuffer:U,deleteFramebuffer:V}=ix($),{gl:N,handle:D}=U;Y||=U.width,W||=U.height;let z=U.colorAttachments[K]?.texture;if(!z)throw Error(`Invalid framebuffer attachment ${K}`);q=z?.depth||1,H||=z?.glFormat||6408,F||=z?.glType||5121,X=p91(X,F,H,Y,W,q),F=F||gx(X);let B=N.bindFramebuffer(36160,D);if(N.readBuffer(36064+K),N.readPixels(J,Z,Y,W,H,F,X),N.readBuffer(36064),N.bindFramebuffer(36160,B||null),V)U.destroy();return X}function ux($,Q){let{target:J,sourceX:Z=0,sourceY:K=0,sourceFormat:X=6408,targetByteOffset:Y=0}=Q||{},{sourceWidth:W,sourceHeight:q,sourceType:H}=Q||{},{framebuffer:F,deleteFramebuffer:U}=ix($);W=W||F.width,q=q||F.height;let V=F;H=H||5121;let N=J;if(!N){let z=DD(X),B=bx(H),M=Y+W*q*z*B;N=V.device.createBuffer({byteLength:M})}let D=$.device.createCommandEncoder();if(D.copyTextureToBuffer({sourceTexture:$,width:W,height:q,origin:[Z,K],destinationBuffer:N,byteOffset:Y}),D.destroy(),U)F.destroy();return N}function ix($){if(!($ instanceof A8))return{framebuffer:l91($),deleteFramebuffer:!0};return{framebuffer:$,deleteFramebuffer:!1}}function l91($,Q){let{device:J,width:Z,height:K,id:X}=$;return J.createFramebuffer({...Q,id:`framebuffer-for-${X}`,width:Z,height:K,colorAttachments:[$]})}function p91($,Q,J,Z,K,X){if($)return $;Q||=5121;let Y=yx(Q,{clamped:!1}),W=DD(J);return new Y(Z*K*W)}var zD=C(()=>{O1();fx();mx();lK()});var P4;var pK=C(()=>{O1();F3();UD();VD();ND();zD();P4=class P4 extends E1{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor($,Q){super($,Q);let J={...this.props};J.data=Q.data,this.device=$,this.gl=this.device.gl,this.glTarget=dx(this.props.dimension);let Z=xK(this.props.format);this.glInternalFormat=Z.internalFormat,this.glFormat=Z.format,this.glType=Z.type,this.compressed=Z.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(J),Object.seal(this)}_initialize($){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:$.data});let{width:Q,height:J}=$;if(!Q||!J){let Z=E1.getTextureDataSize($.data);Q=Z?.width||1,J=Z?.height||1}if(this.width=Q,this.height=J,this.depth=$.depth,this.setSampler($.sampler),this.view=new O4(this.device,{...this.props,texture:this}),this.bind(),cx(this.gl,this.mipLevels,this),$.data)switch($.dimension){case"1d":this.setTexture1DData($.data);break;case"2d":this.setTexture2DData($.data);break;case"3d":this.setTexture3DData($.data);break;case"cube":this.setTextureCubeData($.data);break;case"2d-array":this.setTextureArrayData($.data);break;case"cube-array":this.setTextureCubeArrayData($.data);break;default:throw Error($.dimension)}if(this.mipmaps)this.generateMipmap()}destroy(){if(this.handle)this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0}createView($){return new O4(this.device,{...$,texture:this})}setSampler($={}){let Q;if($ instanceof U3)this.sampler=$,Q=$.props;else this.sampler=new U3(this.device,$),Q=$;let J=dK(Q);this._setSamplerParameters(J)}generateMipmap($){if(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))){if(f.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!$?.force)return}try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(J){f.warn(`Error generating mipmap for ${this}: ${J.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage($){let Q=E1.getExternalImageSize($.image),J={...E1.defaultCopyExternalImageOptions,...Q,...$},{image:Z,depth:K,mipLevel:X,x:Y,y:W,z:q,flipY:H}=J,{width:F,height:U}=J,{dimension:V,glTarget:N,glFormat:D,glInternalFormat:z,glType:B}=this;if(F=Math.min(F,this.width-Y),U=Math.min(U,this.height-W),$.sourceX||$.sourceY)throw Error("WebGL does not support sourceX/sourceY)");return CD(this.device.gl,this.handle,Z,{dimension:V,mipLevel:X,x:Y,y:W,z:q,width:F,height:U,depth:K,glFormat:D,glInternalFormat:z,glType:B,glTarget:N,flipY:H}),{width:J.width,height:J.height}}setTexture1DData($){throw Error("setTexture1DData not supported in WebGL.")}setTexture2DData($,Q=0){this.bind();let J=E1.normalizeTextureData($,this);if(J.length>1&&this.props.mipmaps!==!1)f.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let Z=0;Z<J.length;Z++){let K=J[Z];this._setMipLevel(Q,Z,K)}this.unbind()}setTexture3DData($){if(this.props.dimension!=="3d")throw Error(this.id);if(ArrayBuffer.isView($))this.bind(),AD(this.device.gl,$,this),this.unbind()}setTextureCubeData($,Q=0){if(this.props.dimension!=="cube")throw Error(this.id);for(let J of E1.CubeFaces)this.setTextureCubeFaceData($[J],J)}setTextureArrayData($){if(this.props.dimension!=="2d-array")throw Error(this.id);throw Error("setTextureArrayData not implemented.")}setTextureCubeArrayData($){throw Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData($,Q,J=0){if(Array.isArray($)&&$.length>1&&this.props.mipmaps!==!1)f.warn(`${this.id} has mipmap and multiple LODs.`)();let Z=E1.CubeFaces.indexOf(Q);this.setTexture2DData($,Z)}update(){throw Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace($){let{face:Q,width:J,height:Z,pixels:K,data:X,format:Y=6408,type:W=5121}=$,{gl:q}=this,H=K||X;if(this.bind(),H instanceof Promise)H.then((F)=>this.setImageDataForFace(Object.assign({},$,{face:Q,data:F,pixels:F})));else if(this.width||this.height)q.texImage2D(Q,0,Y,J,Z,0,Y,W,H);else q.texImage2D(Q,0,Y,Y,W,H)}_getImageDataMap($){for(let Q=0;Q<E1.CubeFaces.length;++Q){let J=E1.CubeFaces[Q];if($[J])$[34069+Q]=$[J],delete $[J]}return $}_setSamplerParameters($){f.log(1,`${this.id} sampler parameters`,this.device.getGLKeys($))(),this.gl.bindTexture(this.glTarget,this.handle);for(let[Q,J]of Object.entries($)){let Z=Number(Q),K=J;switch(Z){case 33082:case 33083:this.gl.texParameterf(this.glTarget,Z,K);break;case 10241:this.gl.texParameteri(this.glTarget,Z,K);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,Z,K);break;case 34046:if(this.device.features.has("texture-filterable-anisotropic-webgl"))this.gl.texParameteri(this.glTarget,Z,K);break;default:this.gl.texParameteri(this.glTarget,Z,K);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel($,Q,J,Z=this.glTarget){if(E1.isExternalImage(J)){CD(this.device.gl,this.handle,J,{...this,depth:$,mipLevel:Q,glTarget:Z,flipY:this.props.flipY});return}if(E1.isTextureLevelData(J)){AD(this.device.gl,J.data,{...this,depth:$,mipLevel:Q,glTarget:Z});return}throw Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind($){let{gl:Q}=this;if($!==void 0)this.textureUnit=$,Q.activeTexture(33984+$);return Q.bindTexture(this.glTarget,this.handle),$}unbind($){let{gl:Q}=this;if($!==void 0)this.textureUnit=$,Q.activeTexture(33984+$);return Q.bindTexture(this.glTarget,null),$}}});var u91,kD;var nx=C(()=>{O1();lK();W3();u91=[1,2,4,8];kD=class kD extends Y4{device;glParameters;constructor($,Q){super($,Q);this.device=$;let J;if(!Q?.parameters?.viewport)if(Q?.framebuffer){let{width:K,height:X}=Q.framebuffer;J=[0,0,K,X]}else{let[K,X]=$.getCanvasContext().getDrawingBufferSize();J=[0,0,K,X]}if(this.device.pushState(),this.setParameters({viewport:J,...this.props.parameters}),this.props.framebuffer?.handle)if(this.props.framebuffer){let K=this.props.framebuffer.colorAttachments.map((X,Y)=>36064+Y);this.device.gl.drawBuffers(K)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup($){}popDebugGroup(){}insertDebugMarker($){}setParameters($={}){let Q={...this.glParameters};if(Q.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly)Q.depthMask=!this.props.depthReadOnly;if(Q.stencilMask=this.props.stencilReadOnly?0:1,Q[35977]=this.props.discard,$.viewport)if($.viewport.length>=6)Q.viewport=$.viewport.slice(0,4),Q.depthRange=[$.viewport[4],$.viewport[5]];else Q.viewport=$.viewport;if($.scissorRect)Q.scissorTest=!0,Q.scissor=$.scissorRect;if($.blendConstant)Q.blendColor=$.blendConstant;if($.stencilReference)console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),$[2967]=$.stencilReference;if($.colorMask)Q.colorMask=u91.map((J)=>Boolean(J&$.colorMask));this.glParameters=Q,q6(this.device.gl,Q)}beginOcclusionQuery($){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let $={...this.glParameters},Q=0;if(this.props.clearColors)this.props.clearColors.forEach((J,Z)=>{if(J)this.clearColorBuffer(Z,J)});if(this.props.clearColor!==!1&&this.props.clearColors===void 0)Q|=16384,$.clearColor=this.props.clearColor;if(this.props.clearDepth!==!1)Q|=256,$.clearDepth=this.props.clearDepth;if(this.props.clearStencil!==!1)Q|=1024,$.clearStencil=this.props.clearStencil;if(Q!==0)v8(this.device.gl,$,()=>{this.device.gl.clear(Q)})}clearColorBuffer($=0,Q=[0,0,0,0]){v8(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(Q.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,$,Q);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,$,Q);break;case Float32Array:this.device.gl.clearBufferfv(6144,$,Q);break;default:throw Error("clearColorBuffer: color must be typed array")}})}}});function sx($){return i91.includes($)}function BD($){let Q=ox[$];if(!Q)throw Error("uniform");let[J,Z,,K]=Q;return{format:K,components:Z,glType:J}}function rx($){let Q=ox[$];if(!Q)throw Error("attribute");let[,J,,Z,K]=Q;return{attributeType:Z,vertexFormat:K,components:J}}var i91,ox;var ax=C(()=>{i91=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],ox={[5126]:[5126,1,"float","f32","float32"],[35664]:[5126,2,"vec2","vec2<f32>","float32x2"],[35665]:[5126,3,"vec3","vec3<f32>","float32x3"],[35666]:[5126,4,"vec4","vec4<f32>","float32x4"],[5124]:[5124,1,"int","i32","sint32"],[35667]:[5124,2,"ivec2","vec2<i32>","sint32x2"],[35668]:[5124,3,"ivec3","vec3<i32>","sint32x3"],[35669]:[5124,4,"ivec4","vec4<i32>","sint32x4"],[5125]:[5125,1,"uint","u32","uint32"],[36294]:[5125,2,"uvec2","vec2<u32>","uint32x2"],[36295]:[5125,3,"uvec3","vec3<u32>","uint32x3"],[36296]:[5125,4,"uvec4","vec4<u32>","uint32x4"],[35670]:[5126,1,"bool","f32","float32"],[35671]:[5126,2,"bvec2","vec2<f32>","float32x2"],[35672]:[5126,3,"bvec3","vec3<f32>","float32x3"],[35673]:[5126,4,"bvec4","vec4<f32>","float32x4"],[35674]:[5126,8,"mat2","mat2x2<f32>"],[35685]:[5126,8,"mat2x3","mat2x3<f32>"],[35686]:[5126,8,"mat2x4","mat2x4<f32>"],[35687]:[5126,12,"mat3x2","mat3x2<f32>"],[35675]:[5126,12,"mat3","mat3x3<f32>"],[35688]:[5126,12,"mat3x4","mat3x4<f32>"],[35689]:[5126,16,"mat4x2","mat4x2<f32>"],[35690]:[5126,16,"mat4x3","mat4x3<f32>"],[35676]:[5126,16,"mat4","mat4x4<f32>"]}});function tx($,Q){let J={attributes:[],bindings:[]};J.attributes=n91($,Q);let Z=r91($,Q);for(let W of Z){let q=W.uniforms.map((H)=>({name:H.name,format:H.format,byteOffset:H.byteOffset,byteStride:H.byteStride,arrayLength:H.arrayLength}));J.bindings.push({type:"uniform",name:W.name,group:0,location:W.location,visibility:(W.vertex?1:0)&(W.fragment?2:0),minBindingSize:W.byteLength,uniforms:q})}let K=o91($,Q),X=0;for(let W of K)if(sx(W.type)){let{viewDimension:q,sampleType:H}=t91(W.type);J.bindings.push({type:"texture",name:W.name,group:0,location:X,viewDimension:q,sampleType:H}),W.textureUnit=X,X+=1}if(K.length)J.uniforms=K;let Y=s91($,Q);if(Y?.length)J.varyings=Y;return J}function n91($,Q){let J=[],Z=$.getProgramParameter(Q,35721);for(let K=0;K<Z;K++){let X=$.getActiveAttrib(Q,K);if(!X)throw Error("activeInfo");let{name:Y,type:W}=X,q=$.getAttribLocation(Q,Y);if(q>=0){let{attributeType:H}=rx(W),F=/instance/i.test(Y)?"instance":"vertex";J.push({name:Y,location:q,stepMode:F,type:H})}}return J.sort((K,X)=>K.location-X.location),J}function s91($,Q){let J=[],Z=$.getProgramParameter(Q,35971);for(let K=0;K<Z;K++){let X=$.getTransformFeedbackVarying(Q,K);if(!X)throw Error("activeInfo");let{name:Y,type:W,size:q}=X,{glType:H,components:F}=BD(W),U={location:K,name:Y,type:H,size:q*F};J.push(U)}return J.sort((K,X)=>K.location-X.location),J}function o91($,Q){let J=[],Z=$.getProgramParameter(Q,35718);for(let K=0;K<Z;K++){let X=$.getActiveUniform(Q,K);if(!X)throw Error("activeInfo");let{name:Y,size:W,type:q}=X,{name:H,isArray:F}=e91(Y),U=$.getUniformLocation(Q,H),V={location:U,name:H,size:W,type:q,isArray:F};if(J.push(V),V.size>1)for(let N=0;N<V.size;N++){let D=`${H}[${N}]`;U=$.getUniformLocation(Q,D);let z={...V,name:D,location:U};J.push(z)}}return J}function r91($,Q){let J=(X,Y)=>$.getActiveUniformBlockParameter(Q,X,Y),Z=[],K=$.getProgramParameter(Q,35382);for(let X=0;X<K;X++){let Y={name:$.getActiveUniformBlockName(Q,X)||"",location:J(X,35391),byteLength:J(X,35392),vertex:J(X,35396),fragment:J(X,35398),uniformCount:J(X,35394),uniforms:[]},W=J(X,35395)||[],q=$.getActiveUniforms(Q,W,35383),H=$.getActiveUniforms(Q,W,35384),F=$.getActiveUniforms(Q,W,35387),U=$.getActiveUniforms(Q,W,35388);for(let V=0;V<Y.uniformCount;++V){let N=$.getActiveUniform(Q,W[V]);if(!N)throw Error("activeInfo");Y.uniforms.push({name:N.name,format:BD(q[V]).format,type:q[V],arrayLength:H[V],byteOffset:F[V],byteStride:U[V]})}Z.push(Y)}return Z.sort((X,Y)=>X.location-Y.location),Z}function t91($){let Q=a91[$];if(!Q)throw Error("sampler");let[J,Z]=Q;return{viewDimension:J,sampleType:Z}}function e91($){if($[$.length-1]!=="]")return{name:$,length:1,isArray:!1};let J=/([^[]*)(\[[0-9]+\])?/.exec($);if(!J||J.length<2)throw Error(`Failed to parse GLSL uniform name ${$}`);return{name:J[1],length:J[2]?1:0,isArray:Boolean(J[2])}}var a91;var ex=C(()=>{ax();a91={[35678]:["2d","float"],[35680]:["cube","float"],[35679]:["3d","float"],[35682]:["3d","depth"],[36289]:["2d-array","float"],[36292]:["2d-array","depth"],[36293]:["cube","float"],[36298]:["2d","sint"],[36299]:["3d","sint"],[36300]:["cube","sint"],[36303]:["2d-array","uint"],[36306]:["2d","uint"],[36307]:["3d","uint"],[36308]:["cube","uint"],[36311]:["2d-array","uint"]}});function $g($,Q,J,Z){let K=$,X=Z;if(X===!0)X=1;if(X===!1)X=0;let Y=typeof X==="number"?[X]:X;switch(J){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof Z!=="number")throw Error("samplers must be set to integers");return $.uniform1i(Q,Z);case 5126:return $.uniform1fv(Q,Y);case 35664:return $.uniform2fv(Q,Y);case 35665:return $.uniform3fv(Q,Y);case 35666:return $.uniform4fv(Q,Y);case 5124:return $.uniform1iv(Q,Y);case 35667:return $.uniform2iv(Q,Y);case 35668:return $.uniform3iv(Q,Y);case 35669:return $.uniform4iv(Q,Y);case 35670:return $.uniform1iv(Q,Y);case 35671:return $.uniform2iv(Q,Y);case 35672:return $.uniform3iv(Q,Y);case 35673:return $.uniform4iv(Q,Y);case 5125:return K.uniform1uiv(Q,Y,1);case 36294:return K.uniform2uiv(Q,Y,2);case 36295:return K.uniform3uiv(Q,Y,3);case 36296:return K.uniform4uiv(Q,Y,4);case 35674:return $.uniformMatrix2fv(Q,!1,Y);case 35675:return $.uniformMatrix3fv(Q,!1,Y);case 35676:return $.uniformMatrix4fv(Q,!1,Y);case 35685:return K.uniformMatrix2x3fv(Q,!1,Y);case 35686:return K.uniformMatrix2x4fv(Q,!1,Y);case 35687:return K.uniformMatrix3x2fv(Q,!1,Y);case 35688:return K.uniformMatrix3x4fv(Q,!1,Y);case 35689:return K.uniformMatrix4x2fv(Q,!1,Y);case 35690:return K.uniformMatrix4x3fv(Q,!1,Y)}throw Error("Illegal uniform")}var Qg=()=>{};function $31($){return k$($)!==null||typeof $==="number"||typeof $==="boolean"}function Jg($){let Q={bindings:{},uniforms:{}};return Object.keys($).forEach((J)=>{let Z=$[J];if($31(Z))Q.uniforms[J]=Z;else Q.bindings[J]=Z}),Q}var Zg=C(()=>{_N()});function Kg($){switch($){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw Error($)}}function Xg($){switch($){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw Error($)}}var RD=()=>{};function Q31($,Q){let J={...$,attributes:$.attributes.map((Z)=>({...Z}))};for(let Z of Q?.attributes||[]){let K=J.attributes.find((X)=>X.name===Z.name);if(!K)f.warn(`shader layout attribute ${Z.name} not present in shader`);else K.type=Z.type||K.type,K.stepMode=Z.stepMode||K.stepMode}return J}var Yg=4,OD;var Wg=C(()=>{O1();ex();qD();Qg();Zg();bK();gK();pK();ND();RD();OD=class OD extends h6{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor($,Q){super($,Q);this.device=$,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=Q.vs,this.fs=Q.fs;let{varyings:J,bufferMode:Z=35981}=Q;if(J&&J.length>0)this.varyings=J,this.device.gl.transformFeedbackVaryings(this.handle,J,Z);this._linkShaders(),f.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=tx(this.device.gl,this.handle),f.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=Q31(this.introspectedLayout,Q.shaderLayout)}destroy(){if(this.handle)this.device.gl.deleteProgram(this.handle),this.destroyed=!0}setBindings($,Q){for(let[J,Z]of Object.entries($)){let K=this.shaderLayout.bindings.find((X)=>X.name===J)||this.shaderLayout.bindings.find((X)=>X.name===`${J}Uniforms`);if(!K){let X=this.shaderLayout.bindings.map((Y)=>`"${Y.name}"`).join(", ");if(!Q?.disableWarnings)f.warn(`No binding "${J}" in render pipeline "${this.id}", expected one of ${X}`,Z)();continue}if(!Z)f.warn(`Unsetting binding "${J}" in render pipeline "${this.id}"`)();switch(K.type){case"uniform":if(!(Z instanceof l6)&&!(Z.buffer instanceof l6))throw Error("buffer value");break;case"texture":if(!(Z instanceof O4||Z instanceof P4||Z instanceof R4))throw Error("texture value");break;case"sampler":f.warn(`Ignoring sampler ${J}`)();break;default:throw Error(K.type)}this.bindings[J]=Z}}draw($){let{renderPass:Q,parameters:J=this.props.parameters,topology:Z=this.props.topology,vertexArray:K,vertexCount:X,instanceCount:Y,isInstanced:W=!1,firstVertex:q=0,transformFeedback:H}=$,F=Kg(Z),U=Boolean(K.indexBuffer),V=K.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return f.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return f.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(this.device.gl.useProgram(this.handle),K.bindBeforeRender(Q),H)H.begin(this.props.topology);this._applyBindings(),this._applyUniforms();let N=Q;return xx(this.device,J,N.glParameters,()=>{if(U&&W)this.device.gl.drawElementsInstanced(F,X||0,V,q,Y||0);else if(U)this.device.gl.drawElements(F,X||0,V,q);else if(W)this.device.gl.drawArraysInstanced(F,q,X||0,Y||0);else this.device.gl.drawArrays(F,q,X||0);if(H)H.end()}),K.unbindAfterRender(Q),!0}setUniformsWebGL($){let{bindings:Q}=Jg($);Object.keys(Q).forEach((J)=>{f.warn(`Unsupported value "${JSON.stringify(Q[J])}" used in setUniforms() for key ${J}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,$)}async _linkShaders(){let{gl:$}=this.device;if($.attachShader(this.handle,this.vs.handle),$.attachShader(this.handle,this.fs.handle),f.time(Yg,`linkProgram for ${this.id}`)(),$.linkProgram(this.handle),f.timeEnd(Yg,`linkProgram for ${this.id}`)(),f.level===0);if(!this.device.features.has("compilation-status-async-webgl")){let J=this._getLinkStatus();this._reportLinkStatus(J);return}f.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),f.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let Q=this._getLinkStatus();this._reportLinkStatus(Q)}async _reportLinkStatus($){switch($){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break;case"success":break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break;case"success":break}let Q=this.device.gl.getProgramInfoLog(this.handle);throw Error(`Error during ${$}: ${Q}`)}}_getLinkStatus(){let{gl:$}=this.device;if(!$.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";if($.validateProgram(this.handle),!$.getProgramParameter(this.handle,35715))return this.linkStatus="error","validation";return this.linkStatus="success","success"}async _waitForLinkComplete(){let $=async(Z)=>await new Promise((K)=>setTimeout(K,Z)),Q=10;if(!this.device.features.has("compilation-status-async-webgl")){await $(10);return}let{gl:J}=this.device;for(;;){if(J.getProgramParameter(this.handle,37297))return;await $(10)}}_areTexturesRenderable(){let $=!0;for(let Q of this.shaderLayout.bindings)if(!this.bindings[Q.name]&&!this.bindings[Q.name.replace(/Uniforms$/,"")])f.warn(`Binding ${Q.name} not found in ${this.id}`)(),$=!1;return $}_applyBindings(){if(this.linkStatus!=="success")return;let{gl:$}=this.device;$.useProgram(this.handle);let Q=0,J=0;for(let Z of this.shaderLayout.bindings){let K=this.bindings[Z.name]||this.bindings[Z.name.replace(/Uniforms$/,"")];if(!K)throw Error(`No value for binding ${Z.name} in ${this.id}`);switch(Z.type){case"uniform":let{name:X}=Z,Y=$.getUniformBlockIndex(this.handle,X);if(Y===4294967295)throw Error(`Invalid uniform block name ${X}`);if($.uniformBlockBinding(this.handle,J,Y),K instanceof l6)$.bindBufferBase(35345,J,K.handle);else $.bindBufferRange(35345,J,K.buffer.handle,K.offset||0,K.size||K.buffer.byteLength-K.offset);J+=1;break;case"texture":if(!(K instanceof O4||K instanceof P4||K instanceof R4))throw Error("texture");let W;if(K instanceof O4)W=K.texture;else if(K instanceof P4)W=K;else if(K instanceof R4&&K.colorAttachments[0]instanceof O4)f.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),W=K.colorAttachments[0].texture;else throw Error("No texture");$.activeTexture(33984+Q),$.bindTexture(W.glTarget,W.handle),Q+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw Error(`binding type '${Z.type}' not supported in WebGL`)}}}_applyUniforms(){for(let $ of this.shaderLayout.uniforms||[]){let{name:Q,location:J,type:Z,textureUnit:K}=$,X=this.uniforms[Q]??K;if(X!==void 0)$g(this.device.gl,J,Z,X)}}}});function J31($,Q){let{sourceBuffer:J,destinationBuffer:Z}=Q;$.gl.bindBuffer(36662,J.handle),$.gl.bindBuffer(36663,Z.handle),$.gl.copyBufferSubData(36662,36663,Q.sourceOffset??0,Q.destinationOffset??0,Q.size),$.gl.bindBuffer(36662,null),$.gl.bindBuffer(36663,null)}function Z31($,Q){throw Error("Not implemented")}function K31($,Q){let{sourceTexture:J,mipLevel:Z=0,aspect:K="all",width:X=Q.sourceTexture.width,height:Y=Q.sourceTexture.height,depthOrArrayLayers:W=0,origin:q=[0,0],destinationBuffer:H,byteOffset:F=0,bytesPerRow:U,rowsPerImage:V}=Q;if(K!=="all")throw Error("aspect not supported in WebGL");if(Z!==0||W!==0||U||V)throw Error("not implemented");let{framebuffer:N,destroyFramebuffer:D}=qg(J),z;try{let B=H,M=X||N.width,P=Y||N.height,O=xK(N.colorAttachments[0].texture.props.format),G=O.format,L=O.type;$.gl.bindBuffer(35051,B.handle),z=$.gl.bindFramebuffer(36160,N.handle),$.gl.readPixels(q[0],q[1],M,P,G,L,F)}finally{if($.gl.bindBuffer(35051,null),z!==void 0)$.gl.bindFramebuffer(36160,z);if(D)N.destroy()}}function X31($,Q){let{sourceTexture:J,destinationMipLevel:Z=0,origin:K=[0,0],destinationOrigin:X=[0,0],destinationTexture:Y}=Q,{width:W=Q.destinationTexture.width,height:q=Q.destinationTexture.height}=Q,{framebuffer:H,destroyFramebuffer:F}=qg(J),[U,V]=K,[N,D,z]=X,B=$.gl.bindFramebuffer(36160,H.handle),M=null,P;if(Y instanceof P4)M=Y,W=Number.isFinite(W)?W:M.width,q=Number.isFinite(q)?q:M.height,M.bind(0),P=M.glTarget;else throw Error("invalid destination");switch(P){case 3553:case 34067:$.gl.copyTexSubImage2D(P,Z,N,D,U,V,W,q);break;case 35866:case 32879:$.gl.copyTexSubImage3D(P,Z,N,D,z,U,V,W,q);break;default:}if(M)M.unbind();if($.gl.bindFramebuffer(36160,B),F)H.destroy()}function qg($){if($ instanceof E1){let{width:Q,height:J,id:Z}=$;return{framebuffer:$.device.createFramebuffer({id:`framebuffer-for-${Z}`,width:Q,height:J,colorAttachments:[$]}),destroyFramebuffer:!0}}return{framebuffer:$,destroyFramebuffer:!1}}var PD;var Hg=C(()=>{O1();pK();F3();PD=class PD extends y2{device;commands=[];constructor($){super($,{});this.device=$}submitCommands($=this.commands){for(let Q of $)switch(Q.name){case"copy-buffer-to-buffer":J31(this.device,Q.options);break;case"copy-buffer-to-texture":Z31(this.device,Q.options);break;case"copy-texture-to-buffer":K31(this.device,Q.options);break;case"copy-texture-to-texture":X31(this.device,Q.options);break;default:throw Error(Q.name)}}}});var MD;var Fg=C(()=>{O1();Hg();MD=class MD extends g2{device;commandBuffer;constructor($,Q){super($,Q);this.device=$,this.commandBuffer=new PD($)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer($){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:$})}copyBufferToTexture($){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:$})}copyTextureToBuffer($){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:$})}copyTextureToTexture($){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:$})}pushDebugGroup($){}popDebugGroup(){}insertDebugMarker($){}resolveQuerySet($,Q,J){}}});function Ug($){let{target:Q,source:J,start:Z=0,count:K=1}=$,X=J.length,Y=K*X,W=0;for(let q=Z;W<X;W++)Q[q++]=J[W];while(W<Y)if(W<Y-W)Q.copyWithin(Z+W,Z,Z+W),W*=2;else Q.copyWithin(Z+W,Z,Z+Y-W),W=Y;return $.target}function Y31($){if(Array.isArray($))return new Float32Array($);return $}function W31($,Q){if(!$||!Q||$.length!==Q.length||$.constructor!==Q.constructor)return!1;for(let J=0;J<$.length;++J)if($[J]!==Q[J])return!1;return!0}var uK;var Vg=C(()=>{O1();W7();tN();uK=class uK extends f2{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported($){return aH()==="Chrome"}constructor($,Q){super($,Q);this.device=$,this.handle=this.device.gl.createVertexArray()}destroy(){if(super.destroy(),this.buffer)this.buffer?.destroy();if(this.handle)this.device.gl.deleteVertexArray(this.handle),this.handle=void 0}setIndexBuffer($){let Q=$;if(Q&&Q.glTarget!==34963)throw Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,Q?Q.handle:null),this.indexBuffer=Q,this.device.gl.bindVertexArray(null)}setBuffer($,Q){let J=Q;if(J.glTarget===34963)throw Error("Use .setIndexBuffer()");let{size:Z,type:K,stride:X,offset:Y,normalized:W,integer:q,divisor:H}=this._getAccessor($);if(this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,J.handle),q)this.device.gl.vertexAttribIPointer($,Z,K,X,Y);else this.device.gl.vertexAttribPointer($,Z,K,W,X,Y);this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray($),this.device.gl.vertexAttribDivisor($,H||0),this.attributes[$]=J,this.device.gl.bindVertexArray(null)}setConstantWebGL($,Q){this._enable($,!1),this.attributes[$]=Q}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let $=0;$<this.maxVertexAttributes;++$){let Q=this.attributes[$];if(ArrayBuffer.isView(Q))this.device.setConstantAttributeWebGL($,Q)}}_getAccessor($){let Q=this.attributeInfos[$];if(!Q)throw Error(`Unknown attribute location ${$}`);let J=vK(Q.bufferDataType);return{size:Q.bufferComponents,type:J,stride:Q.byteStride,offset:Q.byteOffset,normalized:Q.normalized,integer:Q.integer,divisor:Q.stepMode==="instance"?1:0}}_enable($,Q=!0){let Z=uK.isConstantAttributeZeroSupported(this.device)||$!==0;if(Q||Z){if($=Number($),this.device.gl.bindVertexArray(this.handle),Q)this.device.gl.enableVertexAttribArray($);else this.device.gl.disableVertexAttribArray($);this.device.gl.bindVertexArray(null)}}getConstantBuffer($,Q){let J=Y31(Q),Z=J.byteLength*$,K=J.length*$;if(this.buffer&&Z!==this.buffer.byteLength)throw Error(`Buffer size is immutable, byte length ${Z} !== ${this.buffer.byteLength}.`);let X=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:Z}),X=X||!W31(J,this.bufferValue),X){let Y=DU(Q.constructor,K);Ug({target:Y,source:J,start:0,count:K}),this.buffer.write(Y),this.bufferValue=Q}return this.buffer}}});function Ng($){if(typeof $==="number")return Number.isInteger($);return/^\d+$/.test($)}var wD;var Dg=C(()=>{O1();iK();RD();wD=class wD extends b2{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor($,Q){super($,Q);if(this.device=$,this.gl=$.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,Q.buffers)this.setBuffers(Q.buffers);Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin($="point-list"){if(this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse)this._bindBuffers();this.gl.beginTransformFeedback(Xg($))}end(){if(this.gl.endTransformFeedback(),this.bindOnUse)this._unbindBuffers();this.gl.bindTransformFeedback(36386,null)}setBuffers($){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let Q in $)this.setBuffer(Q,$[Q])})}setBuffer($,Q){let J=this._getVaryingIndex($),{buffer:Z,byteLength:K,byteOffset:X}=this._getBufferRange(Q);if(J<0){this.unusedBuffers[$]=Z,f.warn(`${this.id} unusedBuffers varying buffer ${$}`)();return}if(this.buffers[J]={buffer:Z,byteLength:K,byteOffset:X},!this.bindOnUse)this._bindBuffer(J,Z,X,K)}getBuffer($){if(Ng($))return this.buffers[$]||null;let Q=this._getVaryingIndex($);return Q>=0?this.buffers[Q]:null}bind($=this.handle){if(typeof $!=="function")return this.gl.bindTransformFeedback(36386,$),this;let Q;if(!this._bound)this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,Q=$(),this._bound=!1,this.gl.bindTransformFeedback(36386,null);else Q=$();return Q}unbind(){this.bind(null)}_getBufferRange($){if($ instanceof l6)return{buffer:$,byteOffset:0,byteLength:$.byteLength};let{buffer:Q,byteOffset:J=0,byteLength:Z=$.buffer.byteLength}=$;return{buffer:Q,byteOffset:J,byteLength:Z}}_getVaryingIndex($){if(Ng($))return Number($);for(let Q of this.layout.varyings)if($===Q.name)return Q.location;return-1}_bindBuffers(){for(let $ in this.buffers){let{buffer:Q,byteLength:J,byteOffset:Z}=this._getBufferRange(this.buffers[$]);this._bindBuffer(Number($),Q,Z,J)}}_unbindBuffers(){for(let $ in this.buffers)this.gl.bindBufferBase(35982,Number($),null)}_bindBuffer($,Q,J=0,Z){let K=Q&&Q.handle;if(!K||Z===void 0)this.gl.bindBufferBase(35982,$,K);else this.gl.bindBufferRange(35982,$,K,J,Z)}}});var SD;var Cg=C(()=>{O1();SD=class SD extends m2{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor($,Q){super($,Q);if(this.device=$,Q.count>1)throw Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery($){return this._begin($?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin($){if(this._queryPending)return;this.target=$,this.device.gl.beginQuery(this.target,this.handle);return}_end(){if(this._queryPending)return;if(this.target)this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0;return}isResultAvailable(){if(!this._queryPending)return!1;let $=this.device.gl.getQueryParameter(this.handle,34919);if($)this._queryPending=!1;return $}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery($=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let Q=0;return this._pollingPromise=new Promise((J,Z)=>{let K=()=>{if(this.isResultAvailable())J(this.getResult()),this._pollingPromise=null;else if(Q++>$)Z("Timed out"),this._pollingPromise=null;else requestAnimationFrame(K)};requestAnimationFrame(K)}),this._pollingPromise}}});function q31($,Q,J){switch(J.length){case 1:$.gl.vertexAttrib1fv(Q,J);break;case 2:$.gl.vertexAttrib2fv(Q,J);break;case 3:$.gl.vertexAttrib3fv(Q,J);break;case 4:$.gl.vertexAttrib4fv(Q,J);break;default:}}function H31($,Q,J){$.gl.vertexAttribI4iv(Q,J)}function F31($,Q,J){$.gl.vertexAttribI4uiv(Q,J)}function U31($,Q){if(!$||!Q||$.length!==Q.length||$.constructor!==Q.constructor)return!1;for(let J=0;J<$.length;++J)if($[J]!==Q[J])return!1;return!0}var p6;var TD=C(()=>{O1();aN();Ux();Bx();Rx();Ox();ZD();KD();F3();jx();bK();vx();VD();pK();gK();nx();Wg();Fg();Vg();Dg();Cg();zD();W3();lK();p6=class p6 extends h5{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor($){super({...$,id:$.id||Ex("webgl-device")});let Q=h5._getCanvasContextProps($);if(!Q)throw Error("WebGLDevice requires props.createCanvasContext to be set");let J=Q.canvas?.gl?.device;if(J)throw Error(`WebGL context already attached to device ${J.id}`);this.canvasContext=new JD(this,Q),this.lost=new Promise((H)=>{this._resolveContextLost=H});let Z={...$.webgl};if(Q.alphaMode==="premultiplied")Z.premultipliedAlpha=!0;if($.powerPreference!==void 0)Z.powerPreference=$.powerPreference;let X=this.props._handle||qx(this.canvasContext.canvas,{onContextLost:(H)=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:(H)=>console.log("WebGL context restored")},Z);if(!X)throw Error("WebGL context creation failed");if(J=X.device,J){if($._reuseDevices)return f.log(1,`Not creating a new Device, instead returning a reference to Device ${J.id} already attached to WebGL context`,J)(),J._reused=!0,J;throw Error(`WebGL context already attached to device ${J.id}`)}if(this.handle=X,this.gl=X,this.spectorJS=wx({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=Hx(this.gl,this._extensions),this.limits=new QD(this.gl),this.features=new $D(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures)this.features.initializeFeatures();if(Q.autoResize!==!1)this.canvasContext.resize();new c6(this.gl,{log:(...H)=>f.log(1,...H)()}).trackState(this.gl,{copyState:!1});let W=$.debugWebGL||$.debug,q=$.debugWebGL;if(W){if(this.gl=Gx(this.gl,{debugWebGL:W,traceWebGL:q}),f.warn("WebGL debug mode activated. Performance reduced.")(),$.debugWebGL)f.level=Math.max(f.level,1)}}destroy(){if(!this.props._reuseDevices&&!this._reused)delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext($){throw Error("WebGL only supports a single canvas")}createBuffer($){let Q=this._normalizeBufferProps($);return new l6(this,Q)}createTexture($){return new P4(this,$)}createExternalTexture($){throw Error("createExternalTexture() not implemented")}createSampler($){return new U3(this,$)}createShader($){return new YD(this,$)}createFramebuffer($){return new R4(this,$)}createVertexArray($){return new uK(this,$)}createTransformFeedback($){return new wD(this,$)}createQuerySet($){return new SD(this,$)}createRenderPipeline($){return new OD(this,$)}beginRenderPass($){return new kD(this,$)}createComputePipeline($){throw Error("ComputePipeline not supported in WebGL")}beginComputePass($){throw Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder($={}){return new MD(this,$)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL($,Q){return px($,Q)}readPixelsToBufferWebGL($,Q){return ux($,Q)}setParametersWebGL($){q6(this.gl,$)}getParametersWebGL($){return LK(this.gl,$)}withParametersWebGL($,Q){return v8(this.gl,$,Q)}resetWebGL(){f.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Xx(this.gl)}_getDeviceSpecificTextureFormatCapabilities($){return Ax(this.gl,$,this._extensions)}loseDevice(){let $=!1,J=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;if(J)$=!0,J.loseContext();return this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),$}pushState(){c6.get(this.gl).push()}popState(){c6.get(this.gl).pop()}setSpectorMetadata($,Q){$.__SPECTOR_Metadata=Q}getGLKey($,Q){let J=Number($);for(let Z in this.gl)if(this.gl[Z]===J)return`GL.${Z}`;return Q?.emptyIfUnknown?"":String($)}getGLKeys($){let Q={emptyIfUnknown:!0};return Object.entries($).reduce((J,[Z,K])=>{return J[`${Z}:${this.getGLKey(Z,Q)}`]=`${K}:${this.getGLKey(K,Q)}`,J},{})}_constants;setConstantAttributeWebGL($,Q){let J=this.limits.maxVertexAttributes;this._constants=this._constants||Array(J).fill(null);let Z=this._constants[$];if(Z&&U31(Z,Q))f.info(1,`setConstantAttributeWebGL(${$}) could have been skipped, value unchanged`)();switch(this._constants[$]=Q,Q.constructor){case Float32Array:q31(this,$,Q);break;case Int32Array:H31(this,$,Q);break;case Uint32Array:F31(this,$,Q);break;default:throw Error("constant")}}getExtension($){return d6(this.gl,$,this._extensions),this._extensions}}});function Ag($=!0){let Q=HTMLCanvasElement.prototype;if(!$&&Q.originalGetContext){Q.getContext=Q.originalGetContext,Q.originalGetContext=void 0;return}Q.originalGetContext=Q.getContext,Q.getContext=function(J,Z){if(J==="webgl"||J==="experimental-webgl"){let K=this.originalGetContext("webgl2",Z);if(K instanceof HTMLElement)A31(K);return K}return this.originalGetContext(J,Z)}}function A31($){$.getExtension("EXT_color_buffer_float");let Q={...V31,WEBGL_disjoint_timer_query:$.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:N31($),OES_vertex_array_object:D31($),ANGLE_instanced_arrays:C31($)},J=$.getExtension;$.getExtension=function(K){let X=J.call($,K);if(X)return X;if(K in Q)return Q[K];return null};let Z=$.getSupportedExtensions;$.getSupportedExtensions=function(){return(Z.apply($)||[])?.concat(Object.keys(Q))}}var V31,N31=($)=>({drawBuffersWEBGL(Q){return $.drawBuffers(Q)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),D31=($)=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return $.createVertexArray()},deleteVertexArrayOES(Q){return $.deleteVertexArray(Q)},isVertexArrayOES(Q){return $.isVertexArray(Q)},bindVertexArrayOES(Q){return $.bindVertexArray(Q)}}),C31=($)=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...Q){return $.drawArraysInstanced(...Q)},drawElementsInstancedANGLE(...Q){return $.drawElementsInstanced(...Q)},vertexAttribDivisorANGLE(...Q){return $.vertexAttribDivisor(...Q)}});var zg=C(()=>{V31={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}}});function z31($){if(typeof WebGL2RenderingContext<"u"&&$ instanceof WebGL2RenderingContext)return!0;return Boolean($&&Number.isFinite($._version))}var nK=1,kg,sK;var Bg=C(()=>{O1();TD();zg();ZD();KD();kg=class kg extends DZ{type="webgl";constructor(){super();h5.defaultProps={...h5.defaultProps,...fK},p6.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2($){Ag($)}async attach($){if($ instanceof p6)return $;if($?.device instanceof h5)return $.device;if(!z31($))throw Error("Invalid WebGL2RenderingContext");return new p6({_handle:$,createCanvasContext:{canvas:$.canvas,autoResize:!1}})}async create($={}){f.groupCollapsed(nK,"WebGLDevice created")();let Q=[];if($.debugWebGL||$.debug)Q.push(Ix());if($.debugSpectorJS)Q.push(Mx($));let J=await Promise.allSettled(Q);for(let X of J)if(X.status==="rejected")f.error(`Failed to initialize debug libraries ${X.reason}`)();let Z=new p6($),K=`${Z._reused?"Reusing":"Created"} device with WebGL2 ${Z.debug?"debug ":""}context: ${Z.info.vendor}, ${Z.info.renderer} for canvas: ${Z.canvasContext.id}`;return f.probe(nK,K)(),f.table(nK,Z.info)(),f.groupEnd(nK)(),Z}};sK=new kg});var iK=C(()=>{Bg();TD();bK()});function w7(){}class oK{constructor($){if(this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new e5({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=(J)=>{let{_pickRequest:Z}=this;if(J.type==="pointerleave")Z.x=-1,Z.y=-1,Z.radius=0;else if(J.leftButton||J.rightButton)return;else{let K=J.offsetCenter;if(!K)return;Z.x=K.x,Z.y=K.y,Z.radius=this.props.pickingRadius}if(this.layerManager)this.layerManager.context.mousePosition={x:Z.x,y:Z.y};Z.event=J},this._onEvent=(J)=>{let Z=H$[J.type],K=J.offsetCenter;if(!Z||!K||!this.layerManager)return;let X=this.layerManager.getLayers(),Y=this.deckPicker.getLastPickedObject({x:K.x,y:K.y,layers:X,viewports:this.getViewports(K)},this._lastPointerDownInfo),{layer:W}=Y,q=W&&(W[Z]||W.props[Z]),H=this.props[Z],F=!1;if(q)F=q.call(W,Y,J);if(!F)H?.(Y,J),this.widgetManager.onEvent(Y,J)},this._onPointerDown=(J)=>{if(this.device?.type==="webgpu")return;let Z=J.offsetCenter,K=this._pick("pickObject","pickObject Time",{x:Z.x,y:Z.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=K.result[0]||K.emptyInfo},this.props={...Rg,...$},$=this.props,$.viewState&&$.initialViewState)r.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")();if(this.viewState=this.props.initialViewState,$.device)this.device=$.device;let Q=this.device;if(!Q&&$.gl){if($.gl instanceof WebGLRenderingContext)r.error("WebGL1 context not supported.")();Q=sK.attach($.gl)}if(!Q)Q=v9.createDevice({type:"best-available",_reuseDevices:!0,adapters:[sK],...$.deviceProps,createCanvasContext:{canvas:this._createCanvas($),useDevicePixels:this.props.useDevicePixels,autoResize:!1}});if(this.animationLoop=this._createAnimationLoop(Q,$),this.setProps($),$._typedArrayManagerProps)Y6.setOptions($._typedArrayManagerProps);this.animationLoop.start()}finalize(){if(this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas)this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null}setProps($){if(this.stats.get("setProps Time").timeStart(),"onLayerHover"in $)r.removed("onLayerHover","onHover")();if("onLayerClick"in $)r.removed("onLayerClick","onClick")();if($.initialViewState&&!G0(this.props.initialViewState,$.initialViewState,3))this.viewState=$.initialViewState;Object.assign(this.props,$),this._setCanvasSize(this.props);let Q=Object.create(this.props);if(Object.assign(Q,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(Q),this.layerManager)this.viewManager.setProps(Q),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(Q),this.effectManager.setProps(Q),this.deckRenderer.setProps(Q),this.deckPicker.setProps(Q),this.widgetManager.setProps(Q);this.stats.get("setProps Time").timeEnd()}needsRedraw($={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let Q=this._needsRedraw;if($.clearRedrawFlags)this._needsRedraw=!1;let J=this.viewManager.needsRedraw($),Z=this.layerManager.needsRedraw($),K=this.effectManager.needsRedraw($),X=this.deckRenderer.needsRedraw($);return Q=Q||J||Z||K||X,Q}redraw($){if(!this.layerManager)return;let Q=this.needsRedraw({clearRedrawFlags:!0});if(Q=$||Q,!Q)return;if(this.stats.get("Redraw Count").incrementCount(),this.props._customRender)this.props._customRender(Q);else this._drawLayers(Q)}get isInitialized(){return this.viewManager!==null}getViews(){return r1(this.viewManager),this.viewManager.views}getViewports($){return r1(this.viewManager),this.viewManager.getViewports($)}getCanvas(){return this.canvas}pickObject($){let Q=this._pick("pickObject","pickObject Time",$).result;return Q.length?Q[0]:null}pickMultipleObjects($){return $.depth=$.depth||10,this._pick("pickObject","pickMultipleObjects Time",$).result}pickObjects($){return this._pick("pickObjects","pickObjects Time",$)}_addResources($,Q=!1){for(let J in $)this.layerManager.resourceManager.add({resourceId:J,data:$[J],forceUpdate:Q})}_removeResources($){for(let Q of $)this.layerManager.resourceManager.remove(Q)}_addDefaultEffect($){this.effectManager.addDefaultEffect($)}_addDefaultShaderModule($){this.layerManager.addDefaultShaderModule($)}_removeDefaultShaderModule($){this.layerManager?.removeDefaultShaderModule($)}_pick($,Q,J){r1(this.deckPicker);let{stats:Z}=this;Z.get("Pick Count").incrementCount(),Z.get(Q).timeStart();let K=this.deckPicker[$]({layers:this.layerManager.getLayers(J),views:this.viewManager.getViews(),viewports:this.getViewports(J),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...J});return Z.get(Q).timeEnd(),K}_createCanvas($){let Q=$.canvas;if(typeof Q==="string")Q=document.getElementById(Q),r1(Q);if(!Q)Q=document.createElement("canvas"),Q.id=$.id||"deckgl-overlay",($.parent||document.body).appendChild(Q);return Object.assign(Q.style,$.style),Q}_setCanvasSize($){if(!this.canvas)return;let{width:Q,height:J}=$;if(Q||Q===0){let Z=Number.isFinite(Q)?`${Q}px`:Q;this.canvas.style.width=Z}if(J||J===0){let Z=Number.isFinite(J)?`${J}px`:J;this.canvas.style.position=$.style?.position||"absolute",this.canvas.style.height=Z}}_updateCanvasSize(){let{canvas:$}=this;if(!$)return;let Q=$.clientWidth??$.width,J=$.clientHeight??$.height;if(Q!==this.width||J!==this.height)this.width=Q,this.height=J,this.viewManager?.setProps({width:Q,height:J}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:Q,height:J})}_createAnimationLoop($,Q){let{gl:J,onError:Z,useDevicePixels:K}=Q;return new UK({device:$,useDevicePixels:K,autoResizeDrawingBuffer:!J,autoResizeViewport:!1,onInitialize:(X)=>this._setDevice(X.device),onRender:this._onRenderFrame.bind(this),onError:Z})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:$}=this.props,Q=Array.isArray($)?$:$?[$]:[new b_({id:"default-view"})];if(Q.length&&this.props.controller)Q[0].props.controller=this.props.controller;return Q}_onContextLost(){let{onError:$}=this.props;if(this.animationLoop&&$)$(Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;let{_pickRequest:$}=this;if($.event){let{result:Q,emptyInfo:J}=this._pick("pickObject","pickObject Time",$);this.cursorState.isHovering=Q.length>0;let Z=J,K=!1;for(let X of Q)Z=X,K=X.layer?.onHover(X,$.event)||K;if(!K)this.props.onHover?.(Z,$.event),this.widgetManager.onHover(Z,$.event);$.event=null}}_updateCursor(){let $=this.props.parent||this.canvas;if($)$.style.cursor=this.props.getCursor(this.cursorState)}_setDevice($){if(this.device=$,!this.animationLoop)return;if(!this.canvas)this.canvas=this.device.canvasContext?.canvas;if(this.device.type==="webgl")this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515});if(this.props.onDeviceInitialized(this.device),this.device.type==="webgl")this.props.onWebGLInitialized(this.device.gl);let Q=new J3;Q.play(),this.animationLoop.attachTimeline(Q),this.eventManager=new rZ(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(UN).map((Z)=>{let[K,X,Y,W]=UN[Z],q=this.props.eventRecognizerOptions?.[Z],H={...X,...q,event:Z};return{recognizer:new K(H),recognizeWith:Y,requestFailure:W}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let Z in H$)this.eventManager.on(Z,this._onEvent);this.viewManager=new RK({timeline:Q,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let J=this.viewManager.getViewports()[0];this.layerManager=new BK(this.device,{deck:this,stats:this.stats,viewport:J,timeline:Q}),this.effectManager=new IK({deck:this,device:this.device}),this.deckRenderer=new EK(this.device),this.deckPicker=new jK(this.device),this.widgetManager=new iN({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new hK),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers($,Q){let{device:J,gl:Z}=this.layerManager.context;this.props.onBeforeRender({device:J,gl:Z});let K={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...Q};if(this.deckRenderer?.renderLayers(K),K.pass==="screen")this.widgetManager.onRedraw({viewports:K.viewports,layers:K.layers});this.props.onAfterRender({device:J,gl:Z})}_onRenderFrame(){if(this._getFrameStats(),this._metricsCounter++%60===0){if(this._getMetrics(),this.stats.reset(),r.table(4,this.metrics)(),this.props._onMetrics)this.props._onMetrics(this.metrics)}if(this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu")this._pickAndCallback();if(this.redraw(),this.viewManager)this.viewManager.updateViewStates()}_onViewStateChange($){let Q=this.props.onViewStateChange($)||$.viewState;if(this.viewState){if(this.viewState={...this.viewState,[$.viewId]:Q},!this.props.viewState){if(this.viewManager)this.viewManager.setProps({viewState:this.viewState})}}}_onInteractionStateChange($){this.cursorState.isDragging=$.isDragging||!1,this.props.onInteractionStateChange($)}_getFrameStats(){let{stats:$}=this;$.get("frameRate").timeEnd(),$.get("frameRate").timeStart();let Q=this.animationLoop.stats;$.get("GPU Time").addTime(Q.get("GPU Time").lastTiming),$.get("CPU Time").addTime(Q.get("CPU Time").lastTiming)}_getMetrics(){let{metrics:$,stats:Q}=this;$.fps=Q.get("frameRate").getHz(),$.setPropsTime=Q.get("setProps Time").time,$.updateAttributesTime=Q.get("Update Attributes").time,$.framesRedrawn=Q.get("Redraw Count").count,$.pickTime=Q.get("pickObject Time").time+Q.get("pickMultipleObjects Time").time+Q.get("pickObjects Time").time,$.pickCount=Q.get("Pick Count").count,$.gpuTime=Q.get("GPU Time").time,$.cpuTime=Q.get("CPU Time").time,$.gpuTimePerFrame=Q.get("GPU Time").getAverageTime(),$.cpuTimePerFrame=Q.get("CPU Time").getAverageTime();let J=v9.stats.get("Memory Usage");$.bufferMemory=J.get("Buffer Memory").count,$.textureMemory=J.get("Texture Memory").count,$.renderbufferMemory=J.get("Renderbuffer Memory").count,$.gpuMemory=J.get("GPU Memory").count}}var k31=({isDragging:$})=>$?"grabbing":"grab",Rg,ID;var Og=C(()=>{E_();j_();m_();c_();l_();s_();r_();a_();T0();e9();dE();O1();iK();V5();V5();R2();FN();Z6();Rg={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:w7,onWebGLInitialized:w7,onResize:w7,onViewStateChange:w7,onInteractionStateChange:w7,onBeforeRender:w7,onAfterRender:w7,onLoad:w7,onError:($)=>r.error($.message,$.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:k31,getTooltip:null,debug:!1,drawPickingColors:!1};oK.defaultProps=Rg;oK.VERSION=cE;ID=oK});function Pg($){switch($){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return c2($)}}function w$($,Q,J){let Z=J==="webgpu"&&Q.type==="uint8"?"unorm8":Q.type;return{attribute:$,format:Q.size>1?`${Z}x${Q.size}`:Q.type,byteOffset:Q.offset||0}}function S7($){return $.stride||$.size*$.bytesPerElement}function wg($,Q){return $.type===Q.type&&$.size===Q.size&&S7($)===S7(Q)&&($.offset||0)===(Q.offset||0)}var Mg;var GD=C(()=>{O1();Mg=kZ});function ED($,Q){if(Q.offset)r.removed("shaderAttribute.offset","vertexOffset, elementOffset")();let J=S7($),Z=Q.vertexOffset!==void 0?Q.vertexOffset:$.vertexOffset||0,K=Q.elementOffset||0,X=Z*J+K*$.bytesPerElement+($.offset||0);return{...Q,offset:X,stride:J}}function B31($,Q){let J=ED($,Q);return{high:J,low:{...J,offset:J.offset+$.size*4}}}class rK{constructor($,Q,J){this._buffer=null,this.device=$,this.id=Q.id||"",this.size=Q.size||1;let Z=Q.logicalType||Q.type,K=Z==="float64",{defaultValue:X}=Q;X=Number.isFinite(X)?[X]:X||Array(this.size).fill(0);let Y;if(K)Y="float32";else if(!Z&&Q.isIndexed)Y="uint32";else Y=Z||"float32";let W=Pg(Z||Y);if(this.doublePrecision=K,K&&Q.fp64===!1)W=Float32Array;this.value=null,this.settings={...Q,defaultType:W,defaultValue:X,logicalType:Z,type:Y,normalized:Y.includes("norm"),size:this.size,bytesPerElement:W.BYTES_PER_ELEMENT},this.state={...J,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let $=this.getAccessor();if($.vertexOffset)return $.vertexOffset*S7($);return 0}get numInstances(){return this.state.numInstances}set numInstances($){this.state.numInstances=$}delete(){if(this._buffer)this._buffer.delete(),this._buffer=null;Y6.release(this.state.allocatedValue)}getBuffer(){if(this.state.constant)return null;return this.state.externalBuffer||this._buffer}getValue($=this.id,Q=null){let J={};if(this.state.constant){let Z=this.value;if(Q){let K=ED(this.getAccessor(),Q),X=K.offset/Z.BYTES_PER_ELEMENT,Y=K.size||this.size;J[$]=Z.subarray(X,X+Y)}else J[$]=Z}else J[$]=this.getBuffer();if(this.doublePrecision)if(this.value instanceof Float64Array)J[`${$}64Low`]=J[$];else J[`${$}64Low`]=new Float32Array(this.size);return J}_getBufferLayout($=this.id,Q=null){let J=this.getAccessor(),Z=[],K={name:this.id,byteStride:S7(J),attributes:Z};if(this.doublePrecision){let X=B31(J,Q||{});Z.push(w$($,{...J,...X.high},this.device.type),w$(`${$}64Low`,{...J,...X.low},this.device.type))}else if(Q){let X=ED(J,Q);Z.push(w$($,{...J,...X},this.device.type))}else Z.push(w$($,J,this.device.type));return K}setAccessor($){this.state.bufferAccessor=$}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let $=null;if(this.state.constant&&this.value){let Q=Array.from(this.value);$=[Q,Q]}else{let{value:Q,numInstances:J,size:Z}=this,K=J*Z;if(Q&&K&&Q.length>=K){let X=Array(Z).fill(1/0),Y=Array(Z).fill(-1/0);for(let W=0;W<K;)for(let q=0;q<Z;q++){let H=Q[W++];if(H<X[q])X[q]=H;if(H>Y[q])Y[q]=H}$=[X,Y]}}return this.state.bounds=$,$}setData($){let{state:Q}=this,J;if(ArrayBuffer.isView($))J={value:$};else if($ instanceof M1)J={buffer:$};else J=$;let Z={...this.settings,...J};if(ArrayBuffer.isView(J.value)){if(!J.type)if(this.doublePrecision&&J.value instanceof Float64Array)Z.type="float32";else{let X=Mg(J.value);Z.type=Z.normalized?X.replace("int","norm"):X}Z.bytesPerElement=J.value.BYTES_PER_ELEMENT,Z.stride=S7(Z)}if(Q.bounds=null,J.constant){let K=J.value;if(K=this._normalizeValue(K,[],0),this.settings.normalized)K=this.normalizeConstant(K);if(!(!Q.constant||!this._areValuesEqual(K,this.value)))return!1;Q.externalBuffer=null,Q.constant=!0,this.value=ArrayBuffer.isView(K)?K:new Float32Array(K)}else if(J.buffer){let K=J.buffer;Q.externalBuffer=K,Q.constant=!1,this.value=J.value||null}else if(J.value){this._checkExternalBuffer(J);let K=J.value;Q.externalBuffer=null,Q.constant=!1,this.value=K;let{buffer:X}=this,Y=S7(Z),W=(Z.vertexOffset||0)*Y;if(this.doublePrecision&&K instanceof Float64Array)K=YK(K,Z);if(this.settings.isIndexed){let H=this.settings.defaultType;if(K.constructor!==H)K=new H(K)}let q=K.byteLength+W+Y*2;if(!X||X.byteLength<q)X=this._createBuffer(q);X.write(K,W)}return this.setAccessor(Z),!0}updateSubBuffer($={}){this.state.bounds=null;let Q=this.value,{startOffset:J=0,endOffset:Z}=$;this.buffer.write(this.doublePrecision&&Q instanceof Float64Array?YK(Q,{size:this.size,startIndex:J,endIndex:Z}):Q.subarray(J,Z),J*Q.BYTES_PER_ELEMENT+this.byteOffset)}allocate($,Q=!1){let{state:J}=this,Z=J.allocatedValue,K=Y6.allocate(Z,$+1,{size:this.size,type:this.settings.defaultType,copy:Q});this.value=K;let{byteOffset:X}=this,{buffer:Y}=this;if(!Y||Y.byteLength<K.byteLength+X){if(Y=this._createBuffer(K.byteLength+X),Q&&Z)Y.write(Z instanceof Float64Array?YK(Z,this):Z,X)}return J.allocatedValue=K,J.constant=!1,J.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer($){let{value:Q}=$;if(!ArrayBuffer.isView(Q))throw Error(`Attribute ${this.id} value is not TypedArray`);let J=this.settings.defaultType,Z=!1;if(this.doublePrecision)Z=Q.BYTES_PER_ELEMENT<4;if(Z)throw Error(`Attribute ${this.id} does not support ${Q.constructor.name}`);if(!(Q instanceof J)&&this.settings.normalized&&!("normalized"in $))r.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant($){switch(this.settings.type){case"snorm8":return new Float32Array($).map((Q)=>(Q+128)/255*2-1);case"snorm16":return new Float32Array($).map((Q)=>(Q+32768)/65535*2-1);case"unorm8":return new Float32Array($).map((Q)=>Q/255);case"unorm16":return new Float32Array($).map((Q)=>Q/65535);default:return $}}_normalizeValue($,Q,J){let{defaultValue:Z,size:K}=this.settings;if(Number.isFinite($))return Q[J]=$,Q;if(!$){let X=K;while(--X>=0)Q[J+X]=Z[X];return Q}switch(K){case 4:Q[J+3]=Number.isFinite($[3])?$[3]:Z[3];case 3:Q[J+2]=Number.isFinite($[2])?$[2]:Z[2];case 2:Q[J+1]=Number.isFinite($[1])?$[1]:Z[1];case 1:Q[J+0]=Number.isFinite($[0])?$[0]:Z[0];break;default:let X=K;while(--X>=0)Q[J+X]=Number.isFinite($[X])?$[X]:Z[X]}return Q}_areValuesEqual($,Q){if(!$||!Q)return!1;let{size:J}=this;for(let Z=0;Z<J;Z++)if($[Z]!==Q[Z])return!1;return!0}_createBuffer($){if(this._buffer)this._buffer.destroy();let{isIndexed:Q,type:J}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(Q?M1.INDEX:M1.VERTEX)|M1.COPY_DST,indexType:Q?J:void 0,byteLength:$}),this._buffer}}var Sg=C(()=>{O1();GD();e9();WK();T0()});function M4($,Q=0,J=1/0){let Z=Tg,K={index:-1,data:$,target:[]};if(!$)Z=Tg;else if(typeof $[Symbol.iterator]==="function")Z=$;else if($.length>0)Ig.length=$.length,Z=Ig;if(Q>0||Number.isFinite(J))Z=(Array.isArray(Z)?Z:Array.from(Z)).slice(Q,J),K.index=Q-1;return{iterable:Z,objectInfo:K}}function aK($){return $&&$[Symbol.asyncIterator]}function tK($,Q){let{size:J,stride:Z,offset:K,startIndices:X,nested:Y}=Q,W=$.BYTES_PER_ELEMENT,q=Z?Z/W:J,H=K?K/W:0,F=Math.floor(($.length-H)/q);return(U,{index:V,target:N})=>{if(!X){let M=V*q+H;for(let P=0;P<J;P++)N[P]=$[M+P];return N}let D=X[V],z=X[V+1]||F,B;if(Y){B=Array(z-D);for(let M=D;M<z;M++){let P=M*q+H;N=Array(J);for(let O=0;O<J;O++)N[O]=$[P+O];B[M-D]=N}}else if(q===J)B=$.subarray(D*J+H,z*J+H);else{B=new $.constructor((z-D)*J);let M=0;for(let P=D;P<z;P++){let O=P*q+H;for(let G=0;G<J;G++)B[M++]=$[O+G]}}return B}}var Tg,Ig;var V3=C(()=>{Tg=[],Ig=[]});function Eg($,Q){if($===S$)return $;if(Q[0]<0)Q[0]=0;if(Q[0]>=Q[1])return $;let J=[],Z=$.length,K=0;for(let X=0;X<Z;X++){let Y=$[X];if(Y[1]<Q[0])J.push(Y),K=X+1;else if(Y[0]>Q[1])J.push(Y);else Q=[Math.min(Y[0],Q[0]),Math.max(Y[1],Q[1])]}return J.splice(K,0,Q),J}var Gg,S$;var jg=C(()=>{Gg=[],S$=[[0,1/0]]});function eK($,Q){if(!$)return null;if(Number.isFinite($))$={type:"interpolation",duration:$};let J=$.type||"interpolation";return{...O31[J],...Q,...$,type:J}}var O31;var jD=C(()=>{O31={interpolation:{duration:0,easing:($)=>$},spring:{stiffness:0.05,damping:0.5}}});var N3;var hD=C(()=>{Sg();V3();jg();GD();jD();N3=class N3 extends rK{constructor($,Q){super($,Q,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:S$});this.constant=!1,this.settings.update=Q.update||(Q.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices($){this.state.startIndices=$}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:$=!1}={}){let Q=this.state.needsRedraw;return this.state.needsRedraw=Q&&!$,Q}layoutChanged(){return this.state.layoutChanged}setAccessor($){var Q;(Q=this.state).layoutChanged||(Q.layoutChanged=!wg($,this.getAccessor())),super.setAccessor($)}getUpdateTriggers(){let{accessor:$}=this.settings;return[this.id].concat(typeof $!=="function"&&$||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting($){if(!$||!this.supportsTransition())return null;let{accessor:Q}=this.settings,J=this.settings.transition,Z=Array.isArray(Q)?$[Q.find((K)=>$[K])]:$[Q];return eK(Z,J)}setNeedsUpdate($=this.id,Q){if(this.state.needsUpdate=this.state.needsUpdate||$,this.setNeedsRedraw($),Q){let{startRow:J=0,endRow:Z=1/0}=Q;this.state.updateRanges=Eg(this.state.updateRanges,[J,Z])}else this.state.updateRanges=S$}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Gg}setNeedsRedraw($=this.id){this.state.needsRedraw=this.state.needsRedraw||$}allocate($){let{state:Q,settings:J}=this;if(J.noAlloc)return!1;if(J.update)return super.allocate($,Q.updateRanges!==S$),!0;return!1}updateBuffer({numInstances:$,data:Q,props:J,context:Z}){if(!this.needsUpdate())return!1;let{state:{updateRanges:K},settings:{update:X,noAlloc:Y}}=this,W=!0;if(X){for(let[q,H]of K)X.call(Z,this,{data:Q,startRow:q,endRow:H,props:J,numInstances:$});if(!this.value);else if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[q,H]of K){let F=Number.isFinite(q)?this.getVertexOffset(q):0,U=Number.isFinite(H)?this.getVertexOffset(H):Y||!Number.isFinite($)?this.value.length:$*this.size;super.updateSubBuffer({startOffset:F,endOffset:U})}this._checkAttributeArray()}else W=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),W}setConstantValue($){if(this.device.type==="webgpu"||$===void 0||typeof $==="function")return!1;if(this.setData({constant:!0,value:$}))this.setNeedsRedraw();return this.clearNeedsUpdate(),!0}setExternalBuffer($){let{state:Q}=this;if(!$)return Q.lastExternalBuffer=null,!1;if(this.clearNeedsUpdate(),Q.lastExternalBuffer===$)return!0;return Q.lastExternalBuffer=$,this.setNeedsRedraw(),this.setData($),!0}setBinaryValue($,Q=null){let{state:J,settings:Z}=this;if(!$)return J.binaryValue=null,J.binaryAccessor=null,!1;if(Z.noAlloc)return!1;if(J.binaryValue===$)return this.clearNeedsUpdate(),!0;if(J.binaryValue=$,this.setNeedsRedraw(),Z.transform||Q!==this.startIndices){if(ArrayBuffer.isView($))$={value:$};let X=$;r1(ArrayBuffer.isView(X.value),`invalid ${Z.accessor}`);let Y=Boolean(X.size)&&X.size!==this.size;return J.binaryAccessor=tK(X.value,{size:X.size||this.size,stride:X.stride,offset:X.offset,startIndices:Q,nested:Y}),!1}return this.clearNeedsUpdate(),this.setData($),!0}getVertexOffset($){let{startIndices:Q}=this;return(Q?$<Q.length?Q[$]:this.numInstances:$)*this.size}getValue(){let $=this.settings.shaderAttributes,Q=super.getValue();if(!$)return Q;for(let J in $)Object.assign(Q,super.getValue(J,$[J]));return Q}getBufferLayout($){this.state.layoutChanged=!1;let Q=this.settings.shaderAttributes,J=super._getBufferLayout(),{stepMode:Z}=this.settings;if(Z==="dynamic")J.stepMode=$?$.isInstanced?"instance":"vertex":"instance";else J.stepMode=Z??"vertex";if(!Q)return J;for(let K in Q){let X=super._getBufferLayout(K,Q[K]);J.attributes.push(...X.attributes)}return J}_autoUpdater($,{data:Q,startRow:J,endRow:Z,props:K,numInstances:X}){if($.constant){if(this.context.device.type!=="webgpu")return}let{settings:Y,state:W,value:q,size:H,startIndices:F}=$,{accessor:U,transform:V}=Y,N=W.binaryAccessor||(typeof U==="function"?U:K[U]);if(typeof N!=="function")N=()=>N;r1(typeof N==="function",`accessor "${U}" is not a function`);let D=$.getVertexOffset(J),{iterable:z,objectInfo:B}=M4(Q,J,Z);for(let M of z){B.index++;let P=N(M,B);if(V)P=V.call(this,P);if(F){let O=(B.index<F.length-1?F[B.index+1]:X)-F[B.index];if(P&&Array.isArray(P[0])){let G=D;for(let L of P)$._normalizeValue(L,q,G),G+=H}else if(P&&P.length>H)q.set(P,D);else $._normalizeValue(P,B.target,0),T_({target:q,source:B.target,start:D,count:O});D+=O*H}else $._normalizeValue(P,q,D),D+=H}}_validateAttributeUpdaters(){let{settings:$}=this;if(!($.noAlloc||typeof $.update==="function"))throw Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:$}=this,Q=Math.min(4,this.size);if($&&$.length>=Q){let J=!0;switch(Q){case 4:J=J&&Number.isFinite($[3]);case 3:J=J&&Number.isFinite($[2]);case 2:J=J&&Number.isFinite($[1]);case 1:J=J&&Number.isFinite($[0]);break;default:J=!1}if(!J)throw Error(`Illegal attribute generated for ${this.id}`)}}}});function LD($){let{source:Q,target:J,start:Z=0,size:K,getData:X}=$,Y=$.end||J.length,W=Q.length,q=Y-Z;if(W>q){J.set(Q.subarray(0,q),Z);return}if(J.set(Q,Z),!X)return;let H=W;while(H<q){let F=X(H,Q);for(let U=0;U<K;U++)J[Z+H]=F[U]||0,H++}}function hg({source:$,target:Q,size:J,getData:Z,sourceStartIndices:K,targetStartIndices:X}){if(!K||!X)return LD({source:$,target:Q,size:J,getData:Z}),Q;let Y=0,W=0,q=Z&&((F,U)=>Z(F+W,U)),H=Math.min(K.length,X.length);for(let F=1;F<H;F++){let U=K[F]*J,V=X[F]*J;LD({source:$.subarray(Y,U),target:Q,start:W,end:V,size:J,getData:q}),Y=U,W=V}if(W<Q.length)LD({source:[],target:Q,start:W,size:J,getData:q});return Q}function Lg($){let{device:Q,settings:J,value:Z}=$,K=new N3(Q,J);return K.setData({value:Z instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:J.normalized}),K}function $X($){switch($){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw Error(`No defined attribute type for size "${$}"`)}}function QX($){switch($){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw Error("invalid type size")}}function JX($){$.push($.shift())}function vg($,Q){let{doublePrecision:J,settings:Z,value:K,size:X}=$,Y=J&&K instanceof Float64Array?2:1,W=0,{shaderAttributes:q}=$.settings;if(q)for(let H of Object.values(q))W=Math.max(W,H.vertexOffset??0);return(Z.noAlloc?K.length:(Q+W)*X)*Y}function ZX({device:$,source:Q,target:J}){if(!J||J.byteLength<Q.byteLength)J?.destroy(),J=$.createBuffer({byteLength:Q.byteLength,usage:Q.usage});return J}function KX({device:$,buffer:Q,attribute:J,fromLength:Z,toLength:K,fromStartIndices:X,getData:Y=(W)=>W}){let W=J.doublePrecision&&J.value instanceof Float64Array?2:1,q=J.size*W,H=J.byteOffset,F=J.settings.bytesPerElement<4?H/J.settings.bytesPerElement*4:H,U=J.startIndices,V=X&&U,N=J.isConstant;if(!V&&Q&&Z>=K)return Q;let D=J.value instanceof Float64Array?Float32Array:J.value.constructor,z=N?J.value:new D(J.getBuffer().readSyncWebGL(H,K*D.BYTES_PER_ELEMENT).buffer);if(J.settings.normalized&&!N){let O=Y;Y=(G,L)=>J.normalizeConstant(O(G,L))}let B=N?(O,G)=>Y(z,G):(O,G)=>Y(z.subarray(O+H,O+H+q),G),M=Q?new Float32Array(Q.readSyncWebGL(F,Z*4).buffer):new Float32Array(0),P=new Float32Array(K);if(hg({source:M,target:P,sourceStartIndices:X,targetStartIndices:U,size:q,getData:B}),!Q||Q.byteLength<P.byteLength+F)Q?.destroy(),Q=$.createBuffer({byteLength:P.byteLength+F,usage:35050});return Q.write(P,F),Q}var XX=C(()=>{hD()});class T${constructor({device:$,attribute:Q,timeline:J}){this.buffers=[],this.currentLength=0,this.device=$,this.transition=new b6(J),this.attribute=Q,this.attributeInTransition=Lg(Q),this.currentStartIndices=Q.startIndices}get inProgress(){return this.transition.inProgress}start($,Q,J=1/0){this.settings=$,this.currentStartIndices=this.attribute.startIndices,this.currentLength=vg(this.attribute,Q),this.transition.start({...$,duration:J})}update(){let $=this.transition.update();if($)this.onUpdate();return $}setBuffer($){this.attributeInTransition.setData({buffer:$,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let $ of this.buffers)$.destroy();this.buffers.length=0}}var vD=C(()=>{XX()});function xg($){return $.doublePrecision&&$.value instanceof Float64Array}function S31($,Q){let J=Q.size,Z=$X(J),K=QX(J),X=Q.getBufferLayout();if(xg(Q))return new C4($,{vs:w31,bufferLayout:[{name:"aFrom",byteStride:8*J,attributes:[{attribute:"aFrom",format:K,byteOffset:0},{attribute:"aFrom64Low",format:K,byteOffset:4*J}]},{name:"aTo",byteStride:8*J,attributes:[{attribute:"aTo",format:K,byteOffset:0},{attribute:"aTo64Low",format:K,byteOffset:4*J}]}],modules:[mV,_g],defines:{ATTRIBUTE_TYPE:Z,ATTRIBUTE_SIZE:J},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0});return new C4($,{vs:M31,bufferLayout:[{name:"aFrom",format:K},{name:"aTo",format:X.attributes[0].format}],modules:[_g],defines:{ATTRIBUTE_TYPE:Z},varyings:["vCurrent"],disableWarnings:!0})}var YX,P31=`uniform interpolationUniforms {
  float time;
} interpolation;
`,_g,M31=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,w31=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;var gg=C(()=>{V5();V4();XX();vD();YX=class YX extends T${constructor({device:$,attribute:Q,timeline:J}){super({device:$,attribute:Q,timeline:J});this.type="interpolation",this.transform=S31($,Q)}start($,Q){let J=this.currentLength,Z=this.currentStartIndices;if(super.start($,Q,$.duration),$.duration<=0){this.transition.cancel();return}let{buffers:K,attribute:X}=this;JX(K),K[0]=KX({device:this.device,buffer:K[0],attribute:X,fromLength:J,toLength:this.currentLength,fromStartIndices:Z,getData:$.enter}),K[1]=ZX({device:this.device,source:K[0],target:K[1]}),this.setBuffer(K[1]);let{transform:Y}=this,W=Y.model,q=Math.floor(this.currentLength/X.size);if(xg(X))q/=2;if(W.setVertexCount(q),X.isConstant)W.setAttributes({aFrom:K[0]}),W.setConstantAttributes({aTo:X.value});else W.setAttributes({aFrom:K[0],aTo:X.getBuffer()});Y.transformFeedback.setBuffers({vCurrent:K[1]})}onUpdate(){let{duration:$,easing:Q}=this.settings,{time:J}=this.transition,Z=J/$;if(Q)Z=Q(Z);let{model:K}=this.transform,X={time:Z};K.shaderInputs.setProps({interpolation:X}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}};_g={name:"interpolation",vs:P31,uniformTypes:{time:"f32"}}});function j31($,Q){let J=$X(Q.size),Z=QX(Q.size);return new C4($,{vs:G31,fs:E31,bufferLayout:[{name:"aPrev",format:Z},{name:"aCur",format:Z},{name:"aTo",format:Q.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[I31],defines:{ATTRIBUTE_TYPE:J},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function h31($){return $.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function L31($,Q){return $.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[Q]})}var WX,T31=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,I31,G31=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,E31=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;var yg=C(()=>{V5();XX();vD();WX=class WX extends T${constructor({device:$,attribute:Q,timeline:J}){super({device:$,attribute:Q,timeline:J});this.type="spring",this.texture=h31($),this.framebuffer=L31($,this.texture),this.transform=j31($,Q)}start($,Q){let J=this.currentLength,Z=this.currentStartIndices;super.start($,Q);let{buffers:K,attribute:X}=this;for(let W=0;W<2;W++)K[W]=KX({device:this.device,buffer:K[W],attribute:X,fromLength:J,toLength:this.currentLength,fromStartIndices:Z,getData:$.enter});K[2]=ZX({device:this.device,source:K[0],target:K[2]}),this.setBuffer(K[1]);let{model:Y}=this.transform;if(Y.setVertexCount(Math.floor(this.currentLength/X.size)),X.isConstant)Y.setConstantAttributes({aTo:X.value});else Y.setAttributes({aTo:X.getBuffer()})}onUpdate(){let{buffers:$,transform:Q,framebuffer:J,transition:Z}=this,K=this.settings;Q.model.setAttributes({aPrev:$[0],aCur:$[1]}),Q.transformFeedback.setBuffers({vNext:$[2]});let X={stiffness:K.stiffness,damping:K.damping};if(Q.model.shaderInputs.setProps({spring:X}),Q.run({framebuffer:J,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),JX($),this.setBuffer($[1]),!(this.device.readPixelsToArrayWebGL(J)[0]>0))Z.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}};I31={name:"spring",vs:T31,uniformTypes:{damping:"f32",stiffness:"f32"}}});class qX{constructor($,{id:Q,timeline:J}){if(!$)throw Error("AttributeTransitionManager is constructed without device");this.id=Q,this.device=$,this.timeline=J,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let $ in this.transitions)this._removeTransition($)}update({attributes:$,transitions:Q,numInstances:J}){this.numInstances=J||1;for(let Z in $){let K=$[Z],X=K.getTransitionSetting(Q);if(!X)continue;this._updateAttribute(Z,K,X)}for(let Z in this.transitions){let K=$[Z];if(!K||!K.getTransitionSetting(Q))this._removeTransition(Z)}}hasAttribute($){let Q=this.transitions[$];return Q&&Q.inProgress}getAttributes(){let $={};for(let Q in this.transitions){let J=this.transitions[Q];if(J.inProgress)$[Q]=J.attributeInTransition}return $}run(){if(this.numInstances===0)return!1;for(let Q in this.transitions)if(this.transitions[Q].update())this.needsRedraw=!0;let $=this.needsRedraw;return this.needsRedraw=!1,$}_removeTransition($){this.transitions[$].delete(),delete this.transitions[$]}_updateAttribute($,Q,J){let Z=this.transitions[$],K=!Z||Z.type!==J.type;if(K){if(Z)this._removeTransition($);let X=v31[J.type];if(X)this.transitions[$]=new X({attribute:Q,timeline:this.timeline,device:this.device});else r.error(`unsupported transition type '${J.type}'`)(),K=!1}if(K||Q.needsRedraw())this.needsRedraw=!0,this.transitions[$].start(J,this.numInstances)}}var v31;var fg=C(()=>{gg();yg();T0();v31={interpolation:YX,spring:WX}});class HX{constructor($,{id:Q="attribute-manager",stats:J,timeline:Z}={}){this.mergeBoundsMemoized=y6(Z_),this.id=Q,this.device=$,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=J,this.attributeTransitionManager=new qX($,{id:`${Q}-transitions`,timeline:Z}),Object.seal(this)}finalize(){for(let $ in this.attributes)this.attributes[$].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw($={clearRedrawFlags:!1}){let Q=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!$.clearRedrawFlags,Q&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add($){this._add($)}addInstanced($){this._add($,{stepMode:"instance"})}remove($){for(let Q of $)if(this.attributes[Q]!==void 0)this.attributes[Q].delete(),delete this.attributes[Q]}invalidate($,Q){let J=this._invalidateTrigger($,Q);X0(bg,this,$,J)}invalidateAll($){for(let Q in this.attributes)this.attributes[Q].setNeedsUpdate(Q,$);X0(bg,this,"all")}update({data:$,numInstances:Q,startIndices:J=null,transitions:Z,props:K={},buffers:X={},context:Y={}}){let W=!1;if(X0(_31,this),this.stats)this.stats.get("Update Attributes").timeStart();for(let q in this.attributes){let H=this.attributes[q],F=H.settings.accessor;if(H.startIndices=J,H.numInstances=Q,K[q])r.removed(`props.${q}`,`data.attributes.${q}`)();if(H.setExternalBuffer(X[q]));else if(H.setBinaryValue(typeof F==="string"?X[F]:void 0,$.startIndices));else if(typeof F==="string"&&!X[F]&&H.setConstantValue(K[F]));else if(H.needsUpdate())W=!0,this._updateAttribute({attribute:H,numInstances:Q,data:$,props:K,context:Y});this.needsRedraw=this.needsRedraw||H.needsRedraw()}if(W)X0(x31,this,Q);if(this.stats)this.stats.get("Update Attributes").timeEnd();this.attributeTransitionManager.update({attributes:this.attributes,numInstances:Q,transitions:Z})}updateTransition(){let{attributeTransitionManager:$}=this,Q=$.run();return this.needsRedraw=this.needsRedraw||Q,Q}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds($){let Q=$.map((J)=>this.attributes[J]?.getBounds());return this.mergeBoundsMemoized(Q)}getChangedAttributes($={clearChangedFlags:!1}){let{attributes:Q,attributeTransitionManager:J}=this,Z={...J.getAttributes()};for(let K in Q){let X=Q[K];if(X.needsRedraw($)&&!J.hasAttribute(K))Z[K]=X}return Z}getBufferLayouts($){return Object.values(this.getAttributes()).map((Q)=>Q.getBufferLayout($))}_add($,Q){for(let J in $){let Z=$[J],K={...Z,id:J,size:Z.isIndexed&&1||Z.size||1,...Q};this.attributes[J]=new N3(this.device,K)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let $={};for(let Q in this.attributes)this.attributes[Q].getUpdateTriggers().forEach((Z)=>{if(!$[Z])$[Z]=[];$[Z].push(Q)});this.updateTriggers=$}_invalidateTrigger($,Q){let{attributes:J,updateTriggers:Z}=this,K=Z[$];if(K)K.forEach((X)=>{let Y=J[X];if(Y)Y.setNeedsUpdate(Y.id,Q)});return K}_updateAttribute($){let{attribute:Q,numInstances:J}=$;if(X0(g31,Q),Q.constant){Q.setConstantValue(Q.value);return}if(Q.allocate(J))X0(y31,Q,J);if(Q.updateBuffer($))this.needsRedraw=!0,X0(f31,Q,J)}}var bg="attributeManager.invalidate",_31="attributeManager.updateStart",x31="attributeManager.updateEnd",g31="attribute.updateStart",y31="attribute.allocate",f31="attribute.updateEnd";var mg=C(()=>{hD();T0();WK();N8();fg()});var FX;var cg=C(()=>{g0();FX=class FX extends b6{get value(){return this._value}_onUpdate(){let{time:$,settings:{fromValue:Q,toValue:J,duration:Z,easing:K}}=this,X=K($/Z);this._value=B8(Q,J,X)}}});function lg($,Q,J,Z,K){let X=Q-$,W=(J-Q)*K,q=-X*Z;return W+q+X+Q}function b31($,Q,J,Z,K){if(Array.isArray(J)){let X=[];for(let Y=0;Y<J.length;Y++)X[Y]=lg($[Y],Q[Y],J[Y],Z,K);return X}return lg($,Q,J,Z,K)}function pg($,Q){if(Array.isArray($)){let J=0;for(let Z=0;Z<$.length;Z++){let K=$[Z]-Q[Z];J+=K*K}return Math.sqrt(J)}return Math.abs($-Q)}var dg=0.00001,UX;var ug=C(()=>{UX=class UX extends b6{get value(){return this._currValue}_onUpdate(){let{fromValue:$,toValue:Q,damping:J,stiffness:Z}=this.settings,{_prevValue:K=$,_currValue:X=$}=this,Y=b31(K,X,Q,J,Z),W=pg(Y,Q),q=pg(Y,X);if(W<dg&&q<dg)Y=Q,this.end();this._prevValue=X,this._currValue=Y}}});class VX{constructor($){this.transitions=new Map,this.timeline=$}get active(){return this.transitions.size>0}add($,Q,J,Z){let{transitions:K}=this;if(K.has($)){let W=K.get($),{value:q=W.settings.fromValue}=W;Q=q,this.remove($)}if(Z=eK(Z),!Z)return;let X=m31[Z.type];if(!X){r.error(`unsupported transition type '${Z.type}'`)();return}let Y=new X(this.timeline);Y.start({...Z,fromValue:Q,toValue:J}),K.set($,Y)}remove($){let{transitions:Q}=this;if(Q.has($))Q.get($).cancel(),Q.delete($)}update(){let $={};for(let[Q,J]of this.transitions)if(J.update(),$[Q]=J.value,!J.inProgress)this.remove(Q);return $}clear(){for(let $ of this.transitions.keys())this.remove($)}}var m31;var ig=C(()=>{jD();cg();ug();T0();m31={interpolation:FX,spring:UX}});function sg($){let Q=$[N5];for(let J in Q){let Z=Q[J],{validate:K}=Z;if(K&&!K($[J],Z))throw Error(`Invalid prop ${J}: ${$[J]}`)}}function og($,Q){let J=rg({newProps:$,oldProps:Q,propTypes:$[N5],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),Z=d31($,Q),K=!1;if(!Z)K=l31($,Q);return{dataChanged:Z,propsChanged:J,updateTriggersChanged:K,extensionsChanged:p31($,Q),transitionsChanged:c31($,Q)}}function c31($,Q){if(!$.transitions)return!1;let J={},Z=$[N5],K=!1;for(let X in $.transitions){let Y=Z[X],W=Y&&Y.type;if((W==="number"||W==="color"||W==="array")&&_D($[X],Q[X],Y))J[X]=!0,K=!0}return K?J:!1}function rg({newProps:$,oldProps:Q,ignoreProps:J={},propTypes:Z={},triggerName:K="props"}){if(Q===$)return!1;if(typeof $!=="object"||$===null)return`${K} changed shallowly`;if(typeof Q!=="object"||Q===null)return`${K} changed shallowly`;for(let X of Object.keys($))if(!(X in J)){if(!(X in Q))return`${K}.${X} added`;let Y=_D($[X],Q[X],Z[X]);if(Y)return`${K}.${X} ${Y}`}for(let X of Object.keys(Q))if(!(X in J)){if(!(X in $))return`${K}.${X} dropped`;if(!Object.hasOwnProperty.call($,X)){let Y=_D($[X],Q[X],Z[X]);if(Y)return`${K}.${X} ${Y}`}}return!1}function _D($,Q,J){let Z=J&&J.equal;if(Z&&!Z($,Q,J))return"changed deeply";if(!Z){if(Z=$&&Q&&$.equals,Z&&!Z.call($,Q))return"changed deeply"}if(!Z&&Q!==$)return"changed shallowly";return null}function d31($,Q){if(Q===null)return"oldProps is null, initial diff";let J=!1,{dataComparator:Z,_dataDiff:K}=$;if(Z){if(!Z($.data,Q.data))J="Data comparator detected a change"}else if($.data!==Q.data)J="A new data container was supplied";if(J&&K)J=K($.data,Q.data)||J;return J}function l31($,Q){if(Q===null)return{all:!0};if("all"in $.updateTriggers){if(ng($,Q,"all"))return{all:!0}}let J={},Z=!1;for(let K in $.updateTriggers)if(K!=="all"){if(ng($,Q,K))J[K]=!0,Z=!0}return Z?J:!1}function p31($,Q){if(Q===null)return!0;let J=Q.extensions,{extensions:Z}=$;if(Z===J)return!1;if(!J||!Z)return!0;if(Z.length!==J.length)return!0;for(let K=0;K<Z.length;K++)if(!Z[K].equals(J[K]))return!0;return!1}function ng($,Q,J){let Z=$.updateTriggers[J];Z=Z===void 0||Z===null?{}:Z;let K=Q.updateTriggers[J];return K=K===void 0||K===null?{}:K,rg({oldProps:K,newProps:Z,triggerName:J})}var ag=C(()=>{P7()});function tg($){if(!i31($))throw Error("count(): argument not an object");if(typeof $.count==="function")return $.count();if(Number.isFinite($.size))return $.size;if(Number.isFinite($.length))return $.length;if(u31($))return Object.keys($).length;throw Error("count(): argument not a container")}function u31($){return $!==null&&typeof $==="object"&&$.constructor===Object}function i31($){return $!==null&&typeof $==="object"}function xD($,Q){if(!Q)return $;let J={...$,...Q};if("defines"in Q)J.defines={...$.defines,...Q.defines};if("modules"in Q){if(J.modules=($.modules||[]).concat(Q.modules),Q.modules.some((Z)=>Z.name==="project64")){let Z=J.modules.findIndex((K)=>K.name==="project32");if(Z>=0)J.modules.splice(Z,1)}}if("inject"in Q)if(!$.inject)J.inject=Q.inject;else{let Z={...$.inject};for(let K in Q.inject)Z[K]=(Z[K]||"")+Q.inject[K];J.inject=Z}return J}function eg($,Q,J,Z){if(J instanceof E1)return J;else if(J.constructor&&J.constructor.name!=="Object")J={data:J};let K=null;if(J.compressed)K={minFilter:"linear",mipmapFilter:J.data.length>1?"nearest":"linear"};let X=Q.createTexture({...J,sampler:{...n31,...K,...Z},mipmaps:!0});return gD[X.id]=$,X}function $y($,Q){if(!Q||!(Q instanceof E1))return;if(gD[Q.id]===$)Q.delete(),delete gD[Q.id]}var n31,gD;var Qy=C(()=>{O1();n31={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},gD={}});function Jy($){let Q={},J={},Z={};for(let[K,X]of Object.entries($)){let Y=X?.deprecatedFor;if(Y)Z[K]=Array.isArray(Y)?Y:[Y];else{let W=o31(K,X);Q[K]=W,J[K]=W.value}}return{propTypes:Q,defaultProps:J,deprecatedProps:Z}}function o31($,Q){switch(NX(Q)){case"object":return I$($,Q);case"array":return I$($,{type:"array",value:Q,compare:!1});case"boolean":return I$($,{type:"boolean",value:Q});case"number":return I$($,{type:"number",value:Q});case"function":return I$($,{type:"function",value:Q,compare:!0});default:return{name:$,type:"unknown",value:Q}}}function I$($,Q){if(!("type"in Q)){if(!("value"in Q))return{name:$,type:"object",value:Q};return{name:$,type:NX(Q.value),...Q}}return{name:$,...s31[Q.type],...Q}}function yD($){return Array.isArray($)||ArrayBuffer.isView($)}function NX($){if(yD($))return"array";if($===null)return"null";return typeof $}var s31;var Zy=C(()=>{Qy();s31={boolean:{validate($,Q){return!0},equal($,Q,J){return Boolean($)===Boolean(Q)}},number:{validate($,Q){return Number.isFinite($)&&(!("max"in Q)||$<=Q.max)&&(!("min"in Q)||$>=Q.min)}},color:{validate($,Q){return Q.optional&&!$||yD($)&&($.length===3||$.length===4)},equal($,Q,J){return G0($,Q,1)}},accessor:{validate($,Q){let J=NX($);return J==="function"||J===NX(Q.value)},equal($,Q,J){if(typeof Q==="function")return!0;return G0($,Q,1)}},array:{validate($,Q){return Q.optional&&!$||yD($)},equal($,Q,J){let{compare:Z}=J,K=Number.isInteger(Z)?Z:Z?1:0;return Z?G0($,Q,K):$===Q}},object:{equal($,Q,J){if(J.ignore)return!0;let{compare:Z}=J,K=Number.isInteger(Z)?Z:Z?1:0;return Z?G0($,Q,K):$===Q}},function:{validate($,Q){return Q.optional&&!$||typeof $==="function"},equal($,Q,J){return!J.compare&&J.ignore!==!1||$===Q}},data:{transform:($,Q,J)=>{if(!$)return $;let{dataTransform:Z}=J.props;if(Z)return Z($);if(typeof $.shape==="string"&&$.shape.endsWith("-table")&&Array.isArray($.data))return $.data;return $}},image:{transform:($,Q,J)=>{let Z=J.context;if(!Z||!Z.device)return null;return eg(J.id,Z.device,$,{...Q.parameters,...J.props.textureParameters})},release:($,Q,J)=>{$y(J.id,$)}}}});function Ky($,Q){let J;for(let X=Q.length-1;X>=0;X--){let Y=Q[X];if("extensions"in Y)J=Y.extensions}let Z=fD($.constructor,J),K=Object.create(Z);K[j8]=$,K[f6]={},K[W6]={};for(let X=0;X<Q.length;++X){let Y=Q[X];for(let W in Y)K[W]=Y[W]}return Object.freeze(K),K}function fD($,Q){if(!($ instanceof DX.constructor))return{};let J=r31;if(Q)for(let K of Q){let X=K.constructor;if(X)J+=`:${X.extensionName||X.name}`}let Z=Xy($,J);if(!Z)return $[J]=a31($,Q||[]);return Z}function a31($,Q){if(!$.prototype)return null;let Z=Object.getPrototypeOf($),K=fD(Z),X=Xy($,"defaultProps")||{},Y=Jy(X),W=Object.assign(Object.create(null),K,Y.defaultProps),q=Object.assign(Object.create(null),K?.[N5],Y.propTypes),H=Object.assign(Object.create(null),K?.[AK],Y.deprecatedProps);for(let F of Q){let U=fD(F.constructor);if(U)Object.assign(W,U),Object.assign(q,U[N5]),Object.assign(H,U[AK])}if(t31(W,$),$21(W,q),e31(W,H),W[N5]=q,W[AK]=H,Q.length===0&&!bD($,"_propTypes"))$._propTypes=q;return W}function t31($,Q){let J=J21(Q);Object.defineProperties($,{id:{writable:!0,value:J}})}function e31($,Q){for(let J in Q)Object.defineProperty($,J,{enumerable:!1,set(Z){let K=`${this.id}: ${J}`;for(let X of Q[J])if(!bD(this,X))this[X]=Z;r.deprecated(K,Q[J].join("/"))()}})}function $21($,Q){let J={},Z={};for(let K in Q){let X=Q[K],{name:Y,value:W}=X;if(X.async)J[Y]=W,Z[Y]=Q21(Y)}$[A4]=J,$[f6]={},Object.defineProperties($,Z)}function Q21($){return{enumerable:!0,set(Q){if(typeof Q==="string"||Q instanceof Promise||aK(Q))this[f6][$]=Q;else this[W6][$]=Q},get(){if(this[W6]){if($ in this[W6])return this[W6][$]||this[A4][$];if($ in this[f6]){let Q=this[j8]&&this[j8].internalState;if(Q&&Q.hasAsyncProp($))return Q.getAsyncProp($)||this[A4][$]}}return this[A4][$]}}}function bD($,Q){return Object.prototype.hasOwnProperty.call($,Q)}function Xy($,Q){return bD($,Q)&&$[Q]}function J21($){let Q=$.componentName;if(!Q)r.warn(`${$.name}.componentName not specified`)();return Q||$.name}var r31="_mergedDefaultProps";var Yy=C(()=>{T0();V3();Zy();P7();mD()});class CX{constructor(...$){this.props=Ky(this,$),this.id=this.props.id,this.count=Z21++}clone($){let{props:Q}=this,J={};for(let Z in Q[A4])if(Z in Q[W6])J[Z]=Q[W6][Z];else if(Z in Q[f6])J[Z]=Q[f6][Z];return new this.constructor({...Q,...J,...$})}}var Z21=0,DX;var mD=C(()=>{P7();Yy();CX.componentName="Component";CX.defaultProps={};DX=CX});class AX{constructor($){this.component=$,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let $ in this.asyncProps){let Q=this.asyncProps[$];if(Q&&Q.type&&Q.type.release)Q.type.release(Q.resolvedValue,Q.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||K21}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp($){return $ in this.asyncProps}getAsyncProp($){let Q=this.asyncProps[$];return Q&&Q.resolvedValue}isAsyncPropLoading($){if($){let Q=this.asyncProps[$];return Boolean(Q&&Q.pendingLoadCount>0&&Q.pendingLoadCount!==Q.resolvedLoadCount)}for(let Q in this.asyncProps)if(this.isAsyncPropLoading(Q))return!0;return!1}reloadAsyncProp($,Q){this._watchPromise($,Promise.resolve(Q))}setAsyncProps($){this.component=$[j8]||this.component;let Q=$[W6]||{},J=$[f6]||$,Z=$[A4]||{};for(let K in Q){let X=Q[K];this._createAsyncPropData(K,Z[K]),this._updateAsyncProp(K,X),Q[K]=this.getAsyncProp(K)}for(let K in J){let X=J[K];this._createAsyncPropData(K,Z[K]),this._updateAsyncProp(K,X)}}_fetch($,Q){return null}_onResolve($,Q){}_onError($,Q){}_updateAsyncProp($,Q){if(!this._didAsyncInputValueChange($,Q))return;if(typeof Q==="string")Q=this._fetch($,Q);if(Q instanceof Promise){this._watchPromise($,Q);return}if(aK(Q)){this._resolveAsyncIterable($,Q);return}this._setPropValue($,Q)}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let $ in this.asyncProps)Object.defineProperty(this.oldAsyncProps,$,{enumerable:!0,value:this.oldProps[$]})}}_didAsyncInputValueChange($,Q){let J=this.asyncProps[$];if(Q===J.resolvedValue||Q===J.lastValue)return!1;return J.lastValue=Q,!0}_setPropValue($,Q){this._freezeAsyncOldProps();let J=this.asyncProps[$];if(J)Q=this._postProcessValue(J,Q),J.resolvedValue=Q,J.pendingLoadCount++,J.resolvedLoadCount=J.pendingLoadCount}_setAsyncPropValue($,Q,J){let Z=this.asyncProps[$];if(Z&&J>=Z.resolvedLoadCount&&Q!==void 0)this._freezeAsyncOldProps(),Z.resolvedValue=Q,Z.resolvedLoadCount=J,this.onAsyncPropUpdated($,Q)}_watchPromise($,Q){let J=this.asyncProps[$];if(J){J.pendingLoadCount++;let Z=J.pendingLoadCount;Q.then((K)=>{if(!this.component)return;K=this._postProcessValue(J,K),this._setAsyncPropValue($,K,Z),this._onResolve($,K)}).catch((K)=>{this._onError($,K)})}}async _resolveAsyncIterable($,Q){if($!=="data"){this._setPropValue($,Q);return}let J=this.asyncProps[$];if(!J)return;J.pendingLoadCount++;let Z=J.pendingLoadCount,K=[],X=0;for await(let Y of Q){if(!this.component)return;let{dataTransform:W}=this.component.props;if(W)K=W(Y,K);else K=K.concat(Y);Object.defineProperty(K,"__diff",{enumerable:!1,value:[{startRow:X,endRow:K.length}]}),X=K.length,this._setAsyncPropValue($,K,Z)}this._onResolve($,K)}_postProcessValue($,Q){let J=$.type;if(J&&this.component){if(J.release)J.release($.resolvedValue,J,this.component);if(J.transform)return J.transform(Q,J,this.component)}return Q}_createAsyncPropData($,Q){if(!this.asyncProps[$]){let Z=this.component&&this.component.props[N5];this.asyncProps[$]={type:Z&&Z[$],lastValue:null,resolvedValue:Q,pendingLoadCount:0,resolvedLoadCount:0}}}}var K21;var Wy=C(()=>{V3();P7();K21=Object.freeze({})});var zX;var qy=C(()=>{Wy();zX=class zX extends AX{constructor({attributeManager:$,layer:Q}){super(Q);this.attributeManager=$,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch($,Q){let J=this.layer,Z=J?.props.fetch;if(Z)return Z(Q,{propName:$,layer:J});return super._fetch($,Q)}_onResolve($,Q){let J=this.layer;if(J){let Z=J.props.onDataLoad;if($==="data"&&Z)Z(Q,{propName:$,layer:J})}}_onError($,Q){let J=this.layer;if(J)J.raiseError(Q,`loading ${$} of ${this.layer}`)}}});var X21="layer.changeFlag",Y21="layer.initialize",W21="layer.update",q21="layer.finalize",H21="layer.matched",Hy=16777215,F21,U21,H6,V21,kX,i0;var cD=C(()=>{O1();iK();Z6();mg();ig();ag();P7();T0();N8();W_();e9();mD();qy();G8();E2();F21=Object.freeze([]),U21=y6(({oldViewport:$,viewport:Q})=>{return $.equals(Q)}),H6=new Uint8ClampedArray(0),V21={data:{type:"data",value:F21,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:($)=>$&&$.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:($,{propName:Q,layer:J,loaders:Z,loadOptions:K,signal:X})=>{let{resourceManager:Y}=J.context;if(K=K||J.getLoadOptions(),Z=Z||J.props.loaders,X)K={...K,fetch:{...K?.fetch,signal:X}};let W=Y.contains($);if(!W&&!K)Y.add({resourceId:$,data:q7($,Z),persistent:!1}),W=!0;if(W)return Y.subscribe({resourceId:$,onChange:(q)=>J.internalState?.reloadAsyncProp(Q,q),consumerId:J.id,requestId:Q});return q7($,Z,K)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:z1.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:$})=>[0,-$*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};kX=class kX extends DX{constructor(){super(...arguments);this.internalState=null,this.lifecycle=O7.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let $=this;while($.parent)$=$.parent;return $}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project($){r1(this.internalState);let Q=this.internalState.viewport||this.context.viewport,J=jN($,{viewport:Q,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[Z,K,X]=t9(J,Q.pixelProjectionMatrix);return $.length===2?[Z,K]:[Z,K,X]}unproject($){return r1(this.internalState),(this.internalState.viewport||this.context.viewport).unproject($)}projectPosition($,Q){r1(this.internalState);let J=this.internalState.viewport||this.context.viewport;return Y_($,{viewport:J,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...Q})}get isComposite(){return!1}get isDrawable(){return!0}setState($){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,$),this.setNeedsRedraw()}setNeedsRedraw(){if(this.internalState)this.internalState.needsRedraw=!0}setNeedsUpdate(){if(this.internalState)this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let $=this.state;return $&&($.models||$.model&&[$.model])||[]}setShaderModuleProps(...$){for(let Q of this.getModels())Q.shaderInputs.setProps(...$)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:$}=this.props;return $===z1.DEFAULT||$===z1.LNGLAT||$===z1.CARTESIAN}onHover($,Q){if(this.props.onHover)return this.props.onHover($,Q)||!1;return!1}onClick($,Q){if(this.props.onClick)return this.props.onClick($,Q)||!1;return!1}nullPickingColor(){return[0,0,0]}encodePickingColor($,Q=[]){return Q[0]=$+1&255,Q[1]=$+1>>8&255,Q[2]=$+1>>8>>8&255,Q}decodePickingColor($){r1($ instanceof Uint8Array);let[Q,J,Z]=$;return Q+J*256+Z*65536-1}getNumInstances(){if(Number.isFinite(this.props.numInstances))return this.props.numInstances;if(this.state&&this.state.numInstances!==void 0)return this.state.numInstances;return tg(this.props.data)}getStartIndices(){if(this.props.startIndices)return this.props.startIndices;if(this.state&&this.state.startIndices)return this.state.startIndices;return null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders($){$=xD($,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let Q of this.props.extensions)$=xD($,Q.getShaders.call(this,Q));return $}shouldUpdateState($){return $.changeFlags.propsOrDataChanged}updateState($){let Q=this.getAttributeManager(),{dataChanged:J}=$.changeFlags;if(J&&Q)if(Array.isArray(J))for(let Z of J)Q.invalidateAll(Z);else Q.invalidateAll();if(Q){let{props:Z}=$,K=this.internalState.hasPickingBuffer,X=Number.isInteger(Z.highlightedObjectIndex)||Z.pickable||Z.extensions.some((Y)=>Y.getNeedsPickingBuffer.call(this,Y));if(K!==X){this.internalState.hasPickingBuffer=X;let{pickingColors:Y,instancePickingColors:W}=Q.attributes,q=Y||W;if(q){if(X&&q.constant)q.constant=!1,Q.invalidate(q.id);if(!q.value&&!X)q.constant=!0,q.value=[0,0,0]}}}}finalizeState($){for(let J of this.getModels())J.destroy();let Q=this.getAttributeManager();if(Q)Q.finalize();if(this.context)this.context.resourceManager.unsubscribe({consumerId:this.id});if(this.internalState)this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw($){for(let Q of this.getModels())Q.draw($.renderPass)}getPickingInfo({info:$,mode:Q,sourceLayer:J}){let{index:Z}=$;if(Z>=0){if(Array.isArray(this.props.data))$.object=this.props.data[Z]}return $}raiseError($,Q){if(Q)$=Error(`${Q}: ${$.message}`,{cause:$});if(!this.props.onError?.($))this.context?.onError?.($,this)}getNeedsRedraw($={clearRedrawFlags:!1}){return this._getNeedsRedraw($)}needsUpdate(){if(!this.internalState)return!1;return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport($){if(!this.internalState)return;let Q=this.internalState.viewport;if(this.internalState.viewport=$,!Q||!U21({oldViewport:Q,viewport:$}))if(this.setChangeFlags({viewportChanged:!0}),this.isComposite){if(this.needsUpdate())this.setNeedsUpdate()}else this._update()}invalidateAttribute($="all"){let Q=this.getAttributeManager();if(!Q)return;if($==="all")Q.invalidateAll();else Q.invalidate($)}updateAttributes($){let Q=!1;for(let J in $)if($[J].layoutChanged())Q=!0;for(let J of this.getModels())this._setModelAttributes(J,$,Q)}_updateAttributes(){let $=this.getAttributeManager();if(!$)return;let Q=this.props,J=this.getNumInstances(),Z=this.getStartIndices();$.update({data:Q.data,numInstances:J,startIndices:Z,props:Q,transitions:Q.transitions,buffers:Q.data.attributes,context:this});let K=$.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(K)}_updateAttributeTransition(){let $=this.getAttributeManager();if($)$.updateTransition()}_updateUniformTransition(){let{uniformTransitions:$}=this.internalState;if($.active){let Q=$.update(),J=Object.create(this.props);for(let Z in Q)Object.defineProperty(J,Z,{value:Q[Z]});return J}return this.props}calculateInstancePickingColors($,{numInstances:Q}){if($.constant)return;let J=Math.floor(H6.length/4);if(this.internalState.usesPickingColorCache=!0,J<Q){if(Q>Hy)r.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")();H6=Y6.allocate(H6,Q,{size:4,copy:!0,maxCount:Math.max(Q,Hy)});let Z=Math.floor(H6.length/4),K=[0,0,0];for(let X=J;X<Z;X++)this.encodePickingColor(X,K),H6[X*4+0]=K[0],H6[X*4+1]=K[1],H6[X*4+2]=K[2],H6[X*4+3]=0}$.value=H6.subarray(0,Q*4)}_setModelAttributes($,Q,J=!1){if(!Object.keys(Q).length)return;if(J){let Y=this.getAttributeManager();$.setBufferLayout(Y.getBufferLayouts($)),Q=Y.getAttributes()}let Z=$.userData?.excludeAttributes||{},K={},X={};for(let Y in Q){if(Z[Y])continue;let W=Q[Y].getValue();for(let q in W){let H=W[q];if(H instanceof M1)if(Q[Y].settings.isIndexed)$.setIndexBuffer(H);else K[q]=H;else if(H)X[q]=H}}$.setAttributes(K),$.setConstantAttributes(X)}disablePickingIndex($){let Q=this.props.data;if(!("attributes"in Q)){this._disablePickingIndex($);return}let{pickingColors:J,instancePickingColors:Z}=this.getAttributeManager().attributes,K=J||Z,X=K&&Q.attributes&&Q.attributes[K.id];if(X&&X.value){let Y=X.value,W=this.encodePickingColor($);for(let q=0;q<Q.length;q++){let H=K.getVertexOffset(q);if(Y[H]===W[0]&&Y[H+1]===W[1]&&Y[H+2]===W[2])this._disablePickingIndex(q)}}else this._disablePickingIndex($)}_disablePickingIndex($){let{pickingColors:Q,instancePickingColors:J}=this.getAttributeManager().attributes,Z=Q||J;if(!Z)return;let K=Z.getVertexOffset($),X=Z.getVertexOffset($+1);Z.buffer.write(new Uint8Array(X-K),K)}restorePickingColors(){let{pickingColors:$,instancePickingColors:Q}=this.getAttributeManager().attributes,J=$||Q;if(!J)return;if(this.internalState.usesPickingColorCache&&J.value.buffer!==H6.buffer)J.value=H6.subarray(0,J.value.length);J.updateSubBuffer({startOffset:0})}_initialize(){r1(!this.internalState),r1(Number.isFinite(this.props.coordinateSystem)),X0(Y21,this);let $=this._getAttributeManager();if($)$.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}});this.internalState=new zX({attributeManager:$,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>{return r.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),$}}),this.internalState.uniformTransitions=new VX(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let Q of this.props.extensions)Q.initializeState.call(this,this.context,Q);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState($){X0(H21,this,this===$);let{state:Q,internalState:J}=$;if(this===$)return;this.internalState=J,this.state=Q,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps())}_update(){let $=this.needsUpdate();if(X0(W21,this,$),!$)return;let Q=this.props,J=this.context,Z=this.internalState,K=J.viewport,X=this._updateUniformTransition();Z.propsInTransition=X,J.viewport=Z.viewport||K,this.props=X;try{let Y=this._getUpdateParams(),W=this.getModels();if(J.device)this.updateState(Y);else try{this.updateState(Y)}catch(H){}for(let H of this.props.extensions)H.updateState.call(this,Y,H);this.setNeedsRedraw(),this._updateAttributes();let q=this.getModels()[0]!==W[0];this._postUpdate(Y,q)}finally{J.viewport=K,this.props=Q,this._clearChangeFlags(),Z.needsUpdate=!1,Z.resetOldProps()}}_finalize(){X0(q21,this),this.finalizeState(this.context);for(let $ of this.props.extensions)$.finalizeState.call(this,this.context,$)}_drawLayer({renderPass:$,shaderModuleProps:Q=null,uniforms:J={},parameters:Z={}}){this._updateAttributeTransition();let K=this.props,X=this.context;this.props=this.internalState.propsInTransition||K;try{if(Q)this.setShaderModuleProps(Q);let{getPolygonOffset:Y}=this.props,W=Y&&Y(J)||[0,0];if(X.device instanceof p6)X.device.setParametersWebGL({polygonOffset:W});for(let q of this.getModels())if(q.device.type==="webgpu")q.setParameters({...q.parameters,...Z});else q.setParameters(Z);if(X.device instanceof p6)X.device.withParametersWebGL(Z,()=>{let q={renderPass:$,shaderModuleProps:Q,uniforms:J,parameters:Z,context:X};for(let H of this.props.extensions)H.draw.call(this,q,H);this.draw(q)});else{let q={renderPass:$,shaderModuleProps:Q,uniforms:J,parameters:Z,context:X};for(let H of this.props.extensions)H.draw.call(this,q,H);this.draw(q)}}finally{this.props=K}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags($){if(!this.internalState)return;let{changeFlags:Q}=this.internalState;for(let Z in $)if($[Z]){let K=!1;switch(Z){case"dataChanged":let X=$[Z],Y=Q[Z];if(X&&Array.isArray(Y))Q.dataChanged=Array.isArray(X)?Y.concat(X):X,K=!0;default:if(!Q[Z])Q[Z]=$[Z],K=!0}if(K)X0(X21,this,Z,$)}let J=Boolean(Q.dataChanged||Q.updateTriggersChanged||Q.propsChanged||Q.extensionsChanged);Q.propsOrDataChanged=J,Q.somethingChanged=J||Q.viewportChanged||Q.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps($,Q){let J=og($,Q);if(J.updateTriggersChanged){for(let Z in J.updateTriggersChanged)if(J.updateTriggersChanged[Z])this.invalidateAttribute(Z)}if(J.transitionsChanged)for(let Z in J.transitionsChanged)this.internalState.uniformTransitions.add(Z,Q[Z],$[Z],$.transitions?.[Z]);return this.setChangeFlags(J)}validateProps(){sg(this.props)}updateAutoHighlight($){if(this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex))this._updateAutoHighlight($)}_updateAutoHighlight($){let Q={highlightedObjectColor:$.picked?$.color:null},{highlightColor:J}=this.props;if($.picked&&typeof J==="function")Q.highlightColor=J($);this.setShaderModuleProps({picking:Q}),this.setNeedsRedraw()}_getAttributeManager(){let $=this.context;return new HX($.device,{id:this.props.id,stats:$.stats,timeline:$.timeline})}_postUpdate($,Q){let{props:J,oldProps:Z}=$,K=this.state.model;if(K?.isInstanced)K.setInstanceCount(this.getNumInstances());let{autoHighlight:X,highlightedObjectIndex:Y,highlightColor:W}=J;if(Q||Z.autoHighlight!==X||Z.highlightedObjectIndex!==Y||Z.highlightColor!==W){let q={};if(Array.isArray(W))q.highlightColor=W;if(Q||Z.autoHighlight!==X||Y!==Z.highlightedObjectIndex)q.highlightedObjectColor=Number.isFinite(Y)&&Y>=0?this.encodePickingColor(Y):null;this.setShaderModuleProps({picking:q})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw($){if(!this.internalState)return!1;let Q=!1;Q=Q||this.internalState.needsRedraw&&this.id;let J=this.getAttributeManager(),Z=J?J.getNeedsRedraw($):!1;if(Q=Q||Z,Q)for(let K of this.props.extensions)K.onNeedsRedraw.call(this,K);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!$.clearRedrawFlags,Q}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};kX.defaultProps=V21;kX.layerName="Layer";i0=kX});var N21="compositeLayer.renderLayers",dD,G$;var Fy=C(()=>{cD();N8();P7();dD=class dD extends i0{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(($)=>$.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState($){}setState($){super.setState($),this.setNeedsUpdate()}getPickingInfo({info:$}){let{object:Q}=$;if(!(Q&&Q.__source&&Q.__source.parent&&Q.__source.parent.id===this.id))return $;return $.object=Q.__source.object,$.index=Q.__source.index,$}filterSubLayer($){return!0}shouldRenderSubLayer($,Q){return Q&&Q.length}getSubLayerClass($,Q){let{_subLayerProps:J}=this.props;return J&&J[$]&&J[$].type||Q}getSubLayerRow($,Q,J){return $.__source={parent:this,object:Q,index:J},$}getSubLayerAccessor($){if(typeof $==="function"){let Q={index:-1,data:this.props.data,target:[]};return(J,Z)=>{if(J&&J.__source)return Q.index=J.__source.index,$(J.__source.object,Q);return $(J,Z)}}return $}getSubLayerProps($={}){let{opacity:Q,pickable:J,visible:Z,parameters:K,getPolygonOffset:X,highlightedObjectIndex:Y,autoHighlight:W,highlightColor:q,coordinateSystem:H,coordinateOrigin:F,wrapLongitude:U,positionFormat:V,modelMatrix:N,extensions:D,fetch:z,operation:B,_subLayerProps:M}=this.props,P={id:"",updateTriggers:{},opacity:Q,pickable:J,visible:Z,parameters:K,getPolygonOffset:X,highlightedObjectIndex:Y,autoHighlight:W,highlightColor:q,coordinateSystem:H,coordinateOrigin:F,wrapLongitude:U,positionFormat:V,modelMatrix:N,extensions:D,fetch:z,operation:B},O=M&&$.id&&M[$.id],G=O&&O.updateTriggers,L=$.id||"sublayer";if(O){let b=this.props[N5],d=$.type?$.type._propTypes:{};for(let p in O){let i=d[p]||b[p];if(i&&i.type==="accessor")O[p]=this.getSubLayerAccessor(O[p])}}Object.assign(P,$,O),P.id=`${this.props.id}-${L}`,P.updateTriggers={all:this.props.updateTriggers?.all,...$.updateTriggers,...G};for(let b of D){let d=b.getSubLayerProps.call(this,b);if(d)Object.assign(P,d,{updateTriggers:Object.assign(P.updateTriggers,d.updateTriggers)})}return P}_updateAutoHighlight($){for(let Q of this.getSubLayers())Q.updateAutoHighlight($)}_getAttributeManager(){return null}_postUpdate($,Q){let J=this.internalState.subLayers,Z=!J||this.needsUpdate();if(Z){let K=this.renderLayers();J=K3(K,Boolean),this.internalState.subLayers=J}X0(N21,this,Z,J);for(let K of J)K.parent=this}};dD.layerName="CompositeLayer";G$=dD});class _8{constructor($){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:Q={}}=$;this.typedArrayManager=Y6,this.attributes={},this._attributeDefs=Q,this.opts=$,this.updateGeometry($)}updateGeometry($){Object.assign(this.opts,$);let{data:Q,buffers:J={},getGeometry:Z,geometryBuffer:K,positionFormat:X,dataChanged:Y,normalize:W=!0}=this.opts;if(this.data=Q,this.getGeometry=Z,this.positionSize=K&&K.size||(X==="XY"?2:3),this.buffers=J,this.normalize=W,K){if(r1(Q.startIndices),this.getGeometry=this.getGeometryFromBuffer(K),!W)J.vertexPositions=K}if(this.geometryBuffer=J.vertexPositions,Array.isArray(Y))for(let q of Y)this._rebuildGeometry(q);else this._rebuildGeometry()}updatePartialGeometry({startRow:$,endRow:Q}){this._rebuildGeometry({startRow:$,endRow:Q})}getGeometryFromBuffer($){let Q=$.value||$;if(!ArrayBuffer.isView(Q))return null;return tK(Q,{size:this.positionSize,offset:$.offset,stride:$.stride,startIndices:this.data.startIndices})}_allocate($,Q){let{attributes:J,buffers:Z,_attributeDefs:K,typedArrayManager:X}=this;for(let Y in K)if(Y in Z)X.release(J[Y]),J[Y]=null;else{let W=K[Y];W.copy=Q,J[Y]=X.allocate(J[Y],$,W)}}_forEachGeometry($,Q,J){let{data:Z,getGeometry:K}=this,{iterable:X,objectInfo:Y}=M4(Z,Q,J);for(let W of X){Y.index++;let q=K?K(W,Y):null;$(q,Y.index)}}_rebuildGeometry($){if(!this.data)return;let{indexStarts:Q,vertexStarts:J,instanceCount:Z}=this,{data:K,geometryBuffer:X}=this,{startRow:Y=0,endRow:W=1/0}=$||{},q={};if(!$)Q=[0],J=[0];if(this.normalize||!X)this._forEachGeometry((F,U)=>{let V=F&&this.normalizeGeometry(F);q[U]=V,J[U+1]=J[U]+(V?this.getGeometrySize(V):0)},Y,W),Z=J[J.length-1];else if(J=K.startIndices,Z=J[K.length]||0,ArrayBuffer.isView(X))Z=Z||X.length/this.positionSize;else if(X instanceof M1){let F=this.positionSize*4;Z=Z||X.byteLength/F}else if(X.buffer){let F=X.stride||this.positionSize*4;Z=Z||X.buffer.byteLength/F}else if(X.value){let F=X.value,U=X.stride/F.BYTES_PER_ELEMENT||this.positionSize;Z=Z||F.length/U}this._allocate(Z,Boolean($)),this.indexStarts=Q,this.vertexStarts=J,this.instanceCount=Z;let H={};this._forEachGeometry((F,U)=>{let V=q[U]||F;H.vertexStart=J[U],H.indexStart=Q[U];let N=U<J.length-1?J[U+1]:Z;H.geometrySize=N-J[U],H.geometryIndex=U,this.updateGeometryAttributes(V,H)},Y,W),this.vertexCount=Q[Q.length-1]}}var Uy=C(()=>{V3();e9();O1()});var M0=C(()=>{Z6();Og();cD();Fy();SN();mN();T0();V3();Uy()});var Vy;var Ny=C(()=>{Vy={name:"icon",vs:`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,fs:`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}}});var Dy=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`;var Cy=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function z21($){return Math.pow(2,Math.ceil(Math.log2($)))}function k21($,Q,J,Z){let K=Math.min(J/Q.width,Z/Q.height),X=Math.floor(Q.width*K),Y=Math.floor(Q.height*K);if(K===1)return{image:Q,width:X,height:Y};return $.canvas.height=Y,$.canvas.width=X,$.clearRect(0,0,X,Y),$.drawImage(Q,0,0,Q.width,Q.height,0,0,X,Y),{image:$.canvas,width:X,height:Y}}function E$($){return $&&($.id||$.url)}function B21($,Q,J,Z){let{width:K,height:X,device:Y}=$,W=Y.createTexture({format:"rgba8unorm",width:Q,height:J,sampler:Z,mipmaps:!0}),q=Y.createCommandEncoder();return q.copyTextureToTexture({sourceTexture:$,destinationTexture:W,width:K,height:X}),q.finish(),$.destroy(),W}function ky($,Q,J){for(let Z=0;Z<Q.length;Z++){let{icon:K,xOffset:X}=Q[Z],Y=E$(K);$[Y]={...K,x:X,y:J}}}function R21({icons:$,buffer:Q,mapping:J={},xOffset:Z=0,yOffset:K=0,rowHeight:X=0,canvasWidth:Y}){let W=[];for(let q=0;q<$.length;q++){let H=$[q],F=E$(H);if(!J[F]){let{height:U,width:V}=H;if(Z+V+Q>Y)ky(J,W,K),Z=0,K=X+K+Q,X=0,W=[];W.push({icon:H,xOffset:Z}),Z=Z+V+Q,X=Math.max(X,U)}}if(W.length>0)ky(J,W,K);return{mapping:J,rowHeight:X,xOffset:Z,yOffset:K,canvasWidth:Y,canvasHeight:z21(X+K+Q)}}function O21($,Q,J){if(!$||!Q)return null;J=J||{};let Z={},{iterable:K,objectInfo:X}=M4($);for(let Y of K){X.index++;let W=Q(Y,X),q=E$(W);if(!W)throw Error("Icon is missing.");if(!W.url)throw Error("Icon url is missing.");if(!Z[q]&&(!J[q]||W.url!==J[q].url))Z[q]={...W,source:Y,sourceIndex:X.index}}return Z}class BX{constructor($,{onUpdate:Q=Ay,onError:J=Ay}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=C21,this._canvasWidth=D21,this._canvasHeight=0,this._canvas=null,this.device=$,this.onUpdate=Q,this.onError=J}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping($){let Q=this._autoPacking?E$($):$;return this._mapping[Q]||A21}setProps({loadOptions:$,autoPacking:Q,iconAtlas:J,iconMapping:Z,textureParameters:K}){if($)this._loadOptions=$;if(Q!==void 0)this._autoPacking=Q;if(Z)this._mapping=Z;if(J)this._texture?.delete(),this._texture=null,this._externalTexture=J;if(K)this._samplerParameters=K}get isLoaded(){return this._pendingCount===0}packIcons($,Q){if(!this._autoPacking||typeof document>"u")return;let J=Object.values(O21($,Q,this._mapping)||{});if(J.length>0){let{mapping:Z,xOffset:K,yOffset:X,rowHeight:Y,canvasHeight:W}=R21({icons:J,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});if(this._rowHeight=Y,this._mapping=Z,this._xOffset=K,this._yOffset=X,this._canvasHeight=W,!this._texture)this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||zy,mipmaps:!0});if(this._texture.height!==this._canvasHeight)this._texture=B21(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||zy);this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(J)}}_loadIcons($){let Q=this._canvas.getContext("2d",{willReadFrequently:!0});for(let J of $)this._pendingCount++,q7(J.url,this._loadOptions).then((Z)=>{let K=E$(J),X=this._mapping[K],{x:Y,y:W,width:q,height:H}=X,{image:F,width:U,height:V}=k21(Q,Z,q,H);this._texture?.copyExternalImage({image:F,x:Y+(q-U)/2,y:W+(H-V)/2,width:U,height:V}),X.width=U,X.height=V,this._texture.generateMipmap(),this.onUpdate()}).catch((Z)=>{this.onError({url:J.url,source:J.source,sourceIndex:J.sourceIndex,loadOptions:this._loadOptions,error:Z})}).finally(()=>{this._pendingCount--})}}var D21=1024,C21=4,Ay=()=>{},zy,A21;var By=C(()=>{E2();M0();zy={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},A21={x:0,y:0,width:0,height:0}});var Ry,P21,RX,OX;var lD=C(()=>{M0();V5();Ny();By();Ry=[0,0,0,255],P21={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:0.05,min:0,max:1},getPosition:{type:"accessor",value:($)=>$.position},getIcon:{type:"accessor",value:($)=>$.icon},getColor:{type:"accessor",value:Ry},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};RX=class RX extends i0{getShaders(){return super.getShaders({vs:Dy,fs:Cy,modules:[f5,m5,Vy]})}initializeState(){this.state={iconManager:new BX(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:Ry},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState($){super.updateState($);let{props:Q,oldProps:J,changeFlags:Z}=$,K=this.getAttributeManager(),{iconAtlas:X,iconMapping:Y,data:W,getIcon:q,textureParameters:H}=Q,{iconManager:F}=this.state;if(typeof X==="string")return;let U=X||this.internalState.isAsyncPropLoading("iconAtlas");if(F.setProps({loadOptions:Q.loadOptions,autoPacking:!U,iconAtlas:X,iconMapping:U?Y:null,textureParameters:H}),U){if(J.iconMapping!==Q.iconMapping)K.invalidate("getIcon")}else if(Z.dataChanged||Z.updateTriggersChanged&&(Z.updateTriggersChanged.all||Z.updateTriggersChanged.getIcon))F.packIcons(W,q);if(Z.extensionsChanged)this.state.model?.destroy(),this.state.model=this._getModel(),K.invalidateAll()}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState($){super.finalizeState($),this.state.iconManager.finalize()}draw({uniforms:$}){let{sizeScale:Q,sizeMinPixels:J,sizeMaxPixels:Z,sizeUnits:K,billboard:X,alphaCutoff:Y}=this.props,{iconManager:W}=this.state,q=W.getTexture();if(q){let H=this.state.model,F={iconsTexture:q,iconsTextureDim:[q.width,q.height],sizeUnits:y0[K],sizeScale:Q,sizeMinPixels:J,sizeMaxPixels:Z,billboard:X,alphaCutoff:Y};H.shaderInputs.setProps({icon:F}),H.draw(this.context.renderPass)}}_getModel(){let $=[-1,-1,1,-1,-1,1,1,1];return new P0(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new U5({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array($)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError($){let Q=this.getCurrentLayer()?.props.onIconError;if(Q)Q($);else r.error($.error.message)()}getInstanceOffset($){let{width:Q,height:J,anchorX:Z=Q/2,anchorY:K=J/2}=this.state.iconManager.getIconMapping($);return[Q/2-Z,J/2-K]}getInstanceColorMode($){return this.state.iconManager.getIconMapping($).mask?1:0}getInstanceIconFrame($){let{x:Q,y:J,width:Z,height:K}=this.state.iconManager.getIconMapping($);return[Q,J,Z,K]}};RX.defaultProps=P21;RX.layerName="IconLayer";OX=RX});var Oy;var Py=C(()=>{Oy={name:"scatterplot",vs:`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,fs:`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}}});var My=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var wy=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var Sy=`// TODO(ibgreen): Hack for Layer uniforms (move to new "color" module?)

struct LayerUniforms {
  opacity: f32,
};

var<private> layer: LayerUniforms = LayerUniforms(1.0);
// @group(0) @binding(1) var<uniform> layer: LayerUniforms;

// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * layer.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * layer.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    // discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        // discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    // discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`;var Ty,M21,PX,Iy;var Gy=C(()=>{M0();V5();Py();Ty=[0,0,0,255],M21={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:($)=>$.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Ty},getLineColor:{type:"accessor",value:Ty},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};PX=class PX extends i0{getShaders(){return super.getShaders({vs:My,fs:wy,source:Sy,modules:[f5,m5,Oy]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState($){if(super.updateState($),$.changeFlags.extensionsChanged)this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()}draw({uniforms:$}){let{radiusUnits:Q,radiusScale:J,radiusMinPixels:Z,radiusMaxPixels:K,stroked:X,filled:Y,billboard:W,antialiasing:q,lineWidthUnits:H,lineWidthScale:F,lineWidthMinPixels:U,lineWidthMaxPixels:V}=this.props,N={stroked:X,filled:Y,billboard:W,antialiasing:q,radiusUnits:y0[Q],radiusScale:J,radiusMinPixels:Z,radiusMaxPixels:K,lineWidthUnits:y0[H],lineWidthScale:F,lineWidthMinPixels:U,lineWidthMaxPixels:V},D=this.state.model;D.shaderInputs.setProps({scatterplot:N}),D.draw(this.context.renderPass)}_getModel(){let $=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new P0(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new U5({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array($)}}}),isInstanced:!0})}};PX.defaultProps=M21;PX.layerName="ScatterplotLayer";Iy=PX});function j$($,Q,J={}){if(Ey($,J)!==Q)return w21($,J),!0;return!1}function Ey($,Q={}){return Math.sign(wX($,Q))}function wX($,Q={}){let{start:J=0,end:Z=$.length,plane:K="xy"}=Q,X=Q.size||2,Y=0,W=pD[K[0]],q=pD[K[1]];for(let H=J,F=Z-X;H<Z;H+=X)Y+=($[H+W]-$[F+W])*($[H+q]+$[F+q]),F=H;return Y/2}function w21($,Q){let{start:J=0,end:Z=$.length,size:K=2}=Q,X=(Z-J)/K,Y=Math.floor(X/2);for(let W=0;W<Y;++W){let q=J+W*K,H=J+(X-1-W)*K;for(let F=0;F<K;++F){let U=$[q+F];$[q+F]=$[H+F],$[H+F]=U}}}var MX,pD;var SX=C(()=>{MX={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};pD={x:0,y:1,z:2}});var uD=C(()=>{SX()});var jy=C(()=>{SX()});function Q5($,Q){let J=Q.length,Z=$.length;if(Z>0){let K=!0;for(let X=0;X<J;X++)if($[Z-J+X]!==Q[X]){K=!1;break}if(K)return!1}for(let K=0;K<J;K++)$[Z+K]=Q[K];return!0}function h$($,Q){let J=Q.length;for(let Z=0;Z<J;Z++)$[Z]=Q[Z]}function T7($,Q,J,Z,K=[]){let X=Z+Q*J;for(let Y=0;Y<J;Y++)K[Y]=$[X+Y];return K}function TX($,Q,J,Z,K=[]){let X,Y;if(J&8)X=(Z[3]-$[1])/(Q[1]-$[1]),Y=3;else if(J&4)X=(Z[1]-$[1])/(Q[1]-$[1]),Y=1;else if(J&2)X=(Z[2]-$[0])/(Q[0]-$[0]),Y=2;else if(J&1)X=(Z[0]-$[0])/(Q[0]-$[0]),Y=0;else return null;for(let W=0;W<$.length;W++)K[W]=(Y&1)===W?Z[Y]:X*(Q[W]-$[W])+$[W];return K}function L$($,Q){let J=0;if($[0]<Q[0])J|=1;else if($[0]>Q[2])J|=2;if($[1]<Q[1])J|=4;else if($[1]>Q[3])J|=8;return J}var iD=()=>{};function v$($,Q){let{size:J=2,broken:Z=!1,gridResolution:K=10,gridOffset:X=[0,0],startIndex:Y=0,endIndex:W=$.length}=Q||{},q=(W-Y)/J,H=[],F=[H],U=T7($,0,J,Y),V,N,D=vy(U,K,X,[]),z=[];Q5(H,U);for(let B=1;B<q;B++){V=T7($,B,J,Y,V),N=L$(V,D);while(N){TX(U,V,N,D,z);let M=L$(z,D);if(M)TX(U,z,M,D,z),N=M;if(Q5(H,z),h$(U,z),I21(D,K,N),Z&&H.length>J)H=[],F.push(H),Q5(H,U);N=L$(V,D)}Q5(H,V),h$(U,V)}return Z?F:F[0]}function _$($,Q=null,J){if(!$.length)return[];let{size:Z=2,gridResolution:K=10,gridOffset:X=[0,0],edgeTypes:Y=!1}=J||{},W=[],q=[{pos:$,types:Y?Array($.length/Z).fill(T21):null,holes:Q||[]}],H=[[],[]],F=[];while(q.length){let{pos:U,types:V,holes:N}=q.shift();G21(U,Z,N[0]||U.length,H),F=vy(H[0],K,X,F);let D=L$(H[1],F);if(D){let z=Ly(U,V,Z,0,N[0]||U.length,F,D),B={pos:z[0].pos,types:z[0].types,holes:[]},M={pos:z[1].pos,types:z[1].types,holes:[]};q.push(B,M);for(let P=0;P<N.length;P++){if(z=Ly(U,V,Z,N[P],N[P+1]||U.length,F,D),z[0]){if(B.holes.push(B.pos.length),B.pos=IX(B.pos,z[0].pos),Y)B.types=IX(B.types,z[0].types)}if(z[1]){if(M.holes.push(M.pos.length),M.pos=IX(M.pos,z[1].pos),Y)M.types=IX(M.types,z[1].types)}}}else{let z={positions:U};if(Y)z.edgeTypes=V;if(N.length)z.holeIndices=N;W.push(z)}}return W}function Ly($,Q,J,Z,K,X,Y){let W=(K-Z)/J,q=[],H=[],F=[],U=[],V=[],N,D,z,B=T7($,W-1,J,Z),M=Math.sign(Y&8?B[1]-X[3]:B[0]-X[2]),P=Q&&Q[W-1],O=0,G=0;for(let L=0;L<W;L++){if(N=T7($,L,J,Z,N),D=Math.sign(Y&8?N[1]-X[3]:N[0]-X[2]),z=Q&&Q[Z/J+L],D&&M&&M!==D)TX(B,N,Y,X,V),Q5(q,V)&&F.push(P),Q5(H,V)&&U.push(P);if(D<=0)Q5(q,N)&&F.push(z),O-=D;else if(F.length)F[F.length-1]=hy;if(D>=0)Q5(H,N)&&U.push(z),G+=D;else if(U.length)U[U.length-1]=hy;h$(B,N),M=D,P=z}return[O?{pos:q,types:Q&&F}:null,G?{pos:H,types:Q&&U}:null]}function vy($,Q,J,Z){let K=Math.floor(($[0]-J[0])/Q)*Q+J[0],X=Math.floor(($[1]-J[1])/Q)*Q+J[1];return Z[0]=K,Z[1]=X,Z[2]=K+Q,Z[3]=X+Q,Z}function I21($,Q,J){if(J&8)$[1]+=Q,$[3]+=Q;else if(J&4)$[1]-=Q,$[3]-=Q;else if(J&2)$[0]+=Q,$[2]+=Q;else if(J&1)$[0]-=Q,$[2]-=Q}function G21($,Q,J,Z){let K=1/0,X=-1/0,Y=1/0,W=-1/0;for(let q=0;q<J;q+=Q){let H=$[q],F=$[q+1];K=H<K?H:K,X=H>X?H:X,Y=F<Y?F:Y,W=F>W?F:W}return Z[0][0]=K,Z[0][1]=Y,Z[1][0]=X,Z[1][1]=W,Z}function IX($,Q){for(let J=0;J<Q.length;J++)$.push(Q[J]);return $}var hy=0,T21=1;var nD=C(()=>{iD()});function sD($,Q){let{size:J=2,startIndex:Z=0,endIndex:K=$.length,normalize:X=!0}=Q||{},Y=$.slice(Z,K);_y(Y,J,0,K-Z);let W=v$(Y,{size:J,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(X)for(let q of W)xy(q,J);return W}function oD($,Q=null,J){let{size:Z=2,normalize:K=!0,edgeTypes:X=!1}=J||{};Q=Q||[];let Y=[],W=[],q=0,H=0;for(let U=0;U<=Q.length;U++){let V=Q[U]||$.length,N=H,D=j21($,Z,q,V);for(let z=D;z<V;z++)Y[H++]=$[z];for(let z=q;z<D;z++)Y[H++]=$[z];_y(Y,Z,N,H),h21(Y,Z,N,H,J?.maxLatitude),q=V,W[U]=H}W.pop();let F=_$(Y,W,{size:Z,gridResolution:360,gridOffset:[-180,-180],edgeTypes:X});if(K)for(let U of F)xy(U.positions,Z);return F}function j21($,Q,J,Z){let K=-1,X=-1;for(let Y=J+1;Y<Z;Y+=Q){let W=Math.abs($[Y]);if(W>K)K=W,X=Y-1}return X}function h21($,Q,J,Z,K=E21){let X=$[J],Y=$[Z-Q];if(Math.abs(X-Y)>180){let W=T7($,0,Q,J);W[0]+=Math.round((Y-X)/360)*360,Q5($,W),W[1]=Math.sign(W[1])*K,Q5($,W),W[0]=X,Q5($,W)}}function _y($,Q,J,Z){let K=$[0],X;for(let Y=J;Y<Z;Y+=Q){X=$[Y];let W=X-K;if(W>180||W<-180)X-=Math.round(W/360)*360;$[Y]=K=X}}function xy($,Q){let J,Z=$.length/Q;for(let X=0;X<Z;X++)if(J=$[X*Q],(J+180)%360!==0)break;let K=-Math.round(J/360)*360;if(K===0)return;for(let X=0;X<Z;X++)$[X*Q]+=K}var E21=85.051129;var gy=C(()=>{nD()});var GX=C(()=>{uD();SX();jy();iD();nD();gy();uD()});function yy($,Q,J,Z){let K;if(Array.isArray($[0])){let X=$.length*Q;K=Array(X);for(let Y=0;Y<$.length;Y++)for(let W=0;W<Q;W++)K[Y*Q+W]=$[Y][W]||0}else K=$;if(J)return v$(K,{size:Q,gridResolution:J});if(Z)return sD(K,{size:Q});return K}var fy=C(()=>{GX()});function by($){return Array.isArray($[0])}var v21=1,_21=2,rD=4,EX;var my=C(()=>{M0();fy();EX=class EX extends _8{constructor($){super({...$,attributes:{positions:{size:3,padding:18,initialize:!0,type:$.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get($){return this.attributes[$]}getGeometryFromBuffer($){if(this.normalize)return super.getGeometryFromBuffer($);return null}normalizeGeometry($){if(this.normalize)return yy($,this.positionSize,this.opts.resolution,this.opts.wrapLongitude);return $}getGeometrySize($){if(by($)){let J=0;for(let Z of $)J+=this.getGeometrySize(Z);return J}let Q=this.getPathLength($);if(Q<2)return 0;if(this.isClosed($))return Q<3?0:Q+2;return Q}updateGeometryAttributes($,Q){if(Q.geometrySize===0)return;if($&&by($))for(let J of $){let Z=this.getGeometrySize(J);Q.geometrySize=Z,this.updateGeometryAttributes(J,Q),Q.vertexStart+=Z}else this._updateSegmentTypes($,Q),this._updatePositions($,Q)}_updateSegmentTypes($,Q){let J=this.attributes.segmentTypes,Z=$?this.isClosed($):!1,{vertexStart:K,geometrySize:X}=Q;if(J.fill(0,K,K+X),Z)J[K]=rD,J[K+X-2]=rD;else J[K]+=v21,J[K+X-2]+=_21;J[K+X-1]=rD}_updatePositions($,Q){let{positions:J}=this.attributes;if(!J||!$)return;let{vertexStart:Z,geometrySize:K}=Q,X=[,,,];for(let Y=Z,W=0;W<K;Y++,W++)this.getPointOnPath($,W,X),J[Y*3]=X[0],J[Y*3+1]=X[1],J[Y*3+2]=X[2]}getPathLength($){return $.length/this.positionSize}getPointOnPath($,Q,J=[]){let{positionSize:Z}=this;if(Q*Z>=$.length)Q+=1-$.length/Z;let K=Q*Z;return J[0]=$[K],J[1]=$[K+1],J[2]=Z===3&&$[K+2]||0,J}isClosed($){if(!this.normalize)return Boolean(this.opts.loop);let{positionSize:Q}=this,J=$.length-Q;return $[0]===$[J]&&$[1]===$[J+1]&&(Q===2||$[2]===$[J+2])}}});var cy;var dy=C(()=>{cy={name:"path",vs:`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,fs:`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}}});var ly=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var py=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var uy,x21,aD,jX,iy;var ny=C(()=>{M0();V5();V5();my();dy();uy=[0,0,0,255],x21={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:($)=>$.path},getColor:{type:"accessor",value:uy},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},aD={enter:($,Q)=>{return Q.length?Q.subarray(Q.length-$.length):$}};jX=class jX extends i0{getShaders(){return super.getShaders({vs:ly,fs:py,modules:[f5,m5,cy]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:aD,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:aD,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:aD,defaultValue:uy},instancePickingColors:{size:4,type:"uint8",accessor:(J,{index:Z,target:K})=>this.encodePickingColor(J&&J.__source?J.__source.index:Z,K)}}),this.setState({pathTesselator:new EX({fp64:this.use64bitPositions()})})}updateState($){super.updateState($);let{props:Q,changeFlags:J}=$,Z=this.getAttributeManager();if(J.dataChanged||J.updateTriggersChanged&&(J.updateTriggersChanged.all||J.updateTriggersChanged.getPath)){let{pathTesselator:X}=this.state,Y=Q.data.attributes||{};if(X.updateGeometry({data:Q.data,geometryBuffer:Y.getPath,buffers:Y,normalize:!Q._pathType,loop:Q._pathType==="loop",getGeometry:Q.getPath,positionFormat:Q.positionFormat,wrapLongitude:Q.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:J.dataChanged}),this.setState({numInstances:X.instanceCount,startIndices:X.vertexStarts}),!J.dataChanged)Z.invalidateAll()}if(J.extensionsChanged)this.state.model?.destroy(),this.state.model=this._getModel(),Z.invalidateAll()}getPickingInfo($){let Q=super.getPickingInfo($),{index:J}=Q,Z=this.props.data;if(Z[0]&&Z[0].__source)Q.object=Z.find((K)=>K.__source.index===J);return Q}disablePickingIndex($){let Q=this.props.data;if(Q[0]&&Q[0].__source){for(let J=0;J<Q.length;J++)if(Q[J].__source.index===$)this._disablePickingIndex(J)}else super.disablePickingIndex($)}draw({uniforms:$}){let{jointRounded:Q,capRounded:J,billboard:Z,miterLimit:K,widthUnits:X,widthScale:Y,widthMinPixels:W,widthMaxPixels:q}=this.props,H=this.state.model,F={jointType:Number(Q),capType:Number(J),billboard:Z,widthUnits:y0[X],widthScale:Y,miterLimit:K,widthMinPixels:W,widthMaxPixels:q};H.shaderInputs.setProps({path:F}),H.draw(this.context.renderPass)}_getModel(){let $=[0,1,2,1,4,2,1,3,4,3,5,4],Q=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new P0(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new U5({topology:"triangle-list",attributes:{indices:new Uint16Array($),positions:{value:new Float32Array(Q),size:2}}}),isInstanced:!0})}calculatePositions($){let{pathTesselator:Q}=this.state;$.startIndices=Q.vertexStarts,$.value=Q.get("positions")}calculateSegmentTypes($){let{pathTesselator:Q}=this.state;$.startIndices=Q.vertexStarts,$.value=Q.get("segmentTypes")}};jX.defaultProps=x21;jX.layerName="PathLayer";iy=jX});var ty=g((fL1,QC)=>{QC.exports=vX;QC.exports.default=vX;function vX($,Q,J){J=J||2;var Z=Q&&Q.length,K=Z?Q[0]*J:$.length,X=oy($,0,K,J,!0),Y=[];if(!X||X.next===X.prev)return Y;var W,q,H,F,U,V,N;if(Z)X=m21($,Q,X,J);if($.length>80*J){W=H=$[0],q=F=$[1];for(var D=J;D<K;D+=J){if(U=$[D],V=$[D+1],U<W)W=U;if(V<q)q=V;if(U>H)H=U;if(V>F)F=V}N=Math.max(H-W,F-q),N=N!==0?32767/N:0}return x$(X,Y,J,W,q,N,0),Y}function oy($,Q,J,Z,K){var X,Y;if(K===$C($,Q,J,Z)>0)for(X=Q;X<J;X+=Z)Y=sy(X,$[X],$[X+1],Y);else for(X=J-Z;X>=Q;X-=Z)Y=sy(X,$[X],$[X+1],Y);if(Y&&_X(Y,Y.next))y$(Y),Y=Y.next;return Y}function x8($,Q){if(!$)return $;if(!Q)Q=$;var J=$,Z;do if(Z=!1,!J.steiner&&(_X(J,J.next)||e1(J.prev,J,J.next)===0)){if(y$(J),J=Q=J.prev,J===J.next)break;Z=!0}else J=J.next;while(Z||J!==Q);return Q}function x$($,Q,J,Z,K,X,Y){if(!$)return;if(!Y&&X)u21($,Z,K,X);var W=$,q,H;while($.prev!==$.next){if(q=$.prev,H=$.next,X?y21($,Z,K,X):g21($)){Q.push(q.i/J|0),Q.push($.i/J|0),Q.push(H.i/J|0),y$($),$=H.next,W=H.next;continue}if($=H,$===W){if(!Y)x$(x8($),Q,J,Z,K,X,1);else if(Y===1)$=f21(x8($),Q,J),x$($,Q,J,Z,K,X,2);else if(Y===2)b21($,Q,J,Z,K,X);break}}}function g21($){var Q=$.prev,J=$,Z=$.next;if(e1(Q,J,Z)>=0)return!1;var K=Q.x,X=J.x,Y=Z.x,W=Q.y,q=J.y,H=Z.y,F=K<X?K<Y?K:Y:X<Y?X:Y,U=W<q?W<H?W:H:q<H?q:H,V=K>X?K>Y?K:Y:X>Y?X:Y,N=W>q?W>H?W:H:q>H?q:H,D=Z.next;while(D!==Q){if(D.x>=F&&D.x<=V&&D.y>=U&&D.y<=N&&D3(K,W,X,q,Y,H,D.x,D.y)&&e1(D.prev,D,D.next)>=0)return!1;D=D.next}return!0}function y21($,Q,J,Z){var K=$.prev,X=$,Y=$.next;if(e1(K,X,Y)>=0)return!1;var W=K.x,q=X.x,H=Y.x,F=K.y,U=X.y,V=Y.y,N=W<q?W<H?W:H:q<H?q:H,D=F<U?F<V?F:V:U<V?U:V,z=W>q?W>H?W:H:q>H?q:H,B=F>U?F>V?F:V:U>V?U:V,M=tD(N,D,Q,J,Z),P=tD(z,B,Q,J,Z),O=$.prevZ,G=$.nextZ;while(O&&O.z>=M&&G&&G.z<=P){if(O.x>=N&&O.x<=z&&O.y>=D&&O.y<=B&&O!==K&&O!==Y&&D3(W,F,q,U,H,V,O.x,O.y)&&e1(O.prev,O,O.next)>=0)return!1;if(O=O.prevZ,G.x>=N&&G.x<=z&&G.y>=D&&G.y<=B&&G!==K&&G!==Y&&D3(W,F,q,U,H,V,G.x,G.y)&&e1(G.prev,G,G.next)>=0)return!1;G=G.nextZ}while(O&&O.z>=M){if(O.x>=N&&O.x<=z&&O.y>=D&&O.y<=B&&O!==K&&O!==Y&&D3(W,F,q,U,H,V,O.x,O.y)&&e1(O.prev,O,O.next)>=0)return!1;O=O.prevZ}while(G&&G.z<=P){if(G.x>=N&&G.x<=z&&G.y>=D&&G.y<=B&&G!==K&&G!==Y&&D3(W,F,q,U,H,V,G.x,G.y)&&e1(G.prev,G,G.next)>=0)return!1;G=G.nextZ}return!0}function f21($,Q,J){var Z=$;do{var K=Z.prev,X=Z.next.next;if(!_X(K,X)&&ry(K,Z,Z.next,X)&&g$(K,X)&&g$(X,K))Q.push(K.i/J|0),Q.push(Z.i/J|0),Q.push(X.i/J|0),y$(Z),y$(Z.next),Z=$=X;Z=Z.next}while(Z!==$);return x8(Z)}function b21($,Q,J,Z,K,X){var Y=$;do{var W=Y.next.next;while(W!==Y.prev){if(Y.i!==W.i&&s21(Y,W)){var q=ay(Y,W);Y=x8(Y,Y.next),q=x8(q,q.next),x$(Y,Q,J,Z,K,X,0),x$(q,Q,J,Z,K,X,0);return}W=W.next}Y=Y.next}while(Y!==$)}function m21($,Q,J,Z){var K=[],X,Y,W,q,H;for(X=0,Y=Q.length;X<Y;X++){if(W=Q[X]*Z,q=X<Y-1?Q[X+1]*Z:$.length,H=oy($,W,q,Z,!1),H===H.next)H.steiner=!0;K.push(n21(H))}K.sort(c21);for(X=0;X<K.length;X++)J=d21(K[X],J);return J}function c21($,Q){return $.x-Q.x}function d21($,Q){var J=l21($,Q);if(!J)return Q;var Z=ay(J,$);return x8(Z,Z.next),x8(J,J.next)}function l21($,Q){var J=Q,Z=$.x,K=$.y,X=-1/0,Y;do{if(K<=J.y&&K>=J.next.y&&J.next.y!==J.y){var W=J.x+(K-J.y)*(J.next.x-J.x)/(J.next.y-J.y);if(W<=Z&&W>X){if(X=W,Y=J.x<J.next.x?J:J.next,W===Z)return Y}}J=J.next}while(J!==Q);if(!Y)return null;var q=Y,H=Y.x,F=Y.y,U=1/0,V;J=Y;do{if(Z>=J.x&&J.x>=H&&Z!==J.x&&D3(K<F?Z:X,K,H,F,K<F?X:Z,K,J.x,J.y)){if(V=Math.abs(K-J.y)/(Z-J.x),g$(J,$)&&(V<U||V===U&&(J.x>Y.x||J.x===Y.x&&p21(Y,J))))Y=J,U=V}J=J.next}while(J!==q);return Y}function p21($,Q){return e1($.prev,$,Q.prev)<0&&e1(Q.next,$,$.next)<0}function u21($,Q,J,Z){var K=$;do{if(K.z===0)K.z=tD(K.x,K.y,Q,J,Z);K.prevZ=K.prev,K.nextZ=K.next,K=K.next}while(K!==$);K.prevZ.nextZ=null,K.prevZ=null,i21(K)}function i21($){var Q,J,Z,K,X,Y,W,q,H=1;do{J=$,$=null,X=null,Y=0;while(J){Y++,Z=J,W=0;for(Q=0;Q<H;Q++)if(W++,Z=Z.nextZ,!Z)break;q=H;while(W>0||q>0&&Z){if(W!==0&&(q===0||!Z||J.z<=Z.z))K=J,J=J.nextZ,W--;else K=Z,Z=Z.nextZ,q--;if(X)X.nextZ=K;else $=K;K.prevZ=X,X=K}J=Z}X.nextZ=null,H*=2}while(Y>1);return $}function tD($,Q,J,Z,K){return $=($-J)*K|0,Q=(Q-Z)*K|0,$=($|$<<8)&16711935,$=($|$<<4)&252645135,$=($|$<<2)&858993459,$=($|$<<1)&1431655765,Q=(Q|Q<<8)&16711935,Q=(Q|Q<<4)&252645135,Q=(Q|Q<<2)&858993459,Q=(Q|Q<<1)&1431655765,$|Q<<1}function n21($){var Q=$,J=$;do{if(Q.x<J.x||Q.x===J.x&&Q.y<J.y)J=Q;Q=Q.next}while(Q!==$);return J}function D3($,Q,J,Z,K,X,Y,W){return(K-Y)*(Q-W)>=($-Y)*(X-W)&&($-Y)*(Z-W)>=(J-Y)*(Q-W)&&(J-Y)*(X-W)>=(K-Y)*(Z-W)}function s21($,Q){return $.next.i!==Q.i&&$.prev.i!==Q.i&&!o21($,Q)&&(g$($,Q)&&g$(Q,$)&&r21($,Q)&&(e1($.prev,$,Q.prev)||e1($,Q.prev,Q))||_X($,Q)&&e1($.prev,$,$.next)>0&&e1(Q.prev,Q,Q.next)>0)}function e1($,Q,J){return(Q.y-$.y)*(J.x-Q.x)-(Q.x-$.x)*(J.y-Q.y)}function _X($,Q){return $.x===Q.x&&$.y===Q.y}function ry($,Q,J,Z){var K=LX(e1($,Q,J)),X=LX(e1($,Q,Z)),Y=LX(e1(J,Z,$)),W=LX(e1(J,Z,Q));if(K!==X&&Y!==W)return!0;if(K===0&&hX($,J,Q))return!0;if(X===0&&hX($,Z,Q))return!0;if(Y===0&&hX(J,$,Z))return!0;if(W===0&&hX(J,Q,Z))return!0;return!1}function hX($,Q,J){return Q.x<=Math.max($.x,J.x)&&Q.x>=Math.min($.x,J.x)&&Q.y<=Math.max($.y,J.y)&&Q.y>=Math.min($.y,J.y)}function LX($){return $>0?1:$<0?-1:0}function o21($,Q){var J=$;do{if(J.i!==$.i&&J.next.i!==$.i&&J.i!==Q.i&&J.next.i!==Q.i&&ry(J,J.next,$,Q))return!0;J=J.next}while(J!==$);return!1}function g$($,Q){return e1($.prev,$,$.next)<0?e1($,Q,$.next)>=0&&e1($,$.prev,Q)>=0:e1($,Q,$.prev)<0||e1($,$.next,Q)<0}function r21($,Q){var J=$,Z=!1,K=($.x+Q.x)/2,X=($.y+Q.y)/2;do{if(J.y>X!==J.next.y>X&&J.next.y!==J.y&&K<(J.next.x-J.x)*(X-J.y)/(J.next.y-J.y)+J.x)Z=!Z;J=J.next}while(J!==$);return Z}function ay($,Q){var J=new eD($.i,$.x,$.y),Z=new eD(Q.i,Q.x,Q.y),K=$.next,X=Q.prev;return $.next=Q,Q.prev=$,J.next=K,K.prev=J,Z.next=J,J.prev=Z,X.next=Z,Z.prev=X,Z}function sy($,Q,J,Z){var K=new eD($,Q,J);if(!Z)K.prev=K,K.next=K;else K.next=Z.next,K.prev=Z,Z.next.prev=K,Z.next=K;return K}function y$($){if($.next.prev=$.prev,$.prev.next=$.next,$.prevZ)$.prevZ.nextZ=$.nextZ;if($.nextZ)$.nextZ.prevZ=$.prevZ}function eD($,Q,J){this.i=$,this.x=Q,this.y=J,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}vX.deviation=function($,Q,J,Z){var K=Q&&Q.length,X=K?Q[0]*J:$.length,Y=Math.abs($C($,0,X,J));if(K)for(var W=0,q=Q.length;W<q;W++){var H=Q[W]*J,F=W<q-1?Q[W+1]*J:$.length;Y-=Math.abs($C($,H,F,J))}var U=0;for(W=0;W<Z.length;W+=3){var V=Z[W]*J,N=Z[W+1]*J,D=Z[W+2]*J;U+=Math.abs(($[V]-$[D])*($[N+1]-$[V+1])-($[V]-$[N])*($[D+1]-$[V+1]))}return Y===0&&U===0?0:Math.abs((U-Y)/Y)};function $C($,Q,J,Z){var K=0;for(var X=Q,Y=J-Z;X<J;X+=Z)K+=($[Y]-$[X])*($[X+1]+$[Y+1]),Y=X;return K}vX.flatten=function($){var Q=$[0][0].length,J={vertices:[],holes:[],dimensions:Q},Z=0;for(var K=0;K<$.length;K++){for(var X=0;X<$[K].length;X++)for(var Y=0;Y<Q;Y++)J.vertices.push($[K][X][Y]);if(K>0)Z+=$[K-1].length,J.holes.push(Z)}return J}});function a21($){if($=$&&$.positions||$,!Array.isArray($)&&!ArrayBuffer.isView($))throw Error("invalid polygon")}function C3($){return"positions"in $?$.positions:$}function f$($){return"holeIndices"in $?$.holeIndices:null}function t21($){return Array.isArray($[0])}function e21($){return $.length>=1&&$[0].length>=2&&Number.isFinite($[0][0])}function $$1($){let Q=$[0],J=$[$.length-1];return Q[0]===J[0]&&Q[1]===J[1]&&Q[2]===J[2]}function Q$1($,Q,J,Z){for(let K=0;K<Q;K++)if($[J+K]!==$[Z-Q+K])return!1;return!0}function $f($,Q,J,Z,K){let X=Q,Y=J.length;for(let W=0;W<Y;W++)for(let q=0;q<Z;q++)$[X++]=J[W][q]||0;if(!$$1(J))for(let W=0;W<Z;W++)$[X++]=J[0][W]||0;return I7.start=Q,I7.end=X,I7.size=Z,j$($,K,I7),X}function Qf($,Q,J,Z,K=0,X,Y){X=X||J.length;let W=X-K;if(W<=0)return Q;let q=Q;for(let H=0;H<W;H++)$[q++]=J[K+H];if(!Q$1(J,Z,K,X))for(let H=0;H<Z;H++)$[q++]=J[K+H];return I7.start=Q,I7.end=q,I7.size=Z,j$($,Y,I7),q}function Kf($,Q){a21($);let J=[],Z=[];if("positions"in $){let{positions:K,holeIndices:X}=$;if(X){let Y=0;for(let W=0;W<=X.length;W++)Y=Qf(J,Y,K,Q,X[W-1],X[W],W===0?xX:ey),Z.push(Y);return Z.pop(),{positions:J,holeIndices:Z}}$=K}if(!t21($))return Qf(J,0,$,Q,0,J.length,xX),J;if(!e21($)){let K=0;for(let[X,Y]of $.entries())K=$f(J,K,Y,Q,X===0?xX:ey),Z.push(K);return Z.pop(),{positions:J,holeIndices:Z}}return $f(J,0,$,Q,xX),J}function JC($,Q,J){let Z=$.length/3,K=0;for(let X=0;X<Z;X++){let Y=(X+1)%Z;K+=$[X*3+Q]*$[Y*3+J],K-=$[Y*3+Q]*$[X*3+J]}return Math.abs(K/2)}function Jf($,Q,J,Z){let K=$.length/3;for(let X=0;X<K;X++){let Y=X*3,W=$[Y+0],q=$[Y+1],H=$[Y+2];$[Y+Q]=W,$[Y+J]=q,$[Y+Z]=H}}function Xf($,Q,J,Z){let K=f$($);if(K)K=K.map((W)=>W/Q);let X=C3($),Y=Z&&Q===3;if(J){let W=X.length;X=X.slice();let q=[];for(let H=0;H<W;H+=Q){if(q[0]=X[H],q[1]=X[H+1],Y)q[2]=X[H+2];let F=J(q);if(X[H]=F[0],X[H+1]=F[1],Y)X[H+2]=F[2]}}if(Y){let W=JC(X,0,1),q=JC(X,0,2),H=JC(X,1,2);if(!W&&!q&&!H)return[];if(W>q&&W>H);else if(q>H){if(!J)X=X.slice();Jf(X,0,2,1)}else{if(!J)X=X.slice();Jf(X,2,0,1)}}return Zf.default(X,K,Q)}var Zf,xX,ey,I7;var Yf=C(()=>{GX();Zf=A0(ty(),1),xX=MX.CLOCKWISE,ey=MX.COUNTER_CLOCKWISE,I7={isClosed:!0}});function Wf($){return Array.isArray($)&&$.length>0&&!Number.isFinite($[0])}var gX;var qf=C(()=>{Yf();M0();GX();gX=class gX extends _8{constructor($){let{fp64:Q,IndexType:J=Uint32Array}=$;super({...$,attributes:{positions:{size:3,type:Q?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:J,size:1}}})}get($){let{attributes:Q}=this;if($==="indices")return Q.indices&&Q.indices.subarray(0,this.vertexCount);return Q[$]}updateGeometry($){super.updateGeometry($);let Q=this.buffers.indices;if(Q)this.vertexCount=(Q.value||Q).length;else if(this.data&&!this.getGeometry)throw Error("missing indices buffer")}normalizeGeometry($){if(this.normalize){let Q=Kf($,this.positionSize);if(this.opts.resolution)return _$(C3(Q),f$(Q),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return oD(C3(Q),f$(Q),{size:this.positionSize,maxLatitude:86,edgeTypes:!0});return Q}return $}getGeometrySize($){if(Wf($)){let Q=0;for(let J of $)Q+=this.getGeometrySize(J);return Q}return C3($).length/this.positionSize}getGeometryFromBuffer($){if(this.normalize||!this.buffers.indices)return super.getGeometryFromBuffer($);return null}updateGeometryAttributes($,Q){if($&&Wf($))for(let J of $){let Z=this.getGeometrySize(J);Q.geometrySize=Z,this.updateGeometryAttributes(J,Q),Q.vertexStart+=Z,Q.indexStart=this.indexStarts[Q.geometryIndex+1]}else{let J=$;this._updateIndices(J,Q),this._updatePositions(J,Q),this._updateVertexValid(J,Q)}}_updateIndices($,{geometryIndex:Q,vertexStart:J,indexStart:Z}){let{attributes:K,indexStarts:X,typedArrayManager:Y}=this,W=K.indices;if(!W||!$)return;let q=Z,H=Xf($,this.positionSize,this.opts.preproject,this.opts.full3d);W=Y.allocate(W,Z+H.length,{copy:!0});for(let F=0;F<H.length;F++)W[q++]=H[F]+J;X[Q+1]=Z+H.length,K.indices=W}_updatePositions($,{vertexStart:Q,geometrySize:J}){let{attributes:{positions:Z},positionSize:K}=this;if(!Z||!$)return;let X=C3($);for(let Y=Q,W=0;W<J;Y++,W++){let q=X[W*K],H=X[W*K+1],F=K>2?X[W*K+2]:0;Z[Y*3]=q,Z[Y*3+1]=H,Z[Y*3+2]=F}}_updateVertexValid($,{vertexStart:Q,geometrySize:J}){let{positionSize:Z}=this,K=this.attributes.vertexValid,X=$&&f$($);if($&&$.edgeTypes)K.set($.edgeTypes,Q);else K.fill(1,Q,Q+J);if(X)for(let Y=0;Y<X.length;Y++)K[Q+X[Y]/Z-1]=0;K[Q+J-1]=0}}});var Hf;var Ff=C(()=>{Hf={name:"solidPolygon",vs:`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,fs:`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}}});var yX=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var Uf;var Vf=C(()=>{Uf=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${yX}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`});var Nf;var Df=C(()=>{Nf=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${yX}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`});var Cf=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var bX,Z$1,fX,mX,Af;var zf=C(()=>{M0();V5();V4();qf();Ff();Vf();Df();bX=[0,0,0,255],Z$1={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:($)=>$.polygon},getElevation:{type:"accessor",value:1000},getFillColor:{type:"accessor",value:bX},getLineColor:{type:"accessor",value:bX},material:!0},fX={enter:($,Q)=>{return Q.length?Q.subarray(Q.length-$.length):$}};mX=class mX extends i0{getShaders($){return super.getShaders({vs:$==="top"?Uf:Nf,fs:Cf,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[f5,fZ,m5,Hf]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){let{viewport:$}=this.context,{coordinateSystem:Q}=this.props,{_full3d:J}=this.props;if($.isGeospatial&&Q===z1.DEFAULT)Q=z1.LNGLAT;let Z;if(Q===z1.LNGLAT)if(J)Z=$.projectPosition.bind($);else Z=$.projectFlat.bind($);this.setState({numInstances:0,polygonTesselator:new gX({preproject:Z,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let K=this.getAttributeManager(),X=!0;K.remove(["instancePickingColors"]),K.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:X},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:fX,accessor:"getPolygon",update:this.calculatePositions,noAlloc:X,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:X},elevations:{size:1,stepMode:"dynamic",transition:fX,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:fX,accessor:"getFillColor",defaultValue:bX},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:fX,accessor:"getLineColor",defaultValue:bX},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(Y,{index:W,target:q})=>this.encodePickingColor(Y&&Y.__source?Y.__source.index:W,q)}})}getPickingInfo($){let Q=super.getPickingInfo($),{index:J}=Q,Z=this.props.data;if(Z[0]&&Z[0].__source)Q.object=Z.find((K)=>K.__source.index===J);return Q}disablePickingIndex($){let Q=this.props.data;if(Q[0]&&Q[0].__source){for(let J=0;J<Q.length;J++)if(Q[J].__source.index===$)this._disablePickingIndex(J)}else super.disablePickingIndex($)}draw({uniforms:$}){let{extruded:Q,filled:J,wireframe:Z,elevationScale:K}=this.props,{topModel:X,sideModel:Y,wireframeModel:W,polygonTesselator:q}=this.state,H={extruded:Boolean(Q),elevationScale:K,isWireframe:!1};if(W&&Z)W.setInstanceCount(q.instanceCount-1),W.shaderInputs.setProps({solidPolygon:{...H,isWireframe:!0}}),W.draw(this.context.renderPass);if(Y&&J)Y.setInstanceCount(q.instanceCount-1),Y.shaderInputs.setProps({solidPolygon:H}),Y.draw(this.context.renderPass);if(X&&J)X.setVertexCount(q.vertexCount),X.shaderInputs.setProps({solidPolygon:H}),X.draw(this.context.renderPass)}updateState($){super.updateState($),this.updateGeometry($);let{props:Q,oldProps:J,changeFlags:Z}=$,K=this.getAttributeManager();if(Z.extensionsChanged||Q.filled!==J.filled||Q.extruded!==J.extruded)this.state.models?.forEach((Y)=>Y.destroy()),this.setState(this._getModels()),K.invalidateAll()}updateGeometry({props:$,oldProps:Q,changeFlags:J}){if(J.dataChanged||J.updateTriggersChanged&&(J.updateTriggersChanged.all||J.updateTriggersChanged.getPolygon)){let{polygonTesselator:K}=this.state,X=$.data.attributes||{};if(K.updateGeometry({data:$.data,normalize:$._normalize,geometryBuffer:X.getPolygon,buffers:X,getGeometry:$.getPolygon,positionFormat:$.positionFormat,wrapLongitude:$.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:J.dataChanged,full3d:$._full3d}),this.setState({numInstances:K.instanceCount,startIndices:K.vertexStarts}),!J.dataChanged)this.getAttributeManager().invalidateAll()}}_getModels(){let{id:$,filled:Q,extruded:J}=this.props,Z,K,X;if(Q){let Y=this.getShaders("top");Y.defines.NON_INSTANCED_MODEL=1;let W=this.getAttributeManager().getBufferLayouts({isInstanced:!1});Z=new P0(this.context.device,{...Y,id:`${$}-top`,topology:"triangle-list",bufferLayout:W,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(J){let Y=this.getAttributeManager().getBufferLayouts({isInstanced:!0});K=new P0(this.context.device,{...this.getShaders("side"),id:`${$}-side`,bufferLayout:Y,geometry:new U5({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),X=new P0(this.context.device,{...this.getShaders("side"),id:`${$}-wireframe`,bufferLayout:Y,geometry:new U5({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[K,X,Z].filter(Boolean),topModel:Z,sideModel:K,wireframeModel:X}}calculateIndices($){let{polygonTesselator:Q}=this.state;$.startIndices=Q.indexStarts,$.value=Q.get("indices")}calculatePositions($){let{polygonTesselator:Q}=this.state;$.startIndices=Q.vertexStarts,$.value=Q.get("positions")}calculateVertexValid($){$.value=this.state.polygonTesselator.get("vertexValid")}};mX.defaultProps=Z$1;mX.layerName="SolidPolygonLayer";Af=mX});function kf({data:$,getIndex:Q,dataRange:J,replace:Z}){let{startRow:K=0,endRow:X=1/0}=J,Y=$.length,W=Y,q=Y;for(let V=0;V<Y;V++){let N=Q($[V]);if(W>V&&N>=K)W=V;if(N>=X){q=V;break}}let H=W,U=q-W!==Z.length?$.slice(q):void 0;for(let V=0;V<Z.length;V++)$[H++]=Z[V];if(U){for(let V=0;V<U.length;V++)$[H++]=U[V];$.length=H}return{startRow:W,endRow:W+Z.length}}function Bf($,Q){if(!$)return null;let J="startIndices"in $?$.startIndices[Q]:Q,Z=$.featureIds.value[J];if(J!==-1)return K$1($,Z,J);return null}function K$1($,Q,J){let Z={properties:{...$.properties[Q]}};for(let K in $.numericProps)Z.properties[K]=$.numericProps[K].value[J];return Z}function Rf($,Q){let J={points:null,lines:null,polygons:null};for(let Z in J){let K=$[Z].globalFeatureIds.value;J[Z]=new Uint8ClampedArray(K.length*4);let X=[];for(let Y=0;Y<K.length;Y++)Q(K[Y],X),J[Z][Y*4+0]=X[0],J[Z][Y*4+1]=X[1],J[Z][Y*4+2]=X[2],J[Z][Y*4+3]=255}return J}var Of;var Pf=C(()=>{Of={name:"sdf",vs:`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,fs:`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}}});var Mf=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var ZC=0.75,wf,X$1,cX,Sf;var Tf=C(()=>{M0();lD();Pf();wf=[],X$1={getIconOffsets:{type:"accessor",value:($)=>$.offsets},alphaCutoff:0.001,smoothing:0.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};cX=class cX extends OX{getShaders(){let $=super.getShaders();return{...$,modules:[...$.modules,Of],fs:Mf}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(Q,{index:J,target:Z})=>this.encodePickingColor(J,Z)}})}updateState($){super.updateState($);let{props:Q,oldProps:J}=$,{outlineColor:Z}=Q;if(Z!==J.outlineColor)Z=Z.map((K)=>K/255),Z[3]=Number.isFinite(Z[3])?Z[3]:1,this.setState({outlineColor:Z});if(!Q.sdf&&Q.outlineWidth)r.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw($){let{sdf:Q,smoothing:J,outlineWidth:Z}=this.props,{outlineColor:K}=this.state,X=Z?Math.max(J,ZC*(1-Z)):-1,Y=this.state.model,W={buffer:ZC,outlineBuffer:X,gamma:J,enabled:Boolean(Q),outlineColor:K};if(Y.shaderInputs.setProps({sdf:W}),super.draw($),Q&&Z){let{iconManager:q}=this.state;if(q.getTexture())Y.shaderInputs.setProps({sdf:{...W,outlineBuffer:ZC}}),Y.draw(this.context.renderPass)}}getInstanceOffset($){return $?Array.from($).flatMap((Q)=>super.getInstanceOffset(Q)):wf}getInstanceColorMode($){return 1}getInstanceIconFrame($){return $?Array.from($).flatMap((Q)=>super.getInstanceIconFrame(Q)):wf}};cX.defaultProps=X$1;cX.layerName="MultiIconLayer";Sf=cX});class dX{constructor({fontSize:$=24,buffer:Q=3,radius:J=8,cutoff:Z=0.25,fontFamily:K="sans-serif",fontWeight:X="normal",fontStyle:Y="normal",lang:W=null}={}){this.buffer=Q,this.cutoff=Z,this.radius=J,this.lang=W;let q=this.size=$+Q*4,H=this._createCanvas(q),F=this.ctx=H.getContext("2d",{willReadFrequently:!0});F.font=`${Y} ${X} ${$}px ${K}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(q*q),this.gridInner=new Float64Array(q*q),this.f=new Float64Array(q),this.z=new Float64Array(q+1),this.v=new Uint16Array(q)}_createCanvas($){let Q=document.createElement("canvas");return Q.width=Q.height=$,Q}draw($){let{width:Q,actualBoundingBoxAscent:J,actualBoundingBoxDescent:Z,actualBoundingBoxLeft:K,actualBoundingBoxRight:X}=this.ctx.measureText($),Y=Math.ceil(J),W=0,q=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(X-K))),H=Math.min(this.size-this.buffer,Y+Math.ceil(Z)),F=q+2*this.buffer,U=H+2*this.buffer,V=Math.max(F*U,0),N=new Uint8ClampedArray(V),D={data:N,width:F,height:U,glyphWidth:q,glyphHeight:H,glyphTop:Y,glyphLeft:0,glyphAdvance:Q};if(q===0||H===0)return D;let{ctx:z,buffer:B,gridInner:M,gridOuter:P}=this;if(this.lang)z.lang=this.lang;z.clearRect(B,B,q,H),z.fillText($,B,B+Y);let O=z.getImageData(B,B,q,H);P.fill(100000000000000000000,0,V),M.fill(0,0,V);for(let G=0;G<H;G++)for(let L=0;L<q;L++){let b=O.data[4*(G*q+L)+3]/255;if(b===0)continue;let d=(G+B)*F+L+B;if(b===1)P[d]=0,M[d]=100000000000000000000;else{let p=0.5-b;P[d]=p>0?p*p:0,M[d]=p<0?p*p:0}}If(P,0,0,F,U,F,this.f,this.v,this.z),If(M,B,B,q,H,F,this.f,this.v,this.z);for(let G=0;G<V;G++){let L=Math.sqrt(P[G])-Math.sqrt(M[G]);N[G]=Math.round(255-255*(L/this.radius+this.cutoff))}return D}}function If($,Q,J,Z,K,X,Y,W,q){for(let H=Q;H<Q+Z;H++)Gf($,J*X+H,X,K,Y,W,q);for(let H=J;H<J+K;H++)Gf($,H*X+Q,1,Z,Y,W,q)}function Gf($,Q,J,Z,K,X,Y){X[0]=0,Y[0]=-100000000000000000000,Y[1]=100000000000000000000,K[0]=$[Q];for(let W=1,q=0,H=0;W<Z;W++){K[W]=$[Q+W*J];let F=W*W;do{let U=X[q];H=(K[W]-K[U]+F-U*U)/(W-U)/2}while(H<=Y[q]&&--q>-1);q++,X[q]=W,Y[q]=H,Y[q+1]=100000000000000000000}for(let W=0,q=0;W<Z;W++){while(Y[q+1]<W)q++;let H=X[q],F=W-H;$[Q+W*J]=K[H]+F*F}}function q$1($){return Math.pow(2,Math.ceil(Math.log2($)))}function Ef({characterSet:$,getFontWidth:Q,fontHeight:J,buffer:Z,maxCanvasWidth:K,mapping:X={},xOffset:Y=0,yOffset:W=0}){let q=0,H=Y,F=J+Z*2;for(let U of $)if(!X[U]){let V=Q(U);if(H+V+Z*2>K)H=0,q++;X[U]={x:H+Z,y:W+q*F+Z,width:V,height:F,layoutWidth:V,layoutHeight:J},H+=V+Z*2}return{mapping:X,xOffset:H,yOffset:W+q*F,canvasHeight:q$1(W+(q+1)*F)}}function jf($,Q,J,Z){let K=0;for(let X=Q;X<J;X++){let Y=$[X];K+=Z[Y]?.layoutWidth||0}return K}function hf($,Q,J,Z,K,X){let Y=Q,W=0;for(let q=Q;q<J;q++){let H=jf($,q,q+1,K);if(W+H>Z){if(Y<q)X.push(q);Y=q,W=0}W+=H}return W}function H$1($,Q,J,Z,K,X){let Y=Q,W=Q,q=Q,H=0;for(let F=Q;F<J;F++){if($[F]===" ")q=F+1;else if($[F+1]===" "||F+1===J)q=F+1;if(q>W){let U=jf($,W,q,K);if(H+U>Z){if(Y<W)X.push(W),Y=W,H=0;if(U>Z)U=hf($,W,q,Z,K,X),Y=X[X.length-1]}W=q,H+=U}}return H}function F$1($,Q,J,Z,K=0,X){if(X===void 0)X=$.length;let Y=[];if(Q==="break-all")hf($,K,X,J,Z,Y);else H$1($,K,X,J,Z,Y);return Y}function U$1($,Q,J,Z,K,X){let Y=0,W=0;for(let q=Q;q<J;q++){let H=$[q],F=Z[H];if(F){if(!W)W=F.layoutHeight;K[q]=Y+F.layoutWidth/2,Y+=F.layoutWidth}else r.warn(`Missing character: ${H} (${H.codePointAt(0)})`)(),K[q]=Y,Y+=Y$1}X[0]=Y,X[1]=W}function Lf($,Q,J,Z,K){let X=Array.from($),Y=X.length,W=Array(Y),q=Array(Y),H=Array(Y),F=(J==="break-word"||J==="break-all")&&isFinite(Z)&&Z>0,U=[0,0],V=[0,0],N=0,D=0,z=0;for(let B=0;B<=Y;B++){let M=X[B];if(M===`
`||B===Y)z=B;if(z>D){let P=F?F$1(X,J,Z,K,D,z):W$1;for(let O=0;O<=P.length;O++){let G=O===0?D:P[O-1],L=O<P.length?P[O]:z;U$1(X,G,L,K,W,V);for(let b=G;b<L;b++){let d=W[b]-V[0]/2,p=X[b],i=K[p]?.layoutOffsetY||0;q[b]=N+V[1]/2+i,H[b]=V[0]}N=N+V[1]*Q,U[0]=Math.max(U[0],V[0])}D=z}if(M===`
`)W[D]=0,q[D]=0,H[D]=0,D++}return U[1]=N,{x:W,y:q,rowWidth:H,size:U}}function vf({value:$,length:Q,stride:J,offset:Z,startIndices:K,characterSet:X}){let Y=$.BYTES_PER_ELEMENT,W=J?J/Y:1,q=Z?Z/Y:0,H=K[Q]||Math.ceil(($.length-q)/W),F=X&&new Set,U=Array(Q),V=$;if(W>1||q>0){V=new $.constructor(H);for(let D=0;D<H;D++)V[D]=$[D*W+q]}for(let N=0;N<Q;N++){let D=K[N],z=K[N+1]||H,B=V.subarray(D,z);if(U[N]=String.fromCodePoint.apply(null,B),F)B.forEach(F.add,F)}if(F)for(let N of F)X.add(String.fromCodePoint(N));return{texts:U,characterCount:H}}var Y$1=32,W$1;var KC=C(()=>{M0();W$1=[]});class b${constructor($=5){this._cache={},this._order=[],this.limit=$}get($){let Q=this._cache[$];if(Q)this._deleteOrder($),this._appendOrder($);return Q}set($,Q){if(!this._cache[$]){if(Object.keys(this._cache).length===this.limit)this.delete(this._order[0]);this._cache[$]=Q,this._appendOrder($)}else this.delete($),this._cache[$]=Q,this._appendOrder($)}delete($){if(this._cache[$])delete this._cache[$],this._deleteOrder($)}_deleteOrder($){let Q=this._order.indexOf($);if(Q>=0)this._order.splice(Q,1)}_appendOrder($){this._order.push($)}}function V$1(){let $=[];for(let Q=32;Q<128;Q++)$.push(String.fromCharCode(Q));return $}function N$1($,Q){let J;if(typeof Q==="string")J=new Set(Array.from(Q));else J=new Set(Q);let Z=lX.get($);if(!Z)return J;for(let K in Z.mapping)if(J.has(K))J.delete(K);return J}function D$1($,Q){for(let J=0;J<$.length;J++)Q.data[4*J+3]=$[J]}function yf($,Q,J,Z){$.font=`${Z} ${J}px ${Q}`,$.fillStyle="#000",$.textBaseline="alphabetic",$.textAlign="left"}function bf($){r.assert(Number.isFinite($)&&$>=ff,"Invalid cache limit"),lX=new b$($)}class pX{constructor(){this.props={...g8}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:$,buffer:Q}=this.props;return($*gf+Q*2)/$}setProps($={}){Object.assign(this.props,$),this._key=this._getKey();let Q=N$1(this._key,this.props.characterSet),J=lX.get(this._key);if(J&&Q.size===0){if(this._atlas!==J)this._atlas=J;return}let Z=this._generateFontAtlas(Q,J);this._atlas=Z,lX.set(this._key,Z)}_generateFontAtlas($,Q){let{fontFamily:J,fontWeight:Z,fontSize:K,buffer:X,sdf:Y,radius:W,cutoff:q}=this.props,H=Q&&Q.data;if(!H)H=document.createElement("canvas"),H.width=_f;let F=H.getContext("2d",{willReadFrequently:!0});yf(F,J,K,Z);let{mapping:U,canvasHeight:V,xOffset:N,yOffset:D}=Ef({getFontWidth:(z)=>F.measureText(z).width,fontHeight:K*gf,buffer:X,characterSet:$,maxCanvasWidth:_f,...Q&&{mapping:Q.mapping,xOffset:Q.xOffset,yOffset:Q.yOffset}});if(H.height!==V){let z=F.getImageData(0,0,H.width,H.height);H.height=V,F.putImageData(z,0,0)}if(yf(F,J,K,Z),Y){let z=new dX({fontSize:K,buffer:X,radius:W,cutoff:q,fontFamily:J,fontWeight:`${Z}`});for(let B of $){let{data:M,width:P,height:O,glyphTop:G}=z.draw(B);U[B].width=P,U[B].layoutOffsetY=K*xf-G;let L=F.createImageData(P,O);D$1(M,L),F.putImageData(L,U[B].x,U[B].y)}}else for(let z of $)F.fillText(z,U[z].x,U[z].y+X+K*xf);return{xOffset:N,yOffset:D,mapping:U,data:H,width:H.width,height:H.height}}_getKey(){let{fontFamily:$,fontWeight:Q,fontSize:J,buffer:Z,sdf:K,radius:X,cutoff:Y}=this.props;if(K)return`${$} ${Q} ${J} ${Z} ${X} ${Y}`;return`${$} ${Q} ${J} ${Z}`}}var g8,_f=1024,xf=0.9,gf=1.2,ff=3,lX;var mf=C(()=>{M0();KC();g8={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:V$1(),fontSize:64,buffer:4,sdf:!1,cutoff:0.25,radius:12,smoothing:0.1},lX=new b$(ff)});var cf;var df=C(()=>{cf={name:"textBackground",vs:`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 borderRadius;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,fs:`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 borderRadius;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}}});var lf=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var pf=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
float round_rect(vec2 p, vec2 size, vec4 radii) {
vec2 pixelPositionCB = (p - 0.5) * size;
vec2 sizeCB = size * 0.5;
float maxBorderRadius = min(size.x, size.y) * 0.5;
vec4 borderRadius = vec4(min(radii, maxBorderRadius));
borderRadius.xy =
(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;
borderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;
vec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;
return -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);
}
float rect(vec2 p, vec2 size) {
vec2 pixelPosition = p * size;
return min(min(pixelPosition.x, size.x - pixelPosition.x),
min(pixelPosition.y, size.y - pixelPosition.y));
}
vec4 get_stroked_fragColor(float dist) {
float isBorder = smoothedge(dist, vLineWidth);
return mix(vFillColor, vLineColor, isBorder);
}
void main(void) {
geometry.uv = uv;
if (textBackground.borderRadius != vec4(0.0)) {
float distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);
if (textBackground.stroked) {
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
float shapeAlpha = smoothedge(-distToEdge, 0.0);
fragColor.a *= shapeAlpha;
} else {
if (textBackground.stroked) {
float distToEdge = rect(uv, dimensions);
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var C$1,uX,uf;var nf=C(()=>{M0();V5();V5();df();C$1={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:($)=>$.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};uX=class uX extends i0{getShaders(){return super.getShaders({vs:lf,fs:pf,modules:[f5,m5,cf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState($){super.updateState($);let{changeFlags:Q}=$;if(Q.extensionsChanged)this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()}draw({uniforms:$}){let{billboard:Q,sizeScale:J,sizeUnits:Z,sizeMinPixels:K,sizeMaxPixels:X,getLineWidth:Y}=this.props,{padding:W,borderRadius:q}=this.props;if(W.length<4)W=[W[0],W[1],W[0],W[1]];if(!Array.isArray(q))q=[q,q,q,q];let H=this.state.model,F={billboard:Q,stroked:Boolean(Y),borderRadius:q,padding:W,sizeUnits:y0[Z],sizeScale:J,sizeMinPixels:K,sizeMaxPixels:X};H.shaderInputs.setProps({textBackground:F}),H.draw(this.context.renderPass)}_getModel(){let $=[0,0,1,0,0,1,1,1];return new P0(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new U5({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array($)}}}),isInstanced:!0})}};uX.defaultProps=C$1;uX.layerName="TextBackgroundLayer";uf=uX});var sf,of,XC,A$1=1,z$1,iX,rf;var af=C(()=>{M0();Tf();mf();KC();nf();sf={start:1,middle:0,end:-1},of={top:1,center:0,bottom:-1},XC=[0,0,0,255],z$1={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:XC},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:g8.characterSet},fontFamily:g8.fontFamily,fontWeight:g8.fontWeight,lineHeight:A$1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:XC},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:($)=>$.text},getPosition:{type:"accessor",value:($)=>$.position},getColor:{type:"accessor",value:XC},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};iX=class iX extends G${constructor(){super(...arguments);this.getBoundingRect=($,Q)=>{let{size:[J,Z]}=this.transformParagraph($,Q),{fontSize:K}=this.state.fontAtlasManager.props;J/=K,Z/=K;let{getTextAnchor:X,getAlignmentBaseline:Y}=this.props,W=sf[typeof X==="function"?X($,Q):X],q=of[typeof Y==="function"?Y($,Q):Y];return[(W-1)*J/2,(q-1)*Z/2,J,Z]},this.getIconOffsets=($,Q)=>{let{getTextAnchor:J,getAlignmentBaseline:Z}=this.props,{x:K,y:X,rowWidth:Y,size:[W,q]}=this.transformParagraph($,Q),H=sf[typeof J==="function"?J($,Q):J],F=of[typeof Z==="function"?Z($,Q):Z],U=K.length,V=Array(U*2),N=0;for(let D=0;D<U;D++){let z=(1-H)*(W-Y[D])/2;V[N++]=(H-1)*W/2+z+K[D],V[N++]=(F-1)*q/2+X[D]}return V}}initializeState(){if(this.state={styleVersion:0,fontAtlasManager:new pX},this.props.maxWidth>0)r.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState($){let{props:Q,oldProps:J,changeFlags:Z}=$;if(Z.dataChanged||Z.updateTriggersChanged&&(Z.updateTriggersChanged.all||Z.updateTriggersChanged.getText))this._updateText();if(this._updateFontAtlas()||Q.lineHeight!==J.lineHeight||Q.wordBreak!==J.wordBreak||Q.maxWidth!==J.maxWidth)this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:$}){return $.object=$.index>=0?this.props.data[$.index]:null,$}_updateFontAtlas(){let{fontSettings:$,fontFamily:Q,fontWeight:J}=this.props,{fontAtlasManager:Z,characterSet:K}=this.state,X={...$,characterSet:K,fontFamily:Q,fontWeight:J};if(!Z.mapping)return Z.setProps(X),!0;for(let Y in X)if(X[Y]!==Z.props[Y])return Z.setProps(X),!0;return!1}_updateText(){let{data:$,characterSet:Q}=this.props,J=$.attributes?.getText,{getText:Z}=this.props,K=$.startIndices,X,Y=Q==="auto"&&new Set;if(J&&K){let{texts:W,characterCount:q}=vf({...ArrayBuffer.isView(J)?{value:J}:J,length:$.length,startIndices:K,characterSet:Y});X=q,Z=(H,{index:F})=>W[F]}else{let{iterable:W,objectInfo:q}=M4($);K=[0],X=0;for(let H of W){q.index++;let F=Array.from(Z(H,q)||"");if(Y)F.forEach(Y.add,Y);X+=F.length,K.push(X)}}this.setState({getText:Z,startIndices:K,numInstances:X,characterSet:Y||Q})}transformParagraph($,Q){let{fontAtlasManager:J}=this.state,Z=J.mapping,K=this.state.getText,{wordBreak:X,lineHeight:Y,maxWidth:W}=this.props,q=K($,Q)||"";return Lf(q,Y,X,W*J.props.fontSize,Z)}renderLayers(){let{startIndices:$,numInstances:Q,getText:J,fontAtlasManager:{scale:Z,atlas:K,mapping:X},styleVersion:Y}=this.state,{data:W,_dataDiff:q,getPosition:H,getColor:F,getSize:U,getAngle:V,getPixelOffset:N,getBackgroundColor:D,getBorderColor:z,getBorderWidth:B,backgroundBorderRadius:M,backgroundPadding:P,background:O,billboard:G,fontSettings:L,outlineWidth:b,outlineColor:d,sizeScale:p,sizeUnits:i,sizeMinPixels:l,sizeMaxPixels:N1,transitions:Y1,updateTriggers:a}=this.props,D1=this.getSubLayerClass("characters",Sf),F0=this.getSubLayerClass("background",uf);return[O&&new F0({getFillColor:D,getLineColor:z,getLineWidth:B,borderRadius:M,padding:P,getPosition:H,getSize:U,getAngle:V,getPixelOffset:N,billboard:G,sizeScale:p,sizeUnits:i,sizeMinPixels:l,sizeMaxPixels:N1,transitions:Y1&&{getPosition:Y1.getPosition,getAngle:Y1.getAngle,getSize:Y1.getSize,getFillColor:Y1.getBackgroundColor,getLineColor:Y1.getBorderColor,getLineWidth:Y1.getBorderWidth,getPixelOffset:Y1.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:a.getPosition,getAngle:a.getAngle,getSize:a.getSize,getFillColor:a.getBackgroundColor,getLineColor:a.getBorderColor,getLineWidth:a.getBorderWidth,getPixelOffset:a.getPixelOffset,getBoundingRect:{getText:a.getText,getTextAnchor:a.getTextAnchor,getAlignmentBaseline:a.getAlignmentBaseline,styleVersion:Y}}}),{data:W.attributes&&W.attributes.background?{length:W.length,attributes:W.attributes.background}:W,_dataDiff:q,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new D1({sdf:L.sdf,smoothing:Number.isFinite(L.smoothing)?L.smoothing:g8.smoothing,outlineWidth:b/(L.radius||g8.radius),outlineColor:d,iconAtlas:K,iconMapping:X,getPosition:H,getColor:F,getSize:U,getAngle:V,getPixelOffset:N,billboard:G,sizeScale:p*Z,sizeUnits:i,sizeMinPixels:l*Z,sizeMaxPixels:N1*Z,transitions:Y1&&{getPosition:Y1.getPosition,getAngle:Y1.getAngle,getColor:Y1.getColor,getSize:Y1.getSize,getPixelOffset:Y1.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:a.getText,getPosition:a.getPosition,getAngle:a.getAngle,getColor:a.getColor,getSize:a.getSize,getPixelOffset:a.getPixelOffset,getIconOffsets:{getTextAnchor:a.getTextAnchor,getAlignmentBaseline:a.getAlignmentBaseline,styleVersion:Y}}}),{data:W,_dataDiff:q,startIndices:$,numInstances:Q,getIconOffsets:this.getIconOffsets,getIcon:J})]}static set fontAtlasCacheLimit($){bf($)}};iX.defaultProps=z$1;iX.layerName="TextLayer";rf=iX});function A3({type:$,props:Q}){let J={};for(let Z in Q)J[Z]=$.defaultProps[Q[Z]];return J}function sX($,Q){let{transitions:J,updateTriggers:Z}=$.props,K={updateTriggers:{},transitions:J&&{getPosition:J.geometry}};for(let X in Q){let Y=Q[X],W=$.props[X];if(X.startsWith("get")){if(W=$.getSubLayerAccessor(W),K.updateTriggers[Y]=Z[X],J)K.transitions[Y]=J[X]}K[Y]=W}return K}var m$,c$,nX;var tf=C(()=>{lD();Gy();af();ny();zf();m$={circle:{type:Iy,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:OX,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:rf,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},c$={type:iy,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},nX={type:Af,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}}});function $b($){if(Array.isArray($))return $;switch(r.assert($.type,"GeoJSON does not have type"),$.type){case"Feature":return[$];case"FeatureCollection":return r.assert(Array.isArray($.features),"GeoJSON does not have features array"),$.features;default:return[{geometry:$}]}}function YC($,Q,J={}){let Z={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:K=0,endRow:X=$.length}=J;for(let Y=K;Y<X;Y++){let W=$[Y],{geometry:q}=W;if(!q)continue;if(q.type==="GeometryCollection"){r.assert(Array.isArray(q.geometries),"GeoJSON does not have geometries array");let{geometries:H}=q;for(let F=0;F<H.length;F++){let U=H[F];ef(U,Z,Q,W,Y)}}else ef(q,Z,Q,W,Y)}return Z}function ef($,Q,J,Z,K){let{type:X,coordinates:Y}=$,{pointFeatures:W,lineFeatures:q,polygonFeatures:H,polygonOutlineFeatures:F}=Q;if(!B$1(X,Y)){r.warn(`${X} coordinates are malformed`)();return}switch(X){case"Point":W.push(J({geometry:$},Z,K));break;case"MultiPoint":Y.forEach((U)=>{W.push(J({geometry:{type:"Point",coordinates:U}},Z,K))});break;case"LineString":q.push(J({geometry:$},Z,K));break;case"MultiLineString":Y.forEach((U)=>{q.push(J({geometry:{type:"LineString",coordinates:U}},Z,K))});break;case"Polygon":H.push(J({geometry:$},Z,K)),Y.forEach((U)=>{F.push(J({geometry:{type:"LineString",coordinates:U}},Z,K))});break;case"MultiPolygon":Y.forEach((U)=>{H.push(J({geometry:{type:"Polygon",coordinates:U}},Z,K)),U.forEach((V)=>{F.push(J({geometry:{type:"LineString",coordinates:V}},Z,K))})});break;default:}}function B$1($,Q){let J=k$1[$];r.assert(J,`Unknown GeoJSON type ${$}`);while(Q&&--J>0)Q=Q[0];return Q&&Number.isFinite(Q[0])}var k$1;var Qb=C(()=>{M0();k$1={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4}});function Jb(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function oX($){return $.geometry.coordinates}function Zb($,Q){let J=Jb(),{pointFeatures:Z,lineFeatures:K,polygonFeatures:X,polygonOutlineFeatures:Y}=$;return J.points.data=Z,J.points._dataDiff=Q.pointFeatures&&(()=>Q.pointFeatures),J.points.getPosition=oX,J.lines.data=K,J.lines._dataDiff=Q.lineFeatures&&(()=>Q.lineFeatures),J.lines.getPath=oX,J.polygons.data=X,J.polygons._dataDiff=Q.polygonFeatures&&(()=>Q.polygonFeatures),J.polygons.getPolygon=oX,J.polygonsOutline.data=Y,J.polygonsOutline._dataDiff=Q.polygonOutlineFeatures&&(()=>Q.polygonOutlineFeatures),J.polygonsOutline.getPath=oX,J}function Kb($,Q){let J=Jb(),{points:Z,lines:K,polygons:X}=$,Y=Rf($,Q);if(J.points.data={length:Z.positions.value.length/Z.positions.size,attributes:{...Z.attributes,getPosition:Z.positions,instancePickingColors:{size:4,value:Y.points}},properties:Z.properties,numericProps:Z.numericProps,featureIds:Z.featureIds},J.lines.data={length:K.pathIndices.value.length-1,startIndices:K.pathIndices.value,attributes:{...K.attributes,getPath:K.positions,instancePickingColors:{size:4,value:Y.lines}},properties:K.properties,numericProps:K.numericProps,featureIds:K.featureIds},J.lines._pathType="open",J.polygons.data={length:X.polygonIndices.value.length-1,startIndices:X.polygonIndices.value,attributes:{...X.attributes,getPolygon:X.positions,pickingColors:{size:4,value:Y.polygons}},properties:X.properties,numericProps:X.numericProps,featureIds:X.featureIds},J.polygons._normalize=!1,X.triangles)J.polygons.data.attributes.indices=X.triangles.value;return J.polygonsOutline.data={length:X.primitivePolygonIndices.value.length-1,startIndices:X.primitivePolygonIndices.value,attributes:{...X.attributes,getPath:X.positions,instancePickingColors:{size:4,value:Y.polygons}},properties:X.properties,numericProps:X.numericProps,featureIds:X.featureIds},J.polygonsOutline._pathType="open",J}var Xb=()=>{};var R$1,O$1,rX,WC;var Yb=C(()=>{M0();tf();Qb();Xb();R$1=["points","linestrings","polygons"],O$1={...A3(m$.circle),...A3(m$.icon),...A3(m$.text),...A3(c$),...A3(nX),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:($)=>$.properties.icon},getText:{type:"accessor",value:($)=>$.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};rX=class rX extends G${initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:$,changeFlags:Q}){if(!Q.dataChanged)return;let{data:J}=this.props,Z=J&&"points"in J&&"polygons"in J&&"lines"in J;if(this.setState({binary:Z}),Z)this._updateStateBinary({props:$,changeFlags:Q});else this._updateStateJSON({props:$,changeFlags:Q})}_updateStateBinary({props:$,changeFlags:Q}){let J=Kb($.data,this.encodePickingColor);this.setState({layerProps:J})}_updateStateJSON({props:$,changeFlags:Q}){let J=$b($.data),Z=this.getSubLayerRow.bind(this),K={},X={};if(Array.isArray(Q.dataChanged)){let W=this.state.features;for(let q in W)K[q]=W[q].slice(),X[q]=[];for(let q of Q.dataChanged){let H=YC(J,Z,q);for(let F in W)X[F].push(kf({data:K[F],getIndex:(U)=>U.__source.index,dataRange:q,replace:H[F]}))}}else K=YC(J,Z);let Y=Zb(K,X);this.setState({features:K,featuresDiff:X,layerProps:Y})}getPickingInfo($){let Q=super.getPickingInfo($),{index:J,sourceLayer:Z}=Q;if(Q.featureType=R$1.find((K)=>Z.id.startsWith(`${this.id}-${K}-`)),J>=0&&Z.id.startsWith(`${this.id}-points-text`)&&this.state.binary)Q.index=this.props.data.points.globalFeatureIds.value[J];return Q}_updateAutoHighlight($){let Q=`${this.id}-points-`,J=$.featureType==="points";for(let Z of this.getSubLayers())if(Z.id.startsWith(Q)===J)Z.updateAutoHighlight($)}_renderPolygonLayer(){let{extruded:$,wireframe:Q}=this.props,{layerProps:J}=this.state,Z="polygons-fill",K=this.shouldRenderSubLayer("polygons-fill",J.polygons?.data)&&this.getSubLayerClass("polygons-fill",nX.type);if(K){let X=sX(this,nX.props),Y=$&&Q;if(!Y)delete X.getLineColor;return X.updateTriggers.lineColors=Y,new K(X,this.getSubLayerProps({id:"polygons-fill",updateTriggers:X.updateTriggers}),J.polygons)}return null}_renderLineLayers(){let{extruded:$,stroked:Q}=this.props,{layerProps:J}=this.state,Z="polygons-stroke",K="linestrings",X=!$&&Q&&this.shouldRenderSubLayer("polygons-stroke",J.polygonsOutline?.data)&&this.getSubLayerClass("polygons-stroke",c$.type),Y=this.shouldRenderSubLayer("linestrings",J.lines?.data)&&this.getSubLayerClass("linestrings",c$.type);if(X||Y){let W=sX(this,c$.props);return[X&&new X(W,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:W.updateTriggers}),J.polygonsOutline),Y&&new Y(W,this.getSubLayerProps({id:"linestrings",updateTriggers:W.updateTriggers}),J.lines)]}return null}_renderPointLayers(){let{pointType:$}=this.props,{layerProps:Q,binary:J}=this.state,{highlightedObjectIndex:Z}=this.props;if(!J&&Number.isFinite(Z))Z=Q.points.data.findIndex((Y)=>Y.__source.index===Z);let K=new Set($.split("+")),X=[];for(let Y of K){let W=`points-${Y}`,q=m$[Y],H=q&&this.shouldRenderSubLayer(W,Q.points?.data)&&this.getSubLayerClass(W,q.type);if(H){let F=sX(this,q.props),U=Q.points;if(Y==="text"&&J){let{instancePickingColors:V,...N}=U.data.attributes;U={...U,data:{...U.data,attributes:N}}}X.push(new H(F,this.getSubLayerProps({id:W,updateTriggers:F.updateTriggers,highlightedObjectIndex:Z}),U))}}return X}renderLayers(){let{extruded:$}=this.props,Q=this._renderPolygonLayer(),J=this._renderLineLayers(),Z=this._renderPointLayers();return[!$&&Q,J,Z,$&&Q]}getSubLayerAccessor($){let{binary:Q}=this.state;if(!Q||typeof $!=="function")return super.getSubLayerAccessor($);return(J,Z)=>{let{data:K,index:X}=Z,Y=Bf(K,X);return $(Y,Z)}}};rX.layerName="GeoJsonLayer";rX.defaultProps=O$1;WC=rX});var Wb=C(()=>{Yb()});var aX,M$1,qb;var Hb=C(()=>{aX=A0(Z5(),1),M$1=typeof window<"u"?aX.useLayoutEffect:aX.useEffect,qb=M$1});function z3($,Q){while($){if($===Q)return!0;$=Object.getPrototypeOf($)}return!1}function tX($,Q){if(typeof $==="function")return $(Q);if(Array.isArray($))return $.map((J)=>tX(J,Q));if(k3($)){if(S$1($))return Q.style=w$1,qC.cloneElement($,Q);if(T$1($))return qC.cloneElement($,Q)}return $}function k3($){return $&&typeof $==="object"&&"type"in $||!1}function S$1($){return $.props?.mapStyle}function T$1($){let Q=$.type;return Q&&Q.deckGLViewProps}var qC,w$1;var HC=C(()=>{qC=A0(Z5(),1),w$1={position:"absolute",zIndex:-1}});function FC($){if(typeof $==="function")return Fb.createElement(c5,{},$);if(Array.isArray($))return $.map(FC);if(k3($)){if($.type===eX.Fragment)return FC($.props.children);if(z3($.type,c5))return $}return $}function UC({children:$,layers:Q=[],views:J=null}){let Z=[],K=[],X={};if(eX.Children.forEach(FC($),(Y)=>{if(k3(Y)){let W=Y.type;if(z3(W,i0)){let q=I$1(W,Y.props);K.push(q)}else Z.push(Y);if(z3(W,c5)&&W!==c5&&Y.props.id){let q=new W(Y.props);X[q.id]=q}}else if(Y)Z.push(Y)}),Object.keys(X).length>0){if(Array.isArray(J))J.forEach((Y)=>{X[Y.id]=Y});else if(J)X[J.id]=J;J=Object.values(X)}return Q=K.length>0?[...K,...Q]:Q,{layers:Q,children:Z,views:J}}function I$1($,Q){let J={},Z=$.defaultProps||{};for(let K in Q)if(Z[K]!==Q[K])J[K]=Q[K];return new $(J)}var eX,Fb;var Ub=C(()=>{M0();HC();eX=A0(Z5(),1),Fb=A0(Z5(),1)});var Vb,Nb;var Db=C(()=>{Vb=A0(Z5(),1),Nb=Vb.createContext()});function NC({children:$,deck:Q,ContextProvider:J=Nb.Provider}){let{viewManager:Z}=Q||{};if(!Z||!Z.views.length)return[];let K={},X=Z.views[0].id;for(let Y of $){let W=X,q=Y;if(k3(Y)&&z3(Y.type,c5))W=Y.props.id||X,q=Y.props.children;let H=Z.getViewport(W),F=Z.getViewState(W);if(H){F.padding=H.padding;let{x:U,y:V,width:N,height:D}=H;if(q=tX(q,{x:U,y:V,width:N,height:D,viewport:H,viewState:F}),!K[W])K[W]={viewport:H,children:[]};K[W].children.push(q)}}return Object.keys(K).map((Y)=>{let{viewport:W,children:q}=K[Y],{x:H,y:F,width:U,height:V}=W,N={position:"absolute",left:H,top:F,width:U,height:V},D=`view-${Y}`,z=VC.createElement("div",{key:D,id:D,style:N},...q),B={deck:Q,viewport:W,container:Q.canvas.offsetParent,eventManager:Q.eventManager,onViewStateChange:(P)=>{P.viewId=Y,Q._onViewStateChange(P)},widgets:[]},M=`view-${Y}-context`;return VC.createElement(J,{key:M,value:B},z)})}var VC;var Cb=C(()=>{M0();HC();Db();VC=A0(Z5(),1)});function DC({width:$,height:Q,style:J}){let Z={position:"absolute",zIndex:0,left:0,top:0,width:$,height:Q},K={left:0,top:0};if(J)for(let X in J)if(X in G$1)K[X]=J[X];else Z[X]=J[X];return{containerStyle:Z,canvasStyle:K}}var G$1;var Ab=C(()=>{G$1={mixBlendMode:null}});function E$1($){return{get deck(){return $.deck},pickObject:(Q)=>$.deck.pickObject(Q),pickMultipleObjects:(Q)=>$.deck.pickMultipleObjects(Q),pickObjects:(Q)=>$.deck.pickObjects(Q)}}function kb($){if($.redrawReason)$.deck._drawLayers($.redrawReason),$.redrawReason=null}function j$1($,Q,J){let Z=new Q({...J,_customRender:J.deviceProps?.adapters?.[0]?.type==="webgpu"?void 0:(K)=>{$.redrawReason=K;let X=Z.getViewports();if($.lastRenderedViewports!==X)$.forceUpdate();else kb($)}});return Z}function h$1($,Q){let[J,Z]=E0.useState(0),X=E0.useRef({control:null,version:J,forceUpdate:()=>Z((L)=>L+1)}).current,Y=E0.useRef(null),W=E0.useRef(null),q=E0.useMemo(()=>UC($),[$.layers,$.views,$.children]),H=!0,F=(L)=>{if(H&&$.viewState)return X.viewStateUpdateRequested=L,null;return X.viewStateUpdateRequested=null,$.onViewStateChange?.(L)},U=(L)=>{if(H)X.interactionStateUpdateRequested=L;else X.interactionStateUpdateRequested=null,$.onInteractionStateChange?.(L)},V=E0.useMemo(()=>{let L={widgets:[],...$,style:null,width:"100%",height:"100%",parent:Y.current,canvas:W.current,layers:q.layers,views:q.views,onViewStateChange:F,onInteractionStateChange:U};if(delete L._customRender,X.deck)X.deck.setProps(L);return L},[$]);E0.useEffect(()=>{let L=$.Deck||ID;return X.deck=j$1(X,L,{...V,parent:Y.current,canvas:W.current}),()=>X.deck?.finalize()},[]),qb(()=>{kb(X);let{viewStateUpdateRequested:L,interactionStateUpdateRequested:b}=X;if(L)F(L);if(b)U(b)}),E0.useImperativeHandle(Q,()=>E$1(X),[]);let N=X.deck&&X.deck.isInitialized?X.deck.getViewports():void 0,{ContextProvider:D,width:z="100%",height:B="100%",id:M,style:P}=$,{containerStyle:O,canvasStyle:G}=E0.useMemo(()=>DC({width:z,height:B,style:P}),[z,B,P]);if(!X.viewStateUpdateRequested&&X.lastRenderedViewports===N||X.version!==J){X.lastRenderedViewports=N,X.version=J;let L=NC({children:q.children,deck:X.deck,ContextProvider:D}),b=E0.createElement("canvas",{key:"canvas",id:M||"deckgl-overlay",ref:W,style:G});X.control=E0.createElement("div",{id:`${M||"deckgl"}-wrapper`,ref:Y,style:O},[b,L])}return H=!1,X.control}var zb,E0,L$1,d$;var Bb=C(()=>{M0();Hb();Ub();Cb();Ab();zb=A0(Z5(),1),E0=A0(Z5(),1);L$1=zb.forwardRef(h$1),d$=L$1});var Rb=C(()=>{Bb()});var Ob=C(()=>{Rb()});var Pb=()=>{};var x$1={};E7(x$1,{MapWidget:()=>_$1});function _$1({config:$,filters:Q=[]}){let{db:J,tableVersion:Z}=iI(),[K,X]=QY.useState([]);if(QY.useEffect(()=>{if(console.log(Z),!J||Z<1)return;debugger;new KY(J,$,Q).execute().then((q)=>{debugger;let H=q.reduce((F,U)=>{if(U&&U.simplified_geom_geojson)try{F.push(JSON.parse(U.simplified_geom_geojson))}catch(V){console.error("Error parsing GeoJSON:",V)}return F},[]);debugger;X(H)})},[J,Z]),console.log("Rendering MapWidget",K?.length),Z<1)return $Y.jsxDEV("div",{children:"Map will load after initial data is loaded."},void 0,!1,void 0,this);let Y=[new WC({id:"geojson-layer",data:K,pickable:!0,stroked:!1,filled:!0,extruded:!0,pointType:"circle",lineWidthScale:20,lineWidthMinPixels:2,getFillColor:[160,160,180,200],getPointRadius:100,getLineWidth:1,getElevation:30})];if(Z==0)return $Y.jsxDEV("span",{children:"Waiting"},void 0,!1,void 0,this);return $Y.jsxDEV(d$,{initialViewState:v$1,controller:!0,layers:Y,getTooltip:({object:W})=>{if(W&&W.properties){let q=$.params.columns?.find((H)=>H.column==="org_unit_name");if(q)return W.properties[q.label||q.column];return W.properties.name}return null}},void 0,!1,void 0,this)}var QY,$Y,v$1;var g$1=C(()=>{sI();Ob();Pb();Wb();QY=A0(Z5(),1),$Y=A0(D2(),1),v$1={longitude:-122.41669,latitude:37.7853,zoom:13,pitch:0,bearing:0}});g$1();export{_$1 as MapWidget};

//# debugId=49F209D41B4859A564756E2164756E21
//# sourceMappingURL=MapWidget.js.map
